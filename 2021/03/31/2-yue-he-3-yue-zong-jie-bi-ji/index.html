<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="2月和3月总结笔记, Handy&#39;s blog">
    <meta name="description" content="wuster">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>2月和3月总结笔记 | Handy&#39;s blog</title>
    <link rel="icon" type="image/png" href="/medias/zly.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"></head>



   <style>
    body{
       background-image: url(https://pic1.zhimg.com/80/v2-af16da70cb8e243abd76406cc4c52df4_1440w.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/zly.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Handy&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/zly.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Handy&#39;s blog</div>
        <div class="logo-desc">
            
            wuster
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/WustHandy" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/WustHandy" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/15.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">2月和3月总结笔记</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/writeup/" class="post-category">
                                writeup
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-03-31
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-10-02
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    15.4k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    93 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h1 id="Some-wp"><a href="#Some-wp" class="headerlink" title="Some wp"></a>Some wp</h1><h2 id="hgame2021week2-signin"><a href="#hgame2021week2-signin" class="headerlink" title="[hgame2021week2]signin"></a>[hgame2021week2]signin</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util <span class="token keyword">import</span> number

<span class="token keyword">from</span> secret <span class="token keyword">import</span> FLAG

m <span class="token operator">=</span> s2n<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>
a <span class="token operator">=</span> number<span class="token punctuation">.</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
p <span class="token operator">=</span> number<span class="token punctuation">.</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>

c <span class="token operator">=</span> a <span class="token operator">**</span> p <span class="token operator">*</span> m <span class="token operator">%</span> p

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># a = 114860703441277641159010520457158779743406545528920568790985108964161284695646120202566466577905632104388633713510921541107712064183498148484917830523711193223293589592121551112550440675243616576203905342750212598333519257633313008795211410775228583376590610854565937051450960491199274401879127456639254354787</span>
<span class="token comment"># p = 128337372863548733982628567035170003526593417952180525194192159178242702197521429086326104838106948416844886788242477807248072299082097134981718011660755395525206183882787666600218259021191537486566977688094471407299627161423853728124784268632944908474596463076060977522841693595025422665925345726268832156411</span>
<span class="token comment"># c = 89307609447045247940453313245387079059195320809034029001135691327604934287433876029928261397471393214500935563825104638091048695922698852839685381899565313007469197828666213834055492744237102478143542837196793018354189910673128014928309895806759030851721114111420175990080693470002656332421701173726269842336</span>
</code></pre>
<blockquote>
<p>费马小定理:</p>
<p>$ a ^ {p} \equiv a\left(\bmod p\right) $</p>
</blockquote>
<p>$$<br>\therefore c = \left(a * m\right) \bmod p<br>$$</p>
<p>设 ni 为 a mod p的逆元</p>
<p>两边同时乘ni，得<br>$$<br>m = (c * ni)\bmod p<br>$$<br>已知c,ni,p，可以求得m</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
a <span class="token operator">=</span> <span class="token number">114860703441277641159010520457158779743406545528920568790985108964161284695646120202566466577905632104388633713510921541107712064183498148484917830523711193223293589592121551112550440675243616576203905342750212598333519257633313008795211410775228583376590610854565937051450960491199274401879127456639254354787</span>
p <span class="token operator">=</span> <span class="token number">128337372863548733982628567035170003526593417952180525194192159178242702197521429086326104838106948416844886788242477807248072299082097134981718011660755395525206183882787666600218259021191537486566977688094471407299627161423853728124784268632944908474596463076060977522841693595025422665925345726268832156411</span>
c <span class="token operator">=</span> <span class="token number">89307609447045247940453313245387079059195320809034029001135691327604934287433876029928261397471393214500935563825104638091048695922698852839685381899565313007469197828666213834055492744237102478143542837196793018354189910673128014928309895806759030851721114111420175990080693470002656332421701173726269842336</span>
ni <span class="token operator">=</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
m <span class="token operator">=</span> c <span class="token operator">*</span> ni <span class="token operator">%</span> p 
<span class="token keyword">print</span> n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token comment"># hgame&#123;M0du1@r_m4th+1s^th3~ba5is-Of=cRypt0!!&#125;</span></code></pre>


<h2 id="Common-Private-Exponent（共私钥指数攻击，d相同）"><a href="#Common-Private-Exponent（共私钥指数攻击，d相同）" class="headerlink" title="Common Private Exponent（共私钥指数攻击，d相同）"></a>Common Private Exponent（共私钥指数攻击，d相同）</h2><p><img src="https://img-blog.csdnimg.cn/20210102164535469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FvNTI0MjYwNTU=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
e0<span class="token operator">=</span>
n0<span class="token operator">=</span>
c0<span class="token operator">=</span>
e1<span class="token operator">=</span>
n1<span class="token operator">=</span>
c1<span class="token operator">=</span>
e2<span class="token operator">=</span>
n2<span class="token operator">=</span>
c2<span class="token operator">=</span>

M<span class="token operator">=</span>iroot<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>
a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span>M<span class="token punctuation">,</span>e0<span class="token punctuation">,</span>e1<span class="token punctuation">,</span>e2<span class="token punctuation">]</span>
a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n0<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>
a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n2<span class="token punctuation">]</span>

Mat <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>a<span class="token punctuation">)</span>
Mat_LLL<span class="token operator">=</span>Mat<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>Mat_LLL<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>M
<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>


<h2 id="NCTF2019-babyRSA"><a href="#NCTF2019-babyRSA" class="headerlink" title="[NCTF2019]babyRSA"></a>[NCTF2019]babyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag

<span class="token keyword">def</span> <span class="token function">nextPrime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">+=</span> <span class="token number">2</span> <span class="token keyword">if</span> n <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">1</span>
    <span class="token keyword">while</span> <span class="token keyword">not</span> isPrime<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
        n <span class="token operator">+=</span> <span class="token number">2</span>
    <span class="token keyword">return</span> n

p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> nextPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
n <span class="token operator">=</span> p <span class="token operator">*</span> q
e <span class="token operator">=</span> <span class="token number">0x10001</span>
d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token comment"># d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>
<span class="token comment"># c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span>
</code></pre>


<p>已知<br>$$<br>e，d，c，q = nextprime(p)<br>$$</p>
<p>$$<br>(e*d-1)=k * (q-1)*(p-1)<br>$$</p>
<p><code>p,q接近，p*q为2048位</code></p>
<p><code> (e*d-1)是2064位的，所以k的取值范围为（pow(2,15),pow(2,16)）</code></p>
<p><code>通过爆破k的值，可以得到(p-1)*(q-1) 的值，对phi 开平方，进而求得p,q。</code></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span><span class="token operator">*</span>
<span class="token keyword">from</span> sympy <span class="token keyword">import</span><span class="token operator">*</span> 
<span class="token keyword">from</span> libnum <span class="token keyword">import</span><span class="token operator">*</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>
d <span class="token operator">=</span> <span class="token number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>
c <span class="token operator">=</span> <span class="token number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span>
<span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        phi <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>k
        P1 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>phi<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment">#  对(q-1)*(p-1)开平方        </span>
        p <span class="token operator">=</span> nextprime<span class="token punctuation">(</span>P1<span class="token punctuation">)</span>     <span class="token comment"># 获取素数P        </span>
        q_1 <span class="token operator">=</span> phi<span class="token operator">//</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>      <span class="token comment"># 得到(q-1)        </span>
        q <span class="token operator">=</span> q_1<span class="token operator">+</span><span class="token number">1</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>isprime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>       <span class="token comment"># 对q进行素性检测</span>
                   <span class="token keyword">break</span>            
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>
p<span class="token operator">=</span><span class="token number">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225076497</span>
q<span class="token operator">=</span><span class="token number">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225075839</span>
n<span class="token operator">=</span>p<span class="token operator">*</span>q
m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>


<h2 id="DiceCTF2021-newcrypt-v2"><a href="#DiceCTF2021-newcrypt-v2" class="headerlink" title="[DiceCTF2021]newcrypt v2"></a>[DiceCTF2021]newcrypt v2</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

flag <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Generator</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>N <span class="token operator">=</span> self<span class="token punctuation">.</span>p<span class="token operator">*</span>self<span class="token punctuation">.</span>q
        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">gen</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> <span class="token builtin">round</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            x <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">10</span><span class="token punctuation">)</span>
            <span class="token keyword">while</span> x<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token keyword">or</span> GCD<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
                x <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">10</span><span class="token punctuation">)</span>
            y <span class="token operator">=</span> inverse<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            numbers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">0x1337</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span>

g <span class="token operator">=</span> Generator<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
g<span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre>
<p>只有一解，大佬的exp也没太看懂，之后有空再研究（好像又用到coppersmith了</p>
<p>已知n，e，c，和几组由随机的D生成的E，这几组E只给phin有关系，所以要通过这几组E求出p和q，就能求得d了。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
<span class="token keyword">import</span> itertools
<span class="token keyword">from</span> sympy<span class="token punctuation">.</span>solvers<span class="token punctuation">.</span>diophantine<span class="token punctuation">.</span>diophantine <span class="token keyword">import</span> diop_linear
<span class="token keyword">from</span> sympy <span class="token keyword">import</span> symbols

<span class="token keyword">def</span> <span class="token function">getPolyInfo</span><span class="token punctuation">(</span>poly<span class="token punctuation">)</span><span class="token punctuation">:</span>
    HM <span class="token operator">=</span> poly<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment"># HM: head monomial</span>
    HC <span class="token operator">=</span> poly<span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>HM<span class="token punctuation">)</span>  <span class="token comment"># HC: head coefficient</span>
    HT <span class="token operator">=</span> HC<span class="token operator">*</span>HM                          <span class="token comment"># HT: head term</span>
    HI <span class="token operator">=</span> poly<span class="token punctuation">.</span>exponents<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment"># HI: head index</span>
    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'HT'</span><span class="token punctuation">:</span>HT<span class="token punctuation">,</span><span class="token string">'HC'</span><span class="token punctuation">:</span>HC<span class="token punctuation">,</span><span class="token string">'HM'</span><span class="token punctuation">:</span>HM<span class="token punctuation">,</span><span class="token string">'HI'</span><span class="token punctuation">:</span>HI<span class="token punctuation">&#125;</span>

<span class="token comment"># https://eprint.iacr.org/2012/675.pdf</span>
<span class="token keyword">def</span> <span class="token function">multivariate</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>E<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>m<span class="token punctuation">,</span>improve<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token comment"># Setup multivariate simultaneous equations</span>
    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span>
    P<span class="token punctuation">,</span>x <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>objgens<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># y = x[-1]</span>
    F <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
        F<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span>x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    X <span class="token operator">=</span> <span class="token punctuation">[</span>floor<span class="token punctuation">(</span>N<span class="token operator">^</span>beta<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>floor<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>N<span class="token operator">^</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># upper bounds</span>

    <span class="token comment"># Construct polynomials: G</span>
    G <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    I <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
        g <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
        i_k <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                g<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>i<span class="token operator">-</span>j<span class="token punctuation">)</span> <span class="token operator">*</span> F<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>j <span class="token operator">*</span> E<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>m<span class="token operator">-</span>j<span class="token punctuation">)</span>

                <span class="token comment"># check HM,HI</span>
                polyinfo <span class="token operator">=</span> getPolyInfo<span class="token punctuation">(</span>g<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>
                <span class="token keyword">assert</span> polyinfo<span class="token punctuation">[</span><span class="token string">'HM'</span><span class="token punctuation">]</span> <span class="token operator">==</span> x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>i <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>j
                <span class="token keyword">assert</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>polyinfo<span class="token punctuation">[</span><span class="token string">'HI'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i <span class="token keyword">if</span> <span class="token punctuation">(</span>_ <span class="token operator">==</span> k<span class="token punctuation">)</span> <span class="token keyword">else</span> j <span class="token keyword">if</span><span class="token punctuation">(</span>_ <span class="token operator">==</span> l<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                i_k<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>polyinfo<span class="token punctuation">[</span><span class="token string">'HI'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        G<span class="token punctuation">.</span>append<span class="token punctuation">(</span>g<span class="token punctuation">)</span>
        I<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i_k<span class="token punctuation">)</span>

    <span class="token comment"># Get index set I+</span>
    I_plus <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token operator">*</span>I<span class="token punctuation">)</span><span class="token punctuation">:</span>
        I_plus<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    I_plus <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>I_plus<span class="token punctuation">)</span>

    <span class="token keyword">if</span> improve<span class="token punctuation">:</span>
        <span class="token comment"># Get index set I++</span>
        I_pp <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> idx <span class="token keyword">in</span> I_plus<span class="token punctuation">:</span>
            <span class="token keyword">if</span> idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token number">.5</span><span class="token operator">*</span>idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span>beta <span class="token operator">-</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
                I_pp<span class="token punctuation">.</span>add<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>
        I_pp <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>I_pp<span class="token punctuation">)</span>
        I_plus <span class="token operator">=</span> I_pp

    <span class="token comment"># Construct polynomials: G+</span>
    G_plus <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> idx <span class="token keyword">in</span> I_plus<span class="token punctuation">:</span>
        J <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> j_tuples <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>repeat<span class="token operator">=</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>j_tuples<span class="token punctuation">)</span> <span class="token operator">==</span> idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token keyword">not</span> <span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> j_tuples<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                J<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j_tuples<span class="token punctuation">)</span>

        <span class="token comment"># Find GCD(HC)</span>
        gcdn <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> J<span class="token punctuation">:</span>
            polyinfo <span class="token operator">=</span> getPolyInfo<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>j<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            gcdn <span class="token operator">=</span> polyinfo<span class="token punctuation">[</span><span class="token string">'HC'</span><span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>gcdn <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">else</span> gcd<span class="token punctuation">(</span>gcdn<span class="token punctuation">,</span>polyinfo<span class="token punctuation">[</span><span class="token string">'HC'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>
            arr <span class="token operator">=</span> <span class="token punctuation">[</span>getPolyInfo<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>J<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'HC'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
            sols <span class="token operator">=</span> diop_linear<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">*</span>x0 <span class="token keyword">for</span> t<span class="token punctuation">,</span>x0 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>symbols<span class="token punctuation">(</span><span class="token string">"x0:%d"</span><span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span>integer<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span>gcdn<span class="token punctuation">)</span>
            a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>expr<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>t<span class="token punctuation">:</span><span class="token number">0</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> sols<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>free_symbols<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> expr <span class="token keyword">in</span> sols<span class="token punctuation">]</span>
            <span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> gcdn
            poly <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>J<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            poly <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>j<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> J<span class="token punctuation">)</span>

        <span class="token comment"># check HM</span>
        <span class="token keyword">for</span> j <span class="token keyword">in</span> J<span class="token punctuation">:</span>
            polyinfo <span class="token operator">=</span> getPolyInfo<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>j<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">assert</span> polyinfo<span class="token punctuation">[</span><span class="token string">'HM'</span><span class="token punctuation">]</span> <span class="token operator">==</span> prod<span class="token punctuation">(</span>x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        g_poly <span class="token operator">=</span> poly<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
        G_plus<span class="token punctuation">.</span>append<span class="token punctuation">(</span>g_poly<span class="token punctuation">)</span>

    <span class="token comment"># Get monomials</span>
    monomials <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> poly <span class="token keyword">in</span> G_plus<span class="token punctuation">:</span>
        <span class="token keyword">for</span> m1 <span class="token keyword">in</span> poly<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            monomials<span class="token punctuation">.</span>add<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>
    monomials <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span> <span class="token comment"># sort monomials</span>

    <span class="token comment"># Setup matrix for LLL</span>
    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Matrix dimensions: &#123;&#125;x&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    L <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i<span class="token punctuation">,</span>poly <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j<span class="token punctuation">,</span>m1 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">:</span>
            L<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> poly<span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>

    L <span class="token operator">=</span> L<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>
    
    <span class="token comment"># Get system of polynomials</span>
    H <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> j<span class="token punctuation">,</span>m1 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">:</span>
            H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> P<span class="token punctuation">(</span>m1 <span class="token operator">*</span> L<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">/</span> m1<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">:</span>X<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    <span class="token comment"># Find roots using Groebner basis</span>
    H <span class="token operator">=</span> <span class="token punctuation">[</span>eq<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>QQ<span class="token punctuation">)</span> <span class="token keyword">for</span> eq <span class="token keyword">in</span> H<span class="token punctuation">]</span>
    I <span class="token operator">=</span> Ideal<span class="token punctuation">(</span><span class="token operator">*</span>H<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>l<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    g <span class="token operator">=</span> I<span class="token punctuation">.</span>groebner_basis<span class="token punctuation">(</span><span class="token string">'giac'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> g <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>
    x0 <span class="token operator">=</span> var<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>n<span class="token operator">=</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>
    sols <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span>eq<span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token keyword">for</span> eq <span class="token keyword">in</span> g<span class="token punctuation">]</span><span class="token punctuation">,</span>x0<span class="token punctuation">,</span>solution_dict<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> s <span class="token keyword">in</span> sols<span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>is_integer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> x0<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            p_plus_q <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">-</span>s<span class="token punctuation">[</span>x0<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
            x1 <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
            f <span class="token operator">=</span> x1<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> p_plus_q<span class="token operator">*</span>x1 <span class="token operator">+</span> N
            roots <span class="token operator">=</span> f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>
            p<span class="token punctuation">,</span>q <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>roots<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>n<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>m<span class="token punctuation">,</span>improve<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">'''
    l: number of RSA keys
    n: RSA bit length
    beta: ratio of secret keys to n
    '''</span>
    p <span class="token operator">=</span> random_prime<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>lbound<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    q <span class="token operator">=</span> random_prime<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>lbound<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    N <span class="token operator">=</span> p<span class="token operator">*</span>q
    d_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    e_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        d <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>beta<span class="token operator">*</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> d<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token keyword">or</span> gcd<span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">continue</span>
        d_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>
        e <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        e_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>d_arr<span class="token punctuation">)</span> <span class="token operator">==</span> l<span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"N=pxq: &#123;&#125; = &#123;&#125; x &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"E:"</span><span class="token punctuation">,</span>e_arr<span class="token punctuation">)</span>
    <span class="token keyword">assert</span> <span class="token builtin">set</span><span class="token punctuation">(</span>multivariate<span class="token punctuation">(</span>N<span class="token punctuation">,</span>e_arr<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>m<span class="token punctuation">,</span>improve<span class="token operator">=</span>improve<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Recovered successfully!"</span><span class="token punctuation">)</span>

<span class="token comment"># Tests</span>
<span class="token comment"># test(2,2048,.4,3)</span>
<span class="token comment"># test(3,1024,.46,2)</span>
<span class="token comment"># test(4,2048,.465,1,True)</span>
<span class="token comment"># test(5,2048,.5,1,True)</span>

N <span class="token operator">=</span> <span class="token number">14337596625981852268356733199577363454740211423306675087406912203612106754740920535831186446286722686623181504391319837160175722628785779086065934404508907495375575604993274597567269696998989342554512169936041805398614285019559611603192791406141673196062487187176974406170426326985080300401992871878272750861304966084697316255932229517848590059063403143320068885919541934394285204068719613486701354616465507009243987608727662705537132041395688365562715140968368814327462123434153164039701357637150078015089287814859891259359522535418157646847992980552057214329745061692026530855072281235664669710276172313808317219377</span>
E <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12976676506376070110040406570149996101394527411415881605860843983349363069127746407886818103004002117366801754683449911816105354951654828869006253634088640931647307722477393307231188093852730642851927610384508472618758673499740002362888463449907850898256709493427721244039346744775543365490896192997672156351539772375297375865701816236826858372370828737647663910668758559951734259138880399000934641709724370982987684871113999721232035923836779554293705654708805788634929466224221204317582909006400475748926200070330888314906329563110519417492641071166678480550894995905707586159556311266401315984011972916692724662007</span><span class="token punctuation">,</span> <span class="token number">1863763332200533355187495032998617435554266559806936864499583761336209979224578994667995146126874905256288657356393344293005098598793270446199080399410824354463753330703855276639236442323809498935079594864731622806981650099779625802394492866772783164556122039084479891630004937148495825596230840040565205548593767270423848984375003632523408070963142589587241988428801951874519861970126281101472254516564569333579422627371073253518765484477877683153600580032505599620122184765699186189626337136723831818155748441783703710300026814764444157324740641952652611754903513683898296023658398333790727757433569553518827781081</span><span class="token punctuation">,</span> <span class="token number">2266107108355028257265149613659513002904527665415922083354756255551387373798380715368636460529830761909106090742940804896135018713646665813103359939678904950388594536893820576541648929534374197197699236090310478668004566290689920782095321065479404918697144906086349325096417620451929567373057958837794405051832027393710209669487434964110954150175622748681581358286557194922971711892121496052503670245966738246893335673371911853174980221559458430193451035071192245185753464656500832472716390638460484671724823329824542466725661315185971990283547100285181536347175215757494437839674240264046716971285767053511953014531</span><span class="token punctuation">,</span> <span class="token number">3012665180743215926044185696769375844027893756273454464899436474243670235496407935713055380725328632598984826511997157495169513834153639995899362029217480834870286205900296318828132585598137285805346657507373383217564586845718076975940327895945639149538433468219499891765910172868182009270172797753293191815210844128651385425158004075468732463275400326825588500413826705324683883847629057842100412354271506810539904381290499384122685388561018876503682490390411350939677572500607680288271353610724980926630513275655559323486108263101876350397264023226898671971480444539423455934221932088753929657082051926857943772249</span><span class="token punctuation">,</span> <span class="token number">11654698355361642253478315394509778991884549939645189298025844618346681492919905598771246194066168408610846920719586231628616008528010499420499104967297209036853716237681916872940149475834811605883772954478356917401690932414133714754145102545282932055458620466374791600444965981474694964466374906501557735419193196210081985354200587280684723865152043847523132554069361865253297610018545961901224789197822102327845824463263202308386229169765022168048658546459296356873527223601643713792899944747399360948976054350376734975776305888045491739605171010206699460442078038128020076159311221789613452312845058576145149846029</span><span class="token punctuation">]</span>
c <span class="token operator">=</span> <span class="token number">3956820731464413675248976184330090386023400385276540416612412624089512558297526443036270899672623474843471114663110309683900437072074275592048007465581536399064139915757208597226420873829762312175028263779702542540471556091196109301321307501425411404463271934422940357892918540470499135323435236378549758184835624591770086862646876844851191370941059743180644939927085439332975325190261804739679687807083505313731296227816013191899297272702691347829966232657275540293776915188791505265719622572712788357792237668230216117983278509746622406227163590935715374994406994094600128249001135177407180401006889949317057904629</span>
p<span class="token punctuation">,</span>q <span class="token operator">=</span> multivariate<span class="token punctuation">(</span>N<span class="token punctuation">,</span>E<span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>
<span class="token keyword">assert</span> p<span class="token operator">*</span>q <span class="token operator">==</span> N
phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">0x1337</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>




<h2 id="VNCTF2021-strange-function"><a href="#VNCTF2021-strange-function" class="headerlink" title="[VNCTF2021]strange_function"></a>[VNCTF2021]strange_function</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag
<span class="token keyword">import</span> socketserver
<span class="token keyword">import</span> signal
<span class="token keyword">import</span> string
<span class="token keyword">import</span> random
<span class="token keyword">import</span> os

MENU <span class="token operator">=</span> <span class="token triple-quoted-string string">br'''[+] 1.function
[+] 2.check_answer
[+] 3.exit
'''</span>

<span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">_recvall</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        BUFF_SIZE <span class="token operator">=</span> <span class="token number">2048</span>
        data <span class="token operator">=</span> <span class="token string">b''</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            part <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>BUFF_SIZE<span class="token punctuation">)</span>
            data <span class="token operator">+=</span> part
            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span> <span class="token operator">&lt;</span> BUFF_SIZE<span class="token punctuation">:</span>
                <span class="token keyword">break</span>
        <span class="token keyword">return</span> data<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> newline<span class="token punctuation">:</span>
                msg <span class="token operator">+=</span> <span class="token string">b'\n'</span>
            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>

    <span class="token keyword">def</span> <span class="token function">recv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> prompt<span class="token operator">=</span><span class="token string">b'[-] '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>prompt<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">proof_of_work</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        proof <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        _hexdigest <span class="token operator">=</span> sha256<span class="token punctuation">(</span>proof<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+] sha256(XXXX+</span><span class="token interpolation"><span class="token punctuation">&#123;</span>proof<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token format-spec">]</span><span class="token punctuation">&#125;</span></span><span class="token string">) == </span><span class="token interpolation"><span class="token punctuation">&#123;</span>_hexdigest<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        x <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>prompt<span class="token operator">=</span><span class="token string">b'[+] Plz tell me XXXX: '</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token keyword">or</span> sha256<span class="token punctuation">(</span>x<span class="token operator">+</span>proof<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> _hexdigest<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>

    <span class="token keyword">def</span> <span class="token function">function</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>
        res <span class="token operator">=</span> <span class="token number">0</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">:</span>
            numerator <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            denominator <span class="token operator">=</span> x <span class="token operator">-</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
            <span class="token keyword">try</span><span class="token punctuation">:</span>
                tmp <span class="token operator">=</span> numerator <span class="token operator">/</span> denominator
            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] Error!'</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>
            res <span class="token operator">+=</span> tmp
        <span class="token keyword">return</span> res

    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        signal<span class="token punctuation">.</span>alarm<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>proof_of_work<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span>
            
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] Welcome!'</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] Can you find the flag through the calculating?'</span><span class="token punctuation">)</span>

        self<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>lenth <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>getRandomInteger<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>MENU<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
            choice <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span>choice <span class="token operator">==</span> <span class="token string">b'1'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"[+] Plz give me your x: "</span><span class="token punctuation">)</span>
                now <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                now <span class="token operator">=</span> self<span class="token punctuation">.</span>function<span class="token punctuation">(</span>now<span class="token punctuation">)</span>
                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"[+] let me show you the answer: "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">elif</span><span class="token punctuation">(</span>choice <span class="token operator">==</span> <span class="token string">b'2'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                guess <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span>guess <span class="token operator">==</span> self<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>score <span class="token operator">+=</span> <span class="token number">1</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"[+] You win!"</span><span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"[!] Now your score: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

                    self<span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>lenth <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token<span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
                    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">:</span>
                        self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>getRandomInteger<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    
                    <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] What do you want to say???'</span><span class="token punctuation">)</span>
                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[!] Go away!'</span><span class="token punctuation">)</span>
                    <span class="token keyword">break</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>

        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">ThreadedServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>ThreadingMixIn<span class="token punctuation">,</span> socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


<span class="token keyword">class</span> <span class="token class-name">ForkedServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>ForkingMixIn<span class="token punctuation">,</span> socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">10002</span>
    server <span class="token operator">=</span> ForkedServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> Task<span class="token punctuation">)</span>
    server<span class="token punctuation">.</span>allow_reuse_address <span class="token operator">=</span> <span class="token boolean">True</span>
    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>
<p>主要逻辑如下：</p>
<p><img src="imgs/image-20210321162145223.png" alt="image-20210321162145223"></p>
<p>即每次反馈给我们的res等于token[i]/(x-data[i])的和</p>
<p>x是我们输入的数，每次输入data[i]+1，后面的每项分母很大，极限约等于0，所以每次的res都约等于token[i]</p>
<h2 id="NepCTF2021-Real-Base"><a href="#NepCTF2021-Real-Base" class="headerlink" title="[NepCTF2021]Real_Base"></a>[NepCTF2021]Real_Base</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#py2</span>
<span class="token keyword">import</span> string
<span class="token keyword">import</span> random
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token punctuation">,</span>b_char

<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res<span class="token operator">=</span><span class="token string">''</span>
    binstr<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    p1<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>binstr<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span>
    p2<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>binstr<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">3</span>
    part1 <span class="token operator">=</span> binstr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token operator">*</span>p1<span class="token punctuation">]</span>
    
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">:</span>
        str_p1<span class="token operator">=</span>binstr<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>binstr<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>binstr<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>
        tmp_str <span class="token operator">=</span> <span class="token punctuation">[</span>str_p1<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>b_char<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> tmp_str<span class="token punctuation">]</span>
        res<span class="token operator">+=</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>

    <span class="token keyword">if</span> p2<span class="token punctuation">:</span>
        part2 <span class="token operator">=</span> binstr<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>p1<span class="token punctuation">:</span><span class="token punctuation">]</span>
        str_p2 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>part2<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>p2<span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">'0'</span><span class="token operator">*</span><span class="token number">8</span>
        tmp_str <span class="token operator">=</span> <span class="token punctuation">[</span>str_p2<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>p2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>
        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>b_char<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> tmp_str<span class="token punctuation">]</span>
        res<span class="token operator">+=</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>
        res <span class="token operator">+=</span><span class="token string">'='</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>p2<span class="token punctuation">)</span>
    <span class="token keyword">return</span> res
 
m1<span class="token operator">=</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>b_char<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>
<span class="token keyword">print</span> encode<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>
<span class="token keyword">print</span> encode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># rTcb1BR8YVW2EOUjweXpIiLt5QCNg7ZAsD9muq3ylMhvofnx/P</span>
<span class="token comment"># 2Br9y9fcu97zvB2OruZv0D3Bwhbj0uNQnvfdtC2TwAfPrdBJ3xeP4wNn0hzLzCVUlRa=</span>
<span class="token comment"># tCvM4R3TzvZ7nhjBxSiNyxmP28e7qCjVxQn91SRM3gBKzxQ=</span></code></pre>
<blockquote>
<p>b_char = ‘abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/‘</p>
</blockquote>
<p>base64变种，编码过程是每个转成八位二进制数之后，每六位切片，二进制转十进制对应到表上的位置，最后补位。所以我们解码就可以先把每个字符根据表上的位置全部转成六位二进制数，然后八个一组切片，转成十进制，ASCII码转字符。</p>
<pre class="language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'tCvM4R3TzvZ7nhjBxSiNyxmP28e7qCjVxQn91SRM3gBKzxQ='</span>
<span class="token comment"># b = ''</span>
<span class="token comment"># for i in s:</span>
<span class="token comment">#     for j in range(len(b_char)):</span>
<span class="token comment">#         if i == b_char[j]:</span>
<span class="token comment">#             b += str(bin(j)).replace('0b', '').zfill(6)</span>
            <span class="token comment"># print b</span>
<span class="token comment"># print b</span>
b <span class="token operator">=</span> <span class="token string">'0100111001100101011100000111101101010111011101110110010101011111011000010011010001110010011001010101111101100010001100010110000101110011001100110111001000100001001000010100001001100010011110010101111101000011011000110110111101101101011100000111010001101001011011100110010101111101'</span> <span class="token comment">#去掉末尾两个0</span>
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> flag</code></pre>


<h2 id="NepCTF2021-easyEncryption"><a href="#NepCTF2021-easyEncryption" class="headerlink" title="[NepCTF2021]easyEncryption"></a>[NepCTF2021]easyEncryption</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> random <span class="token keyword">import</span> randrange
<span class="token keyword">from</span> random <span class="token keyword">import</span> shuffle
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag1<span class="token punctuation">,</span> flag2
<span class="token keyword">import</span> string
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5


ALPHABET <span class="token operator">=</span> string<span class="token punctuation">.</span>hexdigits<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span>
ALPHABET_ALL <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> \
    string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits


<span class="token keyword">def</span> <span class="token function">plus</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num1 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num2 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>
        tmp <span class="token operator">=</span> tmp <span class="token operator">&lt;&lt;</span> i
        res <span class="token operator">+=</span> tmp
        num1 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>
        num2 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> res


<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> key<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    c <span class="token operator">=</span> <span class="token string">''</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> msg<span class="token punctuation">:</span>
        c_i <span class="token operator">=</span> key<span class="token punctuation">[</span>plus<span class="token punctuation">(</span>key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">]</span>
        c <span class="token operator">+=</span> c_i
        s <span class="token operator">=</span> key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">return</span> c


k <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>ALPHABET<span class="token punctuation">)</span>
shuffle<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
k <span class="token operator">=</span> <span class="token string">'ca038b6194df72e5'</span>

m <span class="token operator">=</span> <span class="token string">b'Welcome to NepCTF. I have a message for you '</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> flag1<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
cipher <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>
<span class="token comment"># 93d4466bb2277405eb5265f1943efd76c5f335fab5800afdc4058ad587743555baadd4058cc21ac5e8e2130580043af40ac5e5e8e2133ac58cc66aad5880758cc66aadc46a85dcbbcee8a555dccbccc47cbf</span>

<span class="token comment"># kk = []</span>
<span class="token comment"># kk.append(k)</span>
<span class="token comment"># while len(kk) &lt; 500:</span>
<span class="token comment">#     tmp_k = list(ALPHABET)</span>
<span class="token comment">#     shuffle(tmp_k)</span>
<span class="token comment">#     if encrypt(m, tmp_k, 7) == cipher:</span>
<span class="token comment">#         kk.append(tmp_k)</span>

kk <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'22'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'out.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> k <span class="token keyword">in</span> kk<span class="token punctuation">:</span>
    iv <span class="token operator">=</span> <span class="token string">b'i\xfd\xd1\xb9\x81U\x87\xde\xdbB\x9b\x1b\x14|\x97\x14'</span>
    secret2 <span class="token operator">=</span> flag2 <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    m <span class="token operator">=</span> <span class="token string">b"Hope you enjoy NepCtf"</span>
    m <span class="token operator">=</span> m <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    AES_keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        prefix <span class="token operator">=</span> ALPHABET_ALL<span class="token punctuation">[</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET_ALL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> \
            ALPHABET_ALL<span class="token punctuation">[</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET_ALL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        AES_keys<span class="token punctuation">.</span>append<span class="token punctuation">(</span>prefix<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span>

    <span class="token keyword">for</span> subkey <span class="token keyword">in</span> AES_keys<span class="token punctuation">:</span>
        cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>subkey<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>
        secret2 <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>secret2<span class="token punctuation">)</span>

    <span class="token keyword">for</span> subkey <span class="token keyword">in</span> AES_keys<span class="token punctuation">:</span>
        cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>subkey<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>
        m <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span>

    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span>secret2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> md5<span class="token punctuation">(</span>
        <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span>
</code></pre>


<p>求解第一部分的flag1很简单，通过找规律发现plus函数的逆运算还是plus</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plus</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num1 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num2 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>
        tmp <span class="token operator">=</span> tmp <span class="token operator">&lt;&lt;</span> i
        res <span class="token operator">+=</span> tmp
        num1 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>
        num2 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>
    <span class="token keyword">return</span> res
key <span class="token operator">=</span> <span class="token string">'ca038b6194df72e5'</span>
s <span class="token operator">=</span> <span class="token number">7</span>
flag <span class="token operator">=</span> <span class="token string">'93d4466bb2277405eb5265f1943efd76c5f335fab5800afdc4058ad587743555baadd4058cc21ac5e8e2130580043af40ac5e5e8e2133ac58cc66aad5880758cc66aadc46a85dcbbcee8a555dccbccc47cbf'</span>
flag1 <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
    c_i <span class="token operator">=</span> key<span class="token punctuation">[</span>plus<span class="token punctuation">(</span>key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">]</span>
    flag1 <span class="token operator">+=</span> c_i
    s <span class="token operator">=</span> key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c_i<span class="token punctuation">)</span> <span class="token comment"># 这里特别要注意一下，不是i而是c_i</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># b"Welcome to NepCTF. I have a message for you here's your flag1: flag&#123;0d3c21dd36fe3b"</span></code></pre>


<p>第二部分的flag2，遍历所有的AESKEY以及用这些key生成明文加密两次和密文解密两次的两个list，用set和&amp;来找交集，并且找到这个交集使用了哪四个key，最后用这四个key解密即可。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
<span class="token keyword">import</span> string
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">def</span> <span class="token function">jiami</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>k<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>
    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">jiemi</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>k<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>
    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
ALPHABET_ALL <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits
cipher <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'26bd5910dfb1a236a7ca20650eb9ea3d846d1baacde9591cfdf28c852e16ddf6'</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token string">b"Hope you enjoy NepCtf"</span>
m <span class="token operator">=</span> m <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
iv <span class="token operator">=</span> <span class="token string">b'i\xfd\xd1\xb9\x81U\x87\xde\xdbB\x9b\x1b\x14|\x97\x14'</span>
k <span class="token operator">=</span> <span class="token string">'ca038b6194df72e5'</span>
list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
list3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
list4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token comment"># for a in tqdm(ALPHABET_ALL):#加密</span>
<span class="token comment">#     for b in ALPHABET_ALL:</span>
<span class="token comment">#         str1 = a+b</span>
<span class="token comment">#         key1 = str1.encode() + ''.join(k).encode() + b'\x00' * 6</span>
<span class="token comment">#         jiami1 = jiami(m, key1)</span>
<span class="token comment">#         for c in ALPHABET_ALL:</span>
<span class="token comment">#             for d in ALPHABET_ALL:</span>
<span class="token comment">#                 str2 = c+d</span>
<span class="token comment">#                 key2 = str2.encode() + ''.join(k).encode() + b'\x00' * 6</span>
<span class="token comment">#                 jiami2 = jiami(jiami1, key2)</span>
<span class="token comment">#                 list1.append(jiami2)</span>
<span class="token comment">#                 list2.append(str(a+b+c+d))</span>
<span class="token comment"># print('ok1')</span>
<span class="token comment"># for a in tqdm(ALPHABET_ALL):</span>
<span class="token comment">#     for b in ALPHABET_ALL:</span>
<span class="token comment">#         str1 = a+b</span>
<span class="token comment">#         key3 = str1.encode() + ''.join(k).encode() + b'\x00' * 6</span>
<span class="token comment">#         jiemi1 = jiemi(cipher, key3)</span>
<span class="token comment">#         for c in ALPHABET_ALL:</span>
<span class="token comment">#             for d in ALPHABET_ALL:</span>
<span class="token comment">#                 str2 = c+d</span>
<span class="token comment">#                 key4 = str2.encode() + ''.join(k).encode() + b'\x00' * 6</span>
<span class="token comment">#                 jiemi2 = jiemi(jiemi1, key4)</span>
<span class="token comment">#                 list3.append(jiemi2)</span>
<span class="token comment">#                 list4.append(str(a+b+c+d)) </span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ok2'</span><span class="token punctuation">)</span>
<span class="token comment"># jiaoji = set(list1) &amp; set(list3)</span>
<span class="token comment"># print(jiaoji)</span>
jiaoji <span class="token operator">=</span> <span class="token string">b'\x87\xf3b\xfe\xc8\xe3\x96q5\xdax\x01\xe1U\xfd\x88_:7\xb8\t\x82\x83\xdd5\x1atO\xe9\xdfn\xea'</span>
<span class="token comment"># for i in tqdm(range(len(list1))):</span>
    <span class="token comment"># if list1[i] == jiaoji:</span>
    <span class="token comment">#     print(list2[i])</span>
    <span class="token comment">#     exit()</span>
    <span class="token comment"># if list3[i] == jiaoji:</span>
    <span class="token comment">#     print(list4[i])</span>
    <span class="token comment">#     exit()</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ok3'</span><span class="token punctuation">)</span>
key1 <span class="token operator">=</span> <span class="token string">'8U'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>
key2 <span class="token operator">=</span> <span class="token string">'9e'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>
key3 <span class="token operator">=</span> <span class="token string">'aT'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>
key4 <span class="token operator">=</span> <span class="token string">'lt'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>
flag <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'9da1f3806954ebe7f76b829f799901617ffae4eee96c5bb925f6fd58feecdef2c74505c02262e9d5480c2375300f2f3d404a6eee31f03e172c30b246c6490479d2d6d759611dc5cdc410d631b9709936'</span><span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> jiemi<span class="token punctuation">(</span>jiemi<span class="token punctuation">(</span>jiemi<span class="token punctuation">(</span>jiemi<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> key3<span class="token punctuation">)</span><span class="token punctuation">,</span> key4<span class="token punctuation">)</span><span class="token punctuation">,</span> key2<span class="token punctuation">)</span><span class="token punctuation">,</span> key1<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span>
<span class="token comment"># b'wow! you are wonderful, this is your flag2 : aaf2e86a3fe4af5156&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span></code></pre>


<h2 id="GKCTF2020-Backdoor"><a href="#GKCTF2020-Backdoor" class="headerlink" title="[GKCTF2020]Backdoor"></a>[GKCTF2020]Backdoor</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA
<span class="token keyword">import</span> gmpy2<span class="token punctuation">,</span> binascii
<span class="token keyword">import</span> base64
<span class="token keyword">from</span> FLAG <span class="token keyword">import</span> flag

<span class="token keyword">def</span> <span class="token function">rsa_encrypt</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./pub.pem'</span> <span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>import_key<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    e <span class="token operator">=</span> key<span class="token punctuation">.</span>e
    n <span class="token operator">=</span> key<span class="token punctuation">.</span>n
    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
 
    ciphertext <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> ciphertext

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>rsa_encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre>
<p>某CVE</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># f = '02142af7ce70fe0ddae116bb7e96260274ee9252a8cb528e7fdd29809c2a6032727c05526133ae4610ed944572ff1abfcd0b17aa22ef44a2'</span>
<span class="token comment"># c = bytes_to_long(bytes.fromhex(f))</span>
<span class="token comment"># print(c)</span>
<span class="token comment"># with open('./pub.pem' ,'r') as f:</span>
<span class="token comment">#     key = RSA.import_key(f.read())</span>
<span class="token comment"># e = key.e</span>
<span class="token comment"># n = key.n</span>
<span class="token comment"># print(e, n)</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util <span class="token keyword">import</span> number
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
c <span class="token operator">=</span> <span class="token number">5902102609936183530036413041949205016072856184947596155784933422689438216690059498706287388882989673839294236821030261398121787376802</span>
e <span class="token operator">=</span> <span class="token number">65537</span> 
n <span class="token operator">=</span> <span class="token number">15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739</span>
vals<span class="token operator">=</span><span class="token number">39</span>
M<span class="token operator">=</span><span class="token number">1</span>
n <span class="token operator">=</span> mpz<span class="token punctuation">(</span><span class="token number">15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739</span><span class="token punctuation">)</span>
primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">,</span> <span class="token number">263</span><span class="token punctuation">,</span> <span class="token number">269</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">,</span> <span class="token number">277</span><span class="token punctuation">,</span> <span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">283</span><span class="token punctuation">,</span> <span class="token number">293</span><span class="token punctuation">,</span> <span class="token number">307</span><span class="token punctuation">,</span> <span class="token number">311</span><span class="token punctuation">,</span> <span class="token number">313</span><span class="token punctuation">,</span> <span class="token number">317</span><span class="token punctuation">,</span> <span class="token number">331</span><span class="token punctuation">,</span> <span class="token number">337</span><span class="token punctuation">,</span> <span class="token number">347</span><span class="token punctuation">,</span> <span class="token number">349</span><span class="token punctuation">,</span> <span class="token number">353</span><span class="token punctuation">,</span> <span class="token number">359</span><span class="token punctuation">,</span> <span class="token number">367</span><span class="token punctuation">,</span> <span class="token number">373</span><span class="token punctuation">,</span> <span class="token number">379</span><span class="token punctuation">,</span> <span class="token number">383</span><span class="token punctuation">,</span> <span class="token number">389</span><span class="token punctuation">,</span> <span class="token number">397</span><span class="token punctuation">,</span> <span class="token number">401</span><span class="token punctuation">,</span> <span class="token number">409</span><span class="token punctuation">,</span> <span class="token number">419</span><span class="token punctuation">,</span> <span class="token number">421</span><span class="token punctuation">,</span> <span class="token number">431</span><span class="token punctuation">,</span> <span class="token number">433</span><span class="token punctuation">,</span> <span class="token number">439</span><span class="token punctuation">,</span> <span class="token number">443</span><span class="token punctuation">,</span> <span class="token number">449</span><span class="token punctuation">,</span> <span class="token number">457</span><span class="token punctuation">,</span> <span class="token number">461</span><span class="token punctuation">,</span> <span class="token number">463</span><span class="token punctuation">,</span> <span class="token number">467</span><span class="token punctuation">,</span> <span class="token number">479</span><span class="token punctuation">,</span> <span class="token number">487</span><span class="token punctuation">,</span> <span class="token number">491</span><span class="token punctuation">,</span> <span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">503</span><span class="token punctuation">,</span> <span class="token number">509</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">523</span><span class="token punctuation">,</span> <span class="token number">541</span><span class="token punctuation">,</span> <span class="token number">547</span><span class="token punctuation">,</span> <span class="token number">557</span><span class="token punctuation">,</span> <span class="token number">563</span><span class="token punctuation">,</span> <span class="token number">569</span><span class="token punctuation">,</span> <span class="token number">571</span><span class="token punctuation">,</span> <span class="token number">577</span><span class="token punctuation">,</span> <span class="token number">587</span><span class="token punctuation">,</span> <span class="token number">593</span><span class="token punctuation">,</span> <span class="token number">599</span><span class="token punctuation">,</span> <span class="token number">601</span><span class="token punctuation">,</span> <span class="token number">607</span><span class="token punctuation">,</span> <span class="token number">613</span><span class="token punctuation">,</span> <span class="token number">617</span><span class="token punctuation">,</span> <span class="token number">619</span><span class="token punctuation">,</span> <span class="token number">631</span><span class="token punctuation">,</span> <span class="token number">641</span><span class="token punctuation">,</span> <span class="token number">643</span><span class="token punctuation">,</span> <span class="token number">647</span><span class="token punctuation">,</span> <span class="token number">653</span><span class="token punctuation">,</span> <span class="token number">659</span><span class="token punctuation">,</span> <span class="token number">661</span><span class="token punctuation">,</span> <span class="token number">673</span><span class="token punctuation">,</span> <span class="token number">677</span><span class="token punctuation">,</span> <span class="token number">683</span><span class="token punctuation">,</span> <span class="token number">691</span><span class="token punctuation">,</span> <span class="token number">701</span><span class="token punctuation">,</span> <span class="token number">709</span><span class="token punctuation">,</span> <span class="token number">719</span><span class="token punctuation">,</span> <span class="token number">727</span><span class="token punctuation">,</span> <span class="token number">733</span><span class="token punctuation">,</span> <span class="token number">739</span><span class="token punctuation">,</span> <span class="token number">743</span><span class="token punctuation">,</span> <span class="token number">751</span><span class="token punctuation">,</span> <span class="token number">757</span><span class="token punctuation">,</span> <span class="token number">761</span><span class="token punctuation">,</span> <span class="token number">769</span><span class="token punctuation">,</span> <span class="token number">773</span><span class="token punctuation">,</span> <span class="token number">787</span><span class="token punctuation">,</span> <span class="token number">797</span><span class="token punctuation">,</span> <span class="token number">809</span><span class="token punctuation">,</span> <span class="token number">811</span><span class="token punctuation">,</span> <span class="token number">821</span><span class="token punctuation">,</span> <span class="token number">823</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">,</span> <span class="token number">829</span><span class="token punctuation">,</span> <span class="token number">839</span><span class="token punctuation">,</span> <span class="token number">853</span><span class="token punctuation">,</span> <span class="token number">857</span><span class="token punctuation">,</span> <span class="token number">859</span><span class="token punctuation">,</span> <span class="token number">863</span><span class="token punctuation">,</span> <span class="token number">877</span><span class="token punctuation">,</span> <span class="token number">881</span><span class="token punctuation">,</span> <span class="token number">883</span><span class="token punctuation">,</span> <span class="token number">887</span><span class="token punctuation">,</span> <span class="token number">907</span><span class="token punctuation">,</span> <span class="token number">911</span><span class="token punctuation">,</span> <span class="token number">919</span><span class="token punctuation">,</span> <span class="token number">929</span><span class="token punctuation">,</span> <span class="token number">937</span><span class="token punctuation">,</span> <span class="token number">941</span><span class="token punctuation">,</span> <span class="token number">947</span><span class="token punctuation">,</span> <span class="token number">953</span><span class="token punctuation">,</span> <span class="token number">967</span><span class="token punctuation">,</span> <span class="token number">971</span><span class="token punctuation">,</span> <span class="token number">977</span><span class="token punctuation">,</span> <span class="token number">983</span><span class="token punctuation">,</span> <span class="token number">991</span><span class="token punctuation">,</span> <span class="token number">997</span><span class="token punctuation">,</span> <span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">1013</span><span class="token punctuation">,</span> <span class="token number">1019</span><span class="token punctuation">,</span> <span class="token number">1021</span><span class="token punctuation">,</span> <span class="token number">1031</span><span class="token punctuation">,</span> <span class="token number">1033</span><span class="token punctuation">,</span> <span class="token number">1039</span><span class="token punctuation">,</span> <span class="token number">1049</span><span class="token punctuation">,</span> <span class="token number">1051</span><span class="token punctuation">,</span> <span class="token number">1061</span><span class="token punctuation">,</span> <span class="token number">1063</span><span class="token punctuation">,</span> <span class="token number">1069</span><span class="token punctuation">,</span> <span class="token number">1087</span><span class="token punctuation">,</span> <span class="token number">1091</span><span class="token punctuation">,</span> <span class="token number">1093</span><span class="token punctuation">,</span> <span class="token number">1097</span><span class="token punctuation">,</span> <span class="token number">1103</span><span class="token punctuation">,</span> <span class="token number">1109</span><span class="token punctuation">,</span> <span class="token number">1117</span><span class="token punctuation">,</span> <span class="token number">1123</span><span class="token punctuation">,</span> <span class="token number">1129</span><span class="token punctuation">,</span> <span class="token number">1151</span><span class="token punctuation">,</span> <span class="token number">1153</span><span class="token punctuation">,</span> <span class="token number">1163</span><span class="token punctuation">,</span> <span class="token number">1171</span><span class="token punctuation">,</span> <span class="token number">1181</span><span class="token punctuation">,</span> <span class="token number">1187</span><span class="token punctuation">,</span> <span class="token number">1193</span><span class="token punctuation">,</span> <span class="token number">1201</span><span class="token punctuation">,</span> <span class="token number">1213</span><span class="token punctuation">,</span> <span class="token number">1217</span><span class="token punctuation">,</span> <span class="token number">1223</span><span class="token punctuation">,</span> <span class="token number">1229</span><span class="token punctuation">,</span> <span class="token number">1231</span><span class="token punctuation">,</span> <span class="token number">1237</span><span class="token punctuation">,</span> <span class="token number">1249</span><span class="token punctuation">,</span> <span class="token number">1259</span><span class="token punctuation">,</span> <span class="token number">1277</span><span class="token punctuation">,</span> <span class="token number">1279</span><span class="token punctuation">,</span> <span class="token number">1283</span><span class="token punctuation">,</span> <span class="token number">1289</span><span class="token punctuation">,</span> <span class="token number">1291</span><span class="token punctuation">,</span> <span class="token number">1297</span><span class="token punctuation">,</span> <span class="token number">1301</span><span class="token punctuation">,</span> <span class="token number">1303</span><span class="token punctuation">,</span> <span class="token number">1307</span><span class="token punctuation">,</span> <span class="token number">1319</span><span class="token punctuation">,</span> <span class="token number">1321</span><span class="token punctuation">,</span> <span class="token number">1327</span><span class="token punctuation">,</span> <span class="token number">1361</span><span class="token punctuation">,</span> <span class="token number">1367</span><span class="token punctuation">,</span> <span class="token number">1373</span><span class="token punctuation">,</span> <span class="token number">1381</span><span class="token punctuation">,</span> <span class="token number">1399</span><span class="token punctuation">,</span> <span class="token number">1409</span><span class="token punctuation">,</span> <span class="token number">1423</span><span class="token punctuation">,</span> <span class="token number">1427</span><span class="token punctuation">,</span> <span class="token number">1429</span><span class="token punctuation">,</span> <span class="token number">1433</span><span class="token punctuation">,</span> <span class="token number">1439</span><span class="token punctuation">,</span> <span class="token number">1447</span><span class="token punctuation">,</span> <span class="token number">1451</span><span class="token punctuation">,</span> <span class="token number">1453</span><span class="token punctuation">,</span> <span class="token number">1459</span><span class="token punctuation">,</span> <span class="token number">1471</span><span class="token punctuation">,</span> <span class="token number">1481</span><span class="token punctuation">,</span> <span class="token number">1483</span><span class="token punctuation">,</span> <span class="token number">1487</span><span class="token punctuation">,</span> <span class="token number">1489</span><span class="token punctuation">,</span> <span class="token number">1493</span><span class="token punctuation">,</span> <span class="token number">1499</span><span class="token punctuation">,</span> <span class="token number">1511</span><span class="token punctuation">,</span> <span class="token number">1523</span><span class="token punctuation">,</span> <span class="token number">1531</span><span class="token punctuation">,</span> <span class="token number">1543</span><span class="token punctuation">,</span> <span class="token number">1549</span><span class="token punctuation">,</span> <span class="token number">1553</span><span class="token punctuation">,</span> <span class="token number">1559</span><span class="token punctuation">,</span> <span class="token number">1567</span><span class="token punctuation">,</span> <span class="token number">1571</span><span class="token punctuation">,</span> <span class="token number">1579</span><span class="token punctuation">,</span> <span class="token number">1583</span><span class="token punctuation">,</span> <span class="token number">1597</span><span class="token punctuation">,</span> <span class="token number">1601</span><span class="token punctuation">,</span> <span class="token number">1607</span><span class="token punctuation">,</span> <span class="token number">1609</span><span class="token punctuation">,</span> <span class="token number">1613</span><span class="token punctuation">,</span> <span class="token number">1619</span><span class="token punctuation">,</span> <span class="token number">1621</span><span class="token punctuation">,</span> <span class="token number">1627</span><span class="token punctuation">,</span> <span class="token number">1637</span><span class="token punctuation">,</span> <span class="token number">1657</span><span class="token punctuation">,</span> <span class="token number">1663</span><span class="token punctuation">,</span> <span class="token number">1667</span><span class="token punctuation">,</span> <span class="token number">1669</span><span class="token punctuation">,</span> <span class="token number">1693</span><span class="token punctuation">,</span> <span class="token number">1697</span><span class="token punctuation">,</span> <span class="token number">1699</span><span class="token punctuation">,</span> <span class="token number">1709</span><span class="token punctuation">,</span> <span class="token number">1721</span><span class="token punctuation">,</span> <span class="token number">1723</span><span class="token punctuation">,</span> <span class="token number">1733</span><span class="token punctuation">,</span> <span class="token number">1741</span><span class="token punctuation">,</span> <span class="token number">1747</span><span class="token punctuation">,</span> <span class="token number">1753</span><span class="token punctuation">,</span> <span class="token number">1759</span><span class="token punctuation">,</span> <span class="token number">1777</span><span class="token punctuation">,</span> <span class="token number">1783</span><span class="token punctuation">,</span> <span class="token number">1787</span><span class="token punctuation">,</span> <span class="token number">1789</span><span class="token punctuation">,</span> <span class="token number">1801</span><span class="token punctuation">,</span> <span class="token number">1811</span><span class="token punctuation">,</span> <span class="token number">1823</span><span class="token punctuation">,</span> <span class="token number">1831</span><span class="token punctuation">,</span> <span class="token number">1847</span><span class="token punctuation">,</span> <span class="token number">1861</span><span class="token punctuation">,</span> <span class="token number">1867</span><span class="token punctuation">,</span> <span class="token number">1871</span><span class="token punctuation">,</span> <span class="token number">1873</span><span class="token punctuation">,</span> <span class="token number">1877</span><span class="token punctuation">,</span> <span class="token number">1879</span><span class="token punctuation">,</span> <span class="token number">1889</span><span class="token punctuation">,</span> <span class="token number">1901</span><span class="token punctuation">,</span> <span class="token number">1907</span><span class="token punctuation">,</span> <span class="token number">1913</span><span class="token punctuation">,</span> <span class="token number">1931</span><span class="token punctuation">,</span> <span class="token number">1933</span><span class="token punctuation">,</span> <span class="token number">1949</span><span class="token punctuation">,</span> <span class="token number">1951</span><span class="token punctuation">,</span> <span class="token number">1973</span><span class="token punctuation">,</span> <span class="token number">1979</span><span class="token punctuation">,</span> <span class="token number">1987</span><span class="token punctuation">,</span> <span class="token number">1993</span><span class="token punctuation">,</span> <span class="token number">1997</span><span class="token punctuation">,</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">2003</span><span class="token punctuation">,</span> <span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">2027</span><span class="token punctuation">,</span> <span class="token number">2029</span><span class="token punctuation">,</span> <span class="token number">2039</span><span class="token punctuation">,</span> <span class="token number">2053</span><span class="token punctuation">,</span> <span class="token number">2063</span><span class="token punctuation">,</span> <span class="token number">2069</span><span class="token punctuation">,</span> <span class="token number">2081</span><span class="token punctuation">,</span> <span class="token number">2083</span><span class="token punctuation">,</span> <span class="token number">2087</span><span class="token punctuation">,</span> <span class="token number">2089</span><span class="token punctuation">,</span> <span class="token number">2099</span><span class="token punctuation">,</span> <span class="token number">2111</span><span class="token punctuation">,</span> <span class="token number">2113</span><span class="token punctuation">,</span> <span class="token number">2129</span><span class="token punctuation">,</span> <span class="token number">2131</span><span class="token punctuation">,</span> <span class="token number">2137</span><span class="token punctuation">,</span> <span class="token number">2141</span><span class="token punctuation">,</span> <span class="token number">2143</span><span class="token punctuation">,</span> <span class="token number">2153</span><span class="token punctuation">,</span> <span class="token number">2161</span><span class="token punctuation">,</span> <span class="token number">2179</span><span class="token punctuation">,</span> <span class="token number">2203</span><span class="token punctuation">,</span> <span class="token number">2207</span><span class="token punctuation">,</span> <span class="token number">2213</span><span class="token punctuation">,</span> <span class="token number">2221</span><span class="token punctuation">,</span> <span class="token number">2237</span><span class="token punctuation">,</span> <span class="token number">2239</span><span class="token punctuation">,</span> <span class="token number">2243</span><span class="token punctuation">,</span> <span class="token number">2251</span><span class="token punctuation">,</span> <span class="token number">2267</span><span class="token punctuation">,</span> <span class="token number">2269</span><span class="token punctuation">,</span> <span class="token number">2273</span><span class="token punctuation">,</span> <span class="token number">2281</span><span class="token punctuation">,</span> <span class="token number">2287</span><span class="token punctuation">,</span> <span class="token number">2293</span><span class="token punctuation">,</span> <span class="token number">2297</span><span class="token punctuation">,</span> <span class="token number">2309</span><span class="token punctuation">,</span> <span class="token number">2311</span><span class="token punctuation">,</span> <span class="token number">2333</span><span class="token punctuation">,</span> <span class="token number">2339</span><span class="token punctuation">,</span> <span class="token number">2341</span><span class="token punctuation">,</span> <span class="token number">2347</span><span class="token punctuation">,</span> <span class="token number">2351</span><span class="token punctuation">,</span> <span class="token number">2357</span><span class="token punctuation">,</span> <span class="token number">2371</span><span class="token punctuation">,</span> <span class="token number">2377</span><span class="token punctuation">,</span> <span class="token number">2381</span><span class="token punctuation">,</span> <span class="token number">2383</span><span class="token punctuation">,</span> <span class="token number">2389</span><span class="token punctuation">,</span> <span class="token number">2393</span><span class="token punctuation">,</span> <span class="token number">2399</span><span class="token punctuation">,</span> <span class="token number">2411</span><span class="token punctuation">,</span> <span class="token number">2417</span><span class="token punctuation">,</span> <span class="token number">2423</span><span class="token punctuation">,</span> <span class="token number">2437</span><span class="token punctuation">,</span> <span class="token number">2441</span><span class="token punctuation">,</span> <span class="token number">2447</span><span class="token punctuation">,</span> <span class="token number">2459</span><span class="token punctuation">,</span> <span class="token number">2467</span><span class="token punctuation">,</span> <span class="token number">2473</span><span class="token punctuation">,</span> <span class="token number">2477</span><span class="token punctuation">,</span> <span class="token number">2503</span><span class="token punctuation">,</span> <span class="token number">2521</span><span class="token punctuation">,</span> <span class="token number">2531</span><span class="token punctuation">,</span> <span class="token number">2539</span><span class="token punctuation">,</span> <span class="token number">2543</span><span class="token punctuation">,</span> <span class="token number">2549</span><span class="token punctuation">,</span> <span class="token number">2551</span><span class="token punctuation">,</span> <span class="token number">2557</span><span class="token punctuation">,</span> <span class="token number">2579</span><span class="token punctuation">,</span> <span class="token number">2591</span><span class="token punctuation">,</span> <span class="token number">2593</span><span class="token punctuation">,</span> <span class="token number">2609</span><span class="token punctuation">,</span> <span class="token number">2617</span><span class="token punctuation">,</span> <span class="token number">2621</span><span class="token punctuation">,</span> <span class="token number">2633</span><span class="token punctuation">,</span> <span class="token number">2647</span><span class="token punctuation">,</span> <span class="token number">2657</span><span class="token punctuation">,</span> <span class="token number">2659</span><span class="token punctuation">,</span> <span class="token number">2663</span><span class="token punctuation">,</span> <span class="token number">2671</span><span class="token punctuation">,</span> <span class="token number">2677</span><span class="token punctuation">,</span> <span class="token number">2683</span><span class="token punctuation">,</span> <span class="token number">2687</span><span class="token punctuation">,</span> <span class="token number">2689</span><span class="token punctuation">,</span> <span class="token number">2693</span><span class="token punctuation">,</span> <span class="token number">2699</span><span class="token punctuation">,</span> <span class="token number">2707</span><span class="token punctuation">,</span> <span class="token number">2711</span><span class="token punctuation">,</span> <span class="token number">2713</span><span class="token punctuation">,</span> <span class="token number">2719</span><span class="token punctuation">,</span> <span class="token number">2729</span><span class="token punctuation">,</span> <span class="token number">2731</span><span class="token punctuation">,</span> <span class="token number">2741</span><span class="token punctuation">,</span> <span class="token number">2749</span><span class="token punctuation">,</span> <span class="token number">2753</span><span class="token punctuation">,</span> <span class="token number">2767</span><span class="token punctuation">,</span> <span class="token number">2777</span><span class="token punctuation">,</span> <span class="token number">2789</span><span class="token punctuation">,</span> <span class="token number">2791</span><span class="token punctuation">,</span> <span class="token number">2797</span><span class="token punctuation">,</span> <span class="token number">2801</span><span class="token punctuation">,</span> <span class="token number">2803</span><span class="token punctuation">,</span> <span class="token number">2819</span><span class="token punctuation">,</span> <span class="token number">2833</span><span class="token punctuation">,</span> <span class="token number">2837</span><span class="token punctuation">,</span> <span class="token number">2843</span><span class="token punctuation">,</span> <span class="token number">2851</span><span class="token punctuation">,</span> <span class="token number">2857</span><span class="token punctuation">,</span> <span class="token number">2861</span><span class="token punctuation">,</span> <span class="token number">2879</span><span class="token punctuation">,</span> <span class="token number">2887</span><span class="token punctuation">,</span> <span class="token number">2897</span><span class="token punctuation">,</span> <span class="token number">2903</span><span class="token punctuation">,</span> <span class="token number">2909</span><span class="token punctuation">,</span> <span class="token number">2917</span><span class="token punctuation">,</span> <span class="token number">2927</span><span class="token punctuation">,</span> <span class="token number">2939</span><span class="token punctuation">,</span> <span class="token number">2953</span><span class="token punctuation">,</span> <span class="token number">2957</span><span class="token punctuation">,</span> <span class="token number">2963</span><span class="token punctuation">,</span> <span class="token number">2969</span><span class="token punctuation">,</span> <span class="token number">2971</span><span class="token punctuation">,</span> <span class="token number">2999</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> vals<span class="token punctuation">)</span><span class="token punctuation">:</span>
    M<span class="token operator">=</span>M<span class="token operator">*</span>primes<span class="token punctuation">[</span>x<span class="token punctuation">]</span>
<span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        p<span class="token operator">=</span>mpz<span class="token punctuation">(</span>k<span class="token operator">*</span>M<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">65537</span><span class="token operator">**</span>a <span class="token operator">%</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
            q <span class="token operator">=</span> mpz<span class="token punctuation">(</span>n<span class="token operator">//</span>p<span class="token punctuation">)</span>
            <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'p=%d\nq=%d'</span><span class="token operator">%</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
p<span class="token operator">=</span><span class="token number">4582433561127855310805294456657993281782662645116543024537051682479</span>
q<span class="token operator">=</span><span class="token number">3386619977051114637303328519173627165817832179845212640767197001941</span>
d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># flag&#123;760958c9-cca9-458b-9cbe-ea07aa1668e4&#125;</span></code></pre>


<h2 id="V-amp-N2020-公开赛-easy-RSA"><a href="#V-amp-N2020-公开赛-easy-RSA" class="headerlink" title="[V&amp;N2020 公开赛]easy_RSA"></a>[V&amp;N2020 公开赛]easy_RSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randint
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token keyword">def</span> <span class="token function">getprime</span><span class="token punctuation">(</span>bits<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>
        n <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token keyword">while</span> n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> bits<span class="token punctuation">:</span>
            n <span class="token operator">*=</span> next_prime<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> n <span class="token operator">-</span> <span class="token number">1</span>

m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token string">b'flag&#123;************************************&#125;'</span><span class="token punctuation">)</span>

p <span class="token operator">=</span> getprime<span class="token punctuation">(</span><span class="token number">505</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> m <span class="token operator">&lt;</span> q

n <span class="token operator">=</span> p <span class="token operator">*</span> q <span class="token operator">*</span> r
e <span class="token operator">=</span> <span class="token number">0x10001</span>
d <span class="token operator">=</span> invert<span class="token punctuation">(</span>q <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> p <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>
cipher <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>


<span class="token triple-quoted-string string">'''

7941371739956577280160664419383740967516918938781306610817149744988379280561359039016508679365806108722198157199058807892703837558280678711420411242914059658055366348123106473335186505617418956630780649894945233345985279471106888635177256011468979083320605103256178446993230320443790240285158260236926519042413378204298514714890725325831769281505530787739922007367026883959544239568886349070557272869042275528961483412544495589811933856131557221673534170105409
7515987842794170949444517202158067021118454558360145030399453487603693522695746732547224100845570119375977629070702308991221388721952258969752305904378724402002545947182529859604584400048983091861594720299791743887521228492714135449584003054386457751933095902983841246048952155097668245322664318518861440
1618155233923718966393124032999431934705026408748451436388483012584983753140040289666712916510617403356206112730613485227084128314043665913357106301736817062412927135716281544348612150328867226515184078966397180771624148797528036548243343316501503364783092550480439749404301122277056732857399413805293899249313045684662146333448668209567898831091274930053147799756622844119463942087160062353526056879436998061803187343431081504474584816590199768034450005448200

'''</span></code></pre>


<blockquote>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Williams'_p_%2B_1_algorithm">Williams’p+1 algorithm</a></p>
<p><a target="_blank" rel="noopener" href="https://0xdktb.top/2020/02/28/Summary-of-Crypto-in-CTF-RSA/#RSA-William%E2%80%99s-p-1-and-Pollard%E2%80%99s-p-1">https://0xdktb.top/2020/02/28/Summary-of-Crypto-in-CTF-RSA/#RSA-William%E2%80%99s-p-1-and-Pollard%E2%80%99s-p-1</a></p>
</li>
<li><p>p &lt; q  ，分解q^2的时候要加上p^2的倍数</p>
</li>
<li><p>模数是素数，e = 2，求解二次平方根：Tonelli–Shanks算法</p>
</li>
</ol>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> primefac <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm
n <span class="token operator">=</span> <span class="token number">7941371739956577280160664419383740967516918938781306610817149744988379280561359039016508679365806108722198157199058807892703837558280678711420411242914059658055366348123106473335186505617418956630780649894945233345985279471106888635177256011468979083320605103256178446993230320443790240285158260236926519042413378204298514714890725325831769281505530787739922007367026883959544239568886349070557272869042275528961483412544495589811933856131557221673534170105409</span>
<span class="token comment"># p = williams_pp1(n)</span>
<span class="token comment"># print p</span>
p <span class="token operator">=</span> <span class="token number">102634610559478918970860957918259981057327949366949344137104804864768237961662136189827166317524151288799657758536256924609797810164397005081733039415393</span>
e <span class="token operator">=</span> <span class="token number">0x10001</span>
d <span class="token operator">=</span> <span class="token number">7515987842794170949444517202158067021118454558360145030399453487603693522695746732547224100845570119375977629070702308991221388721952258969752305904378724402002545947182529859604584400048983091861594720299791743887521228492714135449584003054386457751933095902983841246048952155097668245322664318518861440</span>
cipher <span class="token operator">=</span> <span class="token number">1618155233923718966393124032999431934705026408748451436388483012584983753140040289666712916510617403356206112730613485227084128314043665913357106301736817062412927135716281544348612150328867226515184078966397180771624148797528036548243343316501503364783092550480439749404301122277056732857399413805293899249313045684662146333448668209567898831091274930053147799756622844119463942087160062353526056879436998061803187343431081504474584816590199768034450005448200</span>
q2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>d<span class="token punctuation">,</span> p<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span>
<span class="token comment"># for i in tqdm(range(10000)):</span>
<span class="token comment"># 	q = iroot(q2+i*p**2, 2)</span>
<span class="token comment"># 	if q[1]:</span>
<span class="token comment"># 		print q[0]</span>
<span class="token comment"># 		exit()</span>
q <span class="token operator">=</span> <span class="token number">7534810196420932552168708937019691994681052660068275906973480617604535381306041583841106383688654426129050931519275383386503174076258645141589911492908993</span>
r <span class="token operator">=</span> n <span class="token operator">//</span> p <span class="token operator">//</span> q
d1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">legendre</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">tonelli</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> legendre<span class="token punctuation">(</span>n<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>
    q <span class="token operator">=</span> p <span class="token operator">-</span> <span class="token number">1</span>
    s <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> q <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        q <span class="token operator">//=</span> <span class="token number">2</span>
        s <span class="token operator">+=</span> <span class="token number">1</span>
    <span class="token keyword">if</span> s <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
<span class="token comment">#    for z in range(2, p):</span>
        <span class="token keyword">if</span> p <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> legendre<span class="token punctuation">(</span>z<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    r <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    t <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    m <span class="token operator">=</span> s
    t2 <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token punctuation">(</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>
        t2 <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token operator">%</span> p
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>t2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
                <span class="token keyword">break</span>
            t2 <span class="token operator">=</span> <span class="token punctuation">(</span>t2 <span class="token operator">*</span> t2<span class="token punctuation">)</span> <span class="token operator">%</span> p
        b <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>m <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
        r <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> p
        c <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> p
        t <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> c<span class="token punctuation">)</span> <span class="token operator">%</span> p
        m <span class="token operator">=</span> i
    <span class="token keyword">return</span> r
m <span class="token operator">=</span> tonelli<span class="token punctuation">(</span>c<span class="token punctuation">,</span> r<span class="token punctuation">)</span>
<span class="token keyword">print</span> n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token comment"># flag&#123;fd462593-25e4-4631-a96a-0cd5c72b2d1b&#125;</span></code></pre>


<h2 id="DASCTF三月赛-son-of-NTRU"><a href="#DASCTF三月赛-son-of-NTRU" class="headerlink" title="[DASCTF三月赛]son_of_NTRU"></a>[DASCTF三月赛]son_of_NTRU</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randrange
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert
<span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">while</span> b<span class="token punctuation">:</span>
        a<span class="token punctuation">,</span>b <span class="token operator">=</span> b<span class="token punctuation">,</span>a<span class="token operator">%</span>b
    <span class="token keyword">return</span> a

<span class="token keyword">def</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        g <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>f<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>f<span class="token punctuation">,</span>g<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
    h <span class="token operator">=</span> <span class="token punctuation">(</span>invert<span class="token punctuation">(</span>f<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">*</span>g<span class="token punctuation">)</span><span class="token operator">%</span>p
    <span class="token keyword">return</span> h<span class="token punctuation">,</span>p<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g

<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>h<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">assert</span> m<span class="token operator">&lt;</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>r<span class="token operator">*</span>h<span class="token operator">+</span>m<span class="token punctuation">)</span><span class="token operator">%</span>p
    <span class="token keyword">return</span> c

h<span class="token punctuation">,</span>p<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g <span class="token operator">=</span> generate<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag
c <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span>h<span class="token punctuation">,</span>p<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"h = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># h = 70851272226599856513658616506718804769182611213413854493145253337330709939355936692154199813179587933065165812259913249917314725765898812249062834111179900151466610356207921771928832591335738750053453046857602342378475278876652263044722419918958361163645152112020971804267503129035439011008349349624213734004</span>
<span class="token comment"># p = 125796773654949906956757901514929172896506715196511121353157781851652093811702246079116208920427110231653664239838444378725001877052652056537732732266407477191221775698956008368755461680533430353707546171814962217736494341129233572423073286387554056407408816555382448824610216634458550949715062229816683685469</span>
<span class="token comment"># c = 4691517945653877981376957637565364382959972087952249273292897076221178958350355396910942555879426136128610896883898318646711419768716904972164508407035668258209226498292327845169861395205212789741065517685193351416871631112431257858097798333893494180621728198734264288028849543413123321402664789239712408700</span></code></pre>


<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/7163">https://xz.aliyun.com/t/7163</a></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
h <span class="token operator">=</span> <span class="token number">70851272226599856513658616506718804769182611213413854493145253337330709939355936692154199813179587933065165812259913249917314725765898812249062834111179900151466610356207921771928832591335738750053453046857602342378475278876652263044722419918958361163645152112020971804267503129035439011008349349624213734004</span>
p <span class="token operator">=</span> <span class="token number">125796773654949906956757901514929172896506715196511121353157781851652093811702246079116208920427110231653664239838444378725001877052652056537732732266407477191221775698956008368755461680533430353707546171814962217736494341129233572423073286387554056407408816555382448824610216634458550949715062229816683685469</span>
c <span class="token operator">=</span> <span class="token number">4691517945653877981376957637565364382959972087952249273292897076221178958350355396910942555879426136128610896883898318646711419768716904972164508407035668258209226498292327845169861395205212789741065517685193351416871631112431257858097798333893494180621728198734264288028849543413123321402664789239712408700</span>
<span class="token comment"># Construct lattice.</span>
v1 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">)</span>
v2 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> p<span class="token punctuation">]</span><span class="token punctuation">)</span>
m <span class="token operator">=</span> matrix<span class="token punctuation">(</span><span class="token punctuation">[</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment"># Solve SVP.</span>
shortest_vector <span class="token operator">=</span> m<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
f<span class="token punctuation">,</span> g <span class="token operator">=</span> shortest_vector
<span class="token comment"># print(f, g)</span>
<span class="token comment"># Decrypt</span>
f <span class="token operator">=</span> <span class="token number">3052745506321037491577220926923466609715612813029263120922605939187287981215931840968854538555321338710902665095952768815345285556873715325200121768087377</span> 
g <span class="token operator">=</span> <span class="token number">6390108444026998457573135563944030351069358995011779835195686570376684843461358071141777920310356437442825541867565659114422145012850808683785653621804110</span>
a <span class="token operator">=</span> f<span class="token operator">*</span>c <span class="token operator">%</span> p <span class="token operator">%</span> g
m <span class="token operator">=</span> a <span class="token operator">*</span> inverse_mod<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">%</span> g
<span class="token comment"># print(m)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># b'flag&#123;93d02e3bf2c7458a47aac58387140dd5&#125;'</span></code></pre>


<h2 id="DASCTF三月赛-FeedBack"><a href="#DASCTF三月赛-FeedBack" class="headerlink" title="[DASCTF三月赛]FeedBack"></a>[DASCTF三月赛]FeedBack</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag
<span class="token keyword">from</span> string <span class="token keyword">import</span> hexdigits
<span class="token keyword">import</span> random
<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>
<span class="token keyword">def</span> <span class="token function">cycle</span><span class="token punctuation">(</span>c<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">,</span>a<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token builtin">int</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> x<span class="token operator">+</span>y<span class="token punctuation">,</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">zip</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>m<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">,</span>k<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token builtin">list</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        m<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cycle<span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>hexdigits<span class="token punctuation">)</span>
<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    key<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>hexdigits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    c<span class="token operator">=</span>enc<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>

<span class="token comment"># flag = [180320, 12795604, 913707946, 65244867544, 4658921499366, 332678259897680, 23755460291939729, 1696299282824525162, 121127152307279309992, 8649291534003765460181, 617617459134250473857819, 44102031285199767595231826, 3149180993372727865351695610, 224872656429052251931507068163, 16057416742916791898621189838002, 1146607313446549338631740275859490, 81875456824588820793005728503088789, 5846457066530480582594997088868317921, 417476268914312098171907310476576578536, 29810607197367740257089118506396936455267, 2128677406710643996313598469435818995764283, 152001851952900202233154866795341968398324618, 10853952282423997785255606215412380976089774602, 775045031593704366379150517314704054142878227755, 55343416422679709865626814221707233611767499083451, 3951891330799176591085237005754672086216649002044116, 282191561344334793283891774610663595748300192924237652, 20150371209182455377207293308509352961052348504530516058, 1438871729308714548579613052036192683042976990785336035213, 102745097443187470470063857372230471012050786200205019335560, 7336689458539737357933680339939811164938123954552946412371136, 523888862345101730958585832445722009143686030486587614405269619, 37409180481229224476184683624742923927721083153229315469794323846, 2671266531631899605156440693785360699681088880751785277451781995127, 190746356675660819059021289711194688989007498945709965975632125093772, 13620569925986012345710256811290898483914841356894501064938828451682289, 972600097542764210429602165761543702875470220807440912087468994318947199, 69450173882625967125859360885466807837084362724230554403206714010957033564, 4959208480970674965771932762141990438694621159829420665293248503741956497339, 354120765763611360372631234091033326236527919343510113669886900852817067794937, 25286599106731127999761204195099137001826484641202640190432847596126102129290177, 1805632869356683189091740036886552559813413339716342384679179468460652986832630119, 128934304100758873373068786008043012614625306314330902439450614878647840309940810799, 9206774564238985792239909901043542380389506567225353556524468058541750913201465442258, 657425488646345934124836595103998888905043390553798696290609052666406363868364633227987, 46944591735815161454850764823066332748372328488810515939042504343121621896260739496814215, 3352158885381868382186614128492698209211597671157972107257901283108688995314288195559935895, 239366640061152248661380413770610731951278310979044705869198442025229868870474962029566786828, 17092384440374810990148000504438682199862673994374786921479630475896214666270304948184067943963, 1220510952499186818225235173267171189892653750839095345581049972346091269304188809141591821528945, 87152672604981875905661244747737456527193455119785950165560211136820203006355054095176767065463607, 6223285687554056604834063330772248822879874758146969128122776216276580479221618865554693862254391145, 444384361274324240336894080988769378714126300500080707977898823502774400070423897702729938853457320554, 31732025566514505285832183071784730973330427403124198140983516899800427456134314554661472009492580417251]</span>
</code></pre>


<p>主要的运算逻辑就是边移位边和key相乘再求和</p>
<p>先把key作为未知数，利用前27位c和key运算生成后27位c的逻辑求得key</p>
<p>再把27位flag作为未知数，利用27位flag和key运算生成前27位c的逻辑求得flag</p>
<p>z3解方程组</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>
c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">180320</span><span class="token punctuation">,</span> <span class="token number">12795604</span><span class="token punctuation">,</span> <span class="token number">913707946</span><span class="token punctuation">,</span> <span class="token number">65244867544</span><span class="token punctuation">,</span> <span class="token number">4658921499366</span><span class="token punctuation">,</span> <span class="token number">332678259897680</span><span class="token punctuation">,</span> <span class="token number">23755460291939729</span><span class="token punctuation">,</span> <span class="token number">1696299282824525162</span><span class="token punctuation">,</span> <span class="token number">121127152307279309992</span><span class="token punctuation">,</span> <span class="token number">8649291534003765460181</span><span class="token punctuation">,</span> <span class="token number">617617459134250473857819</span><span class="token punctuation">,</span> <span class="token number">44102031285199767595231826</span><span class="token punctuation">,</span> <span class="token number">3149180993372727865351695610</span><span class="token punctuation">,</span> <span class="token number">224872656429052251931507068163</span><span class="token punctuation">,</span> <span class="token number">16057416742916791898621189838002</span><span class="token punctuation">,</span> <span class="token number">1146607313446549338631740275859490</span><span class="token punctuation">,</span> <span class="token number">81875456824588820793005728503088789</span><span class="token punctuation">,</span> <span class="token number">5846457066530480582594997088868317921</span><span class="token punctuation">,</span> <span class="token number">417476268914312098171907310476576578536</span><span class="token punctuation">,</span> <span class="token number">29810607197367740257089118506396936455267</span><span class="token punctuation">,</span> <span class="token number">2128677406710643996313598469435818995764283</span><span class="token punctuation">,</span> <span class="token number">152001851952900202233154866795341968398324618</span><span class="token punctuation">,</span> <span class="token number">10853952282423997785255606215412380976089774602</span><span class="token punctuation">,</span> <span class="token number">775045031593704366379150517314704054142878227755</span><span class="token punctuation">,</span> <span class="token number">55343416422679709865626814221707233611767499083451</span><span class="token punctuation">,</span> <span class="token number">3951891330799176591085237005754672086216649002044116</span><span class="token punctuation">,</span> <span class="token number">282191561344334793283891774610663595748300192924237652</span><span class="token punctuation">,</span> <span class="token number">20150371209182455377207293308509352961052348504530516058</span><span class="token punctuation">,</span> <span class="token number">1438871729308714548579613052036192683042976990785336035213</span><span class="token punctuation">,</span> <span class="token number">102745097443187470470063857372230471012050786200205019335560</span><span class="token punctuation">,</span> <span class="token number">7336689458539737357933680339939811164938123954552946412371136</span><span class="token punctuation">,</span> <span class="token number">523888862345101730958585832445722009143686030486587614405269619</span><span class="token punctuation">,</span> <span class="token number">37409180481229224476184683624742923927721083153229315469794323846</span><span class="token punctuation">,</span> <span class="token number">2671266531631899605156440693785360699681088880751785277451781995127</span><span class="token punctuation">,</span> <span class="token number">190746356675660819059021289711194688989007498945709965975632125093772</span><span class="token punctuation">,</span> <span class="token number">13620569925986012345710256811290898483914841356894501064938828451682289</span><span class="token punctuation">,</span> <span class="token number">972600097542764210429602165761543702875470220807440912087468994318947199</span><span class="token punctuation">,</span> <span class="token number">69450173882625967125859360885466807837084362724230554403206714010957033564</span><span class="token punctuation">,</span> <span class="token number">4959208480970674965771932762141990438694621159829420665293248503741956497339</span><span class="token punctuation">,</span> <span class="token number">354120765763611360372631234091033326236527919343510113669886900852817067794937</span><span class="token punctuation">,</span> <span class="token number">25286599106731127999761204195099137001826484641202640190432847596126102129290177</span><span class="token punctuation">,</span> <span class="token number">1805632869356683189091740036886552559813413339716342384679179468460652986832630119</span><span class="token punctuation">,</span> <span class="token number">128934304100758873373068786008043012614625306314330902439450614878647840309940810799</span><span class="token punctuation">,</span> <span class="token number">9206774564238985792239909901043542380389506567225353556524468058541750913201465442258</span><span class="token punctuation">,</span> <span class="token number">657425488646345934124836595103998888905043390553798696290609052666406363868364633227987</span><span class="token punctuation">,</span> <span class="token number">46944591735815161454850764823066332748372328488810515939042504343121621896260739496814215</span><span class="token punctuation">,</span> <span class="token number">3352158885381868382186614128492698209211597671157972107257901283108688995314288195559935895</span><span class="token punctuation">,</span> <span class="token number">239366640061152248661380413770610731951278310979044705869198442025229868870474962029566786828</span><span class="token punctuation">,</span> <span class="token number">17092384440374810990148000504438682199862673994374786921479630475896214666270304948184067943963</span><span class="token punctuation">,</span> <span class="token number">1220510952499186818225235173267171189892653750839095345581049972346091269304188809141591821528945</span><span class="token punctuation">,</span> <span class="token number">87152672604981875905661244747737456527193455119785950165560211136820203006355054095176767065463607</span><span class="token punctuation">,</span> <span class="token number">6223285687554056604834063330772248822879874758146969128122776216276580479221618865554693862254391145</span><span class="token punctuation">,</span> <span class="token number">444384361274324240336894080988769378714126300500080707977898823502774400070423897702729938853457320554</span><span class="token punctuation">,</span> <span class="token number">31732025566514505285832183071784730973330427403124198140983516899800427456134314554661472009492580417251</span><span class="token punctuation">]</span>
<span class="token comment"># k=[Int('k%d'%i) for i in range(27)]</span>
f<span class="token operator">=</span><span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string">'f%d'</span><span class="token operator">%</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token comment"># for i in range(27):</span>
<span class="token comment">#     print('s.add(')</span>
<span class="token comment">#     for j in range(27):</span>
<span class="token comment">#         if j !=26:</span>
<span class="token comment">#             print('c[&#123;&#125;]*k[&#123;&#125;]+'.format(i+j,j),end='')</span>
<span class="token comment">#         else: </span>
<span class="token comment">#         	print('c[&#123;&#125;]*k[&#123;&#125;]'.format(i+j,j),end='')</span>
<span class="token comment">#     print('==c[&#123;&#125;])'.format(i+j+1))</span>
s<span class="token operator">=</span>Solver<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[0]*k[0]+c[1]*k[1]+c[2]*k[2]+c[3]*k[3]+c[4]*k[4]+c[5]*k[5]+c[6]*k[6]+c[7]*k[7]+c[8]*k[8]+c[9]*k[9]+c[10]*k[10]+c[11]*k[11]+c[12]*k[12]+c[13]*k[13]+c[14]*k[14]+c[15]*k[15]+c[16]*k[16]+c[17]*k[17]+c[18]*k[18]+c[19]*k[19]+c[20]*k[20]+c[21]*k[21]+c[22]*k[22]+c[23]*k[23]+c[24]*k[24]+c[25]*k[25]+c[26]*k[26]==c[27])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[1]*k[0]+c[2]*k[1]+c[3]*k[2]+c[4]*k[3]+c[5]*k[4]+c[6]*k[5]+c[7]*k[6]+c[8]*k[7]+c[9]*k[8]+c[10]*k[9]+c[11]*k[10]+c[12]*k[11]+c[13]*k[12]+c[14]*k[13]+c[15]*k[14]+c[16]*k[15]+c[17]*k[16]+c[18]*k[17]+c[19]*k[18]+c[20]*k[19]+c[21]*k[20]+c[22]*k[21]+c[23]*k[22]+c[24]*k[23]+c[25]*k[24]+c[26]*k[25]+c[27]*k[26]==c[28])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[2]*k[0]+c[3]*k[1]+c[4]*k[2]+c[5]*k[3]+c[6]*k[4]+c[7]*k[5]+c[8]*k[6]+c[9]*k[7]+c[10]*k[8]+c[11]*k[9]+c[12]*k[10]+c[13]*k[11]+c[14]*k[12]+c[15]*k[13]+c[16]*k[14]+c[17]*k[15]+c[18]*k[16]+c[19]*k[17]+c[20]*k[18]+c[21]*k[19]+c[22]*k[20]+c[23]*k[21]+c[24]*k[22]+c[25]*k[23]+c[26]*k[24]+c[27]*k[25]+c[28]*k[26]==c[29])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[3]*k[0]+c[4]*k[1]+c[5]*k[2]+c[6]*k[3]+c[7]*k[4]+c[8]*k[5]+c[9]*k[6]+c[10]*k[7]+c[11]*k[8]+c[12]*k[9]+c[13]*k[10]+c[14]*k[11]+c[15]*k[12]+c[16]*k[13]+c[17]*k[14]+c[18]*k[15]+c[19]*k[16]+c[20]*k[17]+c[21]*k[18]+c[22]*k[19]+c[23]*k[20]+c[24]*k[21]+c[25]*k[22]+c[26]*k[23]+c[27]*k[24]+c[28]*k[25]+c[29]*k[26]==c[30])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[4]*k[0]+c[5]*k[1]+c[6]*k[2]+c[7]*k[3]+c[8]*k[4]+c[9]*k[5]+c[10]*k[6]+c[11]*k[7]+c[12]*k[8]+c[13]*k[9]+c[14]*k[10]+c[15]*k[11]+c[16]*k[12]+c[17]*k[13]+c[18]*k[14]+c[19]*k[15]+c[20]*k[16]+c[21]*k[17]+c[22]*k[18]+c[23]*k[19]+c[24]*k[20]+c[25]*k[21]+c[26]*k[22]+c[27]*k[23]+c[28]*k[24]+c[29]*k[25]+c[30]*k[26]==c[31])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[5]*k[0]+c[6]*k[1]+c[7]*k[2]+c[8]*k[3]+c[9]*k[4]+c[10]*k[5]+c[11]*k[6]+c[12]*k[7]+c[13]*k[8]+c[14]*k[9]+c[15]*k[10]+c[16]*k[11]+c[17]*k[12]+c[18]*k[13]+c[19]*k[14]+c[20]*k[15]+c[21]*k[16]+c[22]*k[17]+c[23]*k[18]+c[24]*k[19]+c[25]*k[20]+c[26]*k[21]+c[27]*k[22]+c[28]*k[23]+c[29]*k[24]+c[30]*k[25]+c[31]*k[26]==c[32])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[6]*k[0]+c[7]*k[1]+c[8]*k[2]+c[9]*k[3]+c[10]*k[4]+c[11]*k[5]+c[12]*k[6]+c[13]*k[7]+c[14]*k[8]+c[15]*k[9]+c[16]*k[10]+c[17]*k[11]+c[18]*k[12]+c[19]*k[13]+c[20]*k[14]+c[21]*k[15]+c[22]*k[16]+c[23]*k[17]+c[24]*k[18]+c[25]*k[19]+c[26]*k[20]+c[27]*k[21]+c[28]*k[22]+c[29]*k[23]+c[30]*k[24]+c[31]*k[25]+c[32]*k[26]==c[33])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[7]*k[0]+c[8]*k[1]+c[9]*k[2]+c[10]*k[3]+c[11]*k[4]+c[12]*k[5]+c[13]*k[6]+c[14]*k[7]+c[15]*k[8]+c[16]*k[9]+c[17]*k[10]+c[18]*k[11]+c[19]*k[12]+c[20]*k[13]+c[21]*k[14]+c[22]*k[15]+c[23]*k[16]+c[24]*k[17]+c[25]*k[18]+c[26]*k[19]+c[27]*k[20]+c[28]*k[21]+c[29]*k[22]+c[30]*k[23]+c[31]*k[24]+c[32]*k[25]+c[33]*k[26]==c[34])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[8]*k[0]+c[9]*k[1]+c[10]*k[2]+c[11]*k[3]+c[12]*k[4]+c[13]*k[5]+c[14]*k[6]+c[15]*k[7]+c[16]*k[8]+c[17]*k[9]+c[18]*k[10]+c[19]*k[11]+c[20]*k[12]+c[21]*k[13]+c[22]*k[14]+c[23]*k[15]+c[24]*k[16]+c[25]*k[17]+c[26]*k[18]+c[27]*k[19]+c[28]*k[20]+c[29]*k[21]+c[30]*k[22]+c[31]*k[23]+c[32]*k[24]+c[33]*k[25]+c[34]*k[26]==c[35])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[9]*k[0]+c[10]*k[1]+c[11]*k[2]+c[12]*k[3]+c[13]*k[4]+c[14]*k[5]+c[15]*k[6]+c[16]*k[7]+c[17]*k[8]+c[18]*k[9]+c[19]*k[10]+c[20]*k[11]+c[21]*k[12]+c[22]*k[13]+c[23]*k[14]+c[24]*k[15]+c[25]*k[16]+c[26]*k[17]+c[27]*k[18]+c[28]*k[19]+c[29]*k[20]+c[30]*k[21]+c[31]*k[22]+c[32]*k[23]+c[33]*k[24]+c[34]*k[25]+c[35]*k[26]==c[36])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[10]*k[0]+c[11]*k[1]+c[12]*k[2]+c[13]*k[3]+c[14]*k[4]+c[15]*k[5]+c[16]*k[6]+c[17]*k[7]+c[18]*k[8]+c[19]*k[9]+c[20]*k[10]+c[21]*k[11]+c[22]*k[12]+c[23]*k[13]+c[24]*k[14]+c[25]*k[15]+c[26]*k[16]+c[27]*k[17]+c[28]*k[18]+c[29]*k[19]+c[30]*k[20]+c[31]*k[21]+c[32]*k[22]+c[33]*k[23]+c[34]*k[24]+c[35]*k[25]+c[36]*k[26]==c[37])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[11]*k[0]+c[12]*k[1]+c[13]*k[2]+c[14]*k[3]+c[15]*k[4]+c[16]*k[5]+c[17]*k[6]+c[18]*k[7]+c[19]*k[8]+c[20]*k[9]+c[21]*k[10]+c[22]*k[11]+c[23]*k[12]+c[24]*k[13]+c[25]*k[14]+c[26]*k[15]+c[27]*k[16]+c[28]*k[17]+c[29]*k[18]+c[30]*k[19]+c[31]*k[20]+c[32]*k[21]+c[33]*k[22]+c[34]*k[23]+c[35]*k[24]+c[36]*k[25]+c[37]*k[26]==c[38])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[12]*k[0]+c[13]*k[1]+c[14]*k[2]+c[15]*k[3]+c[16]*k[4]+c[17]*k[5]+c[18]*k[6]+c[19]*k[7]+c[20]*k[8]+c[21]*k[9]+c[22]*k[10]+c[23]*k[11]+c[24]*k[12]+c[25]*k[13]+c[26]*k[14]+c[27]*k[15]+c[28]*k[16]+c[29]*k[17]+c[30]*k[18]+c[31]*k[19]+c[32]*k[20]+c[33]*k[21]+c[34]*k[22]+c[35]*k[23]+c[36]*k[24]+c[37]*k[25]+c[38]*k[26]==c[39])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[13]*k[0]+c[14]*k[1]+c[15]*k[2]+c[16]*k[3]+c[17]*k[4]+c[18]*k[5]+c[19]*k[6]+c[20]*k[7]+c[21]*k[8]+c[22]*k[9]+c[23]*k[10]+c[24]*k[11]+c[25]*k[12]+c[26]*k[13]+c[27]*k[14]+c[28]*k[15]+c[29]*k[16]+c[30]*k[17]+c[31]*k[18]+c[32]*k[19]+c[33]*k[20]+c[34]*k[21]+c[35]*k[22]+c[36]*k[23]+c[37]*k[24]+c[38]*k[25]+c[39]*k[26]==c[40])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[14]*k[0]+c[15]*k[1]+c[16]*k[2]+c[17]*k[3]+c[18]*k[4]+c[19]*k[5]+c[20]*k[6]+c[21]*k[7]+c[22]*k[8]+c[23]*k[9]+c[24]*k[10]+c[25]*k[11]+c[26]*k[12]+c[27]*k[13]+c[28]*k[14]+c[29]*k[15]+c[30]*k[16]+c[31]*k[17]+c[32]*k[18]+c[33]*k[19]+c[34]*k[20]+c[35]*k[21]+c[36]*k[22]+c[37]*k[23]+c[38]*k[24]+c[39]*k[25]+c[40]*k[26]==c[41])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[15]*k[0]+c[16]*k[1]+c[17]*k[2]+c[18]*k[3]+c[19]*k[4]+c[20]*k[5]+c[21]*k[6]+c[22]*k[7]+c[23]*k[8]+c[24]*k[9]+c[25]*k[10]+c[26]*k[11]+c[27]*k[12]+c[28]*k[13]+c[29]*k[14]+c[30]*k[15]+c[31]*k[16]+c[32]*k[17]+c[33]*k[18]+c[34]*k[19]+c[35]*k[20]+c[36]*k[21]+c[37]*k[22]+c[38]*k[23]+c[39]*k[24]+c[40]*k[25]+c[41]*k[26]==c[42])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[16]*k[0]+c[17]*k[1]+c[18]*k[2]+c[19]*k[3]+c[20]*k[4]+c[21]*k[5]+c[22]*k[6]+c[23]*k[7]+c[24]*k[8]+c[25]*k[9]+c[26]*k[10]+c[27]*k[11]+c[28]*k[12]+c[29]*k[13]+c[30]*k[14]+c[31]*k[15]+c[32]*k[16]+c[33]*k[17]+c[34]*k[18]+c[35]*k[19]+c[36]*k[20]+c[37]*k[21]+c[38]*k[22]+c[39]*k[23]+c[40]*k[24]+c[41]*k[25]+c[42]*k[26]==c[43])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[17]*k[0]+c[18]*k[1]+c[19]*k[2]+c[20]*k[3]+c[21]*k[4]+c[22]*k[5]+c[23]*k[6]+c[24]*k[7]+c[25]*k[8]+c[26]*k[9]+c[27]*k[10]+c[28]*k[11]+c[29]*k[12]+c[30]*k[13]+c[31]*k[14]+c[32]*k[15]+c[33]*k[16]+c[34]*k[17]+c[35]*k[18]+c[36]*k[19]+c[37]*k[20]+c[38]*k[21]+c[39]*k[22]+c[40]*k[23]+c[41]*k[24]+c[42]*k[25]+c[43]*k[26]==c[44])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[18]*k[0]+c[19]*k[1]+c[20]*k[2]+c[21]*k[3]+c[22]*k[4]+c[23]*k[5]+c[24]*k[6]+c[25]*k[7]+c[26]*k[8]+c[27]*k[9]+c[28]*k[10]+c[29]*k[11]+c[30]*k[12]+c[31]*k[13]+c[32]*k[14]+c[33]*k[15]+c[34]*k[16]+c[35]*k[17]+c[36]*k[18]+c[37]*k[19]+c[38]*k[20]+c[39]*k[21]+c[40]*k[22]+c[41]*k[23]+c[42]*k[24]+c[43]*k[25]+c[44]*k[26]==c[45])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[19]*k[0]+c[20]*k[1]+c[21]*k[2]+c[22]*k[3]+c[23]*k[4]+c[24]*k[5]+c[25]*k[6]+c[26]*k[7]+c[27]*k[8]+c[28]*k[9]+c[29]*k[10]+c[30]*k[11]+c[31]*k[12]+c[32]*k[13]+c[33]*k[14]+c[34]*k[15]+c[35]*k[16]+c[36]*k[17]+c[37]*k[18]+c[38]*k[19]+c[39]*k[20]+c[40]*k[21]+c[41]*k[22]+c[42]*k[23]+c[43]*k[24]+c[44]*k[25]+c[45]*k[26]==c[46])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[20]*k[0]+c[21]*k[1]+c[22]*k[2]+c[23]*k[3]+c[24]*k[4]+c[25]*k[5]+c[26]*k[6]+c[27]*k[7]+c[28]*k[8]+c[29]*k[9]+c[30]*k[10]+c[31]*k[11]+c[32]*k[12]+c[33]*k[13]+c[34]*k[14]+c[35]*k[15]+c[36]*k[16]+c[37]*k[17]+c[38]*k[18]+c[39]*k[19]+c[40]*k[20]+c[41]*k[21]+c[42]*k[22]+c[43]*k[23]+c[44]*k[24]+c[45]*k[25]+c[46]*k[26]==c[47])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[21]*k[0]+c[22]*k[1]+c[23]*k[2]+c[24]*k[3]+c[25]*k[4]+c[26]*k[5]+c[27]*k[6]+c[28]*k[7]+c[29]*k[8]+c[30]*k[9]+c[31]*k[10]+c[32]*k[11]+c[33]*k[12]+c[34]*k[13]+c[35]*k[14]+c[36]*k[15]+c[37]*k[16]+c[38]*k[17]+c[39]*k[18]+c[40]*k[19]+c[41]*k[20]+c[42]*k[21]+c[43]*k[22]+c[44]*k[23]+c[45]*k[24]+c[46]*k[25]+c[47]*k[26]==c[48])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[22]*k[0]+c[23]*k[1]+c[24]*k[2]+c[25]*k[3]+c[26]*k[4]+c[27]*k[5]+c[28]*k[6]+c[29]*k[7]+c[30]*k[8]+c[31]*k[9]+c[32]*k[10]+c[33]*k[11]+c[34]*k[12]+c[35]*k[13]+c[36]*k[14]+c[37]*k[15]+c[38]*k[16]+c[39]*k[17]+c[40]*k[18]+c[41]*k[19]+c[42]*k[20]+c[43]*k[21]+c[44]*k[22]+c[45]*k[23]+c[46]*k[24]+c[47]*k[25]+c[48]*k[26]==c[49])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[23]*k[0]+c[24]*k[1]+c[25]*k[2]+c[26]*k[3]+c[27]*k[4]+c[28]*k[5]+c[29]*k[6]+c[30]*k[7]+c[31]*k[8]+c[32]*k[9]+c[33]*k[10]+c[34]*k[11]+c[35]*k[12]+c[36]*k[13]+c[37]*k[14]+c[38]*k[15]+c[39]*k[16]+c[40]*k[17]+c[41]*k[18]+c[42]*k[19]+c[43]*k[20]+c[44]*k[21]+c[45]*k[22]+c[46]*k[23]+c[47]*k[24]+c[48]*k[25]+c[49]*k[26]==c[50])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[24]*k[0]+c[25]*k[1]+c[26]*k[2]+c[27]*k[3]+c[28]*k[4]+c[29]*k[5]+c[30]*k[6]+c[31]*k[7]+c[32]*k[8]+c[33]*k[9]+c[34]*k[10]+c[35]*k[11]+c[36]*k[12]+c[37]*k[13]+c[38]*k[14]+c[39]*k[15]+c[40]*k[16]+c[41]*k[17]+c[42]*k[18]+c[43]*k[19]+c[44]*k[20]+c[45]*k[21]+c[46]*k[22]+c[47]*k[23]+c[48]*k[24]+c[49]*k[25]+c[50]*k[26]==c[51])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[25]*k[0]+c[26]*k[1]+c[27]*k[2]+c[28]*k[3]+c[29]*k[4]+c[30]*k[5]+c[31]*k[6]+c[32]*k[7]+c[33]*k[8]+c[34]*k[9]+c[35]*k[10]+c[36]*k[11]+c[37]*k[12]+c[38]*k[13]+c[39]*k[14]+c[40]*k[15]+c[41]*k[16]+c[42]*k[17]+c[43]*k[18]+c[44]*k[19]+c[45]*k[20]+c[46]*k[21]+c[47]*k[22]+c[48]*k[23]+c[49]*k[24]+c[50]*k[25]+c[51]*k[26]==c[52])</span>
<span class="token comment"># s.add(</span>
<span class="token comment"># c[26]*k[0]+c[27]*k[1]+c[28]*k[2]+c[29]*k[3]+c[30]*k[4]+c[31]*k[5]+c[32]*k[6]+c[33]*k[7]+c[34]*k[8]+c[35]*k[9]+c[36]*k[10]+c[37]*k[11]+c[38]*k[12]+c[39]*k[13]+c[40]*k[14]+c[41]*k[15]+c[42]*k[16]+c[43]*k[17]+c[44]*k[18]+c[45]*k[19]+c[46]*k[20]+c[47]*k[21]+c[48]*k[22]+c[49]*k[23]+c[50]*k[24]+c[51]*k[25]+c[52]*k[26]==c[53])</span>
<span class="token comment"># if s.check()==sat:</span>
<span class="token comment">#     m=s.model()</span>
<span class="token comment">#     for i in range(27):</span>
<span class="token comment">#         print(m[k[i]],end=',')</span>
k<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">]</span>
<span class="token comment"># for i in range(27):</span>
<span class="token comment">#     print('s.add(')</span>
<span class="token comment">#     for j in range(27):</span>
<span class="token comment">#         if i+j&lt;=26:</span>
<span class="token comment">#             if j !=26:</span>
<span class="token comment">#                 print('f[&#123;&#125;]*k[&#123;&#125;]+'.format(i+j,j),end='')</span>
<span class="token comment">#             else: print('f[&#123;&#125;]*k[&#123;&#125;]'.format(i+j,j),end='')</span>
<span class="token comment">#         else:</span>
<span class="token comment">#             if j !=26:</span>
<span class="token comment">#                 print('c[&#123;&#125;]*k[&#123;&#125;]+'.format(i+j-27,j),end='')</span>
<span class="token comment">#             else: print('c[&#123;&#125;]*k[&#123;&#125;]'.format(i+j-27,j),end='')</span>
<span class="token comment">#     print('==c[&#123;&#125;])'.format(i))</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>
f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>sat<span class="token punctuation">:</span>
    m<span class="token operator">=</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token comment"># flag&#123;_FeedBack_is_so_e@sy_&#125;</span></code></pre>


<h2 id="DASCTF三月赛-threshold"><a href="#DASCTF三月赛-threshold" class="headerlink" title="[DASCTF三月赛]threshold"></a>[DASCTF三月赛]threshold</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#make.sage</span>
<span class="token keyword">import</span> random
flag <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">"DASCTF&#123;********************************&#125;"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
N<span class="token operator">=</span><span class="token number">53</span>
p<span class="token operator">=</span><span class="token number">257</span>
q<span class="token operator">=</span><span class="token number">28019</span>
d<span class="token operator">=</span><span class="token number">18</span>
f<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">19</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">16</span>
random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
g<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">17</span>
random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>g<span class="token punctuation">)</span>

Q<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
P<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
fx<span class="token operator">=</span>Q<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
fy<span class="token operator">=</span>P<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
gx<span class="token operator">=</span>Q<span class="token punctuation">(</span>g<span class="token punctuation">)</span>
Fqx<span class="token operator">=</span>fx<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
Fpy<span class="token operator">=</span>fy<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>y<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
hx<span class="token operator">=</span><span class="token punctuation">(</span>Fqx<span class="token operator">*</span>gx<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
r<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">22</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">21</span>
random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
rx<span class="token operator">=</span>Q<span class="token punctuation">(</span>r<span class="token punctuation">)</span>
mx<span class="token operator">=</span>Q<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
ex<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">*</span>rx<span class="token operator">*</span>hx<span class="token operator">+</span>mx<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>hx<span class="token punctuation">)</span>

<span class="token comment">#7367*x^52 + 24215*x^51 + 5438*x^50 + 7552*x^49 + 22666*x^48 + 21907*x^47 + 10572*x^46 + 19756*x^45 + 4083*x^44 + 22080*x^43 + 1757*x^42 + 5708*x^41 + 22838*x^40 + 4022*x^39 + 9239*x^38 + 1949*x^37 + 27073*x^36 + 8192*x^35 + 955*x^34 + 4373*x^33 + 17877*x^32 + 25592*x^31 + 13535*x^30 + 185*x^29 + 9471*x^28 + 9793*x^27 + 22637*x^26 + 3293*x^25 + 27047*x^24 + 21985*x^23 + 13584*x^22 + 6809*x^21 + 24770*x^20 + 16964*x^19 + 8866*x^18 + 22102*x^17 + 18006*x^16 + 3198*x^15 + 19024*x^14 + 2777*x^13 + 9252*x^12 + 9684*x^11 + 3604*x^10 + 7840*x^9 + 17573*x^8 + 11382*x^7 + 12726*x^6 + 6811*x^5 + 10104*x^4 + 7485*x^3 + 858*x^2 + 15100*x + 15860</span>
<span class="token comment">#14443*x^52 + 10616*x^51 + 11177*x^50 + 24769*x^49 + 23510*x^48 + 23059*x^47 + 21848*x^46 + 24145*x^45 + 12420*x^44 + 1976*x^43 + 16947*x^42 + 7373*x^41 + 16708*x^40 + 18435*x^39 + 18561*x^38 + 21557*x^37 + 16115*x^36 + 7873*x^35 + 20005*x^34 + 11543*x^33 + 9488*x^32 + 2865*x^31 + 11797*x^30 + 2961*x^29 + 14944*x^28 + 22631*x^27 + 24061*x^26 + 9792*x^25 + 6791*x^24 + 10423*x^23 + 3534*x^22 + 26233*x^21 + 14223*x^20 + 15555*x^19 + 3381*x^18 + 23641*x^17 + 2697*x^16 + 11303*x^15 + 6030*x^14 + 7355*x^13 + 20693*x^12 + 1768*x^11 + 10059*x^10 + 27822*x^9 + 8150*x^8 + 5458*x^7 + 21270*x^6 + 22651*x^5 + 8381*x^4 + 2819*x^3 + 3987*x^2 + 8610*x + 6022</span>
</code></pre>


<p>多项式的格基规约，只需关注每项的系数即可</p>
<p><img src="https://coinc1dens.github.io/pics/lattice/NTRU_LLL1.png" alt="p"></p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
p <span class="token operator">=</span> <span class="token number">257</span>
q <span class="token operator">=</span> <span class="token number">28019</span>
P<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
Q<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
hx <span class="token operator">=</span> <span class="token number">14443</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">10616</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">11177</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">24769</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">23510</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">23059</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">21848</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">24145</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">12420</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">1976</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">16947</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">7373</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">16708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">18435</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">18561</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">21557</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">16115</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">7873</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">20005</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">11543</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">9488</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">2865</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">11797</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">2961</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">14944</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">22631</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">24061</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">9792</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">6791</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">10423</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">3534</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">26233</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">14223</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">15555</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">3381</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">23641</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">2697</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">11303</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">6030</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">7355</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">20693</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">1768</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">10059</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">27822</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">8150</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">5458</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">21270</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">22651</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">8381</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2819</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">3987</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">8610</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">6022</span>
ex <span class="token operator">=</span> <span class="token number">7367</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">24215</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">5438</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">7552</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">22666</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">21907</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">10572</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">19756</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">4083</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">22080</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">1757</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">5708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">22838</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">4022</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">9239</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">1949</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">27073</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">8192</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">955</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">4373</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">17877</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">25592</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">13535</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">185</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">9471</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">9793</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">22637</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">3293</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">27047</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">21985</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">13584</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">6809</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">24770</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">16964</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">8866</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">22102</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">18006</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">3198</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">19024</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">2777</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">9252</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">9684</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">3604</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">7840</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">17573</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">11382</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">12726</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">6811</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">10104</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">7485</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">858</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">15100</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">15860</span>
temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    this <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">53</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        this<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hx<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token operator">-</span>i <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>this<span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    this <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">28019</span><span class="token punctuation">]</span> <span class="token operator">+</span>  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">52</span> <span class="token operator">-</span> i<span class="token punctuation">)</span>
    temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>this<span class="token punctuation">)</span>
M <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ <span class="token punctuation">,</span>temp<span class="token punctuation">)</span>
B <span class="token operator">=</span> M<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>
_f <span class="token operator">=</span> B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">]</span>
_g <span class="token operator">=</span> B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
fqx <span class="token operator">=</span> Q<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
gqx <span class="token operator">=</span> Q<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>_g<span class="token punctuation">)</span><span class="token punctuation">)</span>
fpy <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>_f<span class="token punctuation">)</span><span class="token punctuation">)</span>
Fpy<span class="token operator">=</span>fpy<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>y<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
Fqx<span class="token operator">=</span>fqx<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
ax <span class="token operator">=</span> <span class="token punctuation">(</span>fqx <span class="token operator">*</span> ex<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> ax<span class="token punctuation">:</span>
    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Mod<span class="token punctuation">(</span>i<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">.</span>lift_centered<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
ay <span class="token operator">=</span> P<span class="token punctuation">(</span>a<span class="token punctuation">)</span>
m <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Fpy <span class="token operator">*</span> ay<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>y<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    m <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>
<span class="token comment"># DASCTF&#123;9bba98e8024da44a3250acbc06bebc7b&#125;</span></code></pre>


<h2 id="V-amp-N2020公开赛-CRT"><a href="#V-amp-N2020公开赛-CRT" class="headerlink" title="[V&amp;N2020公开赛]CRT"></a>[V&amp;N2020公开赛]CRT</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib
<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

ms <span class="token operator">=</span> <span class="token punctuation">[</span>getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
p <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> x<span class="token operator">*</span>y<span class="token punctuation">,</span> ms<span class="token punctuation">)</span>
x <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>
cs <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token operator">%</span> m  <span class="token keyword">for</span> m <span class="token keyword">in</span> ms<span class="token punctuation">]</span>

flag <span class="token operator">=</span> <span class="token string">"flag&#123;"</span> <span class="token operator">+</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span>
<span class="token comment"># assert("4b93deeb" in flag)</span>

<span class="token comment"># ms = [284461942441737992421992210219060544764, 218436209063777179204189567410606431578, 288673438109933649911276214358963643204, 239232622368515797881077917549177081575, 206264514127207567149705234795160750411, 338915547568169045185589241329271490503, 246545359356590592172327146579550739141, 219686182542160835171493232381209438048]</span>
<span class="token comment"># cs = [273520784183505348818648859874365852523, 128223029008039086716133583343107528289, 5111091025406771271167772696866083419, 33462335595116820423587878784664448439, 145377705960376589843356778052388633917, 128158421725856807614557926615949143594, 230664008267846531848877293149791626711, 94549019966480959688919233343793910003]</span>
</code></pre>
<p>中国剩余定理模不互素，需要合并不互素的两个方程。通过不断合并方程最终达到一个满足方程组的最小解。求一个满足条件的解,所以需要爆破。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#coding=utf-8</span>
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>n1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    d <span class="token operator">=</span> gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span>
    c <span class="token operator">=</span> a2<span class="token operator">-</span>a1
    <span class="token keyword">if</span> c<span class="token operator">%</span>d<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token number">0</span>
    c <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token operator">%</span>n2<span class="token operator">+</span>n2<span class="token punctuation">)</span><span class="token operator">%</span>n2
    c <span class="token operator">=</span> c<span class="token operator">//</span>d
    n1 <span class="token operator">=</span> n1<span class="token operator">//</span>d
    n2 <span class="token operator">=</span> n2<span class="token operator">//</span>d
    c <span class="token operator">*=</span> invert<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span>
    c <span class="token operator">%=</span> n2
    c <span class="token operator">*=</span> n1<span class="token operator">*</span>d
    c <span class="token operator">+=</span> a1
    <span class="token keyword">global</span> n3
    <span class="token keyword">global</span> a3
    n3 <span class="token operator">=</span> n1<span class="token operator">*</span>n2<span class="token operator">*</span>d
    a3 <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token operator">%</span>n3<span class="token operator">+</span>n3<span class="token punctuation">)</span><span class="token operator">%</span>n3
    <span class="token keyword">return</span> <span class="token number">1</span>
<span class="token keyword">def</span> <span class="token function">exCRT</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a1<span class="token operator">=</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    n1<span class="token operator">=</span>n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    le<span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>le<span class="token punctuation">)</span><span class="token punctuation">:</span>
        a2 <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        n2<span class="token operator">=</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> merge<span class="token punctuation">(</span>a1<span class="token punctuation">,</span>n1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
        a1 <span class="token operator">=</span> a3
        n1 <span class="token operator">=</span> n3
    <span class="token keyword">global</span> mod
    mod<span class="token operator">=</span>n1
    <span class="token keyword">return</span> <span class="token punctuation">(</span>a1<span class="token operator">%</span>n1<span class="token operator">+</span>n1<span class="token punctuation">)</span><span class="token operator">%</span>n1
ms <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">284461942441737992421992210219060544764</span><span class="token punctuation">,</span> <span class="token number">218436209063777179204189567410606431578</span><span class="token punctuation">,</span> <span class="token number">288673438109933649911276214358963643204</span><span class="token punctuation">,</span> <span class="token number">239232622368515797881077917549177081575</span><span class="token punctuation">,</span> <span class="token number">206264514127207567149705234795160750411</span><span class="token punctuation">,</span> <span class="token number">338915547568169045185589241329271490503</span><span class="token punctuation">,</span> <span class="token number">246545359356590592172327146579550739141</span><span class="token punctuation">,</span> <span class="token number">219686182542160835171493232381209438048</span><span class="token punctuation">]</span>
cs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">273520784183505348818648859874365852523</span><span class="token punctuation">,</span> <span class="token number">128223029008039086716133583343107528289</span><span class="token punctuation">,</span> <span class="token number">5111091025406771271167772696866083419</span><span class="token punctuation">,</span> <span class="token number">33462335595116820423587878784664448439</span><span class="token punctuation">,</span> <span class="token number">145377705960376589843356778052388633917</span><span class="token punctuation">,</span> <span class="token number">128158421725856807614557926615949143594</span><span class="token punctuation">,</span> <span class="token number">230664008267846531848877293149791626711</span><span class="token punctuation">,</span> <span class="token number">94549019966480959688919233343793910003</span><span class="token punctuation">]</span>
x<span class="token operator">=</span>exCRT<span class="token punctuation">(</span>cs<span class="token punctuation">,</span>ms<span class="token punctuation">)</span>
flag<span class="token operator">=</span>sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token string">"4b93deeb"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
    x<span class="token operator">=</span>x<span class="token operator">+</span>mod
    flag <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre>


<h2 id="AFCTF2018-MyOwnCBC"><a href="#AFCTF2018-MyOwnCBC" class="headerlink" title="[AFCTF2018]MyOwnCBC"></a>[AFCTF2018]MyOwnCBC</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python2.7</span>
<span class="token comment"># -*- coding: utf-8 -*-</span>

<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> random
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes

<span class="token keyword">def</span> <span class="token function">MyOwnCBC</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> plain<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">32</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> <span class="token string">"error!"</span>
	cipher_txt <span class="token operator">=</span> <span class="token string">b""</span>
	cipher_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
	plain <span class="token operator">=</span> <span class="token punctuation">[</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
	<span class="token keyword">print</span> plain
	cipher_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
	cipher_txt <span class="token operator">+=</span> cipher_arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>cipher_arr<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
		cipher_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		cipher_txt <span class="token operator">+=</span> cipher_arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
	<span class="token keyword">return</span> cipher_txt
	
key <span class="token operator">=</span> random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>key<span class="token punctuation">)</span>

s <span class="token operator">=</span> <span class="token string">""</span>
<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
	s <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
	f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag_cipher"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
	f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>MyOwnCBC<span class="token punctuation">(</span>key<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span>
	f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>


<p>上一组的密文作为下一组的key</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag_cipher"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
	plain <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
	f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
key <span class="token operator">=</span> plain<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
plain <span class="token operator">=</span> <span class="token punctuation">[</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
flag <span class="token operator">=</span> <span class="token string">b''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
	flag <span class="token operator">+=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
	key <span class="token operator">=</span> plain<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
<span class="token comment"># b"mode of operation is an algorithm that uses a block cipher to provide an information service such as confidentiality or authenticity. A block cipher by itself is only suitable for the secure cryptographic transformation (encryption or decryption) of one fixed-length group of bits called a block. A mode of operation describes how to repeatedly apply a cipher's single-block operation to securely transform amounts of data larger than a block.\n\nMost modes require a unique binary sequence, often called an initialization vector (IV), for each encryption operation. The IV has to be non-repeating and, for some modes, random as well. The initialization vector is used to ensure distinct ciphertexts are produced even when the same plaintext is encrypted multiple times independently with the same key. Block ciphers have one or more block size(s), but during transformation the block size is always fixed. Block cipher modes operate on whole blocks and require that the last part of the data be padded to a full block if it is smaller than the current block size. There are, however, modes that do not require padding because they effectively use a block cipher as a stream cipher.\n\nHistorically, encryption modes have been studied extensively in regard to their error propagation properties under various scenarios of data modification. Later development regarded integrity protection as an entirely separate cryptographic goal. Some modern modes of operation combine confidentiality and authenticity in an efficient way, and are known as authenticated encryption modes.\n\nAh you found it~ afctf&#123;Don't_be_fooled_by_yourself&#125;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"</span></code></pre>








<h2 id="Polynomial-Ring"><a href="#Polynomial-Ring" class="headerlink" title="Polynomial Ring"></a>Polynomial Ring</h2><h3 id="多项式中的欧拉函数"><a href="#多项式中的欧拉函数" class="headerlink" title="多项式中的欧拉函数"></a>多项式中的欧拉函数</h3><blockquote>
<p>对于多项式P(y)来讲，欧拉函数phi(P(y))表示所有不高于P(y)幂级的环内所有多项式中，与P(y)无除1以外的公因式的其他多项式的个数。</p>
<p>$ \phi = (p^{P(x).degree()} - 1)*(p^{Q(x).degree()} - 1) $</p>
</blockquote>
<h3 id="some-api-in-sagemath"><a href="#some-api-in-sagemath" class="headerlink" title="some api in sagemath"></a>some api in sagemath</h3><ol>
<li><p>R.<x> = PolynomialRing(GF(p))  系数都小于p的多项式环</p>
</li>
<li><p>out = R.random_element(degree=30)   随机，幂级为30</p>
</li>
<li><p>out.is_irreducible()  不可约的</p>
</li>
<li><p>R.quotient(N)  多项式除法</p>
</li>
</ol>
<h2 id="Pollard’s-p-1-Factorization-Algorithm"><a href="#Pollard’s-p-1-Factorization-Algorithm" class="headerlink" title="Pollard’s p-1 Factorization Algorithm"></a>Pollard’s p-1 Factorization Algorithm</h2><h3 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h3><p>$ L = i(p-1) = j(q-1)+k $</p>
<p>$ a^{L} = a^{i(p-1)} = (a^{p-1})^{i} \equiv 1^{i} \equiv 1 (\bmod p) $</p>
<p>$ a^{L} = a^{j(q-1)+k} = a^{k}(a^{q-1})^{j} \equiv a^{k} \cdot 1^{j} \equiv a^{k}(\bmod q) $</p>
<p>$ p = gcd(a^{L}-1, N) $</p>
<p>Pollard发现如果p-1由一些小素数相乘得到，那么</p>
<p>$ p = gcd(a^{n!}-1, N) $</p>
<p>其中n的值不太大，可以通过爆破</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">2</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
    <span class="token comment"># print(sum)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>gcd<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>gcd<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span></code></pre>


<h3 id="Smooth-Number"><a href="#Smooth-Number" class="headerlink" title="Smooth Number"></a>Smooth Number</h3><p>一个数的所有素因子都小于等于B，叫作B-smooth number</p>
<h2 id="Short-Pad-Attack-amp-Related-Message-Attack"><a href="#Short-Pad-Attack-amp-Related-Message-Attack" class="headerlink" title="Short Pad Attack &amp; Related Message Attack"></a>Short Pad Attack &amp; Related Message Attack</h2><p>padding长度小于等于$ \frac{n.nbits()}{e^{2}} $</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
<span class="token keyword">def</span> <span class="token function">short_pad_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    PRxy<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>xn<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    PRZZ<span class="token punctuation">.</span><span class="token operator">&lt;</span>xz<span class="token punctuation">,</span>yz<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>

    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1
    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2

    q1 <span class="token operator">=</span> g1<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>
    q2 <span class="token operator">=</span> g2<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>

    h <span class="token operator">=</span> q2<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>
    h <span class="token operator">=</span> h<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span>
    h <span class="token operator">=</span> h<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRx<span class="token punctuation">)</span><span class="token punctuation">.</span>subs<span class="token punctuation">(</span>y<span class="token operator">=</span>xn<span class="token punctuation">)</span>
    h <span class="token operator">=</span> h<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>

    kbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token operator">*</span>e<span class="token punctuation">)</span>
    diff <span class="token operator">=</span> h<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># find root &lt; 2^kbits with factor >= n^0.4</span>

    <span class="token keyword">return</span> diff

<span class="token keyword">def</span> <span class="token function">related_message_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#small e</span>
    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1
    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>diff<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2

    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>
            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2
        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> 
    e <span class="token operator">=</span> 

    c1 <span class="token operator">=</span>
    c2 <span class="token operator">=</span> 

    diff <span class="token operator">=</span> short_pad_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"difference of two messages is %d"</span> <span class="token operator">%</span> diff<span class="token punctuation">)</span>

    m1 <span class="token operator">=</span> related_message_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m1:"</span><span class="token punctuation">,</span> m1<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m2:"</span><span class="token punctuation">,</span> m1 <span class="token operator">+</span> diff<span class="token punctuation">)</span></code></pre>


<h2 id="AES-CBC"><a href="#AES-CBC" class="headerlink" title="AES.CBC"></a>AES.CBC</h2><h3 id="bit翻转"><a href="#bit翻转" class="headerlink" title="bit翻转"></a>bit翻转</h3><p>admin=0 -&gt; admin=1</p>
<h3 id="选择明文攻击"><a href="#选择明文攻击" class="headerlink" title="选择明文攻击"></a>选择明文攻击</h3><p>$ iv = M_{1} \oplus M_{2} \oplus C $</p>
<h3 id="padding-oracle"><a href="#padding-oracle" class="headerlink" title="padding oracle"></a>padding oracle</h3><p>PKCS5填充、有交互、key和iv都未知、利用服务器对padding检查有不同回显、末位逐位爆破</p>
<h2 id="NepCTF2021-ChildRSA"><a href="#NepCTF2021-ChildRSA" class="headerlink" title="[NepCTF2021]ChildRSA"></a>[NepCTF2021]ChildRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#childrsa</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> iroot
<span class="token keyword">from</span> os <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag1<span class="token punctuation">,</span>flag2<span class="token punctuation">,</span>padding1<span class="token punctuation">,</span>padding2
<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">20</span>
<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token operator">></span><span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>padding2<span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">init1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    m<span class="token operator">=</span><span class="token punctuation">(</span>padding1<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span><span class="token operator">+</span>bytes_to_long<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span>
    r1<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">)</span>
    r2<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">)</span>
    p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    q<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    N<span class="token operator">=</span>p<span class="token operator">*</span>q

    <span class="token keyword">return</span> m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N
    
<span class="token keyword">def</span> <span class="token function">enc1</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>
    c1<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token operator">+</span>r1<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span>
    c2<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token operator">+</span>r2<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> c1<span class="token punctuation">,</span>c2

<span class="token keyword">def</span> <span class="token function">init2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    prefix <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">1000</span>
    r3 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>prefix<span class="token operator">+</span>flag2<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span>
    r4 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>prefix<span class="token operator">+</span>padding2<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span>
    <span class="token keyword">return</span> r3<span class="token punctuation">,</span>r4

<span class="token keyword">def</span> <span class="token function">enc2</span><span class="token punctuation">(</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span><span class="token punctuation">:</span>
    c3 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>r3<span class="token operator">*</span>r4<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> c3

<span class="token punctuation">(</span>m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N<span class="token punctuation">)</span> <span class="token operator">=</span> init1<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token operator">=</span>enc1<span class="token punctuation">(</span>m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N<span class="token punctuation">)</span>
<span class="token punctuation">(</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span> <span class="token operator">=</span> init2<span class="token punctuation">(</span><span class="token punctuation">)</span>
c3 <span class="token operator">=</span> enc2<span class="token punctuation">(</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span>
<span class="token keyword">print</span> N
<span class="token keyword">print</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span></code></pre>


<h2 id="Coppersmith’s-Random-Padding-Attack"><a href="#Coppersmith’s-Random-Padding-Attack" class="headerlink" title="Coppersmith’s Random Padding Attack"></a>Coppersmith’s Random Padding Attack</h2><p>$   c_1 \equiv (m+r_1)^{3}\mod{N}$</p>
<p>$  c_2\equiv(m+r_2)^{3}\mod{N} $</p>
<p>可以看成是<br>$$<br>c_1 \equiv M^{3}\mod{N}\<br>$$</p>
<p>$$<br>c_2\equiv(M+r)^{3}\mod{N}<br>$$</p>
<p>然后化简两个公式，将M抵消掉，得到只有r的⼀元⽅程<br>$$<br>r^9+(3c_1-3c_2)r^6+(3c_1^2+21c_1c_2+3c_2^2)r^3+(c_1-c_2)^3=0\mod{N}<br>$$<br>因为r1、r2最多170位，所以r也是最多170位。此时利⽤coppersmith可以得到r的值<br>$$<br>170bits \approx N^{\frac{1}{12}}<br>$$</p>
<p>$$<br>epsilon =\frac{1}{9} - \frac{1}{12} = \frac{1}{36}<br>$$</p>
<p>求得r之后⽤Franklin-Reiter Related Message Attack 得到M。由于M=padding 1|| flag1 || r1 ,因此直接转 </p>
<p>化成字节可以得到flag1。 </p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> 
<span class="token comment">#from gmpy2 import iroot </span>
N<span class="token operator">=</span>28158376030783126462160089589823483713527137233213875572448002306591587078780130580064960928000260046723470757493523772992812185236491055072491361217940285809743091958889318723862394925161624189393204199333582056921761101170728126732633570787046368451452592297474997001720894985956809324776433753817913573764903118962295218320504483249302086522864189503976194142497460351928118211969015560337732569710308337625261805046420223294551248496856153012197979278463862836023897894535718512636307578414641240750045867326554984308461337470720249462693325847418638485693227856545631806676082705971847561028566848739943309350523L
<span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">24224099638194324112593871012681573152728137743988130174034194747749499893806613392393262358304278286207848016575593184397104060179978140321847376670647434030870270659753891424180300938412183930402939964298221231907700551385713992208907288670440128651459855106370601996167821568454498946189809679805856760077602954185656580735443254919133313869021875507715983005654259694427753140006431537962760663821770319611657591446033183695065991242937214964884018439712856483970516075937859659014842147053482562615064262033128353761384111673580976781273192034059752430319614321781718852031021334707002690826600780316128823557078</span><span class="token punctuation">,</span> <span class="token number">9346750271098236574311526832166143274981900619073634627239673835573015044474781208925371397721856252589055337535370071073022935304585017378639576719997933317896392172224331035651304165371533650982779424261861522620182573561472976299952543222698749313342053690793739259992577314602927389157124886863152775368006245054707996451092743563826965858367896714784027494674462238582099575028052030487857739015972028019673964986909534784865442448462755269733906210352597618064622408012998910837512387765999752231309660534222112023575816948992389787796776523706795068869288928522584197893586912900864981983132389327089147168146</span><span class="token punctuation">,</span><span class="token number">12107764658433896580107280538635135643387858852976620070691115333175114455948516277086646541412419646593297889201461016204186139568117475108121483620886979081055400119823555863287145558918960315604392538385365775518531415962595383790406519796107060397002742243430892069572422621367817969753308155681207288179722229190134116638193477979912363191546805420859415583321036973918671704414861068461071208456971522273733442192940846444300605718874968169235475237419035100359757819694303844991958162933063957514071374815976765116772095057060790532835820921941088145846413070125370893266694322242100018189171839236880288990785924731992240524566660760922463600094468267262479875177563252492042982465535450638009272498423063736302466479967160885598220013264243699170187377424360056887609494799576319202957855035769847474106037568257493594313444725436907261296589305657506580644724070073124760436092785070723978602029411520504130916009400359604526646351156436915392008166680858644751752849852559564642823536994015310787265345702214921009048446529410934651620740678596168179297695317825626377519087362620254075060283392495964100088104432955208048486368967069833933648053224437409662903374041626724752539021740964387214123704727358129789524527156031473687977024441000979679744414175754810038626527843431424394300602082336759566303619981176757419266691542040519548871088083534246850686949005736818866455421187638056233493672106359797782169712261131423897346468178309589638059793798304934967642857700497827862408132279349488890162419922934863936257606996005393045700768753829407234139813940831919160314036065245565171960402080772504580960750282631405024166104777299328579173845225098623353952827436661379857324363184646746357839176347923656698542515335105484998791972994614628816209171376677660216724863205662719962318372864</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">cop_solve</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    f <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">9</span><span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>c1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">21</span><span class="token operator">*</span>c1<span class="token operator">*</span>c2<span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span>c2<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span> 
    x0<span class="token operator">=</span>f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">170</span><span class="token punctuation">,</span>beta<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span>epsilon <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">36</span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span> 
        <span class="token keyword">print</span><span class="token punctuation">(</span>x0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> x0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 
<span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token keyword">return</span> a<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span> 
<span class="token keyword">def</span> <span class="token function">franklin_solve</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>r<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span> 
    R<span class="token punctuation">.</span><span class="token operator">&lt;</span>X<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span> 
    f1 <span class="token operator">=</span> X<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">-</span> c1 
    f2 <span class="token operator">=</span> <span class="token punctuation">(</span>X <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span> <span class="token operator">-</span> c2 
    <span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span><span class="token operator">-</span>gcd<span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">)</span><span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
R <span class="token operator">=</span> cop_solve<span class="token punctuation">(</span>N<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span> 
M <span class="token operator">=</span> franklin_solve<span class="token punctuation">(</span>N<span class="token punctuation">,</span>R<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#flag1 </span>
<span class="token comment">#28158376030783126462160089589823483713527137233213875572448002306591587078780130580064960928000260046723470757493523772992812185236491055072491361217940285809743091958889318723862394925161624189393204199333582056921761101170728126732633570787046368451452592297474997001720894985956809324776433753817913573764903118962295218320504483249302086522864189503976194142497460351928118211969015560337732569710308337625261805046420223294551248496856153012197979278463862836023897894535718512636307578414641240750045867326554984308461337470720249462693325847418638485693227856340154690304590078577734025351629922056279918570359</span>
<span class="token comment">#b'\x00\x00\x00\x00\x00Nep&#123;Nep_n3p_ba4_bad_\x00\x00\x00\x03\t'</span></code></pre>
<p>flag2直接解⽅程</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> 
<span class="token comment">#from gmpy2 import iroot </span>
c3 <span class="token operator">=</span> <span class="token number">12107764658433896580107280538635135643387858852976620070691115333175114455948516277086646541412419646593297889201461016204186139568117475108121483620886979081055400119823555863287145558918960315604392538385365775518531415962595383790406519796107060397002742243430892069572422621367817969753308155681207288179722229190134116638193477979912363191546805420859415583321036973918671704414861068461071208456971522273733442192940846444300605718874968169235475237419035100359757819694303844991958162933063957514071374815976765116772095057060790532835820921941088145846413070125370893266694322242100018189171839236880288990785924731992240524566660760922463600094468267262479875177563252492042982465535450638009272498423063736302466479967160885598220013264243699170187377424360056887609494799576319202957855035769847474106037568257493594313444725436907261296589305657506580644724070073124760436092785070723978602029411520504130916009400359604526646351156436915392008166680858644751752849852559564642823536994015310787265345702214921009048446529410934651620740678596168179297695317825626377519087362620254075060283392495964100088104432955208048486368967069833933648053224437409662903374041626724752539021740964387214123704727358129789524527156031473687977024441000979679744414175754810038626527843431424394300602082336759566303619981176757419266691542040519548871088083534246850686949005736818866455421187638056233493672106359797782169712261131423897346468178309589638059793798304934967642857700497827862408132279349488890162419922934863936257606996005393045700768753829407234139813940831919160314036065245565171960402080772504580960750282631405024166104777299328579173845225098623353952827436661379857324363184646746357839176347923656698542515335105484998791972994614628816209171376677660216724863205662719962318372864</span>
<span class="token keyword">def</span> <span class="token function">coron</span><span class="token punctuation">(</span>pol<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
    <span class="token keyword">if</span> pol<span class="token punctuation">.</span>nvariables<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span> 
        <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"pol is not bivariate"</span><span class="token punctuation">)</span> 
    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span> 
    pol <span class="token operator">=</span> pol<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span> 
    xoffset <span class="token operator">=</span> <span class="token number">0</span> 
    <span class="token keyword">while</span> pol<span class="token punctuation">(</span>xoffset<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> 
        xoffset <span class="token operator">+=</span> <span class="token number">1</span> 
    pol <span class="token operator">=</span> pol<span class="token punctuation">(</span>x<span class="token operator">+</span>xoffset<span class="token punctuation">,</span>y<span class="token punctuation">)</span> 
    <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>pol<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span> 
        X <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>X<span class="token punctuation">,</span> proof<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> 
    <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>pol<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span> 
        Y <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> proof<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span> 
    pol <span class="token operator">=</span> P<span class="token punctuation">(</span>pol<span class="token operator">/</span>gcd<span class="token punctuation">(</span>pol<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># seems to be helpful </span>
    p00 <span class="token operator">=</span> pol<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> 
    delta <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>pol<span class="token punctuation">.</span>degree<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>pol<span class="token punctuation">.</span>degree<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># maximum degree of any variable </span>
    W <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> pol<span class="token punctuation">(</span>x<span class="token operator">*</span>X<span class="token punctuation">,</span>y<span class="token operator">*</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    u <span class="token operator">=</span> W <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>W<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>p00<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    N <span class="token operator">=</span> u<span class="token operator">*</span><span class="token punctuation">(</span>X<span class="token operator">*</span>Y<span class="token punctuation">)</span><span class="token operator">^</span>k <span class="token comment"># modulus for polynomials </span>
    p00inv <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>p00<span class="token punctuation">,</span>N<span class="token punctuation">)</span> 
    polq <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">*</span>p00inv <span class="token operator">%</span> N<span class="token punctuation">)</span><span class="token operator">*</span>j <span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>pol<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pol<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    polynomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>delta<span class="token operator">+</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>delta<span class="token operator">+</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
            <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;=</span> k <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> j <span class="token operator">&lt;=</span> k<span class="token punctuation">:</span> 
                polynomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>polq <span class="token operator">*</span> x<span class="token operator">^</span>i <span class="token operator">*</span> y<span class="token operator">^</span>j <span class="token operator">*</span> X<span class="token operator">^</span><span class="token punctuation">(</span>k<span class="token operator">-</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> Y<span class="token operator">^</span><span class="token punctuation">(</span>k<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span> 
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                polynomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token operator">^</span>i <span class="token operator">*</span> y<span class="token operator">^</span>j <span class="token operator">*</span> N<span class="token punctuation">)</span> 
    monomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
    <span class="token keyword">for</span> i <span class="token keyword">in</span> polynomials<span class="token punctuation">:</span> 
        <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
            <span class="token keyword">if</span> j <span class="token keyword">not</span> <span class="token keyword">in</span> monomials<span class="token punctuation">:</span> 
                monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">)</span> 
    monomials<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    L <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
            L<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> polynomials<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>X<span class="token operator">*</span>x<span class="token punctuation">,</span>Y<span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>monomials<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> 
    L <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> debug<span class="token punctuation">:</span> 
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bitlengths of matrix elements (before reduction):"</span><span class="token punctuation">)</span> 
        <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>apply_map<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    L <span class="token operator">=</span> L<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span> 
    <span class="token keyword">if</span> debug<span class="token punctuation">:</span> 
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bitlengths of matrix elements (after reduction):"</span><span class="token punctuation">)</span> 
        <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>apply_map<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    roots <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
        <span class="token keyword">if</span> debug<span class="token punctuation">:</span> 
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Trying row &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        pol2 <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>mul<span class="token punctuation">,</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token operator">/</span>X<span class="token punctuation">,</span>y<span class="token operator">/</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span> 
        r <span class="token operator">=</span> pol<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>pol2<span class="token punctuation">,</span> y<span class="token punctuation">)</span> 
        <span class="token keyword">if</span> r<span class="token punctuation">.</span>is_constant<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># not independent </span>
            <span class="token keyword">continue</span> 
    <span class="token keyword">for</span> x0<span class="token punctuation">,</span> _ <span class="token keyword">in</span> r<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
        <span class="token keyword">if</span> x0<span class="token operator">-</span>xoffset <span class="token keyword">in</span> <span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> roots<span class="token punctuation">]</span><span class="token punctuation">:</span> 
            <span class="token keyword">continue</span>
        <span class="token keyword">if</span> debug<span class="token punctuation">:</span> 
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Potential x0:"</span><span class="token punctuation">,</span>x0<span class="token punctuation">)</span> 
        <span class="token keyword">for</span> y0<span class="token punctuation">,</span> _ <span class="token keyword">in</span> pol<span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
            <span class="token keyword">if</span> debug<span class="token punctuation">:</span> 
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Potential y0:"</span><span class="token punctuation">,</span>y0<span class="token punctuation">)</span> 
            <span class="token keyword">if</span> <span class="token punctuation">(</span>x0<span class="token operator">-</span>xoffset<span class="token punctuation">,</span>y0<span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> roots <span class="token keyword">and</span> pol<span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> 
                roots<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>x0<span class="token operator">-</span>xoffset<span class="token punctuation">,</span>y0<span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token keyword">return</span> roots 
prefix <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">1000</span> 
P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span> 
f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>prefix<span class="token operator">+</span>x<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>prefix<span class="token operator">+</span>y<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span><span class="token operator">-</span>c3 
x0<span class="token punctuation">,</span> y0 <span class="token operator">=</span> coron<span class="token punctuation">(</span>f<span class="token punctuation">,</span> X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">160</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">160</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 
<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">(</span>y0<span class="token punctuation">)</span><span class="token punctuation">)</span> </code></pre>


<p>flag2求解报错，尚未解决。。</p>
<h2 id="NepCTF2021-lowExponent"><a href="#NepCTF2021-lowExponent" class="headerlink" title="[NepCTF2021]lowExponent"></a>[NepCTF2021]<strong>lowExponent</strong></h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag

<span class="token keyword">def</span> <span class="token function">Encrypt</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> nbits<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>nbits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    N <span class="token operator">=</span> p<span class="token operator">*</span>q
    x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token punctuation">[</span>getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yp<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
        fp <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span> Yp<span class="token operator">^</span><span class="token number">2</span>
        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yq<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
        fq <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span> Yq<span class="token operator">^</span><span class="token number">2</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            yp<span class="token punctuation">,</span> yq <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fq<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
            y <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token punctuation">[</span>yp<span class="token punctuation">,</span> yq<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>
            E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>
            msg_point <span class="token operator">=</span> E<span class="token punctuation">.</span>point<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>
            Ep <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>
            Eq <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>
            N1 <span class="token operator">=</span> Ep<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span>
            N2 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span>N1
            N3 <span class="token operator">=</span> Eq<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span>
            N4 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>q<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span>N3
            d <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
                <span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N1<span class="token punctuation">,</span> N3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N1<span class="token punctuation">,</span> N4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N2<span class="token punctuation">,</span> N3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N2<span class="token punctuation">,</span> N4<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">break</span>
        <span class="token keyword">except</span><span class="token punctuation">:</span>
            <span class="token keyword">pass</span>
    cip_point <span class="token operator">=</span> e<span class="token operator">*</span>msg_point
    ciphertext <span class="token operator">=</span> cip_point<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    privKey <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
    pubKey <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> N<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> pubKey<span class="token punctuation">,</span> privKey<span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">Decrypt</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> pubKey<span class="token punctuation">,</span> privKey<span class="token punctuation">)</span><span class="token punctuation">:</span>
    d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q <span class="token operator">=</span> privKey
    a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> N <span class="token operator">=</span> pubKey
    x <span class="token operator">=</span> ciphertext
    w <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">%</span> N
    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yp<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fp <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span>Yp<span class="token operator">^</span><span class="token number">2</span>
    yp <span class="token operator">=</span> fp<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yq<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>
    fq <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span>Yq<span class="token operator">^</span><span class="token number">2</span>
    yq <span class="token operator">=</span> fq<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    y <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>yp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>yq<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>
    E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>
    cip_point <span class="token operator">=</span> E<span class="token punctuation">.</span>point<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span>
    legendre_symbol_p <span class="token operator">=</span> legendre_symbol<span class="token punctuation">(</span>w<span class="token punctuation">,</span> p<span class="token punctuation">)</span>
    legendre_symbol_q <span class="token operator">=</span> legendre_symbol<span class="token punctuation">(</span>w<span class="token punctuation">,</span> q<span class="token punctuation">)</span>
    msg_point <span class="token operator">=</span> d<span class="token punctuation">[</span><span class="token punctuation">(</span>legendre_symbol_p<span class="token punctuation">,</span> legendre_symbol_q<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span>cip_point
    <span class="token keyword">return</span> msg_point<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>


msg <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    current_st <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>
    cipher <span class="token operator">=</span> Encrypt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
    f<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span><span class="token string">"&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cipher<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>cipher<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre>


<p>加密后的结果是椭圆曲线上的点， Division Polynomials使我们可以⽤仅含⼀个未知数的多项式来表⽰这个点 </p>
<p>的x坐标： </p>
<p>$$<br>\begin{aligned} </p>
<p>\psi_{-1} &amp;=-1 \ </p>
<p>\psi_{0} &amp;=0 \ </p>
<p>\psi_{1} &amp;=1 \ </p>
<p>\psi_{2} &amp;=2 y \ </p>
<p>\psi_{3} &amp;=3 x^{4}+6 a x^{2}+12 b x-a^{2} \ </p>
<p>\psi_{4} &amp;=4 y\left(x^{6}+5 a x^{4}+20 b x^{3}-5 a^{2} x^{2}-4 a b x-8 b^{2}-a^{3}\right) \ </p>
<p>\psi_{2 i+1} &amp;=\psi_{i}\left(\psi_{i+2} \psi_{i-1}^{2}-\psi_{i-2} \psi_{i+1}^{2}\right) / 2 y, i \geq 2 \ </p>
<p>\psi_{2 i} &amp;=\psi_{i+2} \psi_{i}^{3}-\psi_{i+1}^{3} \psi_{i-1}, i \geq 3 </p>
<p>\end{aligned}<br>$$</p>
<p>此外，还可以定义多项式 $\phi_{m}$ 和 $\omega_{m}$： </p>
<p>$$<br>\begin{aligned} </p>
<p>\phi_{m} &amp;=x \psi_{m}^{2}-\psi_{m+1} \psi_{m-1} \ </p>
<p>\omega_{m} &amp;=\left(\psi_{m+2} \psi_{m-1}^{2}-\psi_{m-2} \psi_{m+1}^{2}\right) / 4 y </p>
<p>\end{aligned}<br>$$</p>
<p>那么椭圆曲线上的数乘，就可以⽤Division Polynomials来表⽰了：<br>$$<br>m P=\left(\frac{\phi_{m}(P)}{\psi_{m}(P)^{2}}, \frac{\omega_{m}(P)}{\psi_{m}(P)^{3}}\right)<br>$$</p>
<p>$$<br>ciphertext=\frac{\phi_{m}(P)}{\psi_{m}(P)^{2}}<br>$$</p>
<p>$$<br>f=ciphertext\cdot \psi_{m}(P)^{2}-\phi_{m}(P)=0\ (mod\ n)<br>$$</p>
<p>由于密⽂给了70组，所以 $f_i$ 多项式⼀共有70个，由于指数 $e=3$，所以 $f_i$ 为九次同余⽅程，可以通 </p>
<p>过中国剩余定理将70个同余⽅程合并成⼀个，这时得到的是⼀个系数很⼤，模数N也很⼤的九次同余⽅程，这 </p>
<p>时可以通过格基规约算法得到模这个很⼤的N的意义下的、较⼩的系数，当真实系数⼩于N时，同余⽅程便可 </p>
<p>以直接看作等号连接的⽅程，即可很⽅便的求解⼀个较⼩的根（明⽂）。 </p>
<p>⾮预期：在使⽤CRT合并成⼀个同余式之后，由于明⽂m相对n过于⼩，可以⽤ </p>
<p>coppersmith求解出根。 </p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> 
f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> 
ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
	ci<span class="token punctuation">,</span> ai<span class="token punctuation">,</span> bi<span class="token punctuation">,</span> ni <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
	ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ci<span class="token punctuation">)</span> 
	a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ai<span class="token punctuation">)</span> 
	b<span class="token punctuation">.</span>append<span class="token punctuation">(</span>bi<span class="token punctuation">)</span> 
	n<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ni<span class="token punctuation">)</span> 
	e <span class="token operator">=</span> <span class="token number">3</span> 
	deg <span class="token operator">=</span> <span class="token number">9</span> 
	coeffi <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
		E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
		P<span class="token punctuation">.</span><span class="token operator">&lt;</span>m<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
		f <span class="token operator">=</span> ciphertext<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>E<span class="token punctuation">.</span>_multiple_x_denominator<span class="token punctuation">(</span>e<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">-</span> E<span class="token punctuation">.</span>_multiple_x_numerator<span class="token punctuation">(</span>e<span class="token punctuation">,</span> m<span class="token punctuation">)</span> 
		coeffi<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span>sparse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
		large_coeffi <span class="token operator">=</span> <span class="token punctuation">[</span>crt<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>coeffi<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>n<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
		N_bitlength <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
		min_n <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> 
		N <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x<span class="token operator">*</span>y<span class="token punctuation">,</span> n<span class="token punctuation">)</span> 
		Sc <span class="token operator">=</span> large_coeffi
var<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span> 
assume<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">'integer'</span><span class="token punctuation">)</span> 
f <span class="token operator">=</span> Sc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 
lat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> 
lat<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>large_coeffi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>min_n<span class="token operator">**</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> 
	lat<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>min_n<span class="token operator">**</span>j<span class="token punctuation">)</span><span class="token operator">*</span>N <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> 
	Mat <span class="token operator">=</span> matrix<span class="token punctuation">(</span>lat<span class="token punctuation">)</span> 
	Mat_LLL <span class="token operator">=</span> Mat<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span> 
<span class="token keyword">for</span> lin <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">:</span> 
	Sc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> Mat_LLL<span class="token punctuation">[</span>lin<span class="token punctuation">]</span><span class="token punctuation">]</span> 
	Sc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>Sc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">//</span><span class="token punctuation">(</span>min_n<span class="token operator">**</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> 
	var<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span> 
	assume<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">'integer'</span><span class="token punctuation">)</span> 
	f <span class="token operator">=</span> Sc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> 
	<span class="token keyword">print</span><span class="token punctuation">(</span>factor<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span> 
	<span class="token keyword">break</span> 
<span class="token triple-quoted-string string">''' 
m = 3088969433059681806521206959873975785377227976800172674306727155831805513908352148702210247662586117242206183337522557 
print(long_to_bytes(m)) 
'''</span></code></pre>
<p>运行报错，待解决</p>
<h3 id="Hasted广播攻击"><a href="#Hasted广播攻击" class="headerlink" title="Hasted广播攻击"></a>Hasted广播攻击</h3><blockquote>
<p>使用不同但互质的模数n，相同的指数e、加密e个明文得到e个密文</p>
<p>$ c_{i} = (a_{i}x + b{i})^{e} \bmod n_{i} , i = 1,2,\cdots,e $</p>
<p>e个式子：$ (a_{i}x + b{i})^{e} - c_{i} \equiv 0 \bmod n_{i} , i = 1, 2, \cdots , e $</p>
<p>$ \because  n_{i}互素 和 中国剩余定理 $</p>
<p>$ \therefore P(x) \equiv 0 \bmod M , M = \prod_{i=1}^{e} n_{i} $</p>
<p>$ \because P(x)有唯一解，且满足LLL算法的约束条件 $</p>
<p>$ \therefore 可以用coppersmith的smallroots求解 $</p>
</blockquote>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
<span class="token keyword">def</span> <span class="token function">linearPaddingHastads1</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> nArray<span class="token punctuation">,</span> aArray<span class="token punctuation">,</span> bArray<span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>aArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bArray<span class="token punctuation">)</span> <span class="token operator">==</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
            cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            nArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>nArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
            bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        TArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>e
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
            arrayToCRT <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>e
            arrayToCRT<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
            TArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> crt<span class="token punctuation">(</span>arrayToCRT<span class="token punctuation">,</span> nArray<span class="token punctuation">)</span>
        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>nArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        gArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>e
        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>
            gArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> TArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x <span class="token operator">+</span> bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">-</span> cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        g <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gArray<span class="token punctuation">)</span>
        g <span class="token operator">=</span> g<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment"># Use Sage's inbuilt coppersmith method</span>
        roots <span class="token operator">=</span> g<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>epsilon<span class="token operator">=</span>eps<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>roots<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No Solutions found"</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>
        <span class="token keyword">return</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CiphertextArray, ModulusArray, and the linear padding arrays need to be of the same length,"</span> <span class="token operator">+</span>
              <span class="token string">"and the same size as the public exponent"</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">linearPaddingHastads2</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> nArray<span class="token punctuation">,</span> aArray<span class="token punctuation">,</span> bArray<span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    cnt <span class="token operator">=</span> e
    PR <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">)</span>
    x <span class="token operator">=</span> PR<span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    Fs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">:</span>
        f <span class="token operator">=</span> PR<span class="token punctuation">(</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x <span class="token operator">+</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span>e <span class="token operator">-</span> Cs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
        ff <span class="token operator">=</span> f<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>Ns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        ff <span class="token operator">=</span> ff<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>
        f <span class="token operator">=</span> ff<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>
        Fs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">)</span>
    F <span class="token operator">=</span> crt<span class="token punctuation">(</span>Fs<span class="token punctuation">,</span> Ns<span class="token punctuation">)</span>
    M <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x <span class="token operator">*</span> y<span class="token punctuation">,</span> Ns<span class="token punctuation">)</span>
    FF <span class="token operator">=</span> F<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>
    m <span class="token operator">=</span> FF<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>epsilon<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> m<span class="token punctuation">:</span>
        <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">None</span></code></pre>









                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Handy</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://wusthandy.github.io/2021/03/31/2-yue-he-3-yue-zong-jie-bi-ji/">https://wusthandy.github.io/2021/03/31/2-yue-he-3-yue-zong-jie-bi-ji/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Handy</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/10/02/4-yue-zong-jie-bi-ji/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/0.jpg" class="responsive-img" alt="4月总结笔记">
                        
                        <span class="card-title">4月总结笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-10-02
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/writeup/" class="post-category">
                                    writeup
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/03/31/lcg-xian-xing-tong-yu-sheng-cheng-qi/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/5.jpg" class="responsive-img" alt="LCG-线性同余生成器">
                        
                        <span class="card-title">LCG-线性同余生成器</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-03-31
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/note/" class="post-category">
                                    note
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="2942228334"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021-2022</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">Handy</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">59.6k</span>&nbsp;字
            
            
            
            
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2021";
                    var startMonth = "2";
                    var startDate = "4";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="/null" target="_blank">冀ICP备20016511号-1</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/WustHandy" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wusthandy@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=821644097" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 821644097" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
