<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="October Summary, Handy&#39;s blog">
    <meta name="description" content="wuster">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>October Summary | Handy&#39;s blog</title>
    <link rel="icon" type="image/png" href="/medias/zly.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <script src="/libs/jquery/jquery.min.js"></script>

<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.3.0"></head>



   <style>
    body{
       background-image: url(https://pic1.zhimg.com/80/v2-af16da70cb8e243abd76406cc4c52df4_1440w.jpg);
       background-repeat:no-repeat;
       background-size:cover;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/zly.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Handy&#39;s blog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/categories" class="waves-effect waves-light">
      
      <i class="fas fa-bookmark" style="zoom: 0.6;"></i>
      
      <span>分类</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/friends" class="waves-effect waves-light">
      
      <i class="fas fa-address-book" style="zoom: 0.6;"></i>
      
      <span>友情链接</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/zly.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Handy&#39;s blog</div>
        <div class="logo-desc">
            
            wuster
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/categories" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-bookmark"></i>
			
			分类
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/friends" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-address-book"></i>
			
			友情链接
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/WustHandy" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/WustHandy" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/10.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">October Summary</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                          <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                          </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fas fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/writeup/" class="post-category">
                                writeup
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2021-11-05
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp;
                    2021-11-05
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp;
                    3.5k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp;
                    20 分
                </div>
                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        
        <!-- 代码块折行 -->
        <style type="text/css">
            code[class*="language-"], pre[class*="language-"] { white-space: pre-wrap !important; }
        </style>
        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="XMAN夏令营TooooomanyRSA"><a href="#XMAN夏令营TooooomanyRSA" class="headerlink" title="XMAN夏令营TooooomanyRSA"></a>XMAN夏令营TooooomanyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd
<span class="token keyword">from</span> uuid <span class="token keyword">import</span> uuid4

flag <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"flag&#123;"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">init_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>
    n <span class="token operator">=</span> p <span class="token operator">*</span> q
    elist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>inverse<span class="token punctuation">(</span>getPrime<span class="token punctuation">(</span><span class="token number">810</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> gcd<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        elist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token keyword">return</span> elist<span class="token punctuation">,</span> n

m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
elist<span class="token punctuation">,</span> n <span class="token operator">=</span> init_key<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c ="</span><span class="token punctuation">,</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">65537</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elist ="</span><span class="token punctuation">,</span>elist<span class="token punctuation">)</span>

<span class="token triple-quoted-string string">'''
c = 8836441252076834545813477411326425375032267123570785772864736522363289546687708899074336247215937510570504358003107825056501941030269383864118843746175337393654312850577439133664730484837119573532202639084658757820201188879766516909534973535998857651937119461057973385426395724145776918292561702292436605761423965907449269350234768599086801097764871812636671292354213601605096195311151373515090830120096932678276497558133279308072396732663178152322425868305886057431421961733257631788613513220162555655889179523511665784230205568552674460999865994501813783725694862606623394523003050895631252334230583883118073253764
n = 13441675621853397537941552930565086940390470130815380172405483101963424807980457970171725987335576421109600777181124732686757429091494072838586546464238360449989289020069386272380414809945684476174566989775147057082001644921451704981593847572798324632557836313044339427816944052099264108168157879645492166128090320214880302941951710697142064976112121583858774576042442313128499340606412845822519283515566759147621860641682899507428800319575392348478145779271935852461866317025429591494415486087527357696348049367246280018948490128455131326723173717164420547870649041609012209503120621766999344338619628361309881504449
elist = [6394785330485131407826851764944106702989306751661773111300134919431104584180613989558300377714349529400378558913602158291081082675430487235339914971012067566601890029839947493155254582899628788537164340404428811085870041808860483801729245083548201334366733631432145384161908034867977906516995215397817811827060338562939218932916441868066261899714398094644048582309184012571138467837154157300425982546397721016585389530109123133328761496692431696333697620772147165360784490956672563278919171793966890158893934190837756790824904679773847777676326932643265426451922272758626857050445979305022351126666958426400079653623, 1369139766594499502102339802022151306473260303306443944809840701670612636871224554225002168944819225437998598365160666841985968029088084698853903787370193867870645734160453072726844381549153136514381609762281206178008136789238144315497475817194151194572296755949819068715206908967557531534965163142405984337962331584669073736885280026972797963267782773986730500382181318371495017118704093918920704345311527651399811381295059334575066198160251659075954912595362620180554775651196811925899974337478484410958141839806933182849189323190130942495340593301630517690327831594714373018323154749642065080783334651101242699263, 5437175210613834481955163777766627983523303337501300230689357572042873091664083970990501546609837607847693632622863075171175573210124960851439677015543351005393752316875323874628271392021624688370950188978195558312943877934365491687668809500866579503310026982199641168879029765994054311638922866950503743682009008734748720854732986500921718042561188808728053600445110972992438469967649056256589175739478272363214764480549487083235779588504538469805052660174224984711215950503095920589943783308241737365123329897745808282472351927870398484175556134059702516479014529101233832019814273876515569307294857432779445820767]
'''</span></code></pre>
<p><img src="https://img-blog.csdnimg.cn/20210807103613465.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NTU1Njc4NzQ0,size_16,color_FFFFFF,t_70" alt="img"></p>
<p>根据论文中三个e的情况更改M矩阵及D矩阵</p>
<p>另外还需要更改a的值，a的值等于e的位数加一（即811），除以p*q的位数加一（即2049），保留三位小数。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert
c <span class="token operator">=</span> <span class="token number">8836441252076834545813477411326425375032267123570785772864736522363289546687708899074336247215937510570504358003107825056501941030269383864118843746175337393654312850577439133664730484837119573532202639084658757820201188879766516909534973535998857651937119461057973385426395724145776918292561702292436605761423965907449269350234768599086801097764871812636671292354213601605096195311151373515090830120096932678276497558133279308072396732663178152322425868305886057431421961733257631788613513220162555655889179523511665784230205568552674460999865994501813783725694862606623394523003050895631252334230583883118073253764</span>
e2 <span class="token operator">=</span> <span class="token number">1369139766594499502102339802022151306473260303306443944809840701670612636871224554225002168944819225437998598365160666841985968029088084698853903787370193867870645734160453072726844381549153136514381609762281206178008136789238144315497475817194151194572296755949819068715206908967557531534965163142405984337962331584669073736885280026972797963267782773986730500382181318371495017118704093918920704345311527651399811381295059334575066198160251659075954912595362620180554775651196811925899974337478484410958141839806933182849189323190130942495340593301630517690327831594714373018323154749642065080783334651101242699263</span>
e1 <span class="token operator">=</span> <span class="token number">6394785330485131407826851764944106702989306751661773111300134919431104584180613989558300377714349529400378558913602158291081082675430487235339914971012067566601890029839947493155254582899628788537164340404428811085870041808860483801729245083548201334366733631432145384161908034867977906516995215397817811827060338562939218932916441868066261899714398094644048582309184012571138467837154157300425982546397721016585389530109123133328761496692431696333697620772147165360784490956672563278919171793966890158893934190837756790824904679773847777676326932643265426451922272758626857050445979305022351126666958426400079653623</span>
e3 <span class="token operator">=</span> <span class="token number">5437175210613834481955163777766627983523303337501300230689357572042873091664083970990501546609837607847693632622863075171175573210124960851439677015543351005393752316875323874628271392021624688370950188978195558312943877934365491687668809500866579503310026982199641168879029765994054311638922866950503743682009008734748720854732986500921718042561188808728053600445110972992438469967649056256589175739478272363214764480549487083235779588504538469805052660174224984711215950503095920589943783308241737365123329897745808282472351927870398484175556134059702516479014529101233832019814273876515569307294857432779445820767</span>
N <span class="token operator">=</span> <span class="token number">13441675621853397537941552930565086940390470130815380172405483101963424807980457970171725987335576421109600777181124732686757429091494072838586546464238360449989289020069386272380414809945684476174566989775147057082001644921451704981593847572798324632557836313044339427816944052099264108168157879645492166128090320214880302941951710697142064976112121583858774576042442313128499340606412845822519283515566759147621860641682899507428800319575392348478145779271935852461866317025429591494415486087527357696348049367246280018948490128455131326723173717164420547870649041609012209503120621766999344338619628361309881504449</span>
a <span class="token operator">=</span> <span class="token number">0.396</span><span class="token comment">#811/2049</span>
M1<span class="token operator">=</span>N<span class="token operator">**</span><span class="token number">0.5</span>
M2<span class="token operator">=</span> N<span class="token operator">**</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1.5</span><span class="token punctuation">)</span>
M3<span class="token operator">=</span>N<span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>a<span class="token punctuation">)</span>
D <span class="token operator">=</span> diagonal_matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token punctuation">[</span>N<span class="token operator">**</span><span class="token number">1.5</span><span class="token punctuation">,</span>N<span class="token punctuation">,</span>M2<span class="token punctuation">,</span>M1<span class="token punctuation">,</span>M2<span class="token punctuation">,</span>M3<span class="token punctuation">,</span>M3<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
M<span class="token operator">=</span>matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>N<span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>N<span class="token punctuation">,</span>e1<span class="token operator">*</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token punctuation">,</span><span class="token operator">-</span>e2<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token operator">*</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>e2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e2<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e2<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e2<span class="token operator">*</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e3<span class="token punctuation">,</span><span class="token operator">-</span>e3<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token operator">-</span>e3<span class="token operator">*</span>N<span class="token punctuation">,</span>e3<span class="token operator">*</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>e3<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e3<span class="token operator">*</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token operator">*</span>e3<span class="token punctuation">,</span><span class="token operator">-</span>e2<span class="token operator">*</span>e3<span class="token operator">*</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>e2<span class="token operator">*</span>e3<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>D
L<span class="token operator">=</span>M<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>
t<span class="token operator">=</span>vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
x<span class="token operator">=</span>t<span class="token operator">*</span>M<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
phi <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>e1<span class="token punctuation">)</span>
d <span class="token operator">=</span> invert<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span>
m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N<span class="token punctuation">)</span>
<span class="token keyword">print</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre>


<h2 id="山东省赛"><a href="#山东省赛" class="headerlink" title="山东省赛"></a>山东省赛</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
<span class="token keyword">import</span> random
<span class="token keyword">import</span> string
<span class="token keyword">import</span> binascii
<span class="token keyword">import</span> os
<span class="token keyword">from</span> secret <span class="token keyword">import</span> key<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> flag



<span class="token keyword">def</span> <span class="token function">proof_of_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">pass</span>


<span class="token keyword">if</span> proof_of_work<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    exit<span class="token punctuation">(</span><span class="token string">"Exit..."</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pad_length <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span>
    <span class="token keyword">return</span> m <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> pad_length


<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>
    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
    <span class="token keyword">return</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>


choice <span class="token operator">=</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Guess the secret!\n1.return enc(pad(m + secret))\n2.check the secret'</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        choice <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Give me your choice: '</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>
            m <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Give me your input (in hex): '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">(</span>pad<span class="token punctuation">(</span>m <span class="token operator">+</span> secret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span>
            ss <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Give me your secret: '</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>ss<span class="token punctuation">)</span> <span class="token operator">==</span> secret<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'here is your flag'</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!'</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!'</span><span class="token punctuation">)</span>

</code></pre>


<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token comment"># -*- coding:utf-8 -*-</span>
<span class="token comment"># author:nothing</span>

<span class="token keyword">import</span> string<span class="token punctuation">,</span> re<span class="token punctuation">,</span> random
<span class="token keyword">import</span> os 
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256
<span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify<span class="token punctuation">,</span> hexlify
<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"101.34.215.5"</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">passpow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
	msg <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me XXXX:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
	bottom <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"\+(.*?)\)"</span><span class="token punctuation">,</span>msg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	res <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r" == (.*?)\n"</span><span class="token punctuation">,</span>msg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
	<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
	<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
		answer <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		cipher <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token punctuation">(</span>answer <span class="token operator">+</span> bottom<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
		<span class="token keyword">if</span> cipher <span class="token operator">==</span> res<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
			<span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span>
			io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>answer<span class="token punctuation">)</span>
			<span class="token keyword">break</span>

<span class="token keyword">def</span> <span class="token function">solve_step_4</span><span class="token punctuation">(</span>level<span class="token punctuation">,</span> known<span class="token punctuation">)</span><span class="token punctuation">:</span>
	<span class="token keyword">print</span> <span class="token string">"Level %s"</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span>level <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		<span class="token keyword">return</span> known
	records <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
	<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
		io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me your choice: "</span><span class="token punctuation">)</span>
		io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
		io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Give me your input (in hex): "</span><span class="token punctuation">)</span>
		tmpstr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token operator">-</span>level<span class="token punctuation">)</span> <span class="token operator">+</span> known <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>
		io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>tmpstr<span class="token punctuation">)</span>
		io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"encrypted msg: "</span><span class="token punctuation">)</span>
		s <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
		<span class="token keyword">print</span> <span class="token string">"Process: %s/256 %s %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> tmpstr<span class="token punctuation">,</span> s<span class="token punctuation">)</span>
		records<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me your choice: "</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Give me your input (in hex): "</span><span class="token punctuation">)</span>
	tmpstr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token operator">-</span>level<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>tmpstr<span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"encrypted msg: "</span><span class="token punctuation">)</span>
	s <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>
	newknown <span class="token operator">=</span> known <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span> <span class="token string">"==========================="</span>
	<span class="token keyword">print</span> newknown<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span> <span class="token string">"==========================="</span>
	<span class="token keyword">return</span> solve_step_4<span class="token punctuation">(</span>level<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> newknown<span class="token punctuation">)</span>



<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
	passpow<span class="token punctuation">(</span><span class="token punctuation">)</span>
	secret <span class="token operator">=</span> solve_step_4<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me your choice: "</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Give me your secret: "</span><span class="token punctuation">)</span>
	io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>hexlify<span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">)</span>
	flag <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>
	<span class="token keyword">print</span> flag
</code></pre>


<h2 id="西南石油招新赛"><a href="#西南石油招新赛" class="headerlink" title="西南石油招新赛"></a>西南石油招新赛</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>



flag  <span class="token operator">=</span> <span class="token string">'****************************'</span>
flag <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"asfajgfbiagbwe"</span><span class="token punctuation">&#125;</span>
p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

e1e2 <span class="token operator">=</span> <span class="token number">3087</span>
n <span class="token operator">=</span> p<span class="token operator">*</span>q
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

flag1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e1<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e2<span class="token punctuation">,</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag1= '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag2= '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n= '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

c1 <span class="token operator">=</span> <span class="token number">463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span>
c2 <span class="token operator">=</span> <span class="token number">130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span>
n <span class="token operator">=</span> <span class="token number">609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span>


<span class="token keyword">def</span> <span class="token function">rsa_gong_N_def</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>e1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>
    s <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>
    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1
        c1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>
        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2
        c2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n
    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">de</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    k <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> k <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">:</span>
        mm <span class="token operator">=</span> c <span class="token operator">+</span> n <span class="token operator">*</span> k
        result<span class="token punctuation">,</span> flag <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> e<span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token boolean">True</span> <span class="token operator">==</span> flag<span class="token punctuation">:</span>
            <span class="token keyword">return</span> result
        k <span class="token operator">+=</span> <span class="token number">1</span>


<span class="token keyword">for</span> e1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> e1e2<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> e1e2 <span class="token operator">%</span> e1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        e2 <span class="token operator">=</span> e1e2 <span class="token operator">//</span> e1
        c <span class="token operator">=</span> rsa_gong_N_def<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        e <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>
        m1 <span class="token operator">=</span> de<span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
        <span class="token keyword">if</span> m1<span class="token punctuation">:</span>
            flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token string">b"NSSCTF"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>
                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
                <span class="token keyword">break</span></code></pre>
<h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

flag <span class="token operator">=</span> <span class="token string">'******************'</span>

p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>
m1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

n <span class="token operator">=</span> p <span class="token operator">*</span> q

flag1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> p<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
flag2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> q<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag1= '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag2= '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n= '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>

flag1 <span class="token operator">=</span> <span class="token number">17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span>
flag2 <span class="token operator">=</span> <span class="token number">95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span>
n <span class="token operator">=</span> <span class="token number">140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span>
</code></pre>
<p>Coppersmith定理：在一个e阶的mod n多项式f(x)中，如果有一个根小于$ n^{\frac{1}{e}} $，就可以运用一个O(log n)的算法求出这些根<br>$$<br>c_{1} = m ^ {p} \bmod n = m ^{p} \bmod p * q<br>$$</p>
<p>$$<br>c_{2} = m ^ {q} \bmod n = m ^{q} \bmod p * q<br>$$</p>
<p>费马定理：<br>$$<br>m ^ {p} \equiv m \bmod p<br>$$</p>
<p>$$<br>m ^ {q} \equiv m \bmod q<br>$$</p>
<p>所以：<br>$$<br>c_{1} = m + ip + xpq = m + ip<br>$$</p>
<p>$$<br>c_{2} = m + jq + ypq = m + jq<br>$$</p>
<p>因此：<br>$$<br>c_{1} * c_{2} = m ^ {2} + (ip + iq)m + ijn<br>$$</p>
<p>$$<br>(c_{1} + c_{2})m = 2m^{2}+(ip+jq)m<br>$$</p>
<p>有：<br>$$<br>m^{2}-(c_{1}+c_{2})m+c1*c2=ijn\equiv0\bmod n<br>$$</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>
n<span class="token operator">=</span><span class="token number">140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span>
c1<span class="token operator">=</span><span class="token number">17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span>
c2<span class="token operator">=</span><span class="token number">95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span>
PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>m<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>
f <span class="token operator">=</span> m<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span><span class="token punctuation">(</span>c1<span class="token operator">+</span>c2<span class="token punctuation">)</span><span class="token operator">*</span>m<span class="token operator">+</span>c1<span class="token operator">*</span>c2
x0 <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token number">400</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span></code></pre>
<h2 id="楚慧杯"><a href="#楚慧杯" class="headerlink" title="楚慧杯"></a>楚慧杯</h2><h3 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy-RSA"></a>Easy-RSA</h3><p>n：27552304606229034903366058815849954030287648695063385362955432137790872571412035824128918674719247737295565001575991597519270789776408208970323808016733976338433371328100880898942106515627607388226912870981180215883273805491209461671730377099185278711453949265641966582563910708529619185885928310168288810488784242368160743359666583499117949407921812317700250240067929572558785431071173411100434109661677786734923283679392823901052633992456780285091988542875991410528415886437666510014123352497264017734716859350294159440761760921548702546470902740121962033241003215821780125194400741190925169397917247376657863011603<br>e：65537<br>c：8643831704675414121804983915084443744489969712473300784256427784417167322852556975560503484179280700293119974607254037642425650493676448134024809335297135239994950178868535219541095694358323044214971760829173918774094415933808417722001811285178546917655837402000771685507972240389565704149610032767242977174132826100177368764169367458684152505611469248099487912367364804360878611296860803835816266114046682291529593099394952245852157119233687981777202751472502060481232341206366584532964027749320641690448228420342308891797513656897566100268729012788419021059054907653832828437666012596894150751431936476816983845357<br>p-q：3216514606297172806828066063738105740383963382396892688569683235383985567043193404185955880509592930874764682428425994713750665248099953457550673860782324431970917492727256948066013701406000049963109681898567026552657377599263519201715733179565306750754520746601394738797021362510415215113118083969304423858</p>
<p>sympy解方程一把梭</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> Symbol<span class="token punctuation">,</span> solve
<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>

n <span class="token operator">=</span> <span class="token number">27552304606229034903366058815849954030287648695063385362955432137790872571412035824128918674719247737295565001575991597519270789776408208970323808016733976338433371328100880898942106515627607388226912870981180215883273805491209461671730377099185278711453949265641966582563910708529619185885928310168288810488784242368160743359666583499117949407921812317700250240067929572558785431071173411100434109661677786734923283679392823901052633992456780285091988542875991410528415886437666510014123352497264017734716859350294159440761760921548702546470902740121962033241003215821780125194400741190925169397917247376657863011603</span>
e <span class="token operator">=</span> <span class="token number">65537</span>
c <span class="token operator">=</span> <span class="token number">8643831704675414121804983915084443744489969712473300784256427784417167322852556975560503484179280700293119974607254037642425650493676448134024809335297135239994950178868535219541095694358323044214971760829173918774094415933808417722001811285178546917655837402000771685507972240389565704149610032767242977174132826100177368764169367458684152505611469248099487912367364804360878611296860803835816266114046682291529593099394952245852157119233687981777202751472502060481232341206366584532964027749320641690448228420342308891797513656897566100268729012788419021059054907653832828437666012596894150751431936476816983845357</span>
s <span class="token operator">=</span>  <span class="token number">3216514606297172806828066063738105740383963382396892688569683235383985567043193404185955880509592930874764682428425994713750665248099953457550673860782324431970917492727256948066013701406000049963109681898567026552657377599263519201715733179565306750754520746601394738797021362510415215113118083969304423858</span>
<span class="token comment"># p = Symbol('p')</span>
<span class="token comment"># q = Symbol('q')</span>
<span class="token comment"># p, q = solve([p*q-n, p-q-s], [p,q])</span>
<span class="token comment"># print(p,q)</span>
p <span class="token operator">=</span> <span class="token number">167604917202624171205562332547086795459018271995531662202392816766661852499967774267554085060619750182533064588995245441659492248123164548905239665224600839192261379211031757557080502863539123811164713057605073461933854926502162793803096063035806777877263036653498763650955936640215477205393488552237210705691</span>
q <span class="token operator">=</span> <span class="token number">164388402596326998398734266483348689718634308613134769513823133531277866932924580863368129180110157251658299906566819446945741582875064595447688991363818514760290461718304500609014489162133123761201603375706506435381197548902899274601380329856241471126508515906897368912158915277705061990280370468267906281833</span>
d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># b'flag&#123;9c0532a253809f180747b6da334b438f&#125;'</span></code></pre>
<h3 id="EasyRandom"><a href="#EasyRandom" class="headerlink" title="EasyRandom"></a>EasyRandom</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> getrandbits
<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom
<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256

flag<span class="token operator">=</span>flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
flag<span class="token operator">=</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"hex"</span><span class="token punctuation">)</span>
<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">48</span>

<span class="token keyword">def</span> <span class="token function">affine</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

randList<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    tmp<span class="token operator">=</span>getrandbits<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>
    randList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>
<span class="token keyword">print</span> randList

n1<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">^</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>
tmp<span class="token operator">=</span>urandom<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
n2<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> sha256<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>
n3<span class="token operator">=</span><span class="token string">""</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
    n3<span class="token operator">+=</span>affine<span class="token punctuation">(</span>i<span class="token punctuation">)</span>
n3<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>n3<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>
res<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n1<span class="token operator">&lt;&lt;</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>n2<span class="token operator">&lt;&lt;</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">+</span>n3<span class="token punctuation">)</span><span class="token operator">^</span>getrandbits<span class="token punctuation">(</span><span class="token number">192</span><span class="token punctuation">)</span>
<span class="token keyword">print</span> res


<span class="token comment"># randList=[3693014292L, 1999090277L, 2812362804L, 2118249952L, 885988212L, 1131999143L, 3327925205L, 731275596L, 1818780432L, 644434032L, 3301077903L, 1004325730L, 113617890L, 262927352L, 1449581419L, 1596910105L, 3680959953L, 4039323321L, 2422810127L, 946521915L, 4049336142L, 1299247828L, 3361233447L, 1319347681L, 2858084207L, 2493466845L, 522894151L, 3272590535L, 2518746559L, 113976089L, 1912521614L, 1971657011L, 4052443472L, 1928327357L, 1481517158L, 1707968618L, 3946904293L, 3941277234L, 1740669853L, 177473759L, 2855945159L, 3217808064L, 568887441L, 2243547768L, 533475147L, 4005163087L, 1991762580L, 1175403787L, 1819485104L, 4162426193L, 2480060730L, 1889558541L, 1659122908L, 2343813603L, 1792751594L, 3287109162L, 4119020356L, 2086904766L, 4227102603L, 4251617926L, 386544361L, 2024596798L, 3275172220L, 1652143183L, 4279693598L, 1741714555L, 3920640884L, 837190820L, 4242688797L, 3406136725L, 272163458L, 1933729342L, 3348914742L, 3483202044L, 313505665L, 3180958891L, 276638359L, 2247257889L, 1283002827L, 253470155L, 2172073971L, 3333335918L, 321125332L, 3478202657L, 1298557332L, 1255183068L, 2347216752L, 1823003608L, 1873938039L, 4172493668L, 1252876713L, 2877329304L, 2733470437L, 743814046L, 1482554102L, 3967801003L, 4135521914L, 1601509876L, 1370623470L, 564556001L, 3369378190L, 1930652933L, 2684027015L, 730072119L, 3133537560L, 554522157L, 4200260396L, 66286223L, 2856462351L, 3409097597L, 1123352314L, 3112249875L, 660537433L, 1027164908L, 2875953843L, 3419766147L, 64818752L, 1572659846L, 176068922L, 2155262681L, 3154282688L, 3215591301L, 923444143L, 54743986L, 3011602372L, 1936525684L, 2636863705L, 3228231549L, 3660514246L, 2503374986L, 1180875896L, 941948277L, 1922552596L, 740696852L, 2337729160L, 1636823570L, 1788245610L, 2970204367L, 1597424641L, 3940594526L, 846332502L, 3177694219L, 1253960959L, 1980517147L, 2066843131L, 3452017677L, 743662084L, 3332614739L, 1230416894L, 1790783329L, 3339256849L, 1223003548L, 3155010716L, 211801309L, 3302823875L, 2203405123L, 4027118331L, 3928670766L, 1551556760L, 2018355543L, 2473765725L, 2451139992L, 3923372144L, 2197282188L, 2056399604L, 1294675076L, 1121984516L, 113881691L, 1646921221L, 3151728031L, 695534775L, 3870352246L, 1614457851L, 1764207471L, 3516853329L, 3276173646L, 3559299512L, 1239291648L, 2417317314L, 908861203L, 3945977517L, 1789725976L, 1094256533L, 1194981603L, 3817224425L, 4294621339L, 3041360046L, 1319794040L, 1881403289L, 151945988L, 3036988698L, 2214811128L, 240957157L, 509921068L, 1538884056L, 119208760L, 1425862614L, 2923918837L, 845827337L, 507023267L, 2955299274L, 1247972138L, 766611587L, 2012831811L, 3441161631L, 2645633381L, 2328705244L, 512481283L, 461960350L, 1704754200L, 1327914555L, 147555684L, 3349647800L, 3062151439L, 3090502250L, 937966533L, 82567652L, 725403325L, 4001427888L, 524069543L, 2291211027L, 2084465414L, 1292961088L, 4278389999L, 1309916992L, 3249380344L, 3493113838L, 83526738L, 4193860366L, 2438456426L, 3510215857L, 175761668L, 2820499306L, 1792194251L, 1225332544L, 3896268058L, 2752286952L, 3182785082L, 956435024L, 3996152048L, 2924148655L, 2895936126L, 1856977607L, 1289267397L, 690722358L, 1937429718L, 1531967867L, 2098208046L, 1815108525L, 1567735201L, 146084074L, 2093897143L, 2793246617L, 1146380003L, 2523936201L, 2301399576L, 2052473947L, 3470101770L, 3722302451L, 3345343326L, 2271545308L, 2657475692L, 2211989611L, 2428885922L, 2097052181L, 3554955904L, 1704837589L, 1494941216L, 3403108634L, 911409695L, 3550042769L, 379101531L, 406655201L, 1317011271L, 2336674904L, 3930303124L, 3038552846L, 3207659329L, 2785076651L, 1203119790L, 1146774748L, 2218279443L, 494710315L, 3507507044L, 922439915L, 35699688L, 2690622469L, 1458912003L, 3911367650L, 983115567L, 2813252332L, 839947939L, 514499603L, 3894529528L, 326817358L, 1479783722L, 4242051909L, 3492972915L, 3473946915L, 3348053727L, 3681386488L, 584266203L, 3531080708L, 3262223061L, 2904040234L, 3897643811L, 2706405422L, 914107260L, 3011659451L, 308811435L, 4103121550L, 4023430755L, 2975129044L, 4139500620L, 1763891748L, 57665971L, 3149249501L, 870034516L, 4142837134L, 3130156432L, 1708266697L, 1242161643L, 1163332264L, 108174709L, 1633896347L, 2820171620L, 1708875131L, 724124719L, 3562786877L, 518616285L, 3643662732L, 3375737681L, 2550728441L, 1823319080L, 1775922455L, 3838709569L, 177763087L, 946611206L, 4054832304L, 1473954380L, 3475817789L, 2590152780L, 3587873907L, 3437231816L, 2708036272L, 3883447173L, 655291275L, 707049339L, 1352718730L, 3543000675L, 962283943L, 4170075509L, 1897499376L, 643615933L, 856277089L, 3299581344L, 4093601146L, 2638625975L, 1563647962L, 890552183L, 3138216177L, 222946344L, 4219020514L, 3218803481L, 3093722090L, 1210144957L, 3499543439L, 4239553976L, 3582176749L, 654186756L, 3005601303L, 1252241368L, 2459425960L, 3587113096L, 3506651695L, 3673557784L, 4157576483L, 733173716L, 1505997631L, 394626148L, 1322270695L, 84604461L, 891267254L, 518241635L, 1068682198L, 3696554893L, 3111393676L, 1398539042L, 901276151L, 483471144L, 1952219546L, 2884270239L, 2215979688L, 4138748504L, 1623101775L, 3102260771L, 4276348310L, 1228132323L, 2250922664L, 833982365L, 3402246096L, 2085678412L, 2707953187L, 590837194L, 3421635592L, 3488064851L, 3655525766L, 1029679348L, 2448841196L, 89284911L, 3970560858L, 334986490L, 3063032848L, 3172506167L, 2391313449L, 3589023591L, 4269870234L, 3275101066L, 1716650872L, 483502324L, 2116979028L, 815078501L, 3475316209L, 1003463022L, 2418993968L, 4251101825L, 346290993L, 3286645593L, 2654742976L, 99974317L, 4124695845L, 3732280507L, 1536249568L, 1440486445L, 1605422491L, 393607563L, 1141210694L, 43848150L, 1656624711L, 2170355702L, 327988021L, 974870171L, 2169013815L, 3689546490L, 3576028106L, 4258679518L, 14944446L, 1786133397L, 264814384L, 1969519378L, 1769400868L, 3098042628L, 22547518L, 3195136230L, 42683806L, 1288550835L, 59638233L, 3534385409L, 2517101496L, 3632913591L, 3894777481L, 2912655780L, 1614602217L, 3498478791L, 1309795895L, 3961554801L, 3625321205L, 308138165L, 2885107341L, 1003378866L, 3462951062L, 1914176024L, 3130918711L, 3919345882L, 3556964414L, 2382442356L, 3968605965L, 2388890395L, 1955471760L, 2358533573L, 2323037969L, 4273118548L, 3577096972L, 4251790958L, 2321545863L, 2057106840L, 4000766037L, 1551111470L, 368761666L, 951769999L, 778229999L, 4235748487L, 2020142699L, 3577752281L, 1269488993L, 1350156870L, 529843408L, 669182431L, 3871401874L, 2180265713L, 3850183472L, 46915226L, 3150800412L, 1139932212L, 2523557119L, 1462042012L, 301258444L, 165757583L, 530704729L, 1848179734L, 1792342751L, 2597916820L, 4041946457L, 1127104524L, 3768573884L, 2614008065L, 741308521L, 477746986L, 507411825L, 4235293189L, 2251811519L, 811234592L, 1985999307L, 844715613L, 1640781314L, 3538036580L, 2764130557L, 2863454433L, 1831736583L, 3857379783L, 658928449L, 1149649578L, 103125751L, 2968446555L, 885660863L, 707321834L, 1728646363L, 2706995220L, 3062604255L, 4177710084L, 3076079677L, 879366858L, 3936728615L, 8828906L, 1656874220L, 2904085639L, 397694272L, 1604508691L, 2083663236L, 2138468690L, 1365350684L, 2870684769L, 384435793L, 1063724290L, 1142482048L, 809857977L, 4192515435L, 267878653L, 206018017L, 3441769173L, 925696591L, 2250932557L, 1973183700L, 577661907L, 2551314381L, 1350352597L, 4151551172L, 774849773L, 2391866106L, 3444137245L, 403261487L, 2724363448L, 3572536490L, 1077243504L, 302416473L, 3457548858L, 564604707L, 1238169871L, 2356838464L, 3083335214L, 3844937218L, 1272458074L, 1782962159L, 1543604321L, 3212537899L, 426074894L, 3053843067L, 2436223151L, 94019340L, 4147659323L, 2893920832L, 626619793L, 3976626567L, 1884877146L, 2696384440L, 1177352315L, 1082374195L, 3289271804L, 1485815836L, 120127000L, 3349349501L, 164243314L, 1703351326L, 1017276501L, 413737931L, 408060344L, 472141408L, 172738862L, 4001606849L, 1888805432L, 2927218529L, 1293362241L, 1941759619L, 1760659398L, 274865852L, 978985751L, 3867215904L, 177291528L, 1083045308L, 3888975618L, 979933689L, 2211634008L, 3899294132L, 1174569575L]</span>
<span class="token comment"># Hash='b0cfb7293d6842e3279f4ef0fc88284174349e111e5b9beb28263df72c9db0bf'</span>
<span class="token comment"># res=1045726758250168034320246515934682860724576730763168865120</span></code></pre>
<p>先用MT19937伪随机数预测出两个异或的数。因为tmp是urandom(3)，还给了sha256的结果，所以可以通过爆破得到tmp的值。异或之后得到(n1&lt;&lt;64)+(n2&lt;&lt;40)+n3的值，又根据位数可知正好错开了。取二进制的低40位为n3，爆破一下仿射密码得到flag16进制的最后十位。取中间一段为n2，和tmp异或一下得到flag16进制的中间6位。取前面一段异或一下得到flag16进制的前32位。把三部分拼起来再n2s得到最后的flag。</p>
<pre class="language-python" data-language="python"><code class="language-python">randist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3693014292</span><span class="token punctuation">,</span> <span class="token number">1999090277</span><span class="token punctuation">,</span> <span class="token number">2812362804</span><span class="token punctuation">,</span> <span class="token number">2118249952</span><span class="token punctuation">,</span> <span class="token number">885988212</span><span class="token punctuation">,</span> <span class="token number">1131999143</span><span class="token punctuation">,</span> <span class="token number">3327925205</span><span class="token punctuation">,</span> <span class="token number">731275596</span><span class="token punctuation">,</span> <span class="token number">1818780432</span><span class="token punctuation">,</span> <span class="token number">644434032</span><span class="token punctuation">,</span> <span class="token number">3301077903</span><span class="token punctuation">,</span> <span class="token number">1004325730</span><span class="token punctuation">,</span> <span class="token number">113617890</span><span class="token punctuation">,</span> <span class="token number">262927352</span><span class="token punctuation">,</span> <span class="token number">1449581419</span><span class="token punctuation">,</span> <span class="token number">1596910105</span><span class="token punctuation">,</span> <span class="token number">3680959953</span><span class="token punctuation">,</span> <span class="token number">4039323321</span><span class="token punctuation">,</span> <span class="token number">2422810127</span><span class="token punctuation">,</span> <span class="token number">946521915</span><span class="token punctuation">,</span> <span class="token number">4049336142</span><span class="token punctuation">,</span> <span class="token number">1299247828</span><span class="token punctuation">,</span> <span class="token number">3361233447</span><span class="token punctuation">,</span> <span class="token number">1319347681</span><span class="token punctuation">,</span> <span class="token number">2858084207</span><span class="token punctuation">,</span> <span class="token number">2493466845</span><span class="token punctuation">,</span> <span class="token number">522894151</span><span class="token punctuation">,</span> <span class="token number">3272590535</span><span class="token punctuation">,</span> <span class="token number">2518746559</span><span class="token punctuation">,</span> <span class="token number">113976089</span><span class="token punctuation">,</span> <span class="token number">1912521614</span><span class="token punctuation">,</span> <span class="token number">1971657011</span><span class="token punctuation">,</span> <span class="token number">4052443472</span><span class="token punctuation">,</span> <span class="token number">1928327357</span><span class="token punctuation">,</span> <span class="token number">1481517158</span><span class="token punctuation">,</span> <span class="token number">1707968618</span><span class="token punctuation">,</span> <span class="token number">3946904293</span><span class="token punctuation">,</span> <span class="token number">3941277234</span><span class="token punctuation">,</span> <span class="token number">1740669853</span><span class="token punctuation">,</span> <span class="token number">177473759</span><span class="token punctuation">,</span> <span class="token number">2855945159</span><span class="token punctuation">,</span> <span class="token number">3217808064</span><span class="token punctuation">,</span> <span class="token number">568887441</span><span class="token punctuation">,</span> <span class="token number">2243547768</span><span class="token punctuation">,</span> <span class="token number">533475147</span><span class="token punctuation">,</span> <span class="token number">4005163087</span><span class="token punctuation">,</span> <span class="token number">1991762580</span><span class="token punctuation">,</span> <span class="token number">1175403787</span><span class="token punctuation">,</span> <span class="token number">1819485104</span><span class="token punctuation">,</span> <span class="token number">4162426193</span><span class="token punctuation">,</span> <span class="token number">2480060730</span><span class="token punctuation">,</span> <span class="token number">1889558541</span><span class="token punctuation">,</span> <span class="token number">1659122908</span><span class="token punctuation">,</span> <span class="token number">2343813603</span><span class="token punctuation">,</span> <span class="token number">1792751594</span><span class="token punctuation">,</span> <span class="token number">3287109162</span><span class="token punctuation">,</span> <span class="token number">4119020356</span><span class="token punctuation">,</span> <span class="token number">2086904766</span><span class="token punctuation">,</span> <span class="token number">4227102603</span><span class="token punctuation">,</span> <span class="token number">4251617926</span><span class="token punctuation">,</span> <span class="token number">386544361</span><span class="token punctuation">,</span> <span class="token number">2024596798</span><span class="token punctuation">,</span> <span class="token number">3275172220</span><span class="token punctuation">,</span> <span class="token number">1652143183</span><span class="token punctuation">,</span> <span class="token number">4279693598</span><span class="token punctuation">,</span> <span class="token number">1741714555</span><span class="token punctuation">,</span> <span class="token number">3920640884</span><span class="token punctuation">,</span> <span class="token number">837190820</span><span class="token punctuation">,</span> <span class="token number">4242688797</span><span class="token punctuation">,</span> <span class="token number">3406136725</span><span class="token punctuation">,</span> <span class="token number">272163458</span><span class="token punctuation">,</span> <span class="token number">1933729342</span><span class="token punctuation">,</span> <span class="token number">3348914742</span><span class="token punctuation">,</span> <span class="token number">3483202044</span><span class="token punctuation">,</span> <span class="token number">313505665</span><span class="token punctuation">,</span> <span class="token number">3180958891</span><span class="token punctuation">,</span> <span class="token number">276638359</span><span class="token punctuation">,</span> <span class="token number">2247257889</span><span class="token punctuation">,</span> <span class="token number">1283002827</span><span class="token punctuation">,</span> <span class="token number">253470155</span><span class="token punctuation">,</span> <span class="token number">2172073971</span><span class="token punctuation">,</span> <span class="token number">3333335918</span><span class="token punctuation">,</span> <span class="token number">321125332</span><span class="token punctuation">,</span> <span class="token number">3478202657</span><span class="token punctuation">,</span> <span class="token number">1298557332</span><span class="token punctuation">,</span> <span class="token number">1255183068</span><span class="token punctuation">,</span> <span class="token number">2347216752</span><span class="token punctuation">,</span> <span class="token number">1823003608</span><span class="token punctuation">,</span> <span class="token number">1873938039</span><span class="token punctuation">,</span> <span class="token number">4172493668</span><span class="token punctuation">,</span> <span class="token number">1252876713</span><span class="token punctuation">,</span> <span class="token number">2877329304</span><span class="token punctuation">,</span> <span class="token number">2733470437</span><span class="token punctuation">,</span> <span class="token number">743814046</span><span class="token punctuation">,</span> <span class="token number">1482554102</span><span class="token punctuation">,</span> <span class="token number">3967801003</span><span class="token punctuation">,</span> <span class="token number">4135521914</span><span class="token punctuation">,</span> <span class="token number">1601509876</span><span class="token punctuation">,</span> <span class="token number">1370623470</span><span class="token punctuation">,</span> <span class="token number">564556001</span><span class="token punctuation">,</span> <span class="token number">3369378190</span><span class="token punctuation">,</span> <span class="token number">1930652933</span><span class="token punctuation">,</span> <span class="token number">2684027015</span><span class="token punctuation">,</span> <span class="token number">730072119</span><span class="token punctuation">,</span> <span class="token number">3133537560</span><span class="token punctuation">,</span> <span class="token number">554522157</span><span class="token punctuation">,</span> <span class="token number">4200260396</span><span class="token punctuation">,</span> <span class="token number">66286223</span><span class="token punctuation">,</span> <span class="token number">2856462351</span><span class="token punctuation">,</span> <span class="token number">3409097597</span><span class="token punctuation">,</span> <span class="token number">1123352314</span><span class="token punctuation">,</span> <span class="token number">3112249875</span><span class="token punctuation">,</span> <span class="token number">660537433</span><span class="token punctuation">,</span> <span class="token number">1027164908</span><span class="token punctuation">,</span> <span class="token number">2875953843</span><span class="token punctuation">,</span> <span class="token number">3419766147</span><span class="token punctuation">,</span> <span class="token number">64818752</span><span class="token punctuation">,</span> <span class="token number">1572659846</span><span class="token punctuation">,</span> <span class="token number">176068922</span><span class="token punctuation">,</span> <span class="token number">2155262681</span><span class="token punctuation">,</span> <span class="token number">3154282688</span><span class="token punctuation">,</span> <span class="token number">3215591301</span><span class="token punctuation">,</span> <span class="token number">923444143</span><span class="token punctuation">,</span> <span class="token number">54743986</span><span class="token punctuation">,</span> <span class="token number">3011602372</span><span class="token punctuation">,</span> <span class="token number">1936525684</span><span class="token punctuation">,</span> <span class="token number">2636863705</span><span class="token punctuation">,</span> <span class="token number">3228231549</span><span class="token punctuation">,</span> <span class="token number">3660514246</span><span class="token punctuation">,</span> <span class="token number">2503374986</span><span class="token punctuation">,</span> <span class="token number">1180875896</span><span class="token punctuation">,</span> <span class="token number">941948277</span><span class="token punctuation">,</span> <span class="token number">1922552596</span><span class="token punctuation">,</span> <span class="token number">740696852</span><span class="token punctuation">,</span> <span class="token number">2337729160</span><span class="token punctuation">,</span> <span class="token number">1636823570</span><span class="token punctuation">,</span> <span class="token number">1788245610</span><span class="token punctuation">,</span> <span class="token number">2970204367</span><span class="token punctuation">,</span> <span class="token number">1597424641</span><span class="token punctuation">,</span> <span class="token number">3940594526</span><span class="token punctuation">,</span> <span class="token number">846332502</span><span class="token punctuation">,</span> <span class="token number">3177694219</span><span class="token punctuation">,</span> <span class="token number">1253960959</span><span class="token punctuation">,</span> <span class="token number">1980517147</span><span class="token punctuation">,</span> <span class="token number">2066843131</span><span class="token punctuation">,</span> <span class="token number">3452017677</span><span class="token punctuation">,</span> <span class="token number">743662084</span><span class="token punctuation">,</span> <span class="token number">3332614739</span><span class="token punctuation">,</span> <span class="token number">1230416894</span><span class="token punctuation">,</span> <span class="token number">1790783329</span><span class="token punctuation">,</span> <span class="token number">3339256849</span><span class="token punctuation">,</span> <span class="token number">1223003548</span><span class="token punctuation">,</span> <span class="token number">3155010716</span><span class="token punctuation">,</span> <span class="token number">211801309</span><span class="token punctuation">,</span> <span class="token number">3302823875</span><span class="token punctuation">,</span> <span class="token number">2203405123</span><span class="token punctuation">,</span> <span class="token number">4027118331</span><span class="token punctuation">,</span> <span class="token number">3928670766</span><span class="token punctuation">,</span> <span class="token number">1551556760</span><span class="token punctuation">,</span> <span class="token number">2018355543</span><span class="token punctuation">,</span> <span class="token number">2473765725</span><span class="token punctuation">,</span> <span class="token number">2451139992</span><span class="token punctuation">,</span> <span class="token number">3923372144</span><span class="token punctuation">,</span> <span class="token number">2197282188</span><span class="token punctuation">,</span> <span class="token number">2056399604</span><span class="token punctuation">,</span> <span class="token number">1294675076</span><span class="token punctuation">,</span> <span class="token number">1121984516</span><span class="token punctuation">,</span> <span class="token number">113881691</span><span class="token punctuation">,</span> <span class="token number">1646921221</span><span class="token punctuation">,</span> <span class="token number">3151728031</span><span class="token punctuation">,</span> <span class="token number">695534775</span><span class="token punctuation">,</span> <span class="token number">3870352246</span><span class="token punctuation">,</span> <span class="token number">1614457851</span><span class="token punctuation">,</span> <span class="token number">1764207471</span><span class="token punctuation">,</span> <span class="token number">3516853329</span><span class="token punctuation">,</span> <span class="token number">3276173646</span><span class="token punctuation">,</span> <span class="token number">3559299512</span><span class="token punctuation">,</span> <span class="token number">1239291648</span><span class="token punctuation">,</span> <span class="token number">2417317314</span><span class="token punctuation">,</span> <span class="token number">908861203</span><span class="token punctuation">,</span> <span class="token number">3945977517</span><span class="token punctuation">,</span> <span class="token number">1789725976</span><span class="token punctuation">,</span> <span class="token number">1094256533</span><span class="token punctuation">,</span> <span class="token number">1194981603</span><span class="token punctuation">,</span> <span class="token number">3817224425</span><span class="token punctuation">,</span> <span class="token number">4294621339</span><span class="token punctuation">,</span> <span class="token number">3041360046</span><span class="token punctuation">,</span> <span class="token number">1319794040</span><span class="token punctuation">,</span> <span class="token number">1881403289</span><span class="token punctuation">,</span> <span class="token number">151945988</span><span class="token punctuation">,</span> <span class="token number">3036988698</span><span class="token punctuation">,</span> <span class="token number">2214811128</span><span class="token punctuation">,</span> <span class="token number">240957157</span><span class="token punctuation">,</span> <span class="token number">509921068</span><span class="token punctuation">,</span> <span class="token number">1538884056</span><span class="token punctuation">,</span> <span class="token number">119208760</span><span class="token punctuation">,</span> <span class="token number">1425862614</span><span class="token punctuation">,</span> <span class="token number">2923918837</span><span class="token punctuation">,</span> <span class="token number">845827337</span><span class="token punctuation">,</span> <span class="token number">507023267</span><span class="token punctuation">,</span> <span class="token number">2955299274</span><span class="token punctuation">,</span> <span class="token number">1247972138</span><span class="token punctuation">,</span> <span class="token number">766611587</span><span class="token punctuation">,</span> <span class="token number">2012831811</span><span class="token punctuation">,</span> <span class="token number">3441161631</span><span class="token punctuation">,</span> <span class="token number">2645633381</span><span class="token punctuation">,</span> <span class="token number">2328705244</span><span class="token punctuation">,</span> <span class="token number">512481283</span><span class="token punctuation">,</span> <span class="token number">461960350</span><span class="token punctuation">,</span> <span class="token number">1704754200</span><span class="token punctuation">,</span> <span class="token number">1327914555</span><span class="token punctuation">,</span> <span class="token number">147555684</span><span class="token punctuation">,</span> <span class="token number">3349647800</span><span class="token punctuation">,</span> <span class="token number">3062151439</span><span class="token punctuation">,</span> <span class="token number">3090502250</span><span class="token punctuation">,</span> <span class="token number">937966533</span><span class="token punctuation">,</span> <span class="token number">82567652</span><span class="token punctuation">,</span> <span class="token number">725403325</span><span class="token punctuation">,</span> <span class="token number">4001427888</span><span class="token punctuation">,</span> <span class="token number">524069543</span><span class="token punctuation">,</span> <span class="token number">2291211027</span><span class="token punctuation">,</span> <span class="token number">2084465414</span><span class="token punctuation">,</span> <span class="token number">1292961088</span><span class="token punctuation">,</span> <span class="token number">4278389999</span><span class="token punctuation">,</span> <span class="token number">1309916992</span><span class="token punctuation">,</span> <span class="token number">3249380344</span><span class="token punctuation">,</span> <span class="token number">3493113838</span><span class="token punctuation">,</span> <span class="token number">83526738</span><span class="token punctuation">,</span> <span class="token number">4193860366</span><span class="token punctuation">,</span> <span class="token number">2438456426</span><span class="token punctuation">,</span> <span class="token number">3510215857</span><span class="token punctuation">,</span> <span class="token number">175761668</span><span class="token punctuation">,</span> <span class="token number">2820499306</span><span class="token punctuation">,</span> <span class="token number">1792194251</span><span class="token punctuation">,</span> <span class="token number">1225332544</span><span class="token punctuation">,</span> <span class="token number">3896268058</span><span class="token punctuation">,</span> <span class="token number">2752286952</span><span class="token punctuation">,</span> <span class="token number">3182785082</span><span class="token punctuation">,</span> <span class="token number">956435024</span><span class="token punctuation">,</span> <span class="token number">3996152048</span><span class="token punctuation">,</span> <span class="token number">2924148655</span><span class="token punctuation">,</span> <span class="token number">2895936126</span><span class="token punctuation">,</span> <span class="token number">1856977607</span><span class="token punctuation">,</span> <span class="token number">1289267397</span><span class="token punctuation">,</span> <span class="token number">690722358</span><span class="token punctuation">,</span> <span class="token number">1937429718</span><span class="token punctuation">,</span> <span class="token number">1531967867</span><span class="token punctuation">,</span> <span class="token number">2098208046</span><span class="token punctuation">,</span> <span class="token number">1815108525</span><span class="token punctuation">,</span> <span class="token number">1567735201</span><span class="token punctuation">,</span> <span class="token number">146084074</span><span class="token punctuation">,</span> <span class="token number">2093897143</span><span class="token punctuation">,</span> <span class="token number">2793246617</span><span class="token punctuation">,</span> <span class="token number">1146380003</span><span class="token punctuation">,</span> <span class="token number">2523936201</span><span class="token punctuation">,</span> <span class="token number">2301399576</span><span class="token punctuation">,</span> <span class="token number">2052473947</span><span class="token punctuation">,</span> <span class="token number">3470101770</span><span class="token punctuation">,</span> <span class="token number">3722302451</span><span class="token punctuation">,</span> <span class="token number">3345343326</span><span class="token punctuation">,</span> <span class="token number">2271545308</span><span class="token punctuation">,</span> <span class="token number">2657475692</span><span class="token punctuation">,</span> <span class="token number">2211989611</span><span class="token punctuation">,</span> <span class="token number">2428885922</span><span class="token punctuation">,</span> <span class="token number">2097052181</span><span class="token punctuation">,</span> <span class="token number">3554955904</span><span class="token punctuation">,</span> <span class="token number">1704837589</span><span class="token punctuation">,</span> <span class="token number">1494941216</span><span class="token punctuation">,</span> <span class="token number">3403108634</span><span class="token punctuation">,</span> <span class="token number">911409695</span><span class="token punctuation">,</span> <span class="token number">3550042769</span><span class="token punctuation">,</span> <span class="token number">379101531</span><span class="token punctuation">,</span> <span class="token number">406655201</span><span class="token punctuation">,</span> <span class="token number">1317011271</span><span class="token punctuation">,</span> <span class="token number">2336674904</span><span class="token punctuation">,</span> <span class="token number">3930303124</span><span class="token punctuation">,</span> <span class="token number">3038552846</span><span class="token punctuation">,</span> <span class="token number">3207659329</span><span class="token punctuation">,</span> <span class="token number">2785076651</span><span class="token punctuation">,</span> <span class="token number">1203119790</span><span class="token punctuation">,</span> <span class="token number">1146774748</span><span class="token punctuation">,</span> <span class="token number">2218279443</span><span class="token punctuation">,</span> <span class="token number">494710315</span><span class="token punctuation">,</span> <span class="token number">3507507044</span><span class="token punctuation">,</span> <span class="token number">922439915</span><span class="token punctuation">,</span> <span class="token number">35699688</span><span class="token punctuation">,</span> <span class="token number">2690622469</span><span class="token punctuation">,</span> <span class="token number">1458912003</span><span class="token punctuation">,</span> <span class="token number">3911367650</span><span class="token punctuation">,</span> <span class="token number">983115567</span><span class="token punctuation">,</span> <span class="token number">2813252332</span><span class="token punctuation">,</span> <span class="token number">839947939</span><span class="token punctuation">,</span> <span class="token number">514499603</span><span class="token punctuation">,</span> <span class="token number">3894529528</span><span class="token punctuation">,</span> <span class="token number">326817358</span><span class="token punctuation">,</span> <span class="token number">1479783722</span><span class="token punctuation">,</span> <span class="token number">4242051909</span><span class="token punctuation">,</span> <span class="token number">3492972915</span><span class="token punctuation">,</span> <span class="token number">3473946915</span><span class="token punctuation">,</span> <span class="token number">3348053727</span><span class="token punctuation">,</span> <span class="token number">3681386488</span><span class="token punctuation">,</span> <span class="token number">584266203</span><span class="token punctuation">,</span> <span class="token number">3531080708</span><span class="token punctuation">,</span> <span class="token number">3262223061</span><span class="token punctuation">,</span> <span class="token number">2904040234</span><span class="token punctuation">,</span> <span class="token number">3897643811</span><span class="token punctuation">,</span> <span class="token number">2706405422</span><span class="token punctuation">,</span> <span class="token number">914107260</span><span class="token punctuation">,</span> <span class="token number">3011659451</span><span class="token punctuation">,</span> <span class="token number">308811435</span><span class="token punctuation">,</span> <span class="token number">4103121550</span><span class="token punctuation">,</span> <span class="token number">4023430755</span><span class="token punctuation">,</span> <span class="token number">2975129044</span><span class="token punctuation">,</span> <span class="token number">4139500620</span><span class="token punctuation">,</span> <span class="token number">1763891748</span><span class="token punctuation">,</span> <span class="token number">57665971</span><span class="token punctuation">,</span> <span class="token number">3149249501</span><span class="token punctuation">,</span> <span class="token number">870034516</span><span class="token punctuation">,</span> <span class="token number">4142837134</span><span class="token punctuation">,</span> <span class="token number">3130156432</span><span class="token punctuation">,</span> <span class="token number">1708266697</span><span class="token punctuation">,</span> <span class="token number">1242161643</span><span class="token punctuation">,</span> <span class="token number">1163332264</span><span class="token punctuation">,</span> <span class="token number">108174709</span><span class="token punctuation">,</span> <span class="token number">1633896347</span><span class="token punctuation">,</span> <span class="token number">2820171620</span><span class="token punctuation">,</span> <span class="token number">1708875131</span><span class="token punctuation">,</span> <span class="token number">724124719</span><span class="token punctuation">,</span> <span class="token number">3562786877</span><span class="token punctuation">,</span> <span class="token number">518616285</span><span class="token punctuation">,</span> <span class="token number">3643662732</span><span class="token punctuation">,</span> <span class="token number">3375737681</span><span class="token punctuation">,</span> <span class="token number">2550728441</span><span class="token punctuation">,</span> <span class="token number">1823319080</span><span class="token punctuation">,</span> <span class="token number">1775922455</span><span class="token punctuation">,</span> <span class="token number">3838709569</span><span class="token punctuation">,</span> <span class="token number">177763087</span><span class="token punctuation">,</span> <span class="token number">946611206</span><span class="token punctuation">,</span> <span class="token number">4054832304</span><span class="token punctuation">,</span> <span class="token number">1473954380</span><span class="token punctuation">,</span> <span class="token number">3475817789</span><span class="token punctuation">,</span> <span class="token number">2590152780</span><span class="token punctuation">,</span> <span class="token number">3587873907</span><span class="token punctuation">,</span> <span class="token number">3437231816</span><span class="token punctuation">,</span> <span class="token number">2708036272</span><span class="token punctuation">,</span> <span class="token number">3883447173</span><span class="token punctuation">,</span> <span class="token number">655291275</span><span class="token punctuation">,</span> <span class="token number">707049339</span><span class="token punctuation">,</span> <span class="token number">1352718730</span><span class="token punctuation">,</span> <span class="token number">3543000675</span><span class="token punctuation">,</span> <span class="token number">962283943</span><span class="token punctuation">,</span> <span class="token number">4170075509</span><span class="token punctuation">,</span> <span class="token number">1897499376</span><span class="token punctuation">,</span> <span class="token number">643615933</span><span class="token punctuation">,</span> <span class="token number">856277089</span><span class="token punctuation">,</span> <span class="token number">3299581344</span><span class="token punctuation">,</span> <span class="token number">4093601146</span><span class="token punctuation">,</span> <span class="token number">2638625975</span><span class="token punctuation">,</span> <span class="token number">1563647962</span><span class="token punctuation">,</span> <span class="token number">890552183</span><span class="token punctuation">,</span> <span class="token number">3138216177</span><span class="token punctuation">,</span> <span class="token number">222946344</span><span class="token punctuation">,</span> <span class="token number">4219020514</span><span class="token punctuation">,</span> <span class="token number">3218803481</span><span class="token punctuation">,</span> <span class="token number">3093722090</span><span class="token punctuation">,</span> <span class="token number">1210144957</span><span class="token punctuation">,</span> <span class="token number">3499543439</span><span class="token punctuation">,</span> <span class="token number">4239553976</span><span class="token punctuation">,</span> <span class="token number">3582176749</span><span class="token punctuation">,</span> <span class="token number">654186756</span><span class="token punctuation">,</span> <span class="token number">3005601303</span><span class="token punctuation">,</span> <span class="token number">1252241368</span><span class="token punctuation">,</span> <span class="token number">2459425960</span><span class="token punctuation">,</span> <span class="token number">3587113096</span><span class="token punctuation">,</span> <span class="token number">3506651695</span><span class="token punctuation">,</span> <span class="token number">3673557784</span><span class="token punctuation">,</span> <span class="token number">4157576483</span><span class="token punctuation">,</span> <span class="token number">733173716</span><span class="token punctuation">,</span> <span class="token number">1505997631</span><span class="token punctuation">,</span> <span class="token number">394626148</span><span class="token punctuation">,</span> <span class="token number">1322270695</span><span class="token punctuation">,</span> <span class="token number">84604461</span><span class="token punctuation">,</span> <span class="token number">891267254</span><span class="token punctuation">,</span> <span class="token number">518241635</span><span class="token punctuation">,</span> <span class="token number">1068682198</span><span class="token punctuation">,</span> <span class="token number">3696554893</span><span class="token punctuation">,</span> <span class="token number">3111393676</span><span class="token punctuation">,</span> <span class="token number">1398539042</span><span class="token punctuation">,</span> <span class="token number">901276151</span><span class="token punctuation">,</span> <span class="token number">483471144</span><span class="token punctuation">,</span> <span class="token number">1952219546</span><span class="token punctuation">,</span> <span class="token number">2884270239</span><span class="token punctuation">,</span> <span class="token number">2215979688</span><span class="token punctuation">,</span> <span class="token number">4138748504</span><span class="token punctuation">,</span> <span class="token number">1623101775</span><span class="token punctuation">,</span> <span class="token number">3102260771</span><span class="token punctuation">,</span> <span class="token number">4276348310</span><span class="token punctuation">,</span> <span class="token number">1228132323</span><span class="token punctuation">,</span> <span class="token number">2250922664</span><span class="token punctuation">,</span> <span class="token number">833982365</span><span class="token punctuation">,</span> <span class="token number">3402246096</span><span class="token punctuation">,</span> <span class="token number">2085678412</span><span class="token punctuation">,</span> <span class="token number">2707953187</span><span class="token punctuation">,</span> <span class="token number">590837194</span><span class="token punctuation">,</span> <span class="token number">3421635592</span><span class="token punctuation">,</span> <span class="token number">3488064851</span><span class="token punctuation">,</span> <span class="token number">3655525766</span><span class="token punctuation">,</span> <span class="token number">1029679348</span><span class="token punctuation">,</span> <span class="token number">2448841196</span><span class="token punctuation">,</span> <span class="token number">89284911</span><span class="token punctuation">,</span> <span class="token number">3970560858</span><span class="token punctuation">,</span> <span class="token number">334986490</span><span class="token punctuation">,</span> <span class="token number">3063032848</span><span class="token punctuation">,</span> <span class="token number">3172506167</span><span class="token punctuation">,</span> <span class="token number">2391313449</span><span class="token punctuation">,</span> <span class="token number">3589023591</span><span class="token punctuation">,</span> <span class="token number">4269870234</span><span class="token punctuation">,</span> <span class="token number">3275101066</span><span class="token punctuation">,</span> <span class="token number">1716650872</span><span class="token punctuation">,</span> <span class="token number">483502324</span><span class="token punctuation">,</span> <span class="token number">2116979028</span><span class="token punctuation">,</span> <span class="token number">815078501</span><span class="token punctuation">,</span> <span class="token number">3475316209</span><span class="token punctuation">,</span> <span class="token number">1003463022</span><span class="token punctuation">,</span> <span class="token number">2418993968</span><span class="token punctuation">,</span> <span class="token number">4251101825</span><span class="token punctuation">,</span> <span class="token number">346290993</span><span class="token punctuation">,</span> <span class="token number">3286645593</span><span class="token punctuation">,</span> <span class="token number">2654742976</span><span class="token punctuation">,</span> <span class="token number">99974317</span><span class="token punctuation">,</span> <span class="token number">4124695845</span><span class="token punctuation">,</span> <span class="token number">3732280507</span><span class="token punctuation">,</span> <span class="token number">1536249568</span><span class="token punctuation">,</span> <span class="token number">1440486445</span><span class="token punctuation">,</span> <span class="token number">1605422491</span><span class="token punctuation">,</span> <span class="token number">393607563</span><span class="token punctuation">,</span> <span class="token number">1141210694</span><span class="token punctuation">,</span> <span class="token number">43848150</span><span class="token punctuation">,</span> <span class="token number">1656624711</span><span class="token punctuation">,</span> <span class="token number">2170355702</span><span class="token punctuation">,</span> <span class="token number">327988021</span><span class="token punctuation">,</span> <span class="token number">974870171</span><span class="token punctuation">,</span> <span class="token number">2169013815</span><span class="token punctuation">,</span> <span class="token number">3689546490</span><span class="token punctuation">,</span> <span class="token number">3576028106</span><span class="token punctuation">,</span> <span class="token number">4258679518</span><span class="token punctuation">,</span> <span class="token number">14944446</span><span class="token punctuation">,</span> <span class="token number">1786133397</span><span class="token punctuation">,</span> <span class="token number">264814384</span><span class="token punctuation">,</span> <span class="token number">1969519378</span><span class="token punctuation">,</span> <span class="token number">1769400868</span><span class="token punctuation">,</span> <span class="token number">3098042628</span><span class="token punctuation">,</span> <span class="token number">22547518</span><span class="token punctuation">,</span> <span class="token number">3195136230</span><span class="token punctuation">,</span> <span class="token number">42683806</span><span class="token punctuation">,</span> <span class="token number">1288550835</span><span class="token punctuation">,</span> <span class="token number">59638233</span><span class="token punctuation">,</span> <span class="token number">3534385409</span><span class="token punctuation">,</span> <span class="token number">2517101496</span><span class="token punctuation">,</span> <span class="token number">3632913591</span><span class="token punctuation">,</span> <span class="token number">3894777481</span><span class="token punctuation">,</span> <span class="token number">2912655780</span><span class="token punctuation">,</span> <span class="token number">1614602217</span><span class="token punctuation">,</span> <span class="token number">3498478791</span><span class="token punctuation">,</span> <span class="token number">1309795895</span><span class="token punctuation">,</span> <span class="token number">3961554801</span><span class="token punctuation">,</span> <span class="token number">3625321205</span><span class="token punctuation">,</span> <span class="token number">308138165</span><span class="token punctuation">,</span> <span class="token number">2885107341</span><span class="token punctuation">,</span> <span class="token number">1003378866</span><span class="token punctuation">,</span> <span class="token number">3462951062</span><span class="token punctuation">,</span> <span class="token number">1914176024</span><span class="token punctuation">,</span> <span class="token number">3130918711</span><span class="token punctuation">,</span> <span class="token number">3919345882</span><span class="token punctuation">,</span> <span class="token number">3556964414</span><span class="token punctuation">,</span> <span class="token number">2382442356</span><span class="token punctuation">,</span> <span class="token number">3968605965</span><span class="token punctuation">,</span> <span class="token number">2388890395</span><span class="token punctuation">,</span> <span class="token number">1955471760</span><span class="token punctuation">,</span> <span class="token number">2358533573</span><span class="token punctuation">,</span> <span class="token number">2323037969</span><span class="token punctuation">,</span> <span class="token number">4273118548</span><span class="token punctuation">,</span> <span class="token number">3577096972</span><span class="token punctuation">,</span> <span class="token number">4251790958</span><span class="token punctuation">,</span> <span class="token number">2321545863</span><span class="token punctuation">,</span> <span class="token number">2057106840</span><span class="token punctuation">,</span> <span class="token number">4000766037</span><span class="token punctuation">,</span> <span class="token number">1551111470</span><span class="token punctuation">,</span> <span class="token number">368761666</span><span class="token punctuation">,</span> <span class="token number">951769999</span><span class="token punctuation">,</span> <span class="token number">778229999</span><span class="token punctuation">,</span> <span class="token number">4235748487</span><span class="token punctuation">,</span> <span class="token number">2020142699</span><span class="token punctuation">,</span> <span class="token number">3577752281</span><span class="token punctuation">,</span> <span class="token number">1269488993</span><span class="token punctuation">,</span> <span class="token number">1350156870</span><span class="token punctuation">,</span> <span class="token number">529843408</span><span class="token punctuation">,</span> <span class="token number">669182431</span><span class="token punctuation">,</span> <span class="token number">3871401874</span><span class="token punctuation">,</span> <span class="token number">2180265713</span><span class="token punctuation">,</span> <span class="token number">3850183472</span><span class="token punctuation">,</span> <span class="token number">46915226</span><span class="token punctuation">,</span> <span class="token number">3150800412</span><span class="token punctuation">,</span> <span class="token number">1139932212</span><span class="token punctuation">,</span> <span class="token number">2523557119</span><span class="token punctuation">,</span> <span class="token number">1462042012</span><span class="token punctuation">,</span> <span class="token number">301258444</span><span class="token punctuation">,</span> <span class="token number">165757583</span><span class="token punctuation">,</span> <span class="token number">530704729</span><span class="token punctuation">,</span> <span class="token number">1848179734</span><span class="token punctuation">,</span> <span class="token number">1792342751</span><span class="token punctuation">,</span> <span class="token number">2597916820</span><span class="token punctuation">,</span> <span class="token number">4041946457</span><span class="token punctuation">,</span> <span class="token number">1127104524</span><span class="token punctuation">,</span> <span class="token number">3768573884</span><span class="token punctuation">,</span> <span class="token number">2614008065</span><span class="token punctuation">,</span> <span class="token number">741308521</span><span class="token punctuation">,</span> <span class="token number">477746986</span><span class="token punctuation">,</span> <span class="token number">507411825</span><span class="token punctuation">,</span> <span class="token number">4235293189</span><span class="token punctuation">,</span> <span class="token number">2251811519</span><span class="token punctuation">,</span> <span class="token number">811234592</span><span class="token punctuation">,</span> <span class="token number">1985999307</span><span class="token punctuation">,</span> <span class="token number">844715613</span><span class="token punctuation">,</span> <span class="token number">1640781314</span><span class="token punctuation">,</span> <span class="token number">3538036580</span><span class="token punctuation">,</span> <span class="token number">2764130557</span><span class="token punctuation">,</span> <span class="token number">2863454433</span><span class="token punctuation">,</span> <span class="token number">1831736583</span><span class="token punctuation">,</span> <span class="token number">3857379783</span><span class="token punctuation">,</span> <span class="token number">658928449</span><span class="token punctuation">,</span> <span class="token number">1149649578</span><span class="token punctuation">,</span> <span class="token number">103125751</span><span class="token punctuation">,</span> <span class="token number">2968446555</span><span class="token punctuation">,</span> <span class="token number">885660863</span><span class="token punctuation">,</span> <span class="token number">707321834</span><span class="token punctuation">,</span> <span class="token number">1728646363</span><span class="token punctuation">,</span> <span class="token number">2706995220</span><span class="token punctuation">,</span> <span class="token number">3062604255</span><span class="token punctuation">,</span> <span class="token number">4177710084</span><span class="token punctuation">,</span> <span class="token number">3076079677</span><span class="token punctuation">,</span> <span class="token number">879366858</span><span class="token punctuation">,</span> <span class="token number">3936728615</span><span class="token punctuation">,</span> <span class="token number">8828906</span><span class="token punctuation">,</span> <span class="token number">1656874220</span><span class="token punctuation">,</span> <span class="token number">2904085639</span><span class="token punctuation">,</span> <span class="token number">397694272</span><span class="token punctuation">,</span> <span class="token number">1604508691</span><span class="token punctuation">,</span> <span class="token number">2083663236</span><span class="token punctuation">,</span> <span class="token number">2138468690</span><span class="token punctuation">,</span> <span class="token number">1365350684</span><span class="token punctuation">,</span> <span class="token number">2870684769</span><span class="token punctuation">,</span> <span class="token number">384435793</span><span class="token punctuation">,</span> <span class="token number">1063724290</span><span class="token punctuation">,</span> <span class="token number">1142482048</span><span class="token punctuation">,</span> <span class="token number">809857977</span><span class="token punctuation">,</span> <span class="token number">4192515435</span><span class="token punctuation">,</span> <span class="token number">267878653</span><span class="token punctuation">,</span> <span class="token number">206018017</span><span class="token punctuation">,</span> <span class="token number">3441769173</span><span class="token punctuation">,</span> <span class="token number">925696591</span><span class="token punctuation">,</span> <span class="token number">2250932557</span><span class="token punctuation">,</span> <span class="token number">1973183700</span><span class="token punctuation">,</span> <span class="token number">577661907</span><span class="token punctuation">,</span> <span class="token number">2551314381</span><span class="token punctuation">,</span> <span class="token number">1350352597</span><span class="token punctuation">,</span> <span class="token number">4151551172</span><span class="token punctuation">,</span> <span class="token number">774849773</span><span class="token punctuation">,</span> <span class="token number">2391866106</span><span class="token punctuation">,</span> <span class="token number">3444137245</span><span class="token punctuation">,</span> <span class="token number">403261487</span><span class="token punctuation">,</span> <span class="token number">2724363448</span><span class="token punctuation">,</span> <span class="token number">3572536490</span><span class="token punctuation">,</span> <span class="token number">1077243504</span><span class="token punctuation">,</span> <span class="token number">302416473</span><span class="token punctuation">,</span> <span class="token number">3457548858</span><span class="token punctuation">,</span> <span class="token number">564604707</span><span class="token punctuation">,</span> <span class="token number">1238169871</span><span class="token punctuation">,</span> <span class="token number">2356838464</span><span class="token punctuation">,</span> <span class="token number">3083335214</span><span class="token punctuation">,</span> <span class="token number">3844937218</span><span class="token punctuation">,</span> <span class="token number">1272458074</span><span class="token punctuation">,</span> <span class="token number">1782962159</span><span class="token punctuation">,</span> <span class="token number">1543604321</span><span class="token punctuation">,</span> <span class="token number">3212537899</span><span class="token punctuation">,</span> <span class="token number">426074894</span><span class="token punctuation">,</span> <span class="token number">3053843067</span><span class="token punctuation">,</span> <span class="token number">2436223151</span><span class="token punctuation">,</span> <span class="token number">94019340</span><span class="token punctuation">,</span> <span class="token number">4147659323</span><span class="token punctuation">,</span> <span class="token number">2893920832</span><span class="token punctuation">,</span> <span class="token number">626619793</span><span class="token punctuation">,</span> <span class="token number">3976626567</span><span class="token punctuation">,</span> <span class="token number">1884877146</span><span class="token punctuation">,</span> <span class="token number">2696384440</span><span class="token punctuation">,</span> <span class="token number">1177352315</span><span class="token punctuation">,</span> <span class="token number">1082374195</span><span class="token punctuation">,</span> <span class="token number">3289271804</span><span class="token punctuation">,</span> <span class="token number">1485815836</span><span class="token punctuation">,</span> <span class="token number">120127000</span><span class="token punctuation">,</span> <span class="token number">3349349501</span><span class="token punctuation">,</span> <span class="token number">164243314</span><span class="token punctuation">,</span> <span class="token number">1703351326</span><span class="token punctuation">,</span> <span class="token number">1017276501</span><span class="token punctuation">,</span> <span class="token number">413737931</span><span class="token punctuation">,</span> <span class="token number">408060344</span><span class="token punctuation">,</span> <span class="token number">472141408</span><span class="token punctuation">,</span> <span class="token number">172738862</span><span class="token punctuation">,</span> <span class="token number">4001606849</span><span class="token punctuation">,</span> <span class="token number">1888805432</span><span class="token punctuation">,</span> <span class="token number">2927218529</span><span class="token punctuation">,</span> <span class="token number">1293362241</span><span class="token punctuation">,</span> <span class="token number">1941759619</span><span class="token punctuation">,</span> <span class="token number">1760659398</span><span class="token punctuation">,</span> <span class="token number">274865852</span><span class="token punctuation">,</span> <span class="token number">978985751</span><span class="token punctuation">,</span> <span class="token number">3867215904</span><span class="token punctuation">,</span> <span class="token number">177291528</span><span class="token punctuation">,</span> <span class="token number">1083045308</span><span class="token punctuation">,</span> <span class="token number">3888975618</span><span class="token punctuation">,</span> <span class="token number">979933689</span><span class="token punctuation">,</span> <span class="token number">2211634008</span><span class="token punctuation">,</span> <span class="token number">3899294132</span><span class="token punctuation">,</span> <span class="token number">1174569575</span><span class="token punctuation">]</span>
Hash<span class="token operator">=</span><span class="token string">'b0cfb7293d6842e3279f4ef0fc88284174349e111e5b9beb28263df72c9db0bf'</span>
res<span class="token operator">=</span><span class="token number">1045726758250168034320246515934682860724576730763168865120</span>


<span class="token keyword">from</span> mt19937predictor <span class="token keyword">import</span> MT19937Predictor
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
predictor <span class="token operator">=</span> MT19937Predictor<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> randist<span class="token punctuation">:</span>
	predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>
x <span class="token operator">=</span> predictor<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>

<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom
<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm


<span class="token comment"># for i in tqdm(range(256)):</span>
<span class="token comment">#     for j in range(256):</span>
<span class="token comment">#         for k in range(256):</span>
<span class="token comment">#             if sha256(i.to_bytes(1, byteorder='big') + j.to_bytes(1, byteorder='big') + k.to_bytes(1, byteorder='big')).hexdigest() == Hash:</span>
<span class="token comment">#                 print(i.to_bytes(1, byteorder='big') + j.to_bytes(1, byteorder='big') + k.to_bytes(1, byteorder='big'))</span>
<span class="token comment">#                 exit()</span>

tmp <span class="token operator">=</span> <span class="token string">b'\xfeV\xe8'</span>
<span class="token comment"># y = predictor.getrandbits(192)</span>
<span class="token comment"># print(res ^ y)</span>
<span class="token comment"># print(bin(3096872116674666632134706098360014813425478687167245803096)[2:])</span>

res <span class="token operator">=</span> <span class="token string">'11111100100110011011010100000010100111101010001110010110101000111010000101111001111100001100100001111110000100000010001010110111001001000101111101101110101101110110111010111010101111001011000'</span>
n3 <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">151</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
n3 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>n3<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
n3 <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>n3<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">def</span> <span class="token function">affine</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>

<span class="token keyword">from</span> string <span class="token keyword">import</span> <span class="token operator">*</span>

flag3 <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n3<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> digits <span class="token operator">+</span> <span class="token string">'abcdef'</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> i<span class="token punctuation">:</span>
            flag3 <span class="token operator">+=</span> j
<span class="token comment"># print(flag3)</span>
<span class="token comment"># 64406e6365</span>

tmp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>
n2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">151</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>n2 <span class="token operator">^</span> tmp<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># 6c795f</span>
<span class="token comment"># for i in range(10, 135):</span>
<span class="token comment">#     n1 = int(res[:i], 2)</span>
<span class="token comment">#     if len(hex(n1 ^ x)[2:]) == 32:</span>
<span class="token comment">#         print(i)</span>
<span class="token comment">#         print(hex(n1 ^ x)[2:])</span>


<span class="token comment"># flag = 0x16ef9b7e65eaccdac7f2a82242f97461fe795f64406e6365</span>
<span class="token comment"># print(n2s(flag))</span>
<span class="token comment"># flag = 0x365ac09e91965ba65b83ea0952bf789afe795f64406e6365</span>
<span class="token comment"># print(n2s(flag))</span>
flag <span class="token operator">=</span> <span class="token number">0x7730775f796f755f63616e5f7233616c6c795f64406e6365</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment"># flag = 0xf5e518dca89d28ad12a466f3332b5280fe795f64406e6365</span>
<span class="token comment"># print(n2s(flag))</span>

<span class="token comment"># flag&#123;w0w_you_can_r3ally_d@nce&#125;</span></code></pre>
<h3 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span>
<span class="token comment">#coding:utf-8</span>

<span class="token keyword">import</span> gmpy2
<span class="token keyword">import</span> random
<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">,</span>bytes_to_long
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom

<span class="token keyword">def</span> <span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>
    k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
    r <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        e <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> p<span class="token operator">**</span>k<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token operator">**</span>r<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>
        	<span class="token keyword">break</span>
    pubkey <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">long</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">long</span><span class="token punctuation">(</span>p<span class="token operator">**</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> pubkey

<span class="token keyword">def</span> <span class="token function">c1pto</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span><span class="token punctuation">:</span>
    e<span class="token punctuation">,</span> n <span class="token operator">=</span> pubkey
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">assert</span> m <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span>
    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> n

<span class="token keyword">def</span> <span class="token function">c2pto</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>
    key<span class="token operator">=</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    iv<span class="token operator">=</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>
    cipher<span class="token operator">=</span>AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span>iv<span class="token punctuation">)</span>
    m<span class="token operator">=</span>iv<span class="token operator">+</span>long_to_bytes<span class="token punctuation">(</span>p<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"base64"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> key

<span class="token keyword">def</span> <span class="token function">c3pto</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>
        a <span class="token operator">=</span> a <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            a <span class="token operator">=</span> a <span class="token operator">^</span> n
        <span class="token keyword">if</span> a <span class="token operator">>></span> <span class="token number">256</span><span class="token punctuation">:</span>
            a <span class="token operator">=</span> a <span class="token operator">^</span> 0x10000000000000000000000000000000000000000000000000000000000000223L
    <span class="token keyword">return</span> a

m<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>urandom<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">+</span>flag<span class="token punctuation">)</span>
pubkey <span class="token operator">=</span> getkey<span class="token punctuation">(</span><span class="token punctuation">)</span>
n <span class="token operator">=</span> c1pto<span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span>
key<span class="token operator">=</span>c2pto<span class="token punctuation">(</span>n<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c3pto<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token triple-quoted-string string">'''output
0x5b0cd450a7bfb679dc9caa8aa6fc131708fca2a34375d049ac035fb019463d9c3fa11adb0eb51dea1ae85223df59f887a12ab376cbcb272681c3872c57f4da27396052242b608e3ea4ff53061e63bbfdff652ce25f4ce73315fd1a73a5d5e7307402c7a3c6c1a80c63297b441125c38e23729da6473e5dc332e4e7201df25ff6c8b9918b262e56a31bebe13e093e6f4dba47a771961358cedf6d740732425cb708a633d538dcdc12ef7b49ce76aa270f50dd7cc1b879f1d7b19c6ac3b891fe4e20fb7645b7567237775881de7d30ba754d495ffe8ee751d1cfee1c661a2dbf13a53ff1bcf8085b39f6508fbf37137ebad659665fe5fcc67eef02970a44ac675e28103bd10f2045983d5adaa909b18b70a909b08b76c21b2798830276068d0ebd27303985bb5f3e681219a50bc761b7630587743768cf61922804d195e265aaaabb4740a2c5d7e8ff4e1c19cfb534d345f537e95e948591557f3136da617657e24d1904be373f5e7d63af330b837bcc662cbcd801eb436dbbeb714469d227e9f17e118db39eeb42e45455e6daf4d8fe0e19c4457b596c20e1ef8d235b230018a58e1c66c52c7317094aa5797f50a3b5ebe2be2abd1a04d907fbb68919956d7b0939ac0195a3f3bd3eb6f08eef67a895807768250172ec6bb2b35c9962de03df847170472b73981c04f2aef03721554c818ec9eb7f625d1a3fcdcf756adc4b6fd61950724ac2164a94df70f4aa1cc36c51dd2c3b6545c6c2233544254f6a24e6a170918fd0c533734ef859fed3c5d6f1f9acf8d3b77804c98fa5f1429763ebe860a77380a1e94626b46d88e5263855a0a0d226eb7ca64824c9a06acda851e650e6b035c04e27de61cd49ff49ac3ea3407440f9e76ce47c02301c1bc9c28befe0cd1f5b999961b055ffb39e2f451302aaedc5d779da03830bda1ed3ba9be4f23b2381096f3dc60c84a91ba0aa44242cc6aa361e2ecac867a2d1ef6868199ecb3004aa62bd56683c3476a9bd3f0316905e4f83ef5a907d9796231b9f506c82c09c739513a0db04467a071dcc34cb11bbba8cd3f1870174e04160ae74c2160a61a7c472e8edc51e969a2f0fb47cee59b67d401ecb13b06f72dcfb24f5850b8921b8bad14f7c6bd123c13b3a2ea1761fc425066ba107d61e96d2fa9b3ed88befec93578495ef4c7a1eb95d76679d1f5261f0202e1de881c5c5b1fb44f471a75a305d86df1123cd83c8bc9449c73cf34dbd247111c873bc1fc7948863bb59f2ac3d7129c2e7c3e0ef94afb38a01b3e42f83f42a5cc8e14cbe53c0c8d76768cdc98bef921aaca60204519b516d4c9de7cf581eec8a53faa2e2d96722d0ef2c23d5567ba48104890534cd84432565236cb3402504e0feb6c25426c52d2b2b42f10a007cdd38b540cf64a96ee784deb2b595deb4a9497f9a25ab06eab443010b66e7decc162dcbd7de12737d72a46ec0b8151e1ed42716af2c7602692d7c0ea757bc056c89d2640773a4c3c1a2297c87c13676e414003ff3af0d1abb87ba618e24a4dfe05c0b4443bda53d26c7e30f0dec498d9091074fe3444e81b9a4d8d7acc8b1e38f6afc63540a4e8880fd73bd34bc3563cc0a98bd35ce7455d5cf8a114bc2fe2fb9a58e725cc121e4e242fc0a9a8e38615bda67fd9f158e718154eb51d0ec3d941426933e36fba1db0d7b59d52be90aa796895e6a49fed0a7887b8d7c71a9aa023a8dc73391e3d1bfc746cde9f964d99625900624a8eb300f2d7d2f8703f470776088f27aaa72e7607dcd78cf63754cec00db23bb36beb48cffb20a06df884f101a9L
0x26c6b16ed40253ff31bdcd502d63230a9655f29599cfb41a29f10e700589e6a13a8c78f483e0aa8b9353fa258a1437ba15e8d2c8bb2b090a6887740b31d71550745611fabd087904f150b4d928d155a7fcdd1a64c7349ce984dfd08c4c795e93b409f53c1458e6de777dc5993198f4c0648381116fe5cbafa57499d9ce685c625df4797afc344e8fe4a0fc36cf82ba1423c8a4ad7a33bc4cbab25e2df729085f96d3d9d542d981fa46cac8a37ceb70b9f808213845c06b72be7e2d1224e4dc02817bd474c690e43f6d8f1916a20f2e078bfaa604343d695e6f5f88d9f11c43a886ff97d9bd26b0126af40bed8e03a43bf8c912b5b0dd2f9f2e7e99db066759f573cd59a40a554bebdd3e7e0adbc38fcb91adeb72f9dcd30558b082471a02fd9131a61cf29b1f4e38a5d689d8dcd0b8dc29075e3a33b2d6a25bee6ff9e20d269cc088a2b155be76a1531ce30b25edf928990b5143fc5ae2737d8d4070d0517f5137c458d7afed8f51e2c2973dd143235c9deaffe9ce8fbcd767a93573399dafd5ef61408c77302c993354a080684cdbfb7c1eeb6e6be907db790038c7ce62517815d16fe366bd26178f2f05b9e56450814f4ba7ab6cab54c5f78316b0451057785c03a77c20814eb405cd20e5bff5247a12500dd16173125ffdef4fb6317ab942d0d7e0e584a8fd97a8ba8d87fd38127d6d059902a2d48dafd10938ea5d108f3eb986aabf9e212151b0e540bb5fd25888143633be9982395d4d3bef5278be37328e0239569eb511698ef7f9e7e12aa204cb4c069ffcdeecb65f42ba37f7bfd47c4ba8df384a88adf3486b58cc1620185ac81dfb10f591fc82f3ae046341ebd1e8288f10500d6677e91b89729dfd299b74be13a9183725aacb0023f4fb01efda61390b0312d90ff6a9a319433681ad1811efe038fcdeb6dc1c3f594c4f8011aacfee74ea9638fccb3d669435a1208578c934277caa3ec74f9efbb33e024909b121e7b4e48ec94b762fa9dcab8a1c11b86bb9db164c7655504d304661e04e95b0b356f5968334596fb11df95bbdcb3a6618f431c864658827662f760fc86b2136221bd50472dc19c4f177eb5edf7978760dc15150cfda0a3ea649cb672b8f37229298c6edcc630e3ac9a5f43f58a93ba8def335472f7ebdedd7715a27c4ea622344a949bec59af030455ed61911d53388022bd502e800b769ef499f94f02c96f486b40ce68dbdc42e5690ac2992bedf7f0ba384504c32cb00a25d4e125483003152e81ebe9c12d928627d7f14fc3fbdf5141addc477d5ae4f32e64dcb58a6e2cf955ad7ae54e1665b3199bd0fae36b9ec56c09ac00efc9d27e69a93f4e08652edc3340fa2c518d388ee4a005b9c83956b9139b98380f6925a1a4c3e64ff8d96f2827d0d8a25cc72a2c03a28e33871284b46e10c85f2ad75969b1d84e9d88bb4e05dL
GuGfliJiRkNsUbbmB+g/q4U3z6YahJ6G1Q9bg6ZT/ilJnkNMICmQYMFuhlNBuVZHfJJIFwwFJ5FK
G+z9zSXalJq6quN6d3CSYSMHvYk04Orpn76Y2VQX5qQk72uCssd4x5KNIOmX0CvzJmjTWjLvL1U5
twQupfkuDr/axqyHFss3pJkj9o0IRZmtz87bi5WojeUjOaayQ0RNenJJzhJ+zFJwdUCpUhwotHxL
OPsUXYSoY7AKPwj53Dlsy0deNBKFN89BolC4pTwHWvn0M/8eu9kIze+5sQuKrk0VI5ASNzA6PRp1
owpgsxNuy18k6/y01+mVheQkFrH2IrFNgqe3+Gu/PXEDPi3G2nAIi/4Xf9QI0DNH+hkoN40zWaX3
OkEVQeLQ9o/KuggeoajYwDusFyQxOQZYFr5I+v8uBApcQz29bKIRiZX78r9YN3IaSsL0JgLPQPYa
NPNiZMm5pqmv/zV0poZikYGYJsAwfjLJ/CYQ/iLBhkhKZoE9VxYEae7Wga1jwpJb3h/lA3mbvQof
MTR6ivnSZHzUu3elxMFTgTi5adB4PsBdke0YRXlWP8/AoggBAN5OMw8n2LCASIhp7q/1iljNUuw/
40mBCt75jszo1eBBDAbP7/DjXL5hUHFgen6xjedcySq/H0ibyNGasyePs3e+igr78fHyvXyIYYPa
EtM4RjC3j3TXheRYRo9lObJgHUHSY0PgAgrqc1rECexNa+QCvzzapemNAEE9OT8YLOEkB6zzpSrZ
6k/NR9KffGnqplQlWAfXdDrf3SsOmWVJ3G6DvmpTCukQgVYn+DCv5LdSSUZo2hjxBHPv8C5zpZia
sPLDr+2CwUvccettO3wwrWQ1bPfRBZ7OSghvipbYI7awjt45tyxT5TopN7e3kud1s4bdm7da/KQD
DQ3pxylH7Kc2b8wWfptW2t9wEoqdjNezr24E+/c6kNIo9TmZ8mPigNBz/d7Sd5TzxhstmXoXscAv
FLpc7B/RhD5qwXWlYZwisemsTL6GVgBpaWI0zp4pk4DaQcT7FM17qddeHCiF5YD9g6TZBkYXnvke
5hW1JERYny3GjTNum8P3p9L3NHWpfAK2S90ChRwDb3nDy81B6b6K+YMNsJmmMjJhE/GbP6jMFE/2
cLIAsAT+Ssk/zNEJKXKe3gN4pQzBcDJksDxrlYJoYQE/rz1Ni7EpKiuuEUtODcGSCcRagh6t6cJV
yDh76DgxgjAvjATjPS6bdJ5PQWocTtjoMUvkMjbeEoWMuoe5cgsHl3HoYsLyxWwk1zn4BVSdjumi
D0o8juKUTFsFjN8yyNQyAA4KNRrhrIBdK8VTcsJC5JFjJnJiX1P6yrUWZPnH4YB3wIZwA5EkXjlg
tNrZghyWTMNoMs4GH6A=

38003142990385686484863558905791098358375993231657244276476071305023256088640
'''</span></code></pre>
<p>先不断用c3pto函数得到key的值，因为在明文前面填充了iv，所以第一轮CBC加密时相当于0。因此先用ECB模式加密16个0就可以得到iv的值。解密之后去掉前16位iv再b2l得到n的值。又因为n是p的k次方，k是3到10的随机数，所以可以通过iroot来爆破得到p和k的值。然后phi就是p^4-p^3，常规rsa解密即可。</p>
<pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>

<span class="token comment"># ans = 38003142990385686484863558905791098358375993231657244276476071305023256088640</span>
<span class="token comment"># for i in range(3000):</span>
<span class="token comment">#     ans = c3pto(ans)</span>
<span class="token comment">#     if len(long_to_bytes(ans)) == 16:</span>
<span class="token comment">#         print(long_to_bytes(ans))</span>
<span class="token comment">#         print(i)</span>
<span class="token comment">#         break</span>
key <span class="token operator">=</span> <span class="token string">b'\xe3+\x91\t\x98\xf3\x1e\xc1:GdW\xa7\x9c\xed\xc8'</span>

cipher <span class="token operator">=</span> <span class="token string">b'GuGfliJiRkNsUbbmB+g/q4U3z6YahJ6G1Q9bg6ZT/ilJnkNMICmQYMFuhlNBuVZHfJJIFwwFJ5FKG+z9zSXalJq6quN6d3CSYSMHvYk04Orpn76Y2VQX5qQk72uCssd4x5KNIOmX0CvzJmjTWjLvL1U5twQupfkuDr/axqyHFss3pJkj9o0IRZmtz87bi5WojeUjOaayQ0RNenJJzhJ+zFJwdUCpUhwotHxLOPsUXYSoY7AKPwj53Dlsy0deNBKFN89BolC4pTwHWvn0M/8eu9kIze+5sQuKrk0VI5ASNzA6PRp1owpgsxNuy18k6/y01+mVheQkFrH2IrFNgqe3+Gu/PXEDPi3G2nAIi/4Xf9QI0DNH+hkoN40zWaX3OkEVQeLQ9o/KuggeoajYwDusFyQxOQZYFr5I+v8uBApcQz29bKIRiZX78r9YN3IaSsL0JgLPQPYaNPNiZMm5pqmv/zV0poZikYGYJsAwfjLJ/CYQ/iLBhkhKZoE9VxYEae7Wga1jwpJb3h/lA3mbvQofMTR6ivnSZHzUu3elxMFTgTi5adB4PsBdke0YRXlWP8/AoggBAN5OMw8n2LCASIhp7q/1iljNUuw/40mBCt75jszo1eBBDAbP7/DjXL5hUHFgen6xjedcySq/H0ibyNGasyePs3e+igr78fHyvXyIYYPaEtM4RjC3j3TXheRYRo9lObJgHUHSY0PgAgrqc1rECexNa+QCvzzapemNAEE9OT8YLOEkB6zzpSrZ6k/NR9KffGnqplQlWAfXdDrf3SsOmWVJ3G6DvmpTCukQgVYn+DCv5LdSSUZo2hjxBHPv8C5zpZiasPLDr+2CwUvccettO3wwrWQ1bPfRBZ7OSghvipbYI7awjt45tyxT5TopN7e3kud1s4bdm7da/KQDDQ3pxylH7Kc2b8wWfptW2t9wEoqdjNezr24E+/c6kNIo9TmZ8mPigNBz/d7Sd5TzxhstmXoXscAvFLpc7B/RhD5qwXWlYZwisemsTL6GVgBpaWI0zp4pk4DaQcT7FM17qddeHCiF5YD9g6TZBkYXnvke5hW1JERYny3GjTNum8P3p9L3NHWpfAK2S90ChRwDb3nDy81B6b6K+YMNsJmmMjJhE/GbP6jMFE/2cLIAsAT+Ssk/zNEJKXKe3gN4pQzBcDJksDxrlYJoYQE/rz1Ni7EpKiuuEUtODcGSCcRagh6t6cJVyDh76DgxgjAvjATjPS6bdJ5PQWocTtjoMUvkMjbeEoWMuoe5cgsHl3HoYsLyxWwk1zn4BVSdjumiD0o8juKUTFsFjN8yyNQyAA4KNRrhrIBdK8VTcsJC5JFjJnJiX1P6yrUWZPnH4YB3wIZwA5EkXjlgtNrZghyWTMNoMs4GH6A='</span>
<span class="token keyword">from</span> base64 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment"># print(b64decode(cipher))</span>
<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES
aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>
iv <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b'0'</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span>
<span class="token comment"># iv = b'&lt;\xf1t)J\xb94\x94\x96k\xb3\xa6\xd0l\x1f\x18'</span>
<span class="token comment"># print(len(iv))</span>
aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
<span class="token comment"># print(bytes_to_long(aes.decrypt(b64decode(cipher))[16:]))</span>
n <span class="token operator">=</span> <span class="token number">192099659971585644585994265356151893462377034960456794411988891865292985043855003153008582523342780428794810302819600257505211543181857907106415116235678327109890992104863370288179222517757670217778339429390238355802091081769000348240713104001227465195009290503347809694648095737603288589286587488951249122808668565718081375241590144993161651582987613212486939491481151331461062699460189663231086086438368188327851901136662178362187582946879512941211019554239356512237609083714797677920647956302526035540976096625395045576074618882913271336136197136983455626303177930159461486947144900160609689255459511724884379858318269727855760842754096692298627624434916921714588784746851193083162412064551556945404206854303755771760752959780690233660596074620616291920828653736584021095005924141651891036415545086668712524203621422434855332350634434410255685899978575653707114060202874964589333127633649581915659487394392054766924938473585908627256425677898409670003835577877230695953230779772624257018952499735317822119685099669750110189929339815489604592011705747522509443099530871227359100112168474188213599742539558713508525377201675194485642343270883438486906530571528359024979260422106335247512597006126883635090340753475080689838573417741101697005667509804117477078714343224837766971175288554228364175312803060405952234277289653353821049167680289322424370730116331485806992442330752262754657170209301796826520903516939270541484630918051998431104746567068050303837266511857593664457675203874622377426656951134697321668662464768461125119491757074002358277630438779981831394788463952738787381176350532134825112678994090733193226361777537532269515922485937976349665991399772388721397960468392351155664481353730638831836994949983037350384382753327305729403941493686341892251753278811372338966651828844911034352886809190060883995056847456555950315611326987545276629529435068813158170690823902054787362572088738335891773343913632258874832438998334332913261810760087047758552754566575308536675397251987093487164542963055804002441751864022715424662848335470359948420027756835213050500577294799638589135949755879898985814242501638839907383377834819866500082619067419468232672548637154121177897443704368253245514204975147693342503301921844252239673318375741456151277008424086433210309669337358030499431697081307189511178107489812792122478536534259554160073644974772253911579253927334216606449192146737795612311912838169178570116934403812068138348378295739329366212651044519758844001</span>
e <span class="token operator">=</span> <span class="token number">0x5b0cd450a7bfb679dc9caa8aa6fc131708fca2a34375d049ac035fb019463d9c3fa11adb0eb51dea1ae85223df59f887a12ab376cbcb272681c3872c57f4da27396052242b608e3ea4ff53061e63bbfdff652ce25f4ce73315fd1a73a5d5e7307402c7a3c6c1a80c63297b441125c38e23729da6473e5dc332e4e7201df25ff6c8b9918b262e56a31bebe13e093e6f4dba47a771961358cedf6d740732425cb708a633d538dcdc12ef7b49ce76aa270f50dd7cc1b879f1d7b19c6ac3b891fe4e20fb7645b7567237775881de7d30ba754d495ffe8ee751d1cfee1c661a2dbf13a53ff1bcf8085b39f6508fbf37137ebad659665fe5fcc67eef02970a44ac675e28103bd10f2045983d5adaa909b18b70a909b08b76c21b2798830276068d0ebd27303985bb5f3e681219a50bc761b7630587743768cf61922804d195e265aaaabb4740a2c5d7e8ff4e1c19cfb534d345f537e95e948591557f3136da617657e24d1904be373f5e7d63af330b837bcc662cbcd801eb436dbbeb714469d227e9f17e118db39eeb42e45455e6daf4d8fe0e19c4457b596c20e1ef8d235b230018a58e1c66c52c7317094aa5797f50a3b5ebe2be2abd1a04d907fbb68919956d7b0939ac0195a3f3bd3eb6f08eef67a895807768250172ec6bb2b35c9962de03df847170472b73981c04f2aef03721554c818ec9eb7f625d1a3fcdcf756adc4b6fd61950724ac2164a94df70f4aa1cc36c51dd2c3b6545c6c2233544254f6a24e6a170918fd0c533734ef859fed3c5d6f1f9acf8d3b77804c98fa5f1429763ebe860a77380a1e94626b46d88e5263855a0a0d226eb7ca64824c9a06acda851e650e6b035c04e27de61cd49ff49ac3ea3407440f9e76ce47c02301c1bc9c28befe0cd1f5b999961b055ffb39e2f451302aaedc5d779da03830bda1ed3ba9be4f23b2381096f3dc60c84a91ba0aa44242cc6aa361e2ecac867a2d1ef6868199ecb3004aa62bd56683c3476a9bd3f0316905e4f83ef5a907d9796231b9f506c82c09c739513a0db04467a071dcc34cb11bbba8cd3f1870174e04160ae74c2160a61a7c472e8edc51e969a2f0fb47cee59b67d401ecb13b06f72dcfb24f5850b8921b8bad14f7c6bd123c13b3a2ea1761fc425066ba107d61e96d2fa9b3ed88befec93578495ef4c7a1eb95d76679d1f5261f0202e1de881c5c5b1fb44f471a75a305d86df1123cd83c8bc9449c73cf34dbd247111c873bc1fc7948863bb59f2ac3d7129c2e7c3e0ef94afb38a01b3e42f83f42a5cc8e14cbe53c0c8d76768cdc98bef921aaca60204519b516d4c9de7cf581eec8a53faa2e2d96722d0ef2c23d5567ba48104890534cd84432565236cb3402504e0feb6c25426c52d2b2b42f10a007cdd38b540cf64a96ee784deb2b595deb4a9497f9a25ab06eab443010b66e7decc162dcbd7de12737d72a46ec0b8151e1ed42716af2c7602692d7c0ea757bc056c89d2640773a4c3c1a2297c87c13676e414003ff3af0d1abb87ba618e24a4dfe05c0b4443bda53d26c7e30f0dec498d9091074fe3444e81b9a4d8d7acc8b1e38f6afc63540a4e8880fd73bd34bc3563cc0a98bd35ce7455d5cf8a114bc2fe2fb9a58e725cc121e4e242fc0a9a8e38615bda67fd9f158e718154eb51d0ec3d941426933e36fba1db0d7b59d52be90aa796895e6a49fed0a7887b8d7c71a9aa023a8dc73391e3d1bfc746cde9f964d99625900624a8eb300f2d7d2f8703f470776088f27aaa72e7607dcd78cf63754cec00db23bb36beb48cffb20a06df884f101a9</span>
c <span class="token operator">=</span> <span class="token number">0x26c6b16ed40253ff31bdcd502d63230a9655f29599cfb41a29f10e700589e6a13a8c78f483e0aa8b9353fa258a1437ba15e8d2c8bb2b090a6887740b31d71550745611fabd087904f150b4d928d155a7fcdd1a64c7349ce984dfd08c4c795e93b409f53c1458e6de777dc5993198f4c0648381116fe5cbafa57499d9ce685c625df4797afc344e8fe4a0fc36cf82ba1423c8a4ad7a33bc4cbab25e2df729085f96d3d9d542d981fa46cac8a37ceb70b9f808213845c06b72be7e2d1224e4dc02817bd474c690e43f6d8f1916a20f2e078bfaa604343d695e6f5f88d9f11c43a886ff97d9bd26b0126af40bed8e03a43bf8c912b5b0dd2f9f2e7e99db066759f573cd59a40a554bebdd3e7e0adbc38fcb91adeb72f9dcd30558b082471a02fd9131a61cf29b1f4e38a5d689d8dcd0b8dc29075e3a33b2d6a25bee6ff9e20d269cc088a2b155be76a1531ce30b25edf928990b5143fc5ae2737d8d4070d0517f5137c458d7afed8f51e2c2973dd143235c9deaffe9ce8fbcd767a93573399dafd5ef61408c77302c993354a080684cdbfb7c1eeb6e6be907db790038c7ce62517815d16fe366bd26178f2f05b9e56450814f4ba7ab6cab54c5f78316b0451057785c03a77c20814eb405cd20e5bff5247a12500dd16173125ffdef4fb6317ab942d0d7e0e584a8fd97a8ba8d87fd38127d6d059902a2d48dafd10938ea5d108f3eb986aabf9e212151b0e540bb5fd25888143633be9982395d4d3bef5278be37328e0239569eb511698ef7f9e7e12aa204cb4c069ffcdeecb65f42ba37f7bfd47c4ba8df384a88adf3486b58cc1620185ac81dfb10f591fc82f3ae046341ebd1e8288f10500d6677e91b89729dfd299b74be13a9183725aacb0023f4fb01efda61390b0312d90ff6a9a319433681ad1811efe038fcdeb6dc1c3f594c4f8011aacfee74ea9638fccb3d669435a1208578c934277caa3ec74f9efbb33e024909b121e7b4e48ec94b762fa9dcab8a1c11b86bb9db164c7655504d304661e04e95b0b356f5968334596fb11df95bbdcb3a6618f431c864658827662f760fc86b2136221bd50472dc19c4f177eb5edf7978760dc15150cfda0a3ea649cb672b8f37229298c6edcc630e3ac9a5f43f58a93ba8def335472f7ebdedd7715a27c4ea622344a949bec59af030455ed61911d53388022bd502e800b769ef499f94f02c96f486b40ce68dbdc42e5690ac2992bedf7f0ba384504c32cb00a25d4e125483003152e81ebe9c12d928627d7f14fc3fbdf5141addc477d5ae4f32e64dcb58a6e2cf955ad7ae54e1665b3199bd0fae36b9ec56c09ac00efc9d27e69a93f4e08652edc3340fa2c518d388ee4a005b9c83956b9139b98380f6925a1a4c3e64ff8d96f2827d0d8a25cc72a2c03a28e33871284b46e10c85f2ad75969b1d84e9d88bb4e05d</span>


<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>
<span class="token comment"># for k in range(3, 10):</span>
<span class="token comment">#     if iroot(n, k)[1]:</span>
<span class="token comment">#         print(iroot(n, k)[0])</span>
<span class="token comment">#         print(k)</span>
k <span class="token operator">=</span> <span class="token number">4</span> 
p <span class="token operator">=</span> <span class="token number">20935418603755826153357961486749000137883878122092541278485245382546346099923598569473814209357669395236788185259189925906627960621490996925200115559569329810746744675867738485473466021581185385430988547168263735484625716958718825113577345085361945421237478366338611831738408648424304228723729310335432168121087334054958276987167490905779911687736536416815227240962562460212183301435420718431023950641725670461044591993133883921646824589614644103106984493917214402278641218422432546374433956301830629567708335305598359150744372547912472684947785245810663217040977994966632748245272393755319650187559761562868158211001</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>
phi <span class="token operator">=</span> p <span class="token operator">**</span> <span class="token number">4</span> <span class="token operator">-</span> p <span class="token operator">**</span> <span class="token number">3</span>
d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment"># b'flag&#123;6354ce3ac23cdfeccf16eb1a53df4423&#125;'</span></code></pre>



                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">Handy</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://wusthandy.github.io/2021/11/05/october-summary/">https://wusthandy.github.io/2021/11/05/october-summary/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">Handy</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            <span class="chip bg-color">无标签</span>
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2021/12/12/wustctf2021-crypto-misc-wp/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/7.jpg" class="responsive-img" alt="记五道RSA">
                        
                        <span class="card-title">记五道RSA</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2021-12-12
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/writeup/" class="post-category">
                                    writeup
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2021/10/26/adversarial-defense-note/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/18.jpg" class="responsive-img" alt="Adversarial Defense Note">
                        
                        <span class="card-title">Adversarial Defense Note</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2021-10-26
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/note/" class="post-category">
                                    note
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>


<script src="//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
    MathJax.Hub.Config({
        tex2jax: {inlineMath: [['$', '$'], ['\(', '\)']]}
    });
</script>



    <footer class="page-footer bg-color">
    
        <link rel="stylesheet" href="/libs/aplayer/APlayer.min.css">
<style>
    .aplayer .aplayer-lrc p {
        
        display: none;
        
        font-size: 12px;
        font-weight: 700;
        line-height: 16px !important;
    }

    .aplayer .aplayer-lrc p.aplayer-lrc-current {
        
        display: none;
        
        font-size: 15px;
        color: #42b983;
    }

    
    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body {
        left: -66px !important;
    }

    .aplayer.aplayer-fixed.aplayer-narrow .aplayer-body:hover {
        left: 0px !important;
    }

    
</style>
<div class="">
    
    <div class="row">
        <meting-js class="col l8 offset-l2 m10 offset-m1 s12"
                   server="netease"
                   type="playlist"
                   id="2942228334"
                   fixed='true'
                   autoplay='false'
                   theme='#42b983'
                   loop='all'
                   order='random'
                   preload='auto'
                   volume='0.7'
                   list-folded='true'
        >
        </meting-js>
    </div>
</div>

<script src="/libs/aplayer/APlayer.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>

    
    <div class="container row center-align" style="margin-bottom: 15px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2021</span>
            
            <span id="year">2021</span>
            <a href="/about" target="_blank">Handy</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                class="white-color">59.1k</span>&nbsp;字
            
            
            
            
            
            <br>
            
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "2021";
                    var startMonth = "2";
                    var startDate = "4";
                    var startHour = "0";
                    var startMinute = "0";
                    var startSecond = "0";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            
            <br>
            
            <span id="icp"><img src="/medias/icp.png" style="vertical-align: text-bottom;" />
                <a href="/null" target="_blank">冀ICP备20016511号-1</a>
            </span>
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/WustHandy" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:wusthandy@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>







    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=821644097" class="tooltipped" target="_blank" data-tooltip="QQ联系我: 821644097" data-position="top" data-delay="50">
        <i class="fab fa-qq"></i>
    </a>







    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fas fa-rss"></i>
    </a>

</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="/libs/materialize/materialize.min.js"></script>
    <script src="/libs/masonry/masonry.pkgd.min.js"></script>
    <script src="/libs/aos/aos.js"></script>
    <script src="/libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="/js/matery.js"></script>

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    
    <script src="/libs/others/clicklove.js" async="async"></script>
    
    

    

    

    <!--腾讯兔小巢-->
    
    
    <script type="text/javascript" color="0,0,255"
        pointColor="0,0,255" opacity='0.7'
        zIndex="-1" count="99"
        src="/libs/background/canvas-nest.js"></script>
    

    

    
    <script type="text/javascript" src="/libs/background/ribbon-dynamic.js" async="async"></script>
    

    
    <script src="/libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
