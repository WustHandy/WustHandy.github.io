<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>记五道RSA</title>
      <link href="2021/12/12/wustctf2021-crypto-misc-wp/"/>
      <url>2021/12/12/wustctf2021-crypto-misc-wp/</url>
      
        <content type="html"><![CDATA[<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><p>零宽度字符隐写+emoji-aes</p><h2 id="py2"><a href="#py2" class="headerlink" title="py2"></a>py2</h2><pre class="language-bash" data-language="bash"><code class="language-bash">__import__<span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span>.system<span class="token punctuation">(</span><span class="token string">'/bin/sh'</span><span class="token punctuation">)</span></code></pre><h2 id="ezsteg"><a href="#ezsteg" class="headerlink" title="ezsteg"></a>ezsteg</h2><p>用stegsolve打开图片，在red plane 0通道发现G plane通道有东西。<br>保存Green plane 0的图片然后用stegsolve的Image Combiner功能进行对比。<br>发现了前一半flag还有后一半flag的提示是用QIM量化，步长为20。在github搜索QIM quantization搜到这个网址<br><a href="https://github.com/pl561/QuantizationIndexModulation/blob/master/qim.py">https://github.com/pl561/QuantizationIndexModulation/blob/master/qim.py</a><br>仿照里面的test_qim进行函数重写，发现结果里的msg_detected全是1和0，把所有的0都改成255，再保存成新的图片，得到后一半flag。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">my_test_qim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    delta <span class="token operator">=</span> <span class="token number">20</span>    qim <span class="token operator">=</span> QIM<span class="token punctuation">(</span>delta<span class="token punctuation">)</span>    y <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span><span class="token string">'./ezsteg.png'</span><span class="token punctuation">)</span>    z_detected<span class="token punctuation">,</span> msg_detected <span class="token operator">=</span> qim<span class="token punctuation">.</span>detect<span class="token punctuation">(</span>y<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>msg_detected<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>msg_detected<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>msg_detected<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">if</span> msg_detected<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>                    msg_detected<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">255</span>    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span><span class="token string">'flag.png'</span><span class="token punctuation">,</span> msg_detected<span class="token punctuation">)</span></code></pre><h2 id="babypcap"><a href="#babypcap" class="headerlink" title="babypcap"></a>babypcap</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># f=open('usbdata.txt','r')</span><span class="token comment"># fi=open('out.txt','w')</span><span class="token comment"># while 1:</span><span class="token comment">#     a=f.readline().strip()</span><span class="token comment">#     if a:</span><span class="token comment">#         if len(a)==8: # 鼠标流量的话len改为8</span><span class="token comment">#             out=''</span><span class="token comment">#             for i in range(0,len(a),2):</span><span class="token comment">#                 if i+2 != len(a):</span><span class="token comment">#                     out+=a[i]+a[i+1]+":"</span><span class="token comment">#                 else:</span><span class="token comment">#                     out+=a[i]+a[i+1]</span><span class="token comment">#             fi.write(out)</span><span class="token comment">#             fi.write('\n')</span><span class="token comment">#     else:</span><span class="token comment">#         break</span><span class="token comment"># fi.close()</span>nums <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>keys <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'out.txt'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'xy.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>posx <span class="token operator">=</span> <span class="token number">0</span>posy <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> line <span class="token keyword">in</span> keys<span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">12</span> <span class="token punctuation">:</span>        <span class="token keyword">continue</span>    x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>    y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> x <span class="token operator">></span> <span class="token number">127</span> <span class="token punctuation">:</span>        x <span class="token operator">-=</span> <span class="token number">256</span>    <span class="token keyword">if</span> y <span class="token operator">></span> <span class="token number">127</span> <span class="token punctuation">:</span>        y <span class="token operator">-=</span> <span class="token number">256</span>    posx <span class="token operator">+=</span> x    posy <span class="token operator">+=</span> y    btn_flag <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>  <span class="token comment"># 1 for left , 2 for right , 0 for nothing</span>    <span class="token keyword">if</span> btn_flag <span class="token operator">==</span> <span class="token number">2</span> <span class="token punctuation">:</span> <span class="token comment"># 1 代表左键</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>posx<span class="token punctuation">)</span><span class="token punctuation">)</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>posy<span class="token punctuation">)</span><span class="token punctuation">)</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="forensic"><a href="#forensic" class="headerlink" title="forensic"></a>forensic</h2><p>Volatility hashdump</p><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="checkin"><a href="#checkin" class="headerlink" title="checkin"></a>checkin</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token number">96316700053619982349826498082259844895063380240567022005928513915204024844540469555622671378420860794984950658042831492783861955562369157151421516119461394776198481138414957948098639517961692333468639614643929505462336976740245087790881358621201910998692556309218648061409226131514631759925556900619868423867</span>p <span class="token operator">=</span> <span class="token number">177239747994633072316370036717795850380946952732364574855526378691774946405888176887836729298576549186507345842031428239242107123560927684315092976659481316206341152868428190256155821018749939785354467611248296042929661619015242685527886041555723637417300791242768261681522882474858447747878003388616705422171</span>c <span class="token operator">=</span> <span class="token number">31249810030340024867701516253216124873798373762921285160326678130373368708545564162489355490838932695325242212478465783024384459580684925642281202270189855386158713050116222890609403658664009085600847194989625233217765205670373759181021708443179634537090066546973252972859914381008999790882607671941093099299</span>ni <span class="token operator">=</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span>m <span class="token operator">=</span> c <span class="token operator">*</span> ni <span class="token operator">%</span> p <span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="base"><a href="#base" class="headerlink" title="base"></a>base</h2><pre class="language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'zCN7zTIOntz8zCiPzsQQzCySltr8m9mJyCiMmsQMmPmRzwyPzdfBowzZ='</span>b_char <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/'</span>b <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> s<span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b_char<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">==</span> b_char<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">:</span>            b <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h2 id="random1"><a href="#random1" class="headerlink" title="random1"></a>random1</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># py2</span><span class="token keyword">import</span> random<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">144573683990296079611135474661197492569962285163118264304760128514378450625043070474838075626723354220121948920313400664358341070757676498630899262349227958025807395866103391135742530910291132519036950667849498017553807524999532071920009738654477379676790400942232810106883328105428161410721145229679023998881</span>c <span class="token operator">=</span> <span class="token number">140936410048438311250552166359315531524717850408136878422422753861467709727494132943441793325459384490656351395836085596063714127829696538515364822908513326788824368390411397265861249839989684310498194231709180660320399728106109349119244510966442534818280589033645304725341767217060885195904689618851168472021</span>res <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">237</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">206</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span>    <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">214</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span>    <span class="token number">249</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">171</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">249</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">26</span><span class="token punctuation">,</span> <span class="token number">52</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">234</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span>    <span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">207</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">56</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span>    <span class="token number">112</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token number">178</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token number">254</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">94</span><span class="token punctuation">,</span> <span class="token number">156</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span>    <span class="token number">252</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">245</span><span class="token punctuation">,</span> <span class="token number">231</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">63</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">210</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">226</span><span class="token punctuation">,</span>    <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">122</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">86</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">126</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">45</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span>    <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">57</span><span class="token punctuation">,</span> <span class="token number">84</span><span class="token punctuation">,</span> <span class="token number">169</span><span class="token punctuation">,</span> <span class="token number">82</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">244</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">62</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">25</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">248</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span>    <span class="token number">236</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">39</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">172</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span>    <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">35</span><span class="token punctuation">,</span> <span class="token number">242</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">]</span>seeds <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">9999</span><span class="token punctuation">,</span> <span class="token number">1247</span><span class="token punctuation">,</span> <span class="token number">5097</span><span class="token punctuation">,</span> <span class="token number">7717</span><span class="token punctuation">,</span> <span class="token number">7026</span><span class="token punctuation">,</span> <span class="token number">8398</span><span class="token punctuation">,</span> <span class="token number">961</span><span class="token punctuation">,</span> <span class="token number">3156</span><span class="token punctuation">,</span> <span class="token number">1271</span><span class="token punctuation">,</span> <span class="token number">7473</span><span class="token punctuation">,</span> <span class="token number">3669</span><span class="token punctuation">,</span> <span class="token number">6716</span><span class="token punctuation">,</span>    <span class="token number">7550</span><span class="token punctuation">,</span> <span class="token number">1426</span><span class="token punctuation">,</span> <span class="token number">8065</span><span class="token punctuation">,</span> <span class="token number">351</span><span class="token punctuation">,</span> <span class="token number">738</span><span class="token punctuation">,</span> <span class="token number">4057</span><span class="token punctuation">,</span> <span class="token number">877</span><span class="token punctuation">,</span> <span class="token number">4029</span><span class="token punctuation">,</span> <span class="token number">7606</span><span class="token punctuation">,</span> <span class="token number">1822</span><span class="token punctuation">,</span> <span class="token number">7749</span><span class="token punctuation">,</span> <span class="token number">7973</span><span class="token punctuation">,</span> <span class="token number">9666</span><span class="token punctuation">,</span>    <span class="token number">5927</span><span class="token punctuation">,</span> <span class="token number">7944</span><span class="token punctuation">,</span> <span class="token number">1240</span><span class="token punctuation">,</span> <span class="token number">8960</span><span class="token punctuation">,</span> <span class="token number">443</span><span class="token punctuation">,</span> <span class="token number">6349</span><span class="token punctuation">,</span> <span class="token number">5949</span><span class="token punctuation">,</span> <span class="token number">5913</span><span class="token punctuation">,</span> <span class="token number">2332</span><span class="token punctuation">,</span> <span class="token number">7255</span><span class="token punctuation">,</span> <span class="token number">5185</span><span class="token punctuation">,</span> <span class="token number">5504</span><span class="token punctuation">,</span>    <span class="token number">3499</span><span class="token punctuation">,</span> <span class="token number">8855</span><span class="token punctuation">,</span> <span class="token number">4183</span><span class="token punctuation">,</span> <span class="token number">8812</span><span class="token punctuation">,</span> <span class="token number">5865</span><span class="token punctuation">,</span> <span class="token number">4147</span><span class="token punctuation">,</span> <span class="token number">5091</span><span class="token punctuation">,</span> <span class="token number">4556</span><span class="token punctuation">,</span> <span class="token number">1968</span><span class="token punctuation">,</span> <span class="token number">5589</span><span class="token punctuation">,</span> <span class="token number">2481</span><span class="token punctuation">,</span> <span class="token number">3411</span><span class="token punctuation">,</span>    <span class="token number">514</span><span class="token punctuation">,</span> <span class="token number">589</span><span class="token punctuation">,</span> <span class="token number">8078</span><span class="token punctuation">,</span> <span class="token number">9590</span><span class="token punctuation">,</span> <span class="token number">1765</span><span class="token punctuation">,</span> <span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">4415</span><span class="token punctuation">,</span> <span class="token number">6603</span><span class="token punctuation">,</span> <span class="token number">3978</span><span class="token punctuation">,</span> <span class="token number">9215</span><span class="token punctuation">,</span> <span class="token number">5307</span><span class="token punctuation">,</span> <span class="token number">3804</span><span class="token punctuation">,</span> <span class="token number">1141</span><span class="token punctuation">,</span>    <span class="token number">6691</span><span class="token punctuation">,</span> <span class="token number">1760</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">7008</span><span class="token punctuation">,</span> <span class="token number">6165</span><span class="token punctuation">,</span> <span class="token number">9974</span><span class="token punctuation">,</span> <span class="token number">1194</span><span class="token punctuation">,</span> <span class="token number">3665</span><span class="token punctuation">,</span> <span class="token number">7579</span><span class="token punctuation">,</span> <span class="token number">1148</span><span class="token punctuation">,</span> <span class="token number">5786</span><span class="token punctuation">,</span> <span class="token number">6175</span><span class="token punctuation">,</span>    <span class="token number">1333</span><span class="token punctuation">,</span> <span class="token number">7932</span><span class="token punctuation">,</span> <span class="token number">8217</span><span class="token punctuation">,</span> <span class="token number">9058</span><span class="token punctuation">,</span> <span class="token number">5400</span><span class="token punctuation">,</span> <span class="token number">6527</span><span class="token punctuation">,</span> <span class="token number">6220</span><span class="token punctuation">,</span> <span class="token number">1111</span><span class="token punctuation">,</span> <span class="token number">4265</span><span class="token punctuation">,</span> <span class="token number">208</span><span class="token punctuation">,</span> <span class="token number">2191</span><span class="token punctuation">,</span> <span class="token number">9706</span><span class="token punctuation">,</span>    <span class="token number">1019</span><span class="token punctuation">,</span> <span class="token number">7249</span><span class="token punctuation">,</span> <span class="token number">7644</span><span class="token punctuation">,</span> <span class="token number">907</span><span class="token punctuation">,</span> <span class="token number">5679</span><span class="token punctuation">,</span> <span class="token number">3335</span><span class="token punctuation">,</span> <span class="token number">3181</span><span class="token punctuation">,</span> <span class="token number">5301</span><span class="token punctuation">,</span> <span class="token number">4977</span><span class="token punctuation">,</span> <span class="token number">2455</span><span class="token punctuation">,</span> <span class="token number">724</span><span class="token punctuation">,</span> <span class="token number">4447</span><span class="token punctuation">,</span> <span class="token number">3566</span><span class="token punctuation">,</span>    <span class="token number">9161</span><span class="token punctuation">,</span> <span class="token number">1289</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">3509</span><span class="token punctuation">,</span> <span class="token number">6305</span><span class="token punctuation">,</span> <span class="token number">8183</span><span class="token punctuation">,</span> <span class="token number">4024</span><span class="token punctuation">,</span> <span class="token number">2630</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">1822</span><span class="token punctuation">,</span> <span class="token number">8918</span><span class="token punctuation">,</span> <span class="token number">5595</span><span class="token punctuation">,</span> <span class="token number">6849</span><span class="token punctuation">,</span>    <span class="token number">2555</span><span class="token punctuation">,</span> <span class="token number">4221</span><span class="token punctuation">,</span> <span class="token number">3023</span><span class="token punctuation">,</span> <span class="token number">5828</span><span class="token punctuation">,</span> <span class="token number">5622</span><span class="token punctuation">,</span> <span class="token number">5812</span><span class="token punctuation">,</span> <span class="token number">2378</span><span class="token punctuation">,</span> <span class="token number">746</span><span class="token punctuation">,</span> <span class="token number">3608</span><span class="token punctuation">,</span> <span class="token number">822</span><span class="token punctuation">,</span> <span class="token number">4856</span><span class="token punctuation">,</span> <span class="token number">6987</span><span class="token punctuation">,</span> <span class="token number">9977</span><span class="token punctuation">,</span>    <span class="token number">5289</span><span class="token punctuation">,</span> <span class="token number">342</span><span class="token punctuation">,</span> <span class="token number">5418</span><span class="token punctuation">,</span> <span class="token number">9974</span><span class="token punctuation">,</span> <span class="token number">5291</span><span class="token punctuation">,</span> <span class="token number">6895</span><span class="token punctuation">,</span> <span class="token number">9663</span><span class="token punctuation">,</span> <span class="token number">3642</span><span class="token punctuation">,</span> <span class="token number">2965</span><span class="token punctuation">,</span> <span class="token number">8003</span><span class="token punctuation">,</span> <span class="token number">5830</span><span class="token punctuation">,</span> <span class="token number">6373</span><span class="token punctuation">,</span>    <span class="token number">3394</span><span class="token punctuation">,</span> <span class="token number">8308</span><span class="token punctuation">,</span> <span class="token number">6754</span><span class="token punctuation">,</span> <span class="token number">4843</span><span class="token punctuation">,</span> <span class="token number">2100</span><span class="token punctuation">,</span> <span class="token number">1355</span><span class="token punctuation">,</span> <span class="token number">5166</span><span class="token punctuation">,</span> <span class="token number">601</span><span class="token punctuation">,</span> <span class="token number">9987</span><span class="token punctuation">,</span> <span class="token number">8921</span><span class="token punctuation">,</span> <span class="token number">7563</span><span class="token punctuation">,</span> <span class="token number">2250</span><span class="token punctuation">,</span>    <span class="token number">9056</span><span class="token punctuation">,</span> <span class="token number">2873</span><span class="token punctuation">,</span> <span class="token number">7479</span><span class="token punctuation">,</span> <span class="token number">5508</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">]</span>dp <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>seeds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>seeds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    rands <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rands<span class="token punctuation">.</span>append<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    dp <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>rands<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>dp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>dp<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>n <span class="token operator">=</span> <span class="token number">144573683990296079611135474661197492569962285163118264304760128514378450625043070474838075626723354220121948920313400664358341070757676498630899262349227958025807395866103391135742530910291132519036950667849498017553807524999532071920009738654477379676790400942232810106883328105428161410721145229679023998881</span>c <span class="token operator">=</span> <span class="token number">140936410048438311250552166359315531524717850408136878422422753861467709727494132943441793325459384490656351395836085596063714127829696538515364822908513326788824368390411397265861249839989684310498194231709180660320399728106109349119244510966442534818280589033645304725341767217060885195904689618851168472021</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> n <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>dp <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>            q <span class="token operator">=</span> n <span class="token operator">//</span> p            phi <span class="token operator">=</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>            m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="random2"><a href="#random2" class="headerlink" title="random2"></a>random2</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> mt19937predictor <span class="token keyword">import</span> MT19937Predictorkeys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">74737492451949886796883447380</span><span class="token punctuation">,</span> <span class="token number">51358027370976380985099489502</span><span class="token punctuation">,</span> <span class="token number">412762483065178295255791439485932171376749700084</span><span class="token punctuation">,</span> <span class="token number">910689806</span><span class="token punctuation">,</span> <span class="token number">1149695904</span><span class="token punctuation">,</span> <span class="token number">3104053370</span><span class="token punctuation">,</span> <span class="token number">221975799</span><span class="token punctuation">,</span> <span class="token number">3823412020</span><span class="token punctuation">,</span> <span class="token number">958468189</span><span class="token punctuation">,</span> <span class="token number">3586356097</span><span class="token punctuation">,</span> <span class="token number">340817801</span><span class="token punctuation">,</span> <span class="token number">2878068849</span><span class="token punctuation">,</span> <span class="token number">2732757663</span><span class="token punctuation">,</span> <span class="token number">2018092082</span><span class="token punctuation">,</span> <span class="token number">1847897227</span><span class="token punctuation">,</span> <span class="token number">1759748212</span><span class="token punctuation">,</span> <span class="token number">1295396426</span><span class="token punctuation">,</span> <span class="token number">2794984001</span><span class="token punctuation">,</span> <span class="token number">4265922173</span><span class="token punctuation">,</span> <span class="token number">3532941962</span><span class="token punctuation">,</span> <span class="token number">3649453440</span><span class="token punctuation">,</span> <span class="token number">1086966694</span><span class="token punctuation">,</span> <span class="token number">2188196779</span><span class="token punctuation">,</span> <span class="token number">1036830362</span><span class="token punctuation">,</span> <span class="token number">3114332204</span><span class="token punctuation">,</span> <span class="token number">2720067903</span><span class="token punctuation">,</span> <span class="token number">3763019658</span><span class="token punctuation">,</span> <span class="token number">4220680032</span><span class="token punctuation">,</span> <span class="token number">1434665040</span><span class="token punctuation">,</span> <span class="token number">2867449357</span><span class="token punctuation">,</span> <span class="token number">327630472</span><span class="token punctuation">,</span> <span class="token number">4028025891</span><span class="token punctuation">,</span> <span class="token number">1107232876</span><span class="token punctuation">,</span> <span class="token number">1341894502</span><span class="token punctuation">,</span> <span class="token number">3410775936</span><span class="token punctuation">,</span> <span class="token number">792029308</span><span class="token punctuation">,</span> <span class="token number">2140406850</span><span class="token punctuation">,</span> <span class="token number">618481849</span><span class="token punctuation">,</span> <span class="token number">3329607978</span><span class="token punctuation">,</span> <span class="token number">1024829298</span><span class="token punctuation">,</span> <span class="token number">1620771375</span><span class="token punctuation">,</span> <span class="token number">1042727260</span><span class="token punctuation">,</span> <span class="token number">1141119170</span><span class="token punctuation">,</span> <span class="token number">2850063412</span><span class="token punctuation">,</span> <span class="token number">722634918</span><span class="token punctuation">,</span> <span class="token number">109575186</span><span class="token punctuation">,</span> <span class="token number">1993029882</span><span class="token punctuation">,</span> <span class="token number">2096912385</span><span class="token punctuation">,</span> <span class="token number">866181039</span><span class="token punctuation">,</span> <span class="token number">827908342</span><span class="token punctuation">,</span> <span class="token number">1718528485</span><span class="token punctuation">,</span> <span class="token number">1617437693</span><span class="token punctuation">,</span> <span class="token number">3893036959</span><span class="token punctuation">,</span> <span class="token number">2846991704</span><span class="token punctuation">,</span> <span class="token number">3366375532</span><span class="token punctuation">,</span> <span class="token number">2763086122</span><span class="token punctuation">,</span> <span class="token number">2690998389</span><span class="token punctuation">,</span> <span class="token number">1148589641</span><span class="token punctuation">,</span> <span class="token number">1571939581</span><span class="token punctuation">,</span> <span class="token number">2933947318</span><span class="token punctuation">,</span> <span class="token number">4121295833</span><span class="token punctuation">,</span> <span class="token number">3030689848</span><span class="token punctuation">,</span> <span class="token number">1790011374</span><span class="token punctuation">,</span> <span class="token number">109272014</span><span class="token punctuation">,</span> <span class="token number">121093659</span><span class="token punctuation">,</span> <span class="token number">4007439172</span><span class="token punctuation">,</span> <span class="token number">831512040</span><span class="token punctuation">,</span> <span class="token number">978840109</span><span class="token punctuation">,</span> <span class="token number">3000990210</span><span class="token punctuation">,</span> <span class="token number">3025633350</span><span class="token punctuation">,</span> <span class="token number">1335144143</span><span class="token punctuation">,</span> <span class="token number">4107810622</span><span class="token punctuation">,</span> <span class="token number">1035611013</span><span class="token punctuation">,</span> <span class="token number">3925921218</span><span class="token punctuation">,</span> <span class="token number">1398042454</span><span class="token punctuation">,</span> <span class="token number">1123546694</span><span class="token punctuation">,</span> <span class="token number">4161792772</span><span class="token punctuation">,</span> <span class="token number">1177640646</span><span class="token punctuation">,</span> <span class="token number">4066189210</span><span class="token punctuation">,</span> <span class="token number">2240592239</span><span class="token punctuation">,</span> <span class="token number">508327944</span><span class="token punctuation">,</span> <span class="token number">839225012</span><span class="token punctuation">,</span> <span class="token number">1605466793</span><span class="token punctuation">,</span> <span class="token number">2875695963</span><span class="token punctuation">,</span> <span class="token number">626270177</span><span class="token punctuation">,</span> <span class="token number">1371375933</span><span class="token punctuation">,</span> <span class="token number">11364760</span><span class="token punctuation">,</span> <span class="token number">3470778132</span><span class="token punctuation">,</span> <span class="token number">1706915094</span><span class="token punctuation">,</span> <span class="token number">1458410373</span><span class="token punctuation">,</span> <span class="token number">98854289</span><span class="token punctuation">,</span> <span class="token number">1392252258</span><span class="token punctuation">,</span> <span class="token number">1560427103</span><span class="token punctuation">,</span> <span class="token number">3615589636</span><span class="token punctuation">,</span> <span class="token number">147666569</span><span class="token punctuation">,</span> <span class="token number">1045773025</span><span class="token punctuation">,</span> <span class="token number">4263298490</span><span class="token punctuation">,</span> <span class="token number">3895751869</span><span class="token punctuation">,</span> <span class="token number">2691680307</span><span class="token punctuation">,</span> <span class="token number">1699526232</span><span class="token punctuation">,</span> <span class="token number">3685180876</span><span class="token punctuation">,</span> <span class="token number">729503966</span><span class="token punctuation">,</span> <span class="token number">554847696</span><span class="token punctuation">,</span> <span class="token number">1562590775</span><span class="token punctuation">,</span> <span class="token number">3563661002</span><span class="token punctuation">,</span> <span class="token number">963617489</span><span class="token punctuation">,</span> <span class="token number">3181526105</span><span class="token punctuation">,</span> <span class="token number">2184215744</span><span class="token punctuation">,</span> <span class="token number">2144648457</span><span class="token punctuation">,</span> <span class="token number">1109270973</span><span class="token punctuation">,</span> <span class="token number">3071342721</span><span class="token punctuation">,</span> <span class="token number">2842429183</span><span class="token punctuation">,</span> <span class="token number">668733579</span><span class="token punctuation">,</span> <span class="token number">1262667392</span><span class="token punctuation">,</span> <span class="token number">772190169</span><span class="token punctuation">,</span> <span class="token number">1000365415</span><span class="token punctuation">,</span> <span class="token number">3453506497</span><span class="token punctuation">,</span> <span class="token number">412844225</span><span class="token punctuation">,</span> <span class="token number">9975293</span><span class="token punctuation">,</span> <span class="token number">919025159</span><span class="token punctuation">,</span> <span class="token number">3317679250</span><span class="token punctuation">,</span> <span class="token number">2335686357</span><span class="token punctuation">,</span> <span class="token number">1608848888</span><span class="token punctuation">,</span> <span class="token number">2579223536</span><span class="token punctuation">,</span> <span class="token number">1816878070</span><span class="token punctuation">,</span> <span class="token number">3734808856</span><span class="token punctuation">,</span> <span class="token number">269077113</span><span class="token punctuation">,</span> <span class="token number">2396885783</span><span class="token punctuation">,</span> <span class="token number">1147867931</span><span class="token punctuation">,</span> <span class="token number">2331502665</span><span class="token punctuation">,</span> <span class="token number">2928315805</span><span class="token punctuation">,</span> <span class="token number">908907677</span><span class="token punctuation">,</span> <span class="token number">1009287219</span><span class="token punctuation">,</span> <span class="token number">1017406485</span><span class="token punctuation">,</span> <span class="token number">3870217028</span><span class="token punctuation">,</span> <span class="token number">1835376973</span><span class="token punctuation">,</span> <span class="token number">890949168</span><span class="token punctuation">,</span> <span class="token number">671845795</span><span class="token punctuation">,</span> <span class="token number">3380480668</span><span class="token punctuation">,</span> <span class="token number">4171623559</span><span class="token punctuation">,</span> <span class="token number">1662988401</span><span class="token punctuation">,</span> <span class="token number">3709126631</span><span class="token punctuation">,</span> <span class="token number">2520677766</span><span class="token punctuation">,</span> <span class="token number">1660449390</span><span class="token punctuation">,</span> <span class="token number">120494599</span><span class="token punctuation">,</span> <span class="token number">907225530</span><span class="token punctuation">,</span> <span class="token number">3665272463</span><span class="token punctuation">,</span> <span class="token number">136171352</span><span class="token punctuation">,</span> <span class="token number">1758076339</span><span class="token punctuation">,</span> <span class="token number">3009587924</span><span class="token punctuation">,</span> <span class="token number">2866084549</span><span class="token punctuation">,</span> <span class="token number">3656368543</span><span class="token punctuation">,</span> <span class="token number">1692972691</span><span class="token punctuation">,</span> <span class="token number">714237605</span><span class="token punctuation">,</span> <span class="token number">892521830</span><span class="token punctuation">,</span> <span class="token number">1942496649</span><span class="token punctuation">,</span> <span class="token number">4241764492</span><span class="token punctuation">,</span> <span class="token number">930308540</span><span class="token punctuation">,</span> <span class="token number">3340229942</span><span class="token punctuation">,</span> <span class="token number">773043293</span><span class="token punctuation">,</span> <span class="token number">3514688079</span><span class="token punctuation">,</span> <span class="token number">1318180965</span><span class="token punctuation">,</span> <span class="token number">1669012263</span><span class="token punctuation">,</span> <span class="token number">3638042505</span><span class="token punctuation">,</span> <span class="token number">3025395295</span><span class="token punctuation">,</span> <span class="token number">226129302</span><span class="token punctuation">,</span> <span class="token number">153479541</span><span class="token punctuation">,</span> <span class="token number">2764571825</span><span class="token punctuation">,</span> <span class="token number">3421587858</span><span class="token punctuation">,</span> <span class="token number">334668853</span><span class="token punctuation">,</span> <span class="token number">1330796170</span><span class="token punctuation">,</span> <span class="token number">218556632</span><span class="token punctuation">,</span> <span class="token number">972714166</span><span class="token punctuation">,</span> <span class="token number">922603164</span><span class="token punctuation">,</span> <span class="token number">4024647445</span><span class="token punctuation">,</span> <span class="token number">4233196368</span><span class="token punctuation">,</span> <span class="token number">1249046751</span><span class="token punctuation">,</span> <span class="token number">3667925019</span><span class="token punctuation">,</span> <span class="token number">2276336634</span><span class="token punctuation">,</span> <span class="token number">3644888947</span><span class="token punctuation">,</span> <span class="token number">1444996806</span><span class="token punctuation">,</span> <span class="token number">413210699</span><span class="token punctuation">,</span> <span class="token number">2208048223</span><span class="token punctuation">,</span> <span class="token number">3813568258</span><span class="token punctuation">,</span> <span class="token number">2345486173</span><span class="token punctuation">,</span> <span class="token number">487998086</span><span class="token punctuation">,</span> <span class="token number">477969329</span><span class="token punctuation">,</span> <span class="token number">3409170127</span><span class="token punctuation">,</span> <span class="token number">3568976035</span><span class="token punctuation">,</span> <span class="token number">3460493127</span><span class="token punctuation">,</span> <span class="token number">2697206478</span><span class="token punctuation">,</span> <span class="token number">1262489351</span><span class="token punctuation">,</span> <span class="token number">4011219190</span><span class="token punctuation">,</span> <span class="token number">1419296521</span><span class="token punctuation">,</span> <span class="token number">1307871567</span><span class="token punctuation">,</span> <span class="token number">270455245</span><span class="token punctuation">,</span> <span class="token number">4245043905</span><span class="token punctuation">,</span> <span class="token number">687578193</span><span class="token punctuation">,</span> <span class="token number">1070246561</span><span class="token punctuation">,</span> <span class="token number">185531160</span><span class="token punctuation">,</span> <span class="token number">2626503659</span><span class="token punctuation">,</span> <span class="token number">3372671141</span><span class="token punctuation">,</span> <span class="token number">3673238883</span><span class="token punctuation">,</span> <span class="token number">2542194104</span><span class="token punctuation">,</span> <span class="token number">4260369384</span><span class="token punctuation">,</span> <span class="token number">67076509</span><span class="token punctuation">,</span> <span class="token number">4164858072</span><span class="token punctuation">,</span> <span class="token number">3344428349</span><span class="token punctuation">,</span> <span class="token number">2674528215</span><span class="token punctuation">,</span> <span class="token number">2352981085</span><span class="token punctuation">,</span> <span class="token number">4188340133</span><span class="token punctuation">,</span> <span class="token number">2490407345</span><span class="token punctuation">,</span> <span class="token number">2277623345</span><span class="token punctuation">,</span> <span class="token number">578009254</span><span class="token punctuation">,</span> <span class="token number">589898778</span><span class="token punctuation">,</span> <span class="token number">2257425250</span><span class="token punctuation">,</span> <span class="token number">4264855682</span><span class="token punctuation">,</span> <span class="token number">3217088425</span><span class="token punctuation">,</span> <span class="token number">1918678675</span><span class="token punctuation">,</span> <span class="token number">2409396248</span><span class="token punctuation">,</span> <span class="token number">366216060</span><span class="token punctuation">,</span> <span class="token number">2318262020</span><span class="token punctuation">,</span> <span class="token number">2695905062</span><span class="token punctuation">,</span> <span class="token number">1588352782</span><span class="token punctuation">,</span> <span class="token number">1427064824</span><span class="token punctuation">,</span> <span class="token number">470125313</span><span class="token punctuation">,</span> <span class="token number">3305196643</span><span class="token punctuation">,</span> <span class="token number">1839661592</span><span class="token punctuation">,</span> <span class="token number">2584820258</span><span class="token punctuation">,</span> <span class="token number">299694866</span><span class="token punctuation">,</span> <span class="token number">4205679150</span><span class="token punctuation">,</span> <span class="token number">3105720803</span><span class="token punctuation">,</span> <span class="token number">2804340888</span><span class="token punctuation">,</span> <span class="token number">3893613342</span><span class="token punctuation">,</span> <span class="token number">733876896</span><span class="token punctuation">,</span> <span class="token number">232917987</span><span class="token punctuation">,</span> <span class="token number">2727309654</span><span class="token punctuation">,</span> <span class="token number">1790439074</span><span class="token punctuation">,</span> <span class="token number">1927738154</span><span class="token punctuation">,</span> <span class="token number">4017472905</span><span class="token punctuation">,</span> <span class="token number">1863059250</span><span class="token punctuation">,</span> <span class="token number">655457188</span><span class="token punctuation">,</span> <span class="token number">3759472447</span><span class="token punctuation">,</span> <span class="token number">4183317773</span><span class="token punctuation">,</span> <span class="token number">797877611</span><span class="token punctuation">,</span> <span class="token number">2699417810</span><span class="token punctuation">,</span> <span class="token number">803278050</span><span class="token punctuation">,</span> <span class="token number">3877877653</span><span class="token punctuation">,</span> <span class="token number">1586583099</span><span class="token punctuation">,</span> <span class="token number">3875432289</span><span class="token punctuation">,</span> <span class="token number">111221042</span><span class="token punctuation">,</span> <span class="token number">233407522</span><span class="token punctuation">,</span> <span class="token number">3347300855</span><span class="token punctuation">,</span> <span class="token number">3873882496</span><span class="token punctuation">,</span> <span class="token number">3741842610</span><span class="token punctuation">,</span> <span class="token number">717425034</span><span class="token punctuation">,</span> <span class="token number">2557158550</span><span class="token punctuation">,</span> <span class="token number">876205693</span><span class="token punctuation">,</span> <span class="token number">683472955</span><span class="token punctuation">,</span> <span class="token number">3676324193</span><span class="token punctuation">,</span> <span class="token number">758448123</span><span class="token punctuation">,</span> <span class="token number">1995439610</span><span class="token punctuation">,</span> <span class="token number">2943722151</span><span class="token punctuation">,</span> <span class="token number">1610689376</span><span class="token punctuation">,</span> <span class="token number">4230997558</span><span class="token punctuation">,</span> <span class="token number">802060680</span><span class="token punctuation">,</span> <span class="token number">2861576590</span><span class="token punctuation">,</span> <span class="token number">960427169</span><span class="token punctuation">,</span> <span class="token number">2361123516</span><span class="token punctuation">,</span> <span class="token number">2886027757</span><span class="token punctuation">,</span> <span class="token number">271492995</span><span class="token punctuation">,</span> <span class="token number">3597341957</span><span class="token punctuation">,</span> <span class="token number">1973308613</span><span class="token punctuation">,</span> <span class="token number">687254699</span><span class="token punctuation">,</span> <span class="token number">2103809719</span><span class="token punctuation">,</span> <span class="token number">1260885931</span><span class="token punctuation">,</span> <span class="token number">2906748062</span><span class="token punctuation">,</span> <span class="token number">873332944</span><span class="token punctuation">,</span> <span class="token number">3671891228</span><span class="token punctuation">,</span> <span class="token number">2490863425</span><span class="token punctuation">,</span> <span class="token number">274650518</span><span class="token punctuation">,</span> <span class="token number">990260178</span><span class="token punctuation">,</span> <span class="token number">989305697</span><span class="token punctuation">,</span> <span class="token number">3765783495</span><span class="token punctuation">,</span> <span class="token number">3579353903</span><span class="token punctuation">,</span> <span class="token number">1372910559</span><span class="token punctuation">,</span> <span class="token number">165320956</span><span class="token punctuation">,</span> <span class="token number">896735304</span><span class="token punctuation">,</span> <span class="token number">3564054930</span><span class="token punctuation">,</span> <span class="token number">2374613969</span><span class="token punctuation">,</span> <span class="token number">786938917</span><span class="token punctuation">,</span> <span class="token number">3955168292</span><span class="token punctuation">,</span> <span class="token number">2134822172</span><span class="token punctuation">,</span> <span class="token number">1403480802</span><span class="token punctuation">,</span> <span class="token number">1340392765</span><span class="token punctuation">,</span> <span class="token number">3154014116</span><span class="token punctuation">,</span> <span class="token number">1793814283</span><span class="token punctuation">,</span> <span class="token number">1981841272</span><span class="token punctuation">,</span> <span class="token number">1873394217</span><span class="token punctuation">,</span> <span class="token number">4217089972</span><span class="token punctuation">,</span> <span class="token number">3403224767</span><span class="token punctuation">,</span> <span class="token number">111486932</span><span class="token punctuation">,</span> <span class="token number">1370301502</span><span class="token punctuation">,</span> <span class="token number">1137722044</span><span class="token punctuation">,</span> <span class="token number">1454768737</span><span class="token punctuation">,</span> <span class="token number">2817161685</span><span class="token punctuation">,</span> <span class="token number">1373532601</span><span class="token punctuation">,</span> <span class="token number">88198402</span><span class="token punctuation">,</span> <span class="token number">1162901466</span><span class="token punctuation">,</span> <span class="token number">1764878443</span><span class="token punctuation">,</span> <span class="token number">3204368881</span><span class="token punctuation">,</span> <span class="token number">764246346</span><span class="token punctuation">,</span> <span class="token number">3192119660</span><span class="token punctuation">,</span> <span class="token number">876165427</span><span class="token punctuation">,</span> <span class="token number">4104033361</span><span class="token punctuation">,</span> <span class="token number">2154934077</span><span class="token punctuation">,</span> <span class="token number">1561430573</span><span class="token punctuation">,</span> <span class="token number">826991304</span><span class="token punctuation">,</span> <span class="token number">849458135</span><span class="token punctuation">,</span> <span class="token number">4188058136</span><span class="token punctuation">,</span> <span class="token number">1199351023</span><span class="token punctuation">,</span> <span class="token number">2127952015</span><span class="token punctuation">,</span> <span class="token number">2094038064</span><span class="token punctuation">,</span> <span class="token number">300699273</span><span class="token punctuation">,</span> <span class="token number">3378157804</span><span class="token punctuation">,</span> <span class="token number">6679715</span><span class="token punctuation">,</span> <span class="token number">559293910</span><span class="token punctuation">,</span> <span class="token number">3028818176</span><span class="token punctuation">,</span> <span class="token number">2490265745</span><span class="token punctuation">,</span> <span class="token number">3646800433</span><span class="token punctuation">,</span> <span class="token number">1746603729</span><span class="token punctuation">,</span> <span class="token number">1531309519</span><span class="token punctuation">,</span> <span class="token number">18564847</span><span class="token punctuation">,</span> <span class="token number">3452425344</span><span class="token punctuation">,</span> <span class="token number">1989426082</span><span class="token punctuation">,</span> <span class="token number">2251367880</span><span class="token punctuation">,</span> <span class="token number">1426356258</span><span class="token punctuation">,</span> <span class="token number">2425736463</span><span class="token punctuation">,</span> <span class="token number">1600248295</span><span class="token punctuation">,</span> <span class="token number">955344576</span><span class="token punctuation">,</span> <span class="token number">3502485031</span><span class="token punctuation">,</span> <span class="token number">1323390407</span><span class="token punctuation">,</span> <span class="token number">399691485</span><span class="token punctuation">,</span> <span class="token number">1835777771</span><span class="token punctuation">,</span> <span class="token number">1828335677</span><span class="token punctuation">,</span> <span class="token number">3348082301</span><span class="token punctuation">,</span> <span class="token number">3687268482</span><span class="token punctuation">,</span> <span class="token number">2457400649</span><span class="token punctuation">,</span> <span class="token number">3368374393</span><span class="token punctuation">,</span> <span class="token number">1119303358</span><span class="token punctuation">,</span> <span class="token number">1270433121</span><span class="token punctuation">,</span> <span class="token number">3059691677</span><span class="token punctuation">,</span> <span class="token number">2392910075</span><span class="token punctuation">,</span> <span class="token number">591224638</span><span class="token punctuation">,</span> <span class="token number">1311675618</span><span class="token punctuation">,</span> <span class="token number">4122050325</span><span class="token punctuation">,</span> <span class="token number">4014348903</span><span class="token punctuation">,</span> <span class="token number">2095907405</span><span class="token punctuation">,</span> <span class="token number">1519824911</span><span class="token punctuation">,</span> <span class="token number">2825776887</span><span class="token punctuation">,</span> <span class="token number">3354142321</span><span class="token punctuation">,</span> <span class="token number">1098235797</span><span class="token punctuation">,</span> <span class="token number">1481266867</span><span class="token punctuation">,</span> <span class="token number">1051367302</span><span class="token punctuation">,</span> <span class="token number">1263016096</span><span class="token punctuation">,</span> <span class="token number">1336057651</span><span class="token punctuation">,</span> <span class="token number">1683842359</span><span class="token punctuation">,</span> <span class="token number">4054448354</span><span class="token punctuation">,</span> <span class="token number">1491994207</span><span class="token punctuation">,</span> <span class="token number">1160110019</span><span class="token punctuation">,</span> <span class="token number">3222808831</span><span class="token punctuation">,</span> <span class="token number">177510926</span><span class="token punctuation">,</span> <span class="token number">423347477</span><span class="token punctuation">,</span> <span class="token number">803602771</span><span class="token punctuation">,</span> <span class="token number">2683641253</span><span class="token punctuation">,</span> <span class="token number">2919035439</span><span class="token punctuation">,</span> <span class="token number">2485161789</span><span class="token punctuation">,</span> <span class="token number">3378544338</span><span class="token punctuation">,</span> <span class="token number">1610409532</span><span class="token punctuation">,</span> <span class="token number">1545641821</span><span class="token punctuation">,</span> <span class="token number">546762619</span><span class="token punctuation">,</span> <span class="token number">2395983270</span><span class="token punctuation">,</span> <span class="token number">3838745031</span><span class="token punctuation">,</span> <span class="token number">789177414</span><span class="token punctuation">,</span> <span class="token number">2123719243</span><span class="token punctuation">,</span> <span class="token number">3476088109</span><span class="token punctuation">,</span> <span class="token number">1615713790</span><span class="token punctuation">,</span> <span class="token number">1335041829</span><span class="token punctuation">,</span> <span class="token number">4006963851</span><span class="token punctuation">,</span> <span class="token number">1700197865</span><span class="token punctuation">,</span> <span class="token number">73798124</span><span class="token punctuation">,</span> <span class="token number">1251950799</span><span class="token punctuation">,</span> <span class="token number">2448692292</span><span class="token punctuation">,</span> <span class="token number">937465221</span><span class="token punctuation">,</span> <span class="token number">2191277155</span><span class="token punctuation">,</span> <span class="token number">2283183462</span><span class="token punctuation">,</span> <span class="token number">3235943428</span><span class="token punctuation">,</span> <span class="token number">1888733145</span><span class="token punctuation">,</span> <span class="token number">1637420644</span><span class="token punctuation">,</span> <span class="token number">2906472352</span><span class="token punctuation">,</span> <span class="token number">538528848</span><span class="token punctuation">,</span> <span class="token number">1787881095</span><span class="token punctuation">,</span> <span class="token number">2527345959</span><span class="token punctuation">,</span> <span class="token number">816324140</span><span class="token punctuation">,</span> <span class="token number">780626095</span><span class="token punctuation">,</span> <span class="token number">3958671235</span><span class="token punctuation">,</span> <span class="token number">1060151404</span><span class="token punctuation">,</span> <span class="token number">3939612973</span><span class="token punctuation">,</span> <span class="token number">720163439</span><span class="token punctuation">,</span> <span class="token number">3130037256</span><span class="token punctuation">,</span> <span class="token number">868218434</span><span class="token punctuation">,</span> <span class="token number">594717218</span><span class="token punctuation">,</span> <span class="token number">2378649142</span><span class="token punctuation">,</span> <span class="token number">630567292</span><span class="token punctuation">,</span> <span class="token number">272416131</span><span class="token punctuation">,</span> <span class="token number">2656750985</span><span class="token punctuation">,</span> <span class="token number">2254309115</span><span class="token punctuation">,</span> <span class="token number">398769631</span><span class="token punctuation">,</span> <span class="token number">144191385</span><span class="token punctuation">,</span> <span class="token number">3584257427</span><span class="token punctuation">,</span> <span class="token number">2276368553</span><span class="token punctuation">,</span> <span class="token number">4037163602</span><span class="token punctuation">,</span> <span class="token number">2651140730</span><span class="token punctuation">,</span> <span class="token number">2231274829</span><span class="token punctuation">,</span> <span class="token number">1953622167</span><span class="token punctuation">,</span> <span class="token number">4083152642</span><span class="token punctuation">,</span> <span class="token number">3006733661</span><span class="token punctuation">,</span> <span class="token number">929392152</span><span class="token punctuation">,</span> <span class="token number">843949652</span><span class="token punctuation">,</span> <span class="token number">2714951407</span><span class="token punctuation">,</span> <span class="token number">810363743</span><span class="token punctuation">,</span> <span class="token number">1283798592</span><span class="token punctuation">,</span> <span class="token number">3121903325</span><span class="token punctuation">,</span> <span class="token number">1988057118</span><span class="token punctuation">,</span> <span class="token number">356119324</span><span class="token punctuation">,</span> <span class="token number">1904222878</span><span class="token punctuation">,</span> <span class="token number">4044843055</span><span class="token punctuation">,</span> <span class="token number">112669104</span><span class="token punctuation">,</span> <span class="token number">868692487</span><span class="token punctuation">,</span> <span class="token number">1115920155</span><span class="token punctuation">,</span> <span class="token number">1623439582</span><span class="token punctuation">,</span> <span class="token number">488326378</span><span class="token punctuation">,</span> <span class="token number">148287535</span><span class="token punctuation">,</span> <span class="token number">3338996246</span><span class="token punctuation">,</span> <span class="token number">2166938666</span><span class="token punctuation">,</span> <span class="token number">3797453833</span><span class="token punctuation">,</span> <span class="token number">1474427255</span><span class="token punctuation">,</span> <span class="token number">1386753952</span><span class="token punctuation">,</span> <span class="token number">3317126798</span><span class="token punctuation">,</span> <span class="token number">2190807666</span><span class="token punctuation">,</span> <span class="token number">4259624962</span><span class="token punctuation">,</span> <span class="token number">3066765455</span><span class="token punctuation">,</span> <span class="token number">2382942891</span><span class="token punctuation">,</span> <span class="token number">4046402452</span><span class="token punctuation">,</span> <span class="token number">3243966738</span><span class="token punctuation">,</span> <span class="token number">1774858251</span><span class="token punctuation">,</span> <span class="token number">3181254579</span><span class="token punctuation">,</span> <span class="token number">2171453049</span><span class="token punctuation">,</span> <span class="token number">905778132</span><span class="token punctuation">,</span> <span class="token number">1409024919</span><span class="token punctuation">,</span> <span class="token number">4082347550</span><span class="token punctuation">,</span> <span class="token number">1308497825</span><span class="token punctuation">,</span> <span class="token number">3944454243</span><span class="token punctuation">,</span> <span class="token number">1681570359</span><span class="token punctuation">,</span> <span class="token number">3622008213</span><span class="token punctuation">,</span> <span class="token number">1130389974</span><span class="token punctuation">,</span> <span class="token number">3937594426</span><span class="token punctuation">,</span> <span class="token number">4193387111</span><span class="token punctuation">,</span> <span class="token number">4156444245</span><span class="token punctuation">,</span> <span class="token number">1665819644</span><span class="token punctuation">,</span> <span class="token number">4099931325</span><span class="token punctuation">,</span> <span class="token number">546382740</span><span class="token punctuation">,</span> <span class="token number">3459524364</span><span class="token punctuation">,</span> <span class="token number">3215392046</span><span class="token punctuation">,</span> <span class="token number">628790677</span><span class="token punctuation">,</span> <span class="token number">2460115724</span><span class="token punctuation">,</span> <span class="token number">4154656625</span><span class="token punctuation">,</span> <span class="token number">1738275004</span><span class="token punctuation">,</span> <span class="token number">372632247</span><span class="token punctuation">,</span> <span class="token number">3901053671</span><span class="token punctuation">,</span> <span class="token number">1968302733</span><span class="token punctuation">,</span> <span class="token number">1542557146</span><span class="token punctuation">,</span> <span class="token number">954360221</span><span class="token punctuation">,</span> <span class="token number">94489421</span><span class="token punctuation">,</span> <span class="token number">2526265974</span><span class="token punctuation">,</span> <span class="token number">3493620125</span><span class="token punctuation">,</span> <span class="token number">227040704</span><span class="token punctuation">,</span> <span class="token number">1966827767</span><span class="token punctuation">,</span> <span class="token number">2710288704</span><span class="token punctuation">,</span> <span class="token number">1777503765</span><span class="token punctuation">,</span> <span class="token number">3060587047</span><span class="token punctuation">,</span> <span class="token number">2922448684</span><span class="token punctuation">,</span> <span class="token number">1818271608</span><span class="token punctuation">,</span> <span class="token number">3774695159</span><span class="token punctuation">,</span> <span class="token number">198891092</span><span class="token punctuation">,</span> <span class="token number">1892315134</span><span class="token punctuation">,</span> <span class="token number">1988189925</span><span class="token punctuation">,</span> <span class="token number">1877360903</span><span class="token punctuation">,</span> <span class="token number">176031450</span><span class="token punctuation">,</span> <span class="token number">782372078</span><span class="token punctuation">,</span> <span class="token number">2630033970</span><span class="token punctuation">,</span> <span class="token number">222585085</span><span class="token punctuation">,</span> <span class="token number">1784220674</span><span class="token punctuation">,</span> <span class="token number">187019927</span><span class="token punctuation">,</span> <span class="token number">3793161227</span><span class="token punctuation">,</span> <span class="token number">275394451</span><span class="token punctuation">,</span> <span class="token number">3620112924</span><span class="token punctuation">,</span> <span class="token number">1046758031</span><span class="token punctuation">,</span> <span class="token number">794695465</span><span class="token punctuation">,</span> <span class="token number">4020417715</span><span class="token punctuation">,</span> <span class="token number">1036350909</span><span class="token punctuation">,</span> <span class="token number">1034143101</span><span class="token punctuation">,</span> <span class="token number">130770292</span><span class="token punctuation">,</span> <span class="token number">3376762604</span><span class="token punctuation">,</span> <span class="token number">3099991375</span><span class="token punctuation">,</span> <span class="token number">1317943524</span><span class="token punctuation">,</span> <span class="token number">538393453</span><span class="token punctuation">,</span> <span class="token number">1676278328</span><span class="token punctuation">,</span> <span class="token number">3728445031</span><span class="token punctuation">,</span> <span class="token number">2444153711</span><span class="token punctuation">,</span> <span class="token number">1294577644</span><span class="token punctuation">,</span> <span class="token number">3255702608</span><span class="token punctuation">,</span> <span class="token number">382221508</span><span class="token punctuation">,</span> <span class="token number">501348604</span><span class="token punctuation">,</span> <span class="token number">1545416914</span><span class="token punctuation">,</span> <span class="token number">4046130944</span><span class="token punctuation">,</span> <span class="token number">1518955393</span><span class="token punctuation">,</span> <span class="token number">3919525514</span><span class="token punctuation">,</span> <span class="token number">1729967634</span><span class="token punctuation">,</span> <span class="token number">2572204860</span><span class="token punctuation">,</span> <span class="token number">3777225961</span><span class="token punctuation">,</span> <span class="token number">1646036822</span><span class="token punctuation">,</span> <span class="token number">475018472</span><span class="token punctuation">,</span> <span class="token number">2247517569</span><span class="token punctuation">,</span> <span class="token number">4257731164</span><span class="token punctuation">,</span> <span class="token number">1111295866</span><span class="token punctuation">,</span> <span class="token number">524303023</span><span class="token punctuation">,</span> <span class="token number">3981652986</span><span class="token punctuation">,</span> <span class="token number">4072216404</span><span class="token punctuation">,</span> <span class="token number">3747688429</span><span class="token punctuation">,</span> <span class="token number">1885894640</span><span class="token punctuation">,</span> <span class="token number">833446526</span><span class="token punctuation">,</span> <span class="token number">3955045968</span><span class="token punctuation">,</span> <span class="token number">1703975805</span><span class="token punctuation">,</span> <span class="token number">1141801012</span><span class="token punctuation">,</span> <span class="token number">2437322873</span><span class="token punctuation">,</span> <span class="token number">2732846667</span><span class="token punctuation">,</span> <span class="token number">1371506834</span><span class="token punctuation">,</span> <span class="token number">669098384</span><span class="token punctuation">,</span> <span class="token number">1963802511</span><span class="token punctuation">,</span> <span class="token number">1542039</span><span class="token punctuation">,</span> <span class="token number">728580454</span><span class="token punctuation">,</span> <span class="token number">4041454310</span><span class="token punctuation">,</span> <span class="token number">1019581040</span><span class="token punctuation">,</span> <span class="token number">3144560205</span><span class="token punctuation">,</span> <span class="token number">1329189307</span><span class="token punctuation">,</span> <span class="token number">1043039655</span><span class="token punctuation">,</span> <span class="token number">1028345076</span><span class="token punctuation">,</span> <span class="token number">3541168610</span><span class="token punctuation">,</span> <span class="token number">2082983922</span><span class="token punctuation">,</span> <span class="token number">1305525731</span><span class="token punctuation">,</span> <span class="token number">1078333930</span><span class="token punctuation">,</span> <span class="token number">556043109</span><span class="token punctuation">,</span> <span class="token number">3570861415</span><span class="token punctuation">,</span> <span class="token number">1623319076</span><span class="token punctuation">,</span> <span class="token number">3514585273</span><span class="token punctuation">,</span> <span class="token number">223719132</span><span class="token punctuation">,</span> <span class="token number">4031808254</span><span class="token punctuation">,</span> <span class="token number">2549094947</span><span class="token punctuation">,</span> <span class="token number">3825858427</span><span class="token punctuation">,</span> <span class="token number">3214724358</span><span class="token punctuation">,</span> <span class="token number">1835103180</span><span class="token punctuation">,</span> <span class="token number">2471774591</span><span class="token punctuation">,</span> <span class="token number">2111554082</span><span class="token punctuation">,</span> <span class="token number">2948121215</span><span class="token punctuation">,</span> <span class="token number">1362405065</span><span class="token punctuation">,</span> <span class="token number">3765638194</span><span class="token punctuation">,</span> <span class="token number">491471279</span><span class="token punctuation">,</span> <span class="token number">2479158340</span><span class="token punctuation">,</span> <span class="token number">3749279021</span><span class="token punctuation">,</span> <span class="token number">3306251008</span><span class="token punctuation">,</span> <span class="token number">2577577664</span><span class="token punctuation">,</span> <span class="token number">1245538106</span><span class="token punctuation">,</span> <span class="token number">503105027</span><span class="token punctuation">,</span> <span class="token number">139202844</span><span class="token punctuation">,</span> <span class="token number">2287890849</span><span class="token punctuation">,</span> <span class="token number">3563168099</span><span class="token punctuation">,</span> <span class="token number">1467460138</span><span class="token punctuation">,</span> <span class="token number">3922094655</span><span class="token punctuation">,</span> <span class="token number">1903765924</span><span class="token punctuation">,</span> <span class="token number">3858903218</span><span class="token punctuation">,</span> <span class="token number">3343562703</span><span class="token punctuation">,</span> <span class="token number">2145132444</span><span class="token punctuation">,</span> <span class="token number">1134537221</span><span class="token punctuation">,</span> <span class="token number">2942539446</span><span class="token punctuation">,</span> <span class="token number">914603375</span><span class="token punctuation">,</span> <span class="token number">2155053085</span><span class="token punctuation">,</span> <span class="token number">2864704965</span><span class="token punctuation">,</span> <span class="token number">1971547127</span><span class="token punctuation">,</span> <span class="token number">1892432263</span><span class="token punctuation">,</span> <span class="token number">2604528206</span><span class="token punctuation">,</span> <span class="token number">3387176542</span><span class="token punctuation">,</span> <span class="token number">361652931</span><span class="token punctuation">,</span> <span class="token number">2305859318</span><span class="token punctuation">,</span> <span class="token number">1345198505</span><span class="token punctuation">,</span> <span class="token number">2416327840</span><span class="token punctuation">,</span> <span class="token number">887059258</span><span class="token punctuation">,</span> <span class="token number">3219763770</span><span class="token punctuation">,</span> <span class="token number">316636299</span><span class="token punctuation">,</span> <span class="token number">307065443</span><span class="token punctuation">,</span> <span class="token number">431437125</span><span class="token punctuation">,</span> <span class="token number">4279494318</span><span class="token punctuation">,</span> <span class="token number">220513368</span><span class="token punctuation">,</span> <span class="token number">2362459616</span><span class="token punctuation">,</span> <span class="token number">3712600310</span><span class="token punctuation">,</span> <span class="token number">2105434588</span><span class="token punctuation">,</span> <span class="token number">2938672182</span><span class="token punctuation">,</span> <span class="token number">3316109731</span><span class="token punctuation">,</span> <span class="token number">850677909</span><span class="token punctuation">,</span> <span class="token number">1593089633</span><span class="token punctuation">,</span> <span class="token number">1448569654</span><span class="token punctuation">,</span> <span class="token number">2885245137</span><span class="token punctuation">,</span> <span class="token number">3269946753</span><span class="token punctuation">,</span> <span class="token number">885150079</span><span class="token punctuation">,</span> <span class="token number">2358168430</span><span class="token punctuation">,</span> <span class="token number">1785698607</span><span class="token punctuation">,</span> <span class="token number">1757002566</span><span class="token punctuation">,</span> <span class="token number">197277094</span><span class="token punctuation">,</span> <span class="token number">47259139</span><span class="token punctuation">,</span> <span class="token number">2710959991</span><span class="token punctuation">,</span> <span class="token number">710476854</span><span class="token punctuation">,</span> <span class="token number">1929434500</span><span class="token punctuation">,</span> <span class="token number">1732169408</span><span class="token punctuation">,</span> <span class="token number">381305673</span><span class="token punctuation">,</span> <span class="token number">2982171232</span><span class="token punctuation">,</span> <span class="token number">486112880</span><span class="token punctuation">,</span> <span class="token number">3651033563</span><span class="token punctuation">,</span> <span class="token number">734915423</span><span class="token punctuation">,</span> <span class="token number">27291312</span><span class="token punctuation">,</span> <span class="token number">93262695</span><span class="token punctuation">,</span> <span class="token number">3206874794</span><span class="token punctuation">,</span> <span class="token number">1595912125</span><span class="token punctuation">,</span> <span class="token number">643556702</span><span class="token punctuation">,</span> <span class="token number">2929755197</span><span class="token punctuation">,</span> <span class="token number">1043917347</span><span class="token punctuation">,</span> <span class="token number">3181953869</span><span class="token punctuation">,</span> <span class="token number">3059173850</span><span class="token punctuation">,</span> <span class="token number">986850461</span><span class="token punctuation">,</span> <span class="token number">947059764</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token string">b'\xd1\xfb\xd3\xf0U\x14\x18\xa9Yf=\xa6\x7fJ\xd0aZ=\xf7\xf6\x1e]\xe7\x07\xbd\x0b\xc9\xf8\xe7k\xa7\x16\xc1Z:\xbf\xde\xea=3\xe0\x82\xf0\xca\xd2R\x91\xf5\x0f\xd1\x06\x99G\xf6\x8dh\x9c\x14Wi\xaf\xdbFL'</span>p <span class="token operator">=</span> MT19937Predictor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> i <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">or</span> i <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        p<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span>    <span class="token keyword">elif</span> i <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>        p<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        p<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>keys<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>p<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="rsa1"><a href="#rsa1" class="headerlink" title="rsa1"></a>rsa1</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sympy <span class="token keyword">import</span> Symbol<span class="token punctuation">,</span> solven <span class="token operator">=</span> <span class="token number">26305215103655644423271873654270896239286789695124090349749665534703077917412304839568833642664450313935099298310980853882272879981733372730292018544572625316902809164514982172181951319743072017697845536018391193871280565807620618786757590917994266113737303548654644579447152708491947981939693209377062932887079053535685222915049638973744785910187846488048054614595896905717548173503097932486976548606688284094985163387830871173351156872303901802063874643159872076045421856161697020709841563253543301088673347562874178275457662923268303751458373213379823091743254295392098852050657389100668196543581156089543387981749</span>s <span class="token operator">=</span> <span class="token number">4323761888398018609852335503896306767680254689118307249919076945474100280053222216117890335097280655812579700210142850972114032619375512508094444700268269861295454361479936323488734938967486887087065985770337167952405916865514342667568344884512919390473013721005783345127779614050256684329541419938215219111638334871769224566807758669615177139619330644265349270609231736366888506999373399354453570974856230273436956657673552797254044789898850371608837651642705304346761776584170067536342839950077554921714223414452726231759701672899981770205900654174771977192152231671555687060576625055995576371428030016472160229195</span>c <span class="token operator">=</span> <span class="token number">18524879875046454765780419291902161505187119049317257440202645362184543856980037891446139747396472606884190295519693050825702398302375035356073354030439092479076493350280491879942676232543272035009619776448668367631674751270025422471697604807309328948811730211796077194562605273068248003067084062604953180981092602825269082443194821795267533259542345280789423885313715011198756408238675212294964169231866750121782891392974982538883759460499654964916672646713561365268497621669918260512318121987464087203488943192447244656120553657904643768811055634526867642121977282747786019413676386087742587120310706285467632914627</span>s <span class="token operator">=</span> invert<span class="token punctuation">(</span>s<span class="token punctuation">,</span> n<span class="token punctuation">)</span>p <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>q <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">)</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token operator">*</span>q<span class="token operator">-</span>n<span class="token punctuation">,</span> <span class="token number">1314</span><span class="token operator">*</span>p<span class="token operator">-</span><span class="token number">520</span><span class="token operator">*</span>q<span class="token operator">-</span>s<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>q <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>q<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="rsa2"><a href="#rsa2" class="headerlink" title="rsa2"></a>rsa2</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">2387626545085756713585102877878108862015179080332961598635902226358817519910295819153349225103418927970241049968506375997</span>e <span class="token operator">=</span> <span class="token number">65537</span>c_mod_p <span class="token operator">=</span> <span class="token number">647648029783204084679833378591490303778808042166748545307033</span>c_mod_q <span class="token operator">=</span> <span class="token number">716978243624820144982668239669070880505037391756433243913335</span>p <span class="token operator">=</span> iroot<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">-=</span> <span class="token number">1</span>    <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>        q <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>        <span class="token keyword">if</span> p <span class="token operator">*</span> q <span class="token operator">==</span> n<span class="token punctuation">:</span>            <span class="token keyword">break</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token punctuation">(</span>c_mod_p<span class="token operator">*</span>invert<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token operator">*</span>q <span class="token operator">+</span> c_mod_q<span class="token operator">*</span>invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="rsa3"><a href="#rsa3" class="headerlink" title="rsa3"></a>rsa3</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> random <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">18896787369812506729161146792420582463075195289705130332145125441873359008259477778705050612028016445531171582699463469223129134497144553118164991259539504187512021208315754514545996574862689888723728779368278057158884309498791988824815380906489884221955569016913002047690134495021638325076324337204120358289197345473645253964897309936634674685256494467965994763346209088569312900310384221856890129638589708704488570062170587822159840004471847429651335596065845176922611177484979368701185198370143451554032097774883881063941164928195206151285053023900417539545188981446823285592433963817981924569149446287916824382561</span>d <span class="token operator">=</span> <span class="token number">5703031224919077324199739420591218709082873607810515782527403392203078685694557440606179655084946477198544985797529455998356213302699576058168444727748170549839026313064029609887624795981035801288838847172210685453187859645339376946854805971427795291607171515106310442975161667104581906887477593810523773846781119913091652230585316578697966956441025050411703279543735184615408372827086048067763849304020844971586419985599715291049252337301504847183917086038225366804009601071701854587257618991903027592792223359879103979050158387898497645317134119316587856020926045834487915948391807346208594166279941244305061329677</span>friend_keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">111697</span><span class="token punctuation">,</span> <span class="token number">106721</span><span class="token punctuation">,</span> <span class="token number">116423</span><span class="token punctuation">,</span> <span class="token number">88843</span><span class="token punctuation">,</span> <span class="token number">119159</span><span class="token punctuation">,</span> <span class="token number">70639</span><span class="token punctuation">,</span> <span class="token number">80819</span><span class="token punctuation">,</span> <span class="token number">74489</span><span class="token punctuation">,</span> <span class="token number">121931</span><span class="token punctuation">,</span> <span class="token number">101141</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token number">11994381627759026162899170243195205997473390753474105847444301599471367630328999329971554672898042711258332343414555886491105235450415874967500999777727188222201701790615800443999694661391161603608205580744046340685740132462956669428633202538875197708853419127000877908034155683418476839027176847825085191766500657063936087300707648173167638212184409940441341192494973780078520658057628747235702262261650533074207402665937459065342008813881483658655820794105733254390600096188629251786257035958039797032257689446780150685916517843665881340793492146980771808706103032498053602112046452376378597181639545983846067945876</span>e <span class="token operator">=</span> <span class="token number">0x10001</span><span class="token keyword">def</span> <span class="token function">getpq</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>k <span class="token operator">=</span> e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span>g <span class="token operator">=</span> randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">while</span> k <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>k <span class="token operator">=</span> k <span class="token operator">//</span> <span class="token number">2</span>temp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> k<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">if</span> gcd<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token keyword">and</span> temp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token keyword">return</span> gcd<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> n<span class="token punctuation">)</span>p <span class="token operator">=</span> getpq<span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pe <span class="token operator">=</span> friend_keys<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> e<span class="token punctuation">:</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="rsa4"><a href="#rsa4" class="headerlink" title="rsa4"></a>rsa4</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">18344208622226145563275332631675852812637974117269410580356372484730868630041087771967863177399468436907179629991713287958712918155881322973807806301979120718337971766642141160715457959104230009865832490334268400708057378872793969706058766934173901720807601381260226109710528613914848911497044918273137096903522367120819016923613011696956531078735040866726836147244627617752866449680818575750555372925099203864465221467261643732258403282300830500857008951036100240417305652712966271750963365056888669691476588673457169183575547654173584411488289083479722447529687480093984214874840116386641308648928664471249163053399</span>c <span class="token operator">=</span> <span class="token number">5799835212682670854600787421394304700766812650929331808305024781919809808414116741938033087654173522429848434831011913540857883976763801585735031494044357475999623804769581806159695530735320829983994397494910262812269266183428964227240479098342185016875916463463869275180539449912347431388217372994987664171819970167145891087464365899986673967607036447794731478364868669512779723692729123522060403205286021628536236794321362684707698114447595523828110511521587142146690874947566042115081767036515192408523157587036063428678576881221634685127738856946514330198100929281963428110917369571549814920857266365740708152342</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>p <span class="token operator">=</span> gcd<span class="token punctuation">(</span>n<span class="token punctuation">,</span> c<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pd <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">//</span> p <span class="token operator">//</span> <span class="token number">2021</span> <span class="token operator">//</span> <span class="token number">1211</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="rsa5"><a href="#rsa5" class="headerlink" title="rsa5"></a>rsa5</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">89114498420780604917531033169596392769455738343415866175560827716329038325885040230287167130153562721085218031290598924393710777384195303868086861588496841776165960494754159665639269842671254641757507534815336115279112577992964099982530678699389798633559364922445110277096686903849847611549099340416648410741</span>c1 <span class="token operator">=</span> <span class="token number">5735952141642500488957438428695439035757844707618704182655499843027856939311070755815954816072248816712526137792678092545003791094632649549645878951707384683857212799418894784114432305066187852999119421690587457065466839964716069311139937099286027346944058896149918834128185367804403864368930212475453509851</span>c2 <span class="token operator">=</span> <span class="token number">83661280370185647448453005460717066890991000188427326405001096935902371566724181207272659273801621639886691480155364009831593695466677783865595971645100536369801815619337129766823938463338128554716970036817952870569822208326583141745930557453969795334892493524974870629590649696998539807821542822600655060074</span>e1 <span class="token operator">=</span> <span class="token number">65536</span>e2 <span class="token operator">=</span> <span class="token number">270270</span>s <span class="token operator">=</span> gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    s1 <span class="token operator">=</span> <span class="token operator">-</span>s1    c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    s2 <span class="token operator">=</span> <span class="token operator">-</span>s2    c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">%</span> nm <span class="token operator">=</span> iroot<span class="token punctuation">(</span>m<span class="token punctuation">,</span> gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="rsa6"><a href="#rsa6" class="headerlink" title="rsa6"></a>rsa6</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token number">7925347972369425166024054435177230521701403766897655936389976238335255023323703665687524237012185378041937237193923196710161053156355234066441645319711183701842329620157704166371157650717222839619648271152128682372913126096365783687520564982937168484788081317675474463083132784582384187507869255885228857467817831476035971705449862080689947994230445839759775090629780928956469253251286916417455655651048075284914909735365261929381321728491210171149534927100638988443996951222567422983340301657352071004491710550791174969744159251674787486029098454525075603086354538724909971206057136959433644905534281024876827756696137754971560173166243058604302626662055704726217622510459832665465892627420770569017615057586162821398601805202941141301996106309483845544353310688985128566888120627304619788965507172962378342832673025236542745105311081361289182947417363008698994494622282298082815746490101801126669328319034060270856334194300252718523432106663273533374335697785044530801700554935518675122267487553622164033394485640597163056563842371857031514865235177157462198413279830879705708485929558610831286243249229145583827781884735083543818839971554442994288987473842873588257719658328581033891822672997846833635917945202914668666249069209</span>N <span class="token operator">=</span> <span class="token number">327704199063655154339194866047748377300483661546348646619543042402260458534101350044000928583250118734194187256215886625771489682622806492392158515139856977282405831771426953889407535449903946471081769989651651591222623997395529035591781660724645156930487601579241488206427939500937938255588575188735472745545946966631822161787569690670592431700668322671046133380934851245111908808167859798212265435088714280150547423032692815776965063410936310739819923896759441335001874930520763236975226711207654895127866843378461328154795776319242290600812698882674645791266238574096744538101900116337068936957681128459670057096430909525261047967406584507167977208793797870831858199445206260549902066723878612723426168458993576999172766781960053959813246897054556640370355234535221471564607870502627719243185861171079980645221020435603883953809425799723857745727457620742919434348781413514988026742127568571934186958953140598517500511323011929458037325804993377002532922851586492715993738894057370890612824581248076082409851337738126905208244299232520865145447167051764102587067960512092944943632792165293701233755265831135001570237083525408605939160927853199431652266761149838259483979450360702066085191758469080084577999970704509262494734276631</span>e1 <span class="token operator">=</span> <span class="token number">113093816717144841270493376736752441673022256694148583901036760385290294469429291287395932962657459627279948131588586212784590640516333875415213429718659370434377813079419901793552309461703882586527503420999488191213528380154291270445702806410792319417099800769397301837093257916765727595155732721396733301006197816845511287287300240373894663383088203656193754454195781571647148298850615901090657526494250418115895409707363373152838151538570469978232752856573089149548109243765929129792122940993776991512134978235283946198861884114007985343254462515565194689101887047325062995222232830812585485386335674066695574712424013748788932584416194906037669948036361191560447424191340446408227050317480535979753006991332324053550385053870295648784077492339350541225982286056281016618014141105366605422149895221611592416532345771815704307846206281439784932410973601384402414039900782254330313269415078960064305344681778478762050176778461863907418405687378915582516510150832198276943089812715818203025913800315465878924192853193803827276622946514235810979197716378589261982901063684489176009723390727783448898996904743318965120718829513279206531437783722261301609689797505310206968838386508504975439758618002450017650730285740872724819939789165</span>e2 <span class="token operator">=</span> <span class="token number">52078480224223317668569462543933564802023331503631866060760905823225375689371194081168967121103174053841803074696022983040703342927472417376159406035704091279470236253461384492704221051191760736060554344469790547031831005280443071825906849136068345545676606027290833620827164313993131618431323752276734358952300945077463041766652124937491934577599675761171103129304421215868699904698815021459210815711145905970197203457821690991062538955208578611369077013345454745776462370445888778852408762328672347603381098296861114748964667016949680885383533471825896084968002739256577852020182053683898979088285241943075282763120057336283443785884582655033693855047579690620713987723203443968343939397180233749872965864492970538352607580127433388577728197382785447538830263277945571714749460381851739146671950305422054343439472788329964959190357803126824073890041111240661865272585084722373190936827940607158935817277773095693778187682594957687156914929123683762234852584982077245872009863739187381156755686726633110551567659009061033997083241163551489323473968854060108298085327929582165884662155874639976829347066561636002017516485007419416446064739412984229663151827434850017915971108388331662865610040555809970494140145365617095067391830661</span>a <span class="token operator">=</span> <span class="token number">0.198</span>  <span class="token comment"># 811./4097</span>M1 <span class="token operator">=</span> N<span class="token operator">**</span><span class="token number">0.5</span>M2 <span class="token operator">=</span> N<span class="token operator">**</span><span class="token punctuation">(</span>a <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>D <span class="token operator">=</span> diagonal_matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span>N<span class="token punctuation">,</span> M1<span class="token punctuation">,</span> M2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>M <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span>N<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> e1<span class="token punctuation">,</span> <span class="token operator">-</span>e1<span class="token punctuation">,</span> <span class="token operator">-</span>e1 <span class="token operator">*</span> N<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> e2<span class="token punctuation">,</span> <span class="token operator">-</span>e2 <span class="token operator">*</span> N<span class="token punctuation">]</span><span class="token punctuation">,</span>                <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> e1 <span class="token operator">*</span> e2<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> DL <span class="token operator">=</span> M<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>t <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>x <span class="token operator">=</span> t <span class="token operator">*</span> M<span class="token operator">**</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>phi <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">/</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> e1<span class="token punctuation">)</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>October Summary</title>
      <link href="2021/11/05/october-summary/"/>
      <url>2021/11/05/october-summary/</url>
      
        <content type="html"><![CDATA[<h2 id="XMAN夏令营TooooomanyRSA"><a href="#XMAN夏令营TooooomanyRSA" class="headerlink" title="XMAN夏令营TooooomanyRSA"></a>XMAN夏令营TooooomanyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token keyword">from</span> uuid <span class="token keyword">import</span> uuid4flag <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">"flag&#123;"</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"&#125;"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">init_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    elist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>inverse<span class="token punctuation">(</span>getPrime<span class="token punctuation">(</span><span class="token number">810</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> gcd<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        elist<span class="token punctuation">.</span>append<span class="token punctuation">(</span>e<span class="token punctuation">)</span>    <span class="token keyword">return</span> elist<span class="token punctuation">,</span> nm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>elist<span class="token punctuation">,</span> n <span class="token operator">=</span> init_key<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c ="</span><span class="token punctuation">,</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">65537</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"elist ="</span><span class="token punctuation">,</span>elist<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''c = 8836441252076834545813477411326425375032267123570785772864736522363289546687708899074336247215937510570504358003107825056501941030269383864118843746175337393654312850577439133664730484837119573532202639084658757820201188879766516909534973535998857651937119461057973385426395724145776918292561702292436605761423965907449269350234768599086801097764871812636671292354213601605096195311151373515090830120096932678276497558133279308072396732663178152322425868305886057431421961733257631788613513220162555655889179523511665784230205568552674460999865994501813783725694862606623394523003050895631252334230583883118073253764n = 13441675621853397537941552930565086940390470130815380172405483101963424807980457970171725987335576421109600777181124732686757429091494072838586546464238360449989289020069386272380414809945684476174566989775147057082001644921451704981593847572798324632557836313044339427816944052099264108168157879645492166128090320214880302941951710697142064976112121583858774576042442313128499340606412845822519283515566759147621860641682899507428800319575392348478145779271935852461866317025429591494415486087527357696348049367246280018948490128455131326723173717164420547870649041609012209503120621766999344338619628361309881504449elist = [6394785330485131407826851764944106702989306751661773111300134919431104584180613989558300377714349529400378558913602158291081082675430487235339914971012067566601890029839947493155254582899628788537164340404428811085870041808860483801729245083548201334366733631432145384161908034867977906516995215397817811827060338562939218932916441868066261899714398094644048582309184012571138467837154157300425982546397721016585389530109123133328761496692431696333697620772147165360784490956672563278919171793966890158893934190837756790824904679773847777676326932643265426451922272758626857050445979305022351126666958426400079653623, 1369139766594499502102339802022151306473260303306443944809840701670612636871224554225002168944819225437998598365160666841985968029088084698853903787370193867870645734160453072726844381549153136514381609762281206178008136789238144315497475817194151194572296755949819068715206908967557531534965163142405984337962331584669073736885280026972797963267782773986730500382181318371495017118704093918920704345311527651399811381295059334575066198160251659075954912595362620180554775651196811925899974337478484410958141839806933182849189323190130942495340593301630517690327831594714373018323154749642065080783334651101242699263, 5437175210613834481955163777766627983523303337501300230689357572042873091664083970990501546609837607847693632622863075171175573210124960851439677015543351005393752316875323874628271392021624688370950188978195558312943877934365491687668809500866579503310026982199641168879029765994054311638922866950503743682009008734748720854732986500921718042561188808728053600445110972992438469967649056256589175739478272363214764480549487083235779588504538469805052660174224984711215950503095920589943783308241737365123329897745808282472351927870398484175556134059702516479014529101233832019814273876515569307294857432779445820767]'''</span></code></pre><p><img src="https://img-blog.csdnimg.cn/20210807103613465.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2E1NTU1Njc4NzQ0,size_16,color_FFFFFF,t_70" alt="img"></p><p>根据论文中三个e的情况更改M矩阵及D矩阵</p><p>另外还需要更改a的值，a的值等于e的位数加一（即811），除以p*q的位数加一（即2049），保留三位小数。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invertc <span class="token operator">=</span> <span class="token number">8836441252076834545813477411326425375032267123570785772864736522363289546687708899074336247215937510570504358003107825056501941030269383864118843746175337393654312850577439133664730484837119573532202639084658757820201188879766516909534973535998857651937119461057973385426395724145776918292561702292436605761423965907449269350234768599086801097764871812636671292354213601605096195311151373515090830120096932678276497558133279308072396732663178152322425868305886057431421961733257631788613513220162555655889179523511665784230205568552674460999865994501813783725694862606623394523003050895631252334230583883118073253764</span>e2 <span class="token operator">=</span> <span class="token number">1369139766594499502102339802022151306473260303306443944809840701670612636871224554225002168944819225437998598365160666841985968029088084698853903787370193867870645734160453072726844381549153136514381609762281206178008136789238144315497475817194151194572296755949819068715206908967557531534965163142405984337962331584669073736885280026972797963267782773986730500382181318371495017118704093918920704345311527651399811381295059334575066198160251659075954912595362620180554775651196811925899974337478484410958141839806933182849189323190130942495340593301630517690327831594714373018323154749642065080783334651101242699263</span>e1 <span class="token operator">=</span> <span class="token number">6394785330485131407826851764944106702989306751661773111300134919431104584180613989558300377714349529400378558913602158291081082675430487235339914971012067566601890029839947493155254582899628788537164340404428811085870041808860483801729245083548201334366733631432145384161908034867977906516995215397817811827060338562939218932916441868066261899714398094644048582309184012571138467837154157300425982546397721016585389530109123133328761496692431696333697620772147165360784490956672563278919171793966890158893934190837756790824904679773847777676326932643265426451922272758626857050445979305022351126666958426400079653623</span>e3 <span class="token operator">=</span> <span class="token number">5437175210613834481955163777766627983523303337501300230689357572042873091664083970990501546609837607847693632622863075171175573210124960851439677015543351005393752316875323874628271392021624688370950188978195558312943877934365491687668809500866579503310026982199641168879029765994054311638922866950503743682009008734748720854732986500921718042561188808728053600445110972992438469967649056256589175739478272363214764480549487083235779588504538469805052660174224984711215950503095920589943783308241737365123329897745808282472351927870398484175556134059702516479014529101233832019814273876515569307294857432779445820767</span>N <span class="token operator">=</span> <span class="token number">13441675621853397537941552930565086940390470130815380172405483101963424807980457970171725987335576421109600777181124732686757429091494072838586546464238360449989289020069386272380414809945684476174566989775147057082001644921451704981593847572798324632557836313044339427816944052099264108168157879645492166128090320214880302941951710697142064976112121583858774576042442313128499340606412845822519283515566759147621860641682899507428800319575392348478145779271935852461866317025429591494415486087527357696348049367246280018948490128455131326723173717164420547870649041609012209503120621766999344338619628361309881504449</span>a <span class="token operator">=</span> <span class="token number">0.396</span><span class="token comment">#811/2049</span>M1<span class="token operator">=</span>N<span class="token operator">**</span><span class="token number">0.5</span>M2<span class="token operator">=</span> N<span class="token operator">**</span><span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1.5</span><span class="token punctuation">)</span>M3<span class="token operator">=</span>N<span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span>a<span class="token punctuation">)</span>D <span class="token operator">=</span> diagonal_matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token punctuation">[</span>N<span class="token operator">**</span><span class="token number">1.5</span><span class="token punctuation">,</span>N<span class="token punctuation">,</span>M2<span class="token punctuation">,</span>M1<span class="token punctuation">,</span>M2<span class="token punctuation">,</span>M3<span class="token punctuation">,</span>M3<span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>M<span class="token operator">=</span>matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>N<span class="token operator">**</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>N<span class="token punctuation">,</span>e1<span class="token operator">*</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token punctuation">,</span><span class="token operator">-</span>e2<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token operator">*</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>e2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e2<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e2<span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e2<span class="token operator">*</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e3<span class="token punctuation">,</span><span class="token operator">-</span>e3<span class="token operator">*</span>N<span class="token punctuation">,</span><span class="token operator">-</span>e3<span class="token operator">*</span>N<span class="token punctuation">,</span>e3<span class="token operator">*</span>N<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>e3<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>e1<span class="token operator">*</span>e3<span class="token operator">*</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e2<span class="token operator">*</span>e3<span class="token punctuation">,</span><span class="token operator">-</span>e2<span class="token operator">*</span>e3<span class="token operator">*</span>N<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span>e1<span class="token operator">*</span>e2<span class="token operator">*</span>e3<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>DL<span class="token operator">=</span>M<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>t<span class="token operator">=</span>vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>L<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>x<span class="token operator">=</span>t<span class="token operator">*</span>M<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>phi <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">/</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>e1<span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="山东省赛"><a href="#山东省赛" class="headerlink" title="山东省赛"></a>山东省赛</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256<span class="token keyword">import</span> random<span class="token keyword">import</span> string<span class="token keyword">import</span> binascii<span class="token keyword">import</span> os<span class="token keyword">from</span> secret <span class="token keyword">import</span> key<span class="token punctuation">,</span> secret<span class="token punctuation">,</span> flag<span class="token keyword">def</span> <span class="token function">proof_of_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">if</span> proof_of_work<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    exit<span class="token punctuation">(</span><span class="token string">"Exit..."</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    pad_length <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span>    <span class="token keyword">return</span> m <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> pad_length<span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>    <span class="token keyword">return</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>choice <span class="token operator">=</span> <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Guess the secret!\n1.return enc(pad(m + secret))\n2.check the secret'</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        choice <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Give me your choice: '</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">'1'</span><span class="token punctuation">:</span>            m <span class="token operator">=</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Give me your input (in hex): '</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>enc<span class="token punctuation">(</span>pad<span class="token punctuation">(</span>m <span class="token operator">+</span> secret<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> choice <span class="token operator">==</span> <span class="token string">'2'</span><span class="token punctuation">:</span>            ss <span class="token operator">=</span> <span class="token builtin">input</span><span class="token punctuation">(</span><span class="token string">'Give me your secret: '</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> binascii<span class="token punctuation">.</span>unhexlify<span class="token punctuation">(</span>ss<span class="token punctuation">)</span> <span class="token operator">==</span> secret<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'here is your flag'</span><span class="token punctuation">,</span> flag<span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!'</span><span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'wrong!'</span><span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token comment"># -*- coding:utf-8 -*-</span><span class="token comment"># author:nothing</span><span class="token keyword">import</span> string<span class="token punctuation">,</span> re<span class="token punctuation">,</span> random<span class="token keyword">import</span> os <span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256<span class="token keyword">from</span> binascii <span class="token keyword">import</span> unhexlify<span class="token punctuation">,</span> hexlify<span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>io <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">"101.34.215.5"</span><span class="token punctuation">,</span> <span class="token number">6666</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">passpow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>msg <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me XXXX:"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>bottom <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r"\+(.*?)\)"</span><span class="token punctuation">,</span>msg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>res <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r" == (.*?)\n"</span><span class="token punctuation">,</span>msg<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>answer <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cipher <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token punctuation">(</span>answer <span class="token operator">+</span> bottom<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> cipher <span class="token operator">==</span> res<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span>answer<span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>answer<span class="token punctuation">)</span><span class="token keyword">break</span><span class="token keyword">def</span> <span class="token function">solve_step_4</span><span class="token punctuation">(</span>level<span class="token punctuation">,</span> known<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span> <span class="token string">"Level %s"</span> <span class="token operator">%</span> <span class="token builtin">str</span><span class="token punctuation">(</span>level<span class="token punctuation">)</span><span class="token keyword">if</span><span class="token punctuation">(</span>level <span class="token operator">==</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> knownrecords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me your choice: "</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Give me your input (in hex): "</span><span class="token punctuation">)</span>tmpstr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token operator">-</span>level<span class="token punctuation">)</span> <span class="token operator">+</span> known <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>tmpstr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"encrypted msg: "</span><span class="token punctuation">)</span>s <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token keyword">print</span> <span class="token string">"Process: %s/256 %s %s"</span> <span class="token operator">%</span> <span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> tmpstr<span class="token punctuation">,</span> s<span class="token punctuation">)</span>records<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me your choice: "</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Give me your input (in hex): "</span><span class="token punctuation">)</span>tmpstr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token string">'a'</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token operator">-</span>level<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>tmpstr<span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"encrypted msg: "</span><span class="token punctuation">)</span>s <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>newknown <span class="token operator">=</span> known <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>records<span class="token punctuation">.</span>index<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"==========================="</span><span class="token keyword">print</span> newknown<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"==========================="</span><span class="token keyword">return</span> solve_step_4<span class="token punctuation">(</span>level<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> newknown<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>passpow<span class="token punctuation">(</span><span class="token punctuation">)</span>secret <span class="token operator">=</span> solve_step_4<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">""</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Give me your choice: "</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"Give me your secret: "</span><span class="token punctuation">)</span>io<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>hexlify<span class="token punctuation">(</span>secret<span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> io<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> flag</code></pre><h2 id="西南石油招新赛"><a href="#西南石油招新赛" class="headerlink" title="西南石油招新赛"></a>西南石油招新赛</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>flag  <span class="token operator">=</span> <span class="token string">'****************************'</span>flag <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"asfajgfbiagbwe"</span><span class="token punctuation">&#125;</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>m1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>e1e2 <span class="token operator">=</span> <span class="token number">3087</span>n <span class="token operator">=</span> p<span class="token operator">*</span>q<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token punctuation">)</span>flag1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e1<span class="token punctuation">,</span>n<span class="token punctuation">)</span>flag2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e2<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag1= '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag2= '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n= '</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>c1 <span class="token operator">=</span> <span class="token number">463634070971821449698012827631572665302589213868521491855038966879005784397309389922926838028598122795187584361359142761652619958273094398420314927073008031088375892957173280915904309949716842152249806486027920136603248454946737961650252641668562626310035983343018705370077783879047584582817271215517599531278507300104564011142229942160380563527291388260832749808727470291331902902518196932928128107067117198707209620169906575791373793854773799564060536121390593687449884988936522369331738199522700261116496965863870682295858957952661531894477603953742494526632841396338388879198270913523572980574440793543571757278020533565628285714358815083303489096524318164071888139412436112963845619981511061231001617406815056986634680975142352197476024575809514978857034477688443230263761729039797859697947454810551009108031457294164840611157524719173343259485881089252938664456637673337362424443150013961181619441267926981848009107466576314685961478748352388452114042115892243272514245081604607798243817586737546663059737344687130881861357423084448027959893402445303299089606081931041217035955143939567456782107203447898345284731038150377722447329202078375870541529539840051415759436083384408203659613313535094343772238691393447475364806171594</span>c2 <span class="token operator">=</span> <span class="token number">130959534275704453216282334815034647265875632781798750901627773826812657339274362406246297925411291822193191483409847323315110393729020700526946712786793380991675008128561863631081095222226285788412970362518398757423705216112313533155390315204875516645459370629706277876211656753247984282379731850770447978537855070379324935282789327428625259945250066774049650951465043700088958965762054418615838049340724639373351248933494355591934236360506778496741051064156771092798005112534162050165095430065000827916096893408569751085550379620558282942254606978819033885539221416335848319082054806148859427713144286777516251724474319613960327799643723278205969253636514684757409059003348229151341200451785288395596484563480261212963114071064979559812327582474674812225260616757099890896900340007990585501470484762752362734968297532533654846190900571017635959385883945858334995884341767905619567505341752047589731815868489295690574109758825021386698440670611361127170896689015108432408490763723594673299472336065575301681055583084547847733168801030191262122130369687497236959760366874106043801542493392227424890925595734150487586757484304609945827925762382889592743709682485229267604771944535469557860120878491329984792448597107256325783346904408</span>n <span class="token operator">=</span> <span class="token number">609305637099654478882754880905638123124918364116173050874864700996165096776233155524277418132679727857702738043786588380577485490575591029930152718828075976000078971987922107645530323356525126496562423491563365836491753476840795804040219013880969539154444387313029522565456897962200817021423704204077133003361140660038327458057898764857872645377236870759691588009666047187685654297678987435769051762120388537868493789773766688347724903911796741124237476823452505450704989455260077833828660552130714794889208291939055406292476845194489525212129635173284301782141617878483740788532998492403101324795726865866661786740345862631916793208037250277376942046905892342213663197755010315060990871143919384283302925469309777769989798197913048813940747488087191697903624669415774198027063997058701217124640082074789591591494106726857376728759663074734040755438623372683762856958888826373151815914621262862750497078245369680378038995425628467728412953392359090775734440671874387905724083226246587924716226512631671786591611586774947156657178654343092123117255372954798131265566301316033414311712092913492774989048057650627801991277862963173961355088082419091848569675686058581383542877982979697235829206442087786927939745804017455244315305118437</span><span class="token keyword">def</span> <span class="token function">rsa_gong_N_def</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>e1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>e2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span>    s <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>    s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s1 <span class="token operator">=</span> <span class="token operator">-</span>s1        c1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">elif</span> s2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token operator">-</span>s2        c2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> n    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">de</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    k <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> k <span class="token operator">&lt;</span> <span class="token number">1000</span><span class="token punctuation">:</span>        mm <span class="token operator">=</span> c <span class="token operator">+</span> n <span class="token operator">*</span> k        result<span class="token punctuation">,</span> flag <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>iroot<span class="token punctuation">(</span>mm<span class="token punctuation">,</span> e<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token boolean">True</span> <span class="token operator">==</span> flag<span class="token punctuation">:</span>            <span class="token keyword">return</span> result        k <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">for</span> e1 <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> e1e2<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> e1e2 <span class="token operator">%</span> e1 <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        e2 <span class="token operator">=</span> e1e2 <span class="token operator">//</span> e1        c <span class="token operator">=</span> rsa_gong_N_def<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>        e <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>        m1 <span class="token operator">=</span> de<span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>        <span class="token keyword">if</span> m1<span class="token punctuation">:</span>            flag <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token string">b"NSSCTF"</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>                <span class="token keyword">break</span></code></pre><h3 id="3"><a href="#3" class="headerlink" title="3"></a>3</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>flag <span class="token operator">=</span> <span class="token string">'******************'</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>m1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qflag1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> p<span class="token punctuation">,</span> n<span class="token punctuation">)</span>flag2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span> q<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag1= '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag2= '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n= '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>flag1 <span class="token operator">=</span> <span class="token number">17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span>flag2 <span class="token operator">=</span> <span class="token number">95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span>n <span class="token operator">=</span> <span class="token number">140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span></code></pre><p>Coppersmith定理：在一个e阶的mod n多项式f(x)中，如果有一个根小于$ n^{\frac{1}{e}} $，就可以运用一个O(log n)的算法求出这些根<br>$$<br>c_{1} = m ^ {p} \bmod n = m ^{p} \bmod p * q<br>$$</p><p>$$<br>c_{2} = m ^ {q} \bmod n = m ^{q} \bmod p * q<br>$$</p><p>费马定理：<br>$$<br>m ^ {p} \equiv m \bmod p<br>$$</p><p>$$<br>m ^ {q} \equiv m \bmod q<br>$$</p><p>所以：<br>$$<br>c_{1} = m + ip + xpq = m + ip<br>$$</p><p>$$<br>c_{2} = m + jq + ypq = m + jq<br>$$</p><p>因此：<br>$$<br>c_{1} * c_{2} = m ^ {2} + (ip + iq)m + ijn<br>$$</p><p>$$<br>(c_{1} + c_{2})m = 2m^{2}+(ip+jq)m<br>$$</p><p>有：<br>$$<br>m^{2}-(c_{1}+c_{2})m+c1*c2=ijn\equiv0\bmod n<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>n<span class="token operator">=</span><span class="token number">140457323583824160338989317689698102738341061967768153879646505422358544720607476140977064053629005764551339082120337223672330979298373653766782620973454095507484118565884885623328751648660379894592063436924903894986994746394508539721459355200184089470977772075720319482839923856979166319700474349042326898971</span>c1<span class="token operator">=</span><span class="token number">17893542812755845772427795161304049467610774531005620109503081344099161906017295486868699578946474114607624347167976713200068059018517606363517478396368430072890681401898145302336139240273132723451063402106360810413024642916851746118524166947301681245568333254648265529408446609050354235727237078987509705857</span>c2<span class="token operator">=</span><span class="token number">95580409405085606847879727622943874726633827220524165744517624606566789614499137069562997931972825651309707390763700301965277040876322904891716953565845966918293178547100704981251056401939781365264616997055296773593435626490578886752446381493929807909671245959154990639046333135728431707979143972145708806954</span>PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>m<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> m<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span><span class="token punctuation">(</span>c1<span class="token operator">+</span>c2<span class="token punctuation">)</span><span class="token operator">*</span>m<span class="token operator">+</span>c1<span class="token operator">*</span>c2x0 <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span></code></pre><h2 id="楚慧杯"><a href="#楚慧杯" class="headerlink" title="楚慧杯"></a>楚慧杯</h2><h3 id="Easy-RSA"><a href="#Easy-RSA" class="headerlink" title="Easy-RSA"></a>Easy-RSA</h3><p>n：27552304606229034903366058815849954030287648695063385362955432137790872571412035824128918674719247737295565001575991597519270789776408208970323808016733976338433371328100880898942106515627607388226912870981180215883273805491209461671730377099185278711453949265641966582563910708529619185885928310168288810488784242368160743359666583499117949407921812317700250240067929572558785431071173411100434109661677786734923283679392823901052633992456780285091988542875991410528415886437666510014123352497264017734716859350294159440761760921548702546470902740121962033241003215821780125194400741190925169397917247376657863011603<br>e：65537<br>c：8643831704675414121804983915084443744489969712473300784256427784417167322852556975560503484179280700293119974607254037642425650493676448134024809335297135239994950178868535219541095694358323044214971760829173918774094415933808417722001811285178546917655837402000771685507972240389565704149610032767242977174132826100177368764169367458684152505611469248099487912367364804360878611296860803835816266114046682291529593099394952245852157119233687981777202751472502060481232341206366584532964027749320641690448228420342308891797513656897566100268729012788419021059054907653832828437666012596894150751431936476816983845357<br>p-q：3216514606297172806828066063738105740383963382396892688569683235383985567043193404185955880509592930874764682428425994713750665248099953457550673860782324431970917492727256948066013701406000049963109681898567026552657377599263519201715733179565306750754520746601394738797021362510415215113118083969304423858</p><p>sympy解方程一把梭</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> Symbol<span class="token punctuation">,</span> solve<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">27552304606229034903366058815849954030287648695063385362955432137790872571412035824128918674719247737295565001575991597519270789776408208970323808016733976338433371328100880898942106515627607388226912870981180215883273805491209461671730377099185278711453949265641966582563910708529619185885928310168288810488784242368160743359666583499117949407921812317700250240067929572558785431071173411100434109661677786734923283679392823901052633992456780285091988542875991410528415886437666510014123352497264017734716859350294159440761760921548702546470902740121962033241003215821780125194400741190925169397917247376657863011603</span>e <span class="token operator">=</span> <span class="token number">65537</span>c <span class="token operator">=</span> <span class="token number">8643831704675414121804983915084443744489969712473300784256427784417167322852556975560503484179280700293119974607254037642425650493676448134024809335297135239994950178868535219541095694358323044214971760829173918774094415933808417722001811285178546917655837402000771685507972240389565704149610032767242977174132826100177368764169367458684152505611469248099487912367364804360878611296860803835816266114046682291529593099394952245852157119233687981777202751472502060481232341206366584532964027749320641690448228420342308891797513656897566100268729012788419021059054907653832828437666012596894150751431936476816983845357</span>s <span class="token operator">=</span>  <span class="token number">3216514606297172806828066063738105740383963382396892688569683235383985567043193404185955880509592930874764682428425994713750665248099953457550673860782324431970917492727256948066013701406000049963109681898567026552657377599263519201715733179565306750754520746601394738797021362510415215113118083969304423858</span><span class="token comment"># p = Symbol('p')</span><span class="token comment"># q = Symbol('q')</span><span class="token comment"># p, q = solve([p*q-n, p-q-s], [p,q])</span><span class="token comment"># print(p,q)</span>p <span class="token operator">=</span> <span class="token number">167604917202624171205562332547086795459018271995531662202392816766661852499967774267554085060619750182533064588995245441659492248123164548905239665224600839192261379211031757557080502863539123811164713057605073461933854926502162793803096063035806777877263036653498763650955936640215477205393488552237210705691</span>q <span class="token operator">=</span> <span class="token number">164388402596326998398734266483348689718634308613134769513823133531277866932924580863368129180110157251658299906566819446945741582875064595447688991363818514760290461718304500609014489162133123761201603375706506435381197548902899274601380329856241471126508515906897368912158915277705061990280370468267906281833</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;9c0532a253809f180747b6da334b438f&#125;'</span></code></pre><h3 id="EasyRandom"><a href="#EasyRandom" class="headerlink" title="EasyRandom"></a>EasyRandom</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> getrandbits<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256flag<span class="token operator">=</span>flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>flag<span class="token operator">=</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"hex"</span><span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">48</span><span class="token keyword">def</span> <span class="token function">affine</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span>randList<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    tmp<span class="token operator">=</span>getrandbits<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>    randList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token keyword">print</span> randListn1<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">^</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>tmp<span class="token operator">=</span>urandom<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>n2<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token number">38</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">print</span> sha256<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>n3<span class="token operator">=</span><span class="token string">""</span><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">[</span><span class="token number">38</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>    n3<span class="token operator">+=</span>affine<span class="token punctuation">(</span>i<span class="token punctuation">)</span>n3<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>n3<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span>res<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>n1<span class="token operator">&lt;&lt;</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span>n2<span class="token operator">&lt;&lt;</span><span class="token number">40</span><span class="token punctuation">)</span><span class="token operator">+</span>n3<span class="token punctuation">)</span><span class="token operator">^</span>getrandbits<span class="token punctuation">(</span><span class="token number">192</span><span class="token punctuation">)</span><span class="token keyword">print</span> res<span class="token comment"># randList=[3693014292L, 1999090277L, 2812362804L, 2118249952L, 885988212L, 1131999143L, 3327925205L, 731275596L, 1818780432L, 644434032L, 3301077903L, 1004325730L, 113617890L, 262927352L, 1449581419L, 1596910105L, 3680959953L, 4039323321L, 2422810127L, 946521915L, 4049336142L, 1299247828L, 3361233447L, 1319347681L, 2858084207L, 2493466845L, 522894151L, 3272590535L, 2518746559L, 113976089L, 1912521614L, 1971657011L, 4052443472L, 1928327357L, 1481517158L, 1707968618L, 3946904293L, 3941277234L, 1740669853L, 177473759L, 2855945159L, 3217808064L, 568887441L, 2243547768L, 533475147L, 4005163087L, 1991762580L, 1175403787L, 1819485104L, 4162426193L, 2480060730L, 1889558541L, 1659122908L, 2343813603L, 1792751594L, 3287109162L, 4119020356L, 2086904766L, 4227102603L, 4251617926L, 386544361L, 2024596798L, 3275172220L, 1652143183L, 4279693598L, 1741714555L, 3920640884L, 837190820L, 4242688797L, 3406136725L, 272163458L, 1933729342L, 3348914742L, 3483202044L, 313505665L, 3180958891L, 276638359L, 2247257889L, 1283002827L, 253470155L, 2172073971L, 3333335918L, 321125332L, 3478202657L, 1298557332L, 1255183068L, 2347216752L, 1823003608L, 1873938039L, 4172493668L, 1252876713L, 2877329304L, 2733470437L, 743814046L, 1482554102L, 3967801003L, 4135521914L, 1601509876L, 1370623470L, 564556001L, 3369378190L, 1930652933L, 2684027015L, 730072119L, 3133537560L, 554522157L, 4200260396L, 66286223L, 2856462351L, 3409097597L, 1123352314L, 3112249875L, 660537433L, 1027164908L, 2875953843L, 3419766147L, 64818752L, 1572659846L, 176068922L, 2155262681L, 3154282688L, 3215591301L, 923444143L, 54743986L, 3011602372L, 1936525684L, 2636863705L, 3228231549L, 3660514246L, 2503374986L, 1180875896L, 941948277L, 1922552596L, 740696852L, 2337729160L, 1636823570L, 1788245610L, 2970204367L, 1597424641L, 3940594526L, 846332502L, 3177694219L, 1253960959L, 1980517147L, 2066843131L, 3452017677L, 743662084L, 3332614739L, 1230416894L, 1790783329L, 3339256849L, 1223003548L, 3155010716L, 211801309L, 3302823875L, 2203405123L, 4027118331L, 3928670766L, 1551556760L, 2018355543L, 2473765725L, 2451139992L, 3923372144L, 2197282188L, 2056399604L, 1294675076L, 1121984516L, 113881691L, 1646921221L, 3151728031L, 695534775L, 3870352246L, 1614457851L, 1764207471L, 3516853329L, 3276173646L, 3559299512L, 1239291648L, 2417317314L, 908861203L, 3945977517L, 1789725976L, 1094256533L, 1194981603L, 3817224425L, 4294621339L, 3041360046L, 1319794040L, 1881403289L, 151945988L, 3036988698L, 2214811128L, 240957157L, 509921068L, 1538884056L, 119208760L, 1425862614L, 2923918837L, 845827337L, 507023267L, 2955299274L, 1247972138L, 766611587L, 2012831811L, 3441161631L, 2645633381L, 2328705244L, 512481283L, 461960350L, 1704754200L, 1327914555L, 147555684L, 3349647800L, 3062151439L, 3090502250L, 937966533L, 82567652L, 725403325L, 4001427888L, 524069543L, 2291211027L, 2084465414L, 1292961088L, 4278389999L, 1309916992L, 3249380344L, 3493113838L, 83526738L, 4193860366L, 2438456426L, 3510215857L, 175761668L, 2820499306L, 1792194251L, 1225332544L, 3896268058L, 2752286952L, 3182785082L, 956435024L, 3996152048L, 2924148655L, 2895936126L, 1856977607L, 1289267397L, 690722358L, 1937429718L, 1531967867L, 2098208046L, 1815108525L, 1567735201L, 146084074L, 2093897143L, 2793246617L, 1146380003L, 2523936201L, 2301399576L, 2052473947L, 3470101770L, 3722302451L, 3345343326L, 2271545308L, 2657475692L, 2211989611L, 2428885922L, 2097052181L, 3554955904L, 1704837589L, 1494941216L, 3403108634L, 911409695L, 3550042769L, 379101531L, 406655201L, 1317011271L, 2336674904L, 3930303124L, 3038552846L, 3207659329L, 2785076651L, 1203119790L, 1146774748L, 2218279443L, 494710315L, 3507507044L, 922439915L, 35699688L, 2690622469L, 1458912003L, 3911367650L, 983115567L, 2813252332L, 839947939L, 514499603L, 3894529528L, 326817358L, 1479783722L, 4242051909L, 3492972915L, 3473946915L, 3348053727L, 3681386488L, 584266203L, 3531080708L, 3262223061L, 2904040234L, 3897643811L, 2706405422L, 914107260L, 3011659451L, 308811435L, 4103121550L, 4023430755L, 2975129044L, 4139500620L, 1763891748L, 57665971L, 3149249501L, 870034516L, 4142837134L, 3130156432L, 1708266697L, 1242161643L, 1163332264L, 108174709L, 1633896347L, 2820171620L, 1708875131L, 724124719L, 3562786877L, 518616285L, 3643662732L, 3375737681L, 2550728441L, 1823319080L, 1775922455L, 3838709569L, 177763087L, 946611206L, 4054832304L, 1473954380L, 3475817789L, 2590152780L, 3587873907L, 3437231816L, 2708036272L, 3883447173L, 655291275L, 707049339L, 1352718730L, 3543000675L, 962283943L, 4170075509L, 1897499376L, 643615933L, 856277089L, 3299581344L, 4093601146L, 2638625975L, 1563647962L, 890552183L, 3138216177L, 222946344L, 4219020514L, 3218803481L, 3093722090L, 1210144957L, 3499543439L, 4239553976L, 3582176749L, 654186756L, 3005601303L, 1252241368L, 2459425960L, 3587113096L, 3506651695L, 3673557784L, 4157576483L, 733173716L, 1505997631L, 394626148L, 1322270695L, 84604461L, 891267254L, 518241635L, 1068682198L, 3696554893L, 3111393676L, 1398539042L, 901276151L, 483471144L, 1952219546L, 2884270239L, 2215979688L, 4138748504L, 1623101775L, 3102260771L, 4276348310L, 1228132323L, 2250922664L, 833982365L, 3402246096L, 2085678412L, 2707953187L, 590837194L, 3421635592L, 3488064851L, 3655525766L, 1029679348L, 2448841196L, 89284911L, 3970560858L, 334986490L, 3063032848L, 3172506167L, 2391313449L, 3589023591L, 4269870234L, 3275101066L, 1716650872L, 483502324L, 2116979028L, 815078501L, 3475316209L, 1003463022L, 2418993968L, 4251101825L, 346290993L, 3286645593L, 2654742976L, 99974317L, 4124695845L, 3732280507L, 1536249568L, 1440486445L, 1605422491L, 393607563L, 1141210694L, 43848150L, 1656624711L, 2170355702L, 327988021L, 974870171L, 2169013815L, 3689546490L, 3576028106L, 4258679518L, 14944446L, 1786133397L, 264814384L, 1969519378L, 1769400868L, 3098042628L, 22547518L, 3195136230L, 42683806L, 1288550835L, 59638233L, 3534385409L, 2517101496L, 3632913591L, 3894777481L, 2912655780L, 1614602217L, 3498478791L, 1309795895L, 3961554801L, 3625321205L, 308138165L, 2885107341L, 1003378866L, 3462951062L, 1914176024L, 3130918711L, 3919345882L, 3556964414L, 2382442356L, 3968605965L, 2388890395L, 1955471760L, 2358533573L, 2323037969L, 4273118548L, 3577096972L, 4251790958L, 2321545863L, 2057106840L, 4000766037L, 1551111470L, 368761666L, 951769999L, 778229999L, 4235748487L, 2020142699L, 3577752281L, 1269488993L, 1350156870L, 529843408L, 669182431L, 3871401874L, 2180265713L, 3850183472L, 46915226L, 3150800412L, 1139932212L, 2523557119L, 1462042012L, 301258444L, 165757583L, 530704729L, 1848179734L, 1792342751L, 2597916820L, 4041946457L, 1127104524L, 3768573884L, 2614008065L, 741308521L, 477746986L, 507411825L, 4235293189L, 2251811519L, 811234592L, 1985999307L, 844715613L, 1640781314L, 3538036580L, 2764130557L, 2863454433L, 1831736583L, 3857379783L, 658928449L, 1149649578L, 103125751L, 2968446555L, 885660863L, 707321834L, 1728646363L, 2706995220L, 3062604255L, 4177710084L, 3076079677L, 879366858L, 3936728615L, 8828906L, 1656874220L, 2904085639L, 397694272L, 1604508691L, 2083663236L, 2138468690L, 1365350684L, 2870684769L, 384435793L, 1063724290L, 1142482048L, 809857977L, 4192515435L, 267878653L, 206018017L, 3441769173L, 925696591L, 2250932557L, 1973183700L, 577661907L, 2551314381L, 1350352597L, 4151551172L, 774849773L, 2391866106L, 3444137245L, 403261487L, 2724363448L, 3572536490L, 1077243504L, 302416473L, 3457548858L, 564604707L, 1238169871L, 2356838464L, 3083335214L, 3844937218L, 1272458074L, 1782962159L, 1543604321L, 3212537899L, 426074894L, 3053843067L, 2436223151L, 94019340L, 4147659323L, 2893920832L, 626619793L, 3976626567L, 1884877146L, 2696384440L, 1177352315L, 1082374195L, 3289271804L, 1485815836L, 120127000L, 3349349501L, 164243314L, 1703351326L, 1017276501L, 413737931L, 408060344L, 472141408L, 172738862L, 4001606849L, 1888805432L, 2927218529L, 1293362241L, 1941759619L, 1760659398L, 274865852L, 978985751L, 3867215904L, 177291528L, 1083045308L, 3888975618L, 979933689L, 2211634008L, 3899294132L, 1174569575L]</span><span class="token comment"># Hash='b0cfb7293d6842e3279f4ef0fc88284174349e111e5b9beb28263df72c9db0bf'</span><span class="token comment"># res=1045726758250168034320246515934682860724576730763168865120</span></code></pre><p>先用MT19937伪随机数预测出两个异或的数。因为tmp是urandom(3)，还给了sha256的结果，所以可以通过爆破得到tmp的值。异或之后得到(n1&lt;&lt;64)+(n2&lt;&lt;40)+n3的值，又根据位数可知正好错开了。取二进制的低40位为n3，爆破一下仿射密码得到flag16进制的最后十位。取中间一段为n2，和tmp异或一下得到flag16进制的中间6位。取前面一段异或一下得到flag16进制的前32位。把三部分拼起来再n2s得到最后的flag。</p><pre class="language-python" data-language="python"><code class="language-python">randist<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">3693014292</span><span class="token punctuation">,</span> <span class="token number">1999090277</span><span class="token punctuation">,</span> <span class="token number">2812362804</span><span class="token punctuation">,</span> <span class="token number">2118249952</span><span class="token punctuation">,</span> <span class="token number">885988212</span><span class="token punctuation">,</span> <span class="token number">1131999143</span><span class="token punctuation">,</span> <span class="token number">3327925205</span><span class="token punctuation">,</span> <span class="token number">731275596</span><span class="token punctuation">,</span> <span class="token number">1818780432</span><span class="token punctuation">,</span> <span class="token number">644434032</span><span class="token punctuation">,</span> <span class="token number">3301077903</span><span class="token punctuation">,</span> <span class="token number">1004325730</span><span class="token punctuation">,</span> <span class="token number">113617890</span><span class="token punctuation">,</span> <span class="token number">262927352</span><span class="token punctuation">,</span> <span class="token number">1449581419</span><span class="token punctuation">,</span> <span class="token number">1596910105</span><span class="token punctuation">,</span> <span class="token number">3680959953</span><span class="token punctuation">,</span> <span class="token number">4039323321</span><span class="token punctuation">,</span> <span class="token number">2422810127</span><span class="token punctuation">,</span> <span class="token number">946521915</span><span class="token punctuation">,</span> <span class="token number">4049336142</span><span class="token punctuation">,</span> <span class="token number">1299247828</span><span class="token punctuation">,</span> <span class="token number">3361233447</span><span class="token punctuation">,</span> <span class="token number">1319347681</span><span class="token punctuation">,</span> <span class="token number">2858084207</span><span class="token punctuation">,</span> <span class="token number">2493466845</span><span class="token punctuation">,</span> <span class="token number">522894151</span><span class="token punctuation">,</span> <span class="token number">3272590535</span><span class="token punctuation">,</span> <span class="token number">2518746559</span><span class="token punctuation">,</span> <span class="token number">113976089</span><span class="token punctuation">,</span> <span class="token number">1912521614</span><span class="token punctuation">,</span> <span class="token number">1971657011</span><span class="token punctuation">,</span> <span class="token number">4052443472</span><span class="token punctuation">,</span> <span class="token number">1928327357</span><span class="token punctuation">,</span> <span class="token number">1481517158</span><span class="token punctuation">,</span> <span class="token number">1707968618</span><span class="token punctuation">,</span> <span class="token number">3946904293</span><span class="token punctuation">,</span> <span class="token number">3941277234</span><span class="token punctuation">,</span> <span class="token number">1740669853</span><span class="token punctuation">,</span> <span class="token number">177473759</span><span class="token punctuation">,</span> <span class="token number">2855945159</span><span class="token punctuation">,</span> <span class="token number">3217808064</span><span class="token punctuation">,</span> <span class="token number">568887441</span><span class="token punctuation">,</span> <span class="token number">2243547768</span><span class="token punctuation">,</span> <span class="token number">533475147</span><span class="token punctuation">,</span> <span class="token number">4005163087</span><span class="token punctuation">,</span> <span class="token number">1991762580</span><span class="token punctuation">,</span> <span class="token number">1175403787</span><span class="token punctuation">,</span> <span class="token number">1819485104</span><span class="token punctuation">,</span> <span class="token number">4162426193</span><span class="token punctuation">,</span> <span class="token number">2480060730</span><span class="token punctuation">,</span> <span class="token number">1889558541</span><span class="token punctuation">,</span> <span class="token number">1659122908</span><span class="token punctuation">,</span> <span class="token number">2343813603</span><span class="token punctuation">,</span> <span class="token number">1792751594</span><span class="token punctuation">,</span> <span class="token number">3287109162</span><span class="token punctuation">,</span> <span class="token number">4119020356</span><span class="token punctuation">,</span> <span class="token number">2086904766</span><span class="token punctuation">,</span> <span class="token number">4227102603</span><span class="token punctuation">,</span> <span class="token number">4251617926</span><span class="token punctuation">,</span> <span class="token number">386544361</span><span class="token punctuation">,</span> <span class="token number">2024596798</span><span class="token punctuation">,</span> <span class="token number">3275172220</span><span class="token punctuation">,</span> <span class="token number">1652143183</span><span class="token punctuation">,</span> <span class="token number">4279693598</span><span class="token punctuation">,</span> <span class="token number">1741714555</span><span class="token punctuation">,</span> <span class="token number">3920640884</span><span class="token punctuation">,</span> <span class="token number">837190820</span><span class="token punctuation">,</span> <span class="token number">4242688797</span><span class="token punctuation">,</span> <span class="token number">3406136725</span><span class="token punctuation">,</span> <span class="token number">272163458</span><span class="token punctuation">,</span> <span class="token number">1933729342</span><span class="token punctuation">,</span> <span class="token number">3348914742</span><span class="token punctuation">,</span> <span class="token number">3483202044</span><span class="token punctuation">,</span> <span class="token number">313505665</span><span class="token punctuation">,</span> <span class="token number">3180958891</span><span class="token punctuation">,</span> <span class="token number">276638359</span><span class="token punctuation">,</span> <span class="token number">2247257889</span><span class="token punctuation">,</span> <span class="token number">1283002827</span><span class="token punctuation">,</span> <span class="token number">253470155</span><span class="token punctuation">,</span> <span class="token number">2172073971</span><span class="token punctuation">,</span> <span class="token number">3333335918</span><span class="token punctuation">,</span> <span class="token number">321125332</span><span class="token punctuation">,</span> <span class="token number">3478202657</span><span class="token punctuation">,</span> <span class="token number">1298557332</span><span class="token punctuation">,</span> <span class="token number">1255183068</span><span class="token punctuation">,</span> <span class="token number">2347216752</span><span class="token punctuation">,</span> <span class="token number">1823003608</span><span class="token punctuation">,</span> <span class="token number">1873938039</span><span class="token punctuation">,</span> <span class="token number">4172493668</span><span class="token punctuation">,</span> <span class="token number">1252876713</span><span class="token punctuation">,</span> <span class="token number">2877329304</span><span class="token punctuation">,</span> <span class="token number">2733470437</span><span class="token punctuation">,</span> <span class="token number">743814046</span><span class="token punctuation">,</span> <span class="token number">1482554102</span><span class="token punctuation">,</span> <span class="token number">3967801003</span><span class="token punctuation">,</span> <span class="token number">4135521914</span><span class="token punctuation">,</span> <span class="token number">1601509876</span><span class="token punctuation">,</span> <span class="token number">1370623470</span><span class="token punctuation">,</span> <span class="token number">564556001</span><span class="token punctuation">,</span> <span class="token number">3369378190</span><span class="token punctuation">,</span> <span class="token number">1930652933</span><span class="token punctuation">,</span> <span class="token number">2684027015</span><span class="token punctuation">,</span> <span class="token number">730072119</span><span class="token punctuation">,</span> <span class="token number">3133537560</span><span class="token punctuation">,</span> <span class="token number">554522157</span><span class="token punctuation">,</span> <span class="token number">4200260396</span><span class="token punctuation">,</span> <span class="token number">66286223</span><span class="token punctuation">,</span> <span class="token number">2856462351</span><span class="token punctuation">,</span> <span class="token number">3409097597</span><span class="token punctuation">,</span> <span class="token number">1123352314</span><span class="token punctuation">,</span> <span class="token number">3112249875</span><span class="token punctuation">,</span> <span class="token number">660537433</span><span class="token punctuation">,</span> <span class="token number">1027164908</span><span class="token punctuation">,</span> <span class="token number">2875953843</span><span class="token punctuation">,</span> <span class="token number">3419766147</span><span class="token punctuation">,</span> <span class="token number">64818752</span><span class="token punctuation">,</span> <span class="token number">1572659846</span><span class="token punctuation">,</span> <span class="token number">176068922</span><span class="token punctuation">,</span> <span class="token number">2155262681</span><span class="token punctuation">,</span> <span class="token number">3154282688</span><span class="token punctuation">,</span> <span class="token number">3215591301</span><span class="token punctuation">,</span> <span class="token number">923444143</span><span class="token punctuation">,</span> <span class="token number">54743986</span><span class="token punctuation">,</span> <span class="token number">3011602372</span><span class="token punctuation">,</span> <span class="token number">1936525684</span><span class="token punctuation">,</span> <span class="token number">2636863705</span><span class="token punctuation">,</span> <span class="token number">3228231549</span><span class="token punctuation">,</span> <span class="token number">3660514246</span><span class="token punctuation">,</span> <span class="token number">2503374986</span><span class="token punctuation">,</span> <span class="token number">1180875896</span><span class="token punctuation">,</span> <span class="token number">941948277</span><span class="token punctuation">,</span> <span class="token number">1922552596</span><span class="token punctuation">,</span> <span class="token number">740696852</span><span class="token punctuation">,</span> <span class="token number">2337729160</span><span class="token punctuation">,</span> <span class="token number">1636823570</span><span class="token punctuation">,</span> <span class="token number">1788245610</span><span class="token punctuation">,</span> <span class="token number">2970204367</span><span class="token punctuation">,</span> <span class="token number">1597424641</span><span class="token punctuation">,</span> <span class="token number">3940594526</span><span class="token punctuation">,</span> <span class="token number">846332502</span><span class="token punctuation">,</span> <span class="token number">3177694219</span><span class="token punctuation">,</span> <span class="token number">1253960959</span><span class="token punctuation">,</span> <span class="token number">1980517147</span><span class="token punctuation">,</span> <span class="token number">2066843131</span><span class="token punctuation">,</span> <span class="token number">3452017677</span><span class="token punctuation">,</span> <span class="token number">743662084</span><span class="token punctuation">,</span> <span class="token number">3332614739</span><span class="token punctuation">,</span> <span class="token number">1230416894</span><span class="token punctuation">,</span> <span class="token number">1790783329</span><span class="token punctuation">,</span> <span class="token number">3339256849</span><span class="token punctuation">,</span> <span class="token number">1223003548</span><span class="token punctuation">,</span> <span class="token number">3155010716</span><span class="token punctuation">,</span> <span class="token number">211801309</span><span class="token punctuation">,</span> <span class="token number">3302823875</span><span class="token punctuation">,</span> <span class="token number">2203405123</span><span class="token punctuation">,</span> <span class="token number">4027118331</span><span class="token punctuation">,</span> <span class="token number">3928670766</span><span class="token punctuation">,</span> <span class="token number">1551556760</span><span class="token punctuation">,</span> <span class="token number">2018355543</span><span class="token punctuation">,</span> <span class="token number">2473765725</span><span class="token punctuation">,</span> <span class="token number">2451139992</span><span class="token punctuation">,</span> <span class="token number">3923372144</span><span class="token punctuation">,</span> <span class="token number">2197282188</span><span class="token punctuation">,</span> <span class="token number">2056399604</span><span class="token punctuation">,</span> <span class="token number">1294675076</span><span class="token punctuation">,</span> <span class="token number">1121984516</span><span class="token punctuation">,</span> <span class="token number">113881691</span><span class="token punctuation">,</span> <span class="token number">1646921221</span><span class="token punctuation">,</span> <span class="token number">3151728031</span><span class="token punctuation">,</span> <span class="token number">695534775</span><span class="token punctuation">,</span> <span class="token number">3870352246</span><span class="token punctuation">,</span> <span class="token number">1614457851</span><span class="token punctuation">,</span> <span class="token number">1764207471</span><span class="token punctuation">,</span> <span class="token number">3516853329</span><span class="token punctuation">,</span> <span class="token number">3276173646</span><span class="token punctuation">,</span> <span class="token number">3559299512</span><span class="token punctuation">,</span> <span class="token number">1239291648</span><span class="token punctuation">,</span> <span class="token number">2417317314</span><span class="token punctuation">,</span> <span class="token number">908861203</span><span class="token punctuation">,</span> <span class="token number">3945977517</span><span class="token punctuation">,</span> <span class="token number">1789725976</span><span class="token punctuation">,</span> <span class="token number">1094256533</span><span class="token punctuation">,</span> <span class="token number">1194981603</span><span class="token punctuation">,</span> <span class="token number">3817224425</span><span class="token punctuation">,</span> <span class="token number">4294621339</span><span class="token punctuation">,</span> <span class="token number">3041360046</span><span class="token punctuation">,</span> <span class="token number">1319794040</span><span class="token punctuation">,</span> <span class="token number">1881403289</span><span class="token punctuation">,</span> <span class="token number">151945988</span><span class="token punctuation">,</span> <span class="token number">3036988698</span><span class="token punctuation">,</span> <span class="token number">2214811128</span><span class="token punctuation">,</span> <span class="token number">240957157</span><span class="token punctuation">,</span> <span class="token number">509921068</span><span class="token punctuation">,</span> <span class="token number">1538884056</span><span class="token punctuation">,</span> <span class="token number">119208760</span><span class="token punctuation">,</span> <span class="token number">1425862614</span><span class="token punctuation">,</span> <span class="token number">2923918837</span><span class="token punctuation">,</span> <span class="token number">845827337</span><span class="token punctuation">,</span> <span class="token number">507023267</span><span class="token punctuation">,</span> <span class="token number">2955299274</span><span class="token punctuation">,</span> <span class="token number">1247972138</span><span class="token punctuation">,</span> <span class="token number">766611587</span><span class="token punctuation">,</span> <span class="token number">2012831811</span><span class="token punctuation">,</span> <span class="token number">3441161631</span><span class="token punctuation">,</span> <span class="token number">2645633381</span><span class="token punctuation">,</span> <span class="token number">2328705244</span><span class="token punctuation">,</span> <span class="token number">512481283</span><span class="token punctuation">,</span> <span class="token number">461960350</span><span class="token punctuation">,</span> <span class="token number">1704754200</span><span class="token punctuation">,</span> <span class="token number">1327914555</span><span class="token punctuation">,</span> <span class="token number">147555684</span><span class="token punctuation">,</span> <span class="token number">3349647800</span><span class="token punctuation">,</span> <span class="token number">3062151439</span><span class="token punctuation">,</span> <span class="token number">3090502250</span><span class="token punctuation">,</span> <span class="token number">937966533</span><span class="token punctuation">,</span> <span class="token number">82567652</span><span class="token punctuation">,</span> <span class="token number">725403325</span><span class="token punctuation">,</span> <span class="token number">4001427888</span><span class="token punctuation">,</span> <span class="token number">524069543</span><span class="token punctuation">,</span> <span class="token number">2291211027</span><span class="token punctuation">,</span> <span class="token number">2084465414</span><span class="token punctuation">,</span> <span class="token number">1292961088</span><span class="token punctuation">,</span> <span class="token number">4278389999</span><span class="token punctuation">,</span> <span class="token number">1309916992</span><span class="token punctuation">,</span> <span class="token number">3249380344</span><span class="token punctuation">,</span> <span class="token number">3493113838</span><span class="token punctuation">,</span> <span class="token number">83526738</span><span class="token punctuation">,</span> <span class="token number">4193860366</span><span class="token punctuation">,</span> <span class="token number">2438456426</span><span class="token punctuation">,</span> <span class="token number">3510215857</span><span class="token punctuation">,</span> <span class="token number">175761668</span><span class="token punctuation">,</span> <span class="token number">2820499306</span><span class="token punctuation">,</span> <span class="token number">1792194251</span><span class="token punctuation">,</span> <span class="token number">1225332544</span><span class="token punctuation">,</span> <span class="token number">3896268058</span><span class="token punctuation">,</span> <span class="token number">2752286952</span><span class="token punctuation">,</span> <span class="token number">3182785082</span><span class="token punctuation">,</span> <span class="token number">956435024</span><span class="token punctuation">,</span> <span class="token number">3996152048</span><span class="token punctuation">,</span> <span class="token number">2924148655</span><span class="token punctuation">,</span> <span class="token number">2895936126</span><span class="token punctuation">,</span> <span class="token number">1856977607</span><span class="token punctuation">,</span> <span class="token number">1289267397</span><span class="token punctuation">,</span> <span class="token number">690722358</span><span class="token punctuation">,</span> <span class="token number">1937429718</span><span class="token punctuation">,</span> <span class="token number">1531967867</span><span class="token punctuation">,</span> <span class="token number">2098208046</span><span class="token punctuation">,</span> <span class="token number">1815108525</span><span class="token punctuation">,</span> <span class="token number">1567735201</span><span class="token punctuation">,</span> <span class="token number">146084074</span><span class="token punctuation">,</span> <span class="token number">2093897143</span><span class="token punctuation">,</span> <span class="token number">2793246617</span><span class="token punctuation">,</span> <span class="token number">1146380003</span><span class="token punctuation">,</span> <span class="token number">2523936201</span><span class="token punctuation">,</span> <span class="token number">2301399576</span><span class="token punctuation">,</span> <span class="token number">2052473947</span><span class="token punctuation">,</span> <span class="token number">3470101770</span><span class="token punctuation">,</span> <span class="token number">3722302451</span><span class="token punctuation">,</span> <span class="token number">3345343326</span><span class="token punctuation">,</span> <span class="token number">2271545308</span><span class="token punctuation">,</span> <span class="token number">2657475692</span><span class="token punctuation">,</span> <span class="token number">2211989611</span><span class="token punctuation">,</span> <span class="token number">2428885922</span><span class="token punctuation">,</span> <span class="token number">2097052181</span><span class="token punctuation">,</span> <span class="token number">3554955904</span><span class="token punctuation">,</span> <span class="token number">1704837589</span><span class="token punctuation">,</span> <span class="token number">1494941216</span><span class="token punctuation">,</span> <span class="token number">3403108634</span><span class="token punctuation">,</span> <span class="token number">911409695</span><span class="token punctuation">,</span> <span class="token number">3550042769</span><span class="token punctuation">,</span> <span class="token number">379101531</span><span class="token punctuation">,</span> <span class="token number">406655201</span><span class="token punctuation">,</span> <span class="token number">1317011271</span><span class="token punctuation">,</span> <span class="token number">2336674904</span><span class="token punctuation">,</span> <span class="token number">3930303124</span><span class="token punctuation">,</span> <span class="token number">3038552846</span><span class="token punctuation">,</span> <span class="token number">3207659329</span><span class="token punctuation">,</span> <span class="token number">2785076651</span><span class="token punctuation">,</span> <span class="token number">1203119790</span><span class="token punctuation">,</span> <span class="token number">1146774748</span><span class="token punctuation">,</span> <span class="token number">2218279443</span><span class="token punctuation">,</span> <span class="token number">494710315</span><span class="token punctuation">,</span> <span class="token number">3507507044</span><span class="token punctuation">,</span> <span class="token number">922439915</span><span class="token punctuation">,</span> <span class="token number">35699688</span><span class="token punctuation">,</span> <span class="token number">2690622469</span><span class="token punctuation">,</span> <span class="token number">1458912003</span><span class="token punctuation">,</span> <span class="token number">3911367650</span><span class="token punctuation">,</span> <span class="token number">983115567</span><span class="token punctuation">,</span> <span class="token number">2813252332</span><span class="token punctuation">,</span> <span class="token number">839947939</span><span class="token punctuation">,</span> <span class="token number">514499603</span><span class="token punctuation">,</span> <span class="token number">3894529528</span><span class="token punctuation">,</span> <span class="token number">326817358</span><span class="token punctuation">,</span> <span class="token number">1479783722</span><span class="token punctuation">,</span> <span class="token number">4242051909</span><span class="token punctuation">,</span> <span class="token number">3492972915</span><span class="token punctuation">,</span> <span class="token number">3473946915</span><span class="token punctuation">,</span> <span class="token number">3348053727</span><span class="token punctuation">,</span> <span class="token number">3681386488</span><span class="token punctuation">,</span> <span class="token number">584266203</span><span class="token punctuation">,</span> <span class="token number">3531080708</span><span class="token punctuation">,</span> <span class="token number">3262223061</span><span class="token punctuation">,</span> <span class="token number">2904040234</span><span class="token punctuation">,</span> <span class="token number">3897643811</span><span class="token punctuation">,</span> <span class="token number">2706405422</span><span class="token punctuation">,</span> <span class="token number">914107260</span><span class="token punctuation">,</span> <span class="token number">3011659451</span><span class="token punctuation">,</span> <span class="token number">308811435</span><span class="token punctuation">,</span> <span class="token number">4103121550</span><span class="token punctuation">,</span> <span class="token number">4023430755</span><span class="token punctuation">,</span> <span class="token number">2975129044</span><span class="token punctuation">,</span> <span class="token number">4139500620</span><span class="token punctuation">,</span> <span class="token number">1763891748</span><span class="token punctuation">,</span> <span class="token number">57665971</span><span class="token punctuation">,</span> <span class="token number">3149249501</span><span class="token punctuation">,</span> <span class="token number">870034516</span><span class="token punctuation">,</span> <span class="token number">4142837134</span><span class="token punctuation">,</span> <span class="token number">3130156432</span><span class="token punctuation">,</span> <span class="token number">1708266697</span><span class="token punctuation">,</span> <span class="token number">1242161643</span><span class="token punctuation">,</span> <span class="token number">1163332264</span><span class="token punctuation">,</span> <span class="token number">108174709</span><span class="token punctuation">,</span> <span class="token number">1633896347</span><span class="token punctuation">,</span> <span class="token number">2820171620</span><span class="token punctuation">,</span> <span class="token number">1708875131</span><span class="token punctuation">,</span> <span class="token number">724124719</span><span class="token punctuation">,</span> <span class="token number">3562786877</span><span class="token punctuation">,</span> <span class="token number">518616285</span><span class="token punctuation">,</span> <span class="token number">3643662732</span><span class="token punctuation">,</span> <span class="token number">3375737681</span><span class="token punctuation">,</span> <span class="token number">2550728441</span><span class="token punctuation">,</span> <span class="token number">1823319080</span><span class="token punctuation">,</span> <span class="token number">1775922455</span><span class="token punctuation">,</span> <span class="token number">3838709569</span><span class="token punctuation">,</span> <span class="token number">177763087</span><span class="token punctuation">,</span> <span class="token number">946611206</span><span class="token punctuation">,</span> <span class="token number">4054832304</span><span class="token punctuation">,</span> <span class="token number">1473954380</span><span class="token punctuation">,</span> <span class="token number">3475817789</span><span class="token punctuation">,</span> <span class="token number">2590152780</span><span class="token punctuation">,</span> <span class="token number">3587873907</span><span class="token punctuation">,</span> <span class="token number">3437231816</span><span class="token punctuation">,</span> <span class="token number">2708036272</span><span class="token punctuation">,</span> <span class="token number">3883447173</span><span class="token punctuation">,</span> <span class="token number">655291275</span><span class="token punctuation">,</span> <span class="token number">707049339</span><span class="token punctuation">,</span> <span class="token number">1352718730</span><span class="token punctuation">,</span> <span class="token number">3543000675</span><span class="token punctuation">,</span> <span class="token number">962283943</span><span class="token punctuation">,</span> <span class="token number">4170075509</span><span class="token punctuation">,</span> <span class="token number">1897499376</span><span class="token punctuation">,</span> <span class="token number">643615933</span><span class="token punctuation">,</span> <span class="token number">856277089</span><span class="token punctuation">,</span> <span class="token number">3299581344</span><span class="token punctuation">,</span> <span class="token number">4093601146</span><span class="token punctuation">,</span> <span class="token number">2638625975</span><span class="token punctuation">,</span> <span class="token number">1563647962</span><span class="token punctuation">,</span> <span class="token number">890552183</span><span class="token punctuation">,</span> <span class="token number">3138216177</span><span class="token punctuation">,</span> <span class="token number">222946344</span><span class="token punctuation">,</span> <span class="token number">4219020514</span><span class="token punctuation">,</span> <span class="token number">3218803481</span><span class="token punctuation">,</span> <span class="token number">3093722090</span><span class="token punctuation">,</span> <span class="token number">1210144957</span><span class="token punctuation">,</span> <span class="token number">3499543439</span><span class="token punctuation">,</span> <span class="token number">4239553976</span><span class="token punctuation">,</span> <span class="token number">3582176749</span><span class="token punctuation">,</span> <span class="token number">654186756</span><span class="token punctuation">,</span> <span class="token number">3005601303</span><span class="token punctuation">,</span> <span class="token number">1252241368</span><span class="token punctuation">,</span> <span class="token number">2459425960</span><span class="token punctuation">,</span> <span class="token number">3587113096</span><span class="token punctuation">,</span> <span class="token number">3506651695</span><span class="token punctuation">,</span> <span class="token number">3673557784</span><span class="token punctuation">,</span> <span class="token number">4157576483</span><span class="token punctuation">,</span> <span class="token number">733173716</span><span class="token punctuation">,</span> <span class="token number">1505997631</span><span class="token punctuation">,</span> <span class="token number">394626148</span><span class="token punctuation">,</span> <span class="token number">1322270695</span><span class="token punctuation">,</span> <span class="token number">84604461</span><span class="token punctuation">,</span> <span class="token number">891267254</span><span class="token punctuation">,</span> <span class="token number">518241635</span><span class="token punctuation">,</span> <span class="token number">1068682198</span><span class="token punctuation">,</span> <span class="token number">3696554893</span><span class="token punctuation">,</span> <span class="token number">3111393676</span><span class="token punctuation">,</span> <span class="token number">1398539042</span><span class="token punctuation">,</span> <span class="token number">901276151</span><span class="token punctuation">,</span> <span class="token number">483471144</span><span class="token punctuation">,</span> <span class="token number">1952219546</span><span class="token punctuation">,</span> <span class="token number">2884270239</span><span class="token punctuation">,</span> <span class="token number">2215979688</span><span class="token punctuation">,</span> <span class="token number">4138748504</span><span class="token punctuation">,</span> <span class="token number">1623101775</span><span class="token punctuation">,</span> <span class="token number">3102260771</span><span class="token punctuation">,</span> <span class="token number">4276348310</span><span class="token punctuation">,</span> <span class="token number">1228132323</span><span class="token punctuation">,</span> <span class="token number">2250922664</span><span class="token punctuation">,</span> <span class="token number">833982365</span><span class="token punctuation">,</span> <span class="token number">3402246096</span><span class="token punctuation">,</span> <span class="token number">2085678412</span><span class="token punctuation">,</span> <span class="token number">2707953187</span><span class="token punctuation">,</span> <span class="token number">590837194</span><span class="token punctuation">,</span> <span class="token number">3421635592</span><span class="token punctuation">,</span> <span class="token number">3488064851</span><span class="token punctuation">,</span> <span class="token number">3655525766</span><span class="token punctuation">,</span> <span class="token number">1029679348</span><span class="token punctuation">,</span> <span class="token number">2448841196</span><span class="token punctuation">,</span> <span class="token number">89284911</span><span class="token punctuation">,</span> <span class="token number">3970560858</span><span class="token punctuation">,</span> <span class="token number">334986490</span><span class="token punctuation">,</span> <span class="token number">3063032848</span><span class="token punctuation">,</span> <span class="token number">3172506167</span><span class="token punctuation">,</span> <span class="token number">2391313449</span><span class="token punctuation">,</span> <span class="token number">3589023591</span><span class="token punctuation">,</span> <span class="token number">4269870234</span><span class="token punctuation">,</span> <span class="token number">3275101066</span><span class="token punctuation">,</span> <span class="token number">1716650872</span><span class="token punctuation">,</span> <span class="token number">483502324</span><span class="token punctuation">,</span> <span class="token number">2116979028</span><span class="token punctuation">,</span> <span class="token number">815078501</span><span class="token punctuation">,</span> <span class="token number">3475316209</span><span class="token punctuation">,</span> <span class="token number">1003463022</span><span class="token punctuation">,</span> <span class="token number">2418993968</span><span class="token punctuation">,</span> <span class="token number">4251101825</span><span class="token punctuation">,</span> <span class="token number">346290993</span><span class="token punctuation">,</span> <span class="token number">3286645593</span><span class="token punctuation">,</span> <span class="token number">2654742976</span><span class="token punctuation">,</span> <span class="token number">99974317</span><span class="token punctuation">,</span> <span class="token number">4124695845</span><span class="token punctuation">,</span> <span class="token number">3732280507</span><span class="token punctuation">,</span> <span class="token number">1536249568</span><span class="token punctuation">,</span> <span class="token number">1440486445</span><span class="token punctuation">,</span> <span class="token number">1605422491</span><span class="token punctuation">,</span> <span class="token number">393607563</span><span class="token punctuation">,</span> <span class="token number">1141210694</span><span class="token punctuation">,</span> <span class="token number">43848150</span><span class="token punctuation">,</span> <span class="token number">1656624711</span><span class="token punctuation">,</span> <span class="token number">2170355702</span><span class="token punctuation">,</span> <span class="token number">327988021</span><span class="token punctuation">,</span> <span class="token number">974870171</span><span class="token punctuation">,</span> <span class="token number">2169013815</span><span class="token punctuation">,</span> <span class="token number">3689546490</span><span class="token punctuation">,</span> <span class="token number">3576028106</span><span class="token punctuation">,</span> <span class="token number">4258679518</span><span class="token punctuation">,</span> <span class="token number">14944446</span><span class="token punctuation">,</span> <span class="token number">1786133397</span><span class="token punctuation">,</span> <span class="token number">264814384</span><span class="token punctuation">,</span> <span class="token number">1969519378</span><span class="token punctuation">,</span> <span class="token number">1769400868</span><span class="token punctuation">,</span> <span class="token number">3098042628</span><span class="token punctuation">,</span> <span class="token number">22547518</span><span class="token punctuation">,</span> <span class="token number">3195136230</span><span class="token punctuation">,</span> <span class="token number">42683806</span><span class="token punctuation">,</span> <span class="token number">1288550835</span><span class="token punctuation">,</span> <span class="token number">59638233</span><span class="token punctuation">,</span> <span class="token number">3534385409</span><span class="token punctuation">,</span> <span class="token number">2517101496</span><span class="token punctuation">,</span> <span class="token number">3632913591</span><span class="token punctuation">,</span> <span class="token number">3894777481</span><span class="token punctuation">,</span> <span class="token number">2912655780</span><span class="token punctuation">,</span> <span class="token number">1614602217</span><span class="token punctuation">,</span> <span class="token number">3498478791</span><span class="token punctuation">,</span> <span class="token number">1309795895</span><span class="token punctuation">,</span> <span class="token number">3961554801</span><span class="token punctuation">,</span> <span class="token number">3625321205</span><span class="token punctuation">,</span> <span class="token number">308138165</span><span class="token punctuation">,</span> <span class="token number">2885107341</span><span class="token punctuation">,</span> <span class="token number">1003378866</span><span class="token punctuation">,</span> <span class="token number">3462951062</span><span class="token punctuation">,</span> <span class="token number">1914176024</span><span class="token punctuation">,</span> <span class="token number">3130918711</span><span class="token punctuation">,</span> <span class="token number">3919345882</span><span class="token punctuation">,</span> <span class="token number">3556964414</span><span class="token punctuation">,</span> <span class="token number">2382442356</span><span class="token punctuation">,</span> <span class="token number">3968605965</span><span class="token punctuation">,</span> <span class="token number">2388890395</span><span class="token punctuation">,</span> <span class="token number">1955471760</span><span class="token punctuation">,</span> <span class="token number">2358533573</span><span class="token punctuation">,</span> <span class="token number">2323037969</span><span class="token punctuation">,</span> <span class="token number">4273118548</span><span class="token punctuation">,</span> <span class="token number">3577096972</span><span class="token punctuation">,</span> <span class="token number">4251790958</span><span class="token punctuation">,</span> <span class="token number">2321545863</span><span class="token punctuation">,</span> <span class="token number">2057106840</span><span class="token punctuation">,</span> <span class="token number">4000766037</span><span class="token punctuation">,</span> <span class="token number">1551111470</span><span class="token punctuation">,</span> <span class="token number">368761666</span><span class="token punctuation">,</span> <span class="token number">951769999</span><span class="token punctuation">,</span> <span class="token number">778229999</span><span class="token punctuation">,</span> <span class="token number">4235748487</span><span class="token punctuation">,</span> <span class="token number">2020142699</span><span class="token punctuation">,</span> <span class="token number">3577752281</span><span class="token punctuation">,</span> <span class="token number">1269488993</span><span class="token punctuation">,</span> <span class="token number">1350156870</span><span class="token punctuation">,</span> <span class="token number">529843408</span><span class="token punctuation">,</span> <span class="token number">669182431</span><span class="token punctuation">,</span> <span class="token number">3871401874</span><span class="token punctuation">,</span> <span class="token number">2180265713</span><span class="token punctuation">,</span> <span class="token number">3850183472</span><span class="token punctuation">,</span> <span class="token number">46915226</span><span class="token punctuation">,</span> <span class="token number">3150800412</span><span class="token punctuation">,</span> <span class="token number">1139932212</span><span class="token punctuation">,</span> <span class="token number">2523557119</span><span class="token punctuation">,</span> <span class="token number">1462042012</span><span class="token punctuation">,</span> <span class="token number">301258444</span><span class="token punctuation">,</span> <span class="token number">165757583</span><span class="token punctuation">,</span> <span class="token number">530704729</span><span class="token punctuation">,</span> <span class="token number">1848179734</span><span class="token punctuation">,</span> <span class="token number">1792342751</span><span class="token punctuation">,</span> <span class="token number">2597916820</span><span class="token punctuation">,</span> <span class="token number">4041946457</span><span class="token punctuation">,</span> <span class="token number">1127104524</span><span class="token punctuation">,</span> <span class="token number">3768573884</span><span class="token punctuation">,</span> <span class="token number">2614008065</span><span class="token punctuation">,</span> <span class="token number">741308521</span><span class="token punctuation">,</span> <span class="token number">477746986</span><span class="token punctuation">,</span> <span class="token number">507411825</span><span class="token punctuation">,</span> <span class="token number">4235293189</span><span class="token punctuation">,</span> <span class="token number">2251811519</span><span class="token punctuation">,</span> <span class="token number">811234592</span><span class="token punctuation">,</span> <span class="token number">1985999307</span><span class="token punctuation">,</span> <span class="token number">844715613</span><span class="token punctuation">,</span> <span class="token number">1640781314</span><span class="token punctuation">,</span> <span class="token number">3538036580</span><span class="token punctuation">,</span> <span class="token number">2764130557</span><span class="token punctuation">,</span> <span class="token number">2863454433</span><span class="token punctuation">,</span> <span class="token number">1831736583</span><span class="token punctuation">,</span> <span class="token number">3857379783</span><span class="token punctuation">,</span> <span class="token number">658928449</span><span class="token punctuation">,</span> <span class="token number">1149649578</span><span class="token punctuation">,</span> <span class="token number">103125751</span><span class="token punctuation">,</span> <span class="token number">2968446555</span><span class="token punctuation">,</span> <span class="token number">885660863</span><span class="token punctuation">,</span> <span class="token number">707321834</span><span class="token punctuation">,</span> <span class="token number">1728646363</span><span class="token punctuation">,</span> <span class="token number">2706995220</span><span class="token punctuation">,</span> <span class="token number">3062604255</span><span class="token punctuation">,</span> <span class="token number">4177710084</span><span class="token punctuation">,</span> <span class="token number">3076079677</span><span class="token punctuation">,</span> <span class="token number">879366858</span><span class="token punctuation">,</span> <span class="token number">3936728615</span><span class="token punctuation">,</span> <span class="token number">8828906</span><span class="token punctuation">,</span> <span class="token number">1656874220</span><span class="token punctuation">,</span> <span class="token number">2904085639</span><span class="token punctuation">,</span> <span class="token number">397694272</span><span class="token punctuation">,</span> <span class="token number">1604508691</span><span class="token punctuation">,</span> <span class="token number">2083663236</span><span class="token punctuation">,</span> <span class="token number">2138468690</span><span class="token punctuation">,</span> <span class="token number">1365350684</span><span class="token punctuation">,</span> <span class="token number">2870684769</span><span class="token punctuation">,</span> <span class="token number">384435793</span><span class="token punctuation">,</span> <span class="token number">1063724290</span><span class="token punctuation">,</span> <span class="token number">1142482048</span><span class="token punctuation">,</span> <span class="token number">809857977</span><span class="token punctuation">,</span> <span class="token number">4192515435</span><span class="token punctuation">,</span> <span class="token number">267878653</span><span class="token punctuation">,</span> <span class="token number">206018017</span><span class="token punctuation">,</span> <span class="token number">3441769173</span><span class="token punctuation">,</span> <span class="token number">925696591</span><span class="token punctuation">,</span> <span class="token number">2250932557</span><span class="token punctuation">,</span> <span class="token number">1973183700</span><span class="token punctuation">,</span> <span class="token number">577661907</span><span class="token punctuation">,</span> <span class="token number">2551314381</span><span class="token punctuation">,</span> <span class="token number">1350352597</span><span class="token punctuation">,</span> <span class="token number">4151551172</span><span class="token punctuation">,</span> <span class="token number">774849773</span><span class="token punctuation">,</span> <span class="token number">2391866106</span><span class="token punctuation">,</span> <span class="token number">3444137245</span><span class="token punctuation">,</span> <span class="token number">403261487</span><span class="token punctuation">,</span> <span class="token number">2724363448</span><span class="token punctuation">,</span> <span class="token number">3572536490</span><span class="token punctuation">,</span> <span class="token number">1077243504</span><span class="token punctuation">,</span> <span class="token number">302416473</span><span class="token punctuation">,</span> <span class="token number">3457548858</span><span class="token punctuation">,</span> <span class="token number">564604707</span><span class="token punctuation">,</span> <span class="token number">1238169871</span><span class="token punctuation">,</span> <span class="token number">2356838464</span><span class="token punctuation">,</span> <span class="token number">3083335214</span><span class="token punctuation">,</span> <span class="token number">3844937218</span><span class="token punctuation">,</span> <span class="token number">1272458074</span><span class="token punctuation">,</span> <span class="token number">1782962159</span><span class="token punctuation">,</span> <span class="token number">1543604321</span><span class="token punctuation">,</span> <span class="token number">3212537899</span><span class="token punctuation">,</span> <span class="token number">426074894</span><span class="token punctuation">,</span> <span class="token number">3053843067</span><span class="token punctuation">,</span> <span class="token number">2436223151</span><span class="token punctuation">,</span> <span class="token number">94019340</span><span class="token punctuation">,</span> <span class="token number">4147659323</span><span class="token punctuation">,</span> <span class="token number">2893920832</span><span class="token punctuation">,</span> <span class="token number">626619793</span><span class="token punctuation">,</span> <span class="token number">3976626567</span><span class="token punctuation">,</span> <span class="token number">1884877146</span><span class="token punctuation">,</span> <span class="token number">2696384440</span><span class="token punctuation">,</span> <span class="token number">1177352315</span><span class="token punctuation">,</span> <span class="token number">1082374195</span><span class="token punctuation">,</span> <span class="token number">3289271804</span><span class="token punctuation">,</span> <span class="token number">1485815836</span><span class="token punctuation">,</span> <span class="token number">120127000</span><span class="token punctuation">,</span> <span class="token number">3349349501</span><span class="token punctuation">,</span> <span class="token number">164243314</span><span class="token punctuation">,</span> <span class="token number">1703351326</span><span class="token punctuation">,</span> <span class="token number">1017276501</span><span class="token punctuation">,</span> <span class="token number">413737931</span><span class="token punctuation">,</span> <span class="token number">408060344</span><span class="token punctuation">,</span> <span class="token number">472141408</span><span class="token punctuation">,</span> <span class="token number">172738862</span><span class="token punctuation">,</span> <span class="token number">4001606849</span><span class="token punctuation">,</span> <span class="token number">1888805432</span><span class="token punctuation">,</span> <span class="token number">2927218529</span><span class="token punctuation">,</span> <span class="token number">1293362241</span><span class="token punctuation">,</span> <span class="token number">1941759619</span><span class="token punctuation">,</span> <span class="token number">1760659398</span><span class="token punctuation">,</span> <span class="token number">274865852</span><span class="token punctuation">,</span> <span class="token number">978985751</span><span class="token punctuation">,</span> <span class="token number">3867215904</span><span class="token punctuation">,</span> <span class="token number">177291528</span><span class="token punctuation">,</span> <span class="token number">1083045308</span><span class="token punctuation">,</span> <span class="token number">3888975618</span><span class="token punctuation">,</span> <span class="token number">979933689</span><span class="token punctuation">,</span> <span class="token number">2211634008</span><span class="token punctuation">,</span> <span class="token number">3899294132</span><span class="token punctuation">,</span> <span class="token number">1174569575</span><span class="token punctuation">]</span>Hash<span class="token operator">=</span><span class="token string">'b0cfb7293d6842e3279f4ef0fc88284174349e111e5b9beb28263df72c9db0bf'</span>res<span class="token operator">=</span><span class="token number">1045726758250168034320246515934682860724576730763168865120</span><span class="token keyword">from</span> mt19937predictor <span class="token keyword">import</span> MT19937Predictor<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>predictor <span class="token operator">=</span> MT19937Predictor<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> randist<span class="token punctuation">:</span>predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>x <span class="token operator">=</span> predictor<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token keyword">from</span> os <span class="token keyword">import</span> urandom<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token comment"># for i in tqdm(range(256)):</span><span class="token comment">#     for j in range(256):</span><span class="token comment">#         for k in range(256):</span><span class="token comment">#             if sha256(i.to_bytes(1, byteorder='big') + j.to_bytes(1, byteorder='big') + k.to_bytes(1, byteorder='big')).hexdigest() == Hash:</span><span class="token comment">#                 print(i.to_bytes(1, byteorder='big') + j.to_bytes(1, byteorder='big') + k.to_bytes(1, byteorder='big'))</span><span class="token comment">#                 exit()</span>tmp <span class="token operator">=</span> <span class="token string">b'\xfeV\xe8'</span><span class="token comment"># y = predictor.getrandbits(192)</span><span class="token comment"># print(res ^ y)</span><span class="token comment"># print(bin(3096872116674666632134706098360014813425478687167245803096)[2:])</span>res <span class="token operator">=</span> <span class="token string">'11111100100110011011010100000010100111101010001110010110101000111010000101111001111100001100100001111110000100000010001010110111001001000101111101101110101101110110111010111010101111001011000'</span>n3 <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token number">151</span><span class="token punctuation">:</span><span class="token punctuation">]</span>n3 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>n3<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>n3 <span class="token operator">=</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>n3<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">affine</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token keyword">from</span> string <span class="token keyword">import</span> <span class="token operator">*</span>flag3 <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n3<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> digits <span class="token operator">+</span> <span class="token string">'abcdef'</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>j<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">13</span><span class="token operator">+</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">==</span> i<span class="token punctuation">:</span>            flag3 <span class="token operator">+=</span> j<span class="token comment"># print(flag3)</span><span class="token comment"># 64406e6365</span>tmp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>tmp<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>n2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">127</span><span class="token punctuation">:</span><span class="token number">151</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>n2 <span class="token operator">^</span> tmp<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 6c795f</span><span class="token comment"># for i in range(10, 135):</span><span class="token comment">#     n1 = int(res[:i], 2)</span><span class="token comment">#     if len(hex(n1 ^ x)[2:]) == 32:</span><span class="token comment">#         print(i)</span><span class="token comment">#         print(hex(n1 ^ x)[2:])</span><span class="token comment"># flag = 0x16ef9b7e65eaccdac7f2a82242f97461fe795f64406e6365</span><span class="token comment"># print(n2s(flag))</span><span class="token comment"># flag = 0x365ac09e91965ba65b83ea0952bf789afe795f64406e6365</span><span class="token comment"># print(n2s(flag))</span>flag <span class="token operator">=</span> <span class="token number">0x7730775f796f755f63616e5f7233616c6c795f64406e6365</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag = 0xf5e518dca89d28ad12a466f3332b5280fe795f64406e6365</span><span class="token comment"># print(n2s(flag))</span><span class="token comment"># flag&#123;w0w_you_can_r3ally_d@nce&#125;</span></code></pre><h3 id="Puzzle"><a href="#Puzzle" class="headerlink" title="Puzzle"></a>Puzzle</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token comment">#coding:utf-8</span><span class="token keyword">import</span> gmpy2<span class="token keyword">import</span> random<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">,</span>bytes_to_long<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom<span class="token keyword">def</span> <span class="token function">getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>    k <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">2048</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> p<span class="token operator">**</span>k<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token operator">**</span>r<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">break</span>    pubkey <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">long</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">long</span><span class="token punctuation">(</span>p<span class="token operator">**</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> pubkey<span class="token keyword">def</span> <span class="token function">c1pto</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span><span class="token punctuation">:</span>    e<span class="token punctuation">,</span> n <span class="token operator">=</span> pubkey    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> m <span class="token operator">&lt;</span> n <span class="token operator">-</span> <span class="token number">1</span>    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> n<span class="token keyword">def</span> <span class="token function">c2pto</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>    key<span class="token operator">=</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    iv<span class="token operator">=</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    cipher<span class="token operator">=</span>AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span>iv<span class="token punctuation">)</span>    m<span class="token operator">=</span>iv<span class="token operator">+</span>long_to_bytes<span class="token punctuation">(</span>p<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"base64"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> key<span class="token keyword">def</span> <span class="token function">c3pto</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">bin</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> a <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            a <span class="token operator">=</span> a <span class="token operator">^</span> n        <span class="token keyword">if</span> a <span class="token operator">>></span> <span class="token number">256</span><span class="token punctuation">:</span>            a <span class="token operator">=</span> a <span class="token operator">^</span> 0x10000000000000000000000000000000000000000000000000000000000000223L    <span class="token keyword">return</span> am<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>urandom<span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token operator">+</span>flag<span class="token punctuation">)</span>pubkey <span class="token operator">=</span> getkey<span class="token punctuation">(</span><span class="token punctuation">)</span>n <span class="token operator">=</span> c1pto<span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span>key<span class="token operator">=</span>c2pto<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c3pto<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''output0x5b0cd450a7bfb679dc9caa8aa6fc131708fca2a34375d049ac035fb019463d9c3fa11adb0eb51dea1ae85223df59f887a12ab376cbcb272681c3872c57f4da27396052242b608e3ea4ff53061e63bbfdff652ce25f4ce73315fd1a73a5d5e7307402c7a3c6c1a80c63297b441125c38e23729da6473e5dc332e4e7201df25ff6c8b9918b262e56a31bebe13e093e6f4dba47a771961358cedf6d740732425cb708a633d538dcdc12ef7b49ce76aa270f50dd7cc1b879f1d7b19c6ac3b891fe4e20fb7645b7567237775881de7d30ba754d495ffe8ee751d1cfee1c661a2dbf13a53ff1bcf8085b39f6508fbf37137ebad659665fe5fcc67eef02970a44ac675e28103bd10f2045983d5adaa909b18b70a909b08b76c21b2798830276068d0ebd27303985bb5f3e681219a50bc761b7630587743768cf61922804d195e265aaaabb4740a2c5d7e8ff4e1c19cfb534d345f537e95e948591557f3136da617657e24d1904be373f5e7d63af330b837bcc662cbcd801eb436dbbeb714469d227e9f17e118db39eeb42e45455e6daf4d8fe0e19c4457b596c20e1ef8d235b230018a58e1c66c52c7317094aa5797f50a3b5ebe2be2abd1a04d907fbb68919956d7b0939ac0195a3f3bd3eb6f08eef67a895807768250172ec6bb2b35c9962de03df847170472b73981c04f2aef03721554c818ec9eb7f625d1a3fcdcf756adc4b6fd61950724ac2164a94df70f4aa1cc36c51dd2c3b6545c6c2233544254f6a24e6a170918fd0c533734ef859fed3c5d6f1f9acf8d3b77804c98fa5f1429763ebe860a77380a1e94626b46d88e5263855a0a0d226eb7ca64824c9a06acda851e650e6b035c04e27de61cd49ff49ac3ea3407440f9e76ce47c02301c1bc9c28befe0cd1f5b999961b055ffb39e2f451302aaedc5d779da03830bda1ed3ba9be4f23b2381096f3dc60c84a91ba0aa44242cc6aa361e2ecac867a2d1ef6868199ecb3004aa62bd56683c3476a9bd3f0316905e4f83ef5a907d9796231b9f506c82c09c739513a0db04467a071dcc34cb11bbba8cd3f1870174e04160ae74c2160a61a7c472e8edc51e969a2f0fb47cee59b67d401ecb13b06f72dcfb24f5850b8921b8bad14f7c6bd123c13b3a2ea1761fc425066ba107d61e96d2fa9b3ed88befec93578495ef4c7a1eb95d76679d1f5261f0202e1de881c5c5b1fb44f471a75a305d86df1123cd83c8bc9449c73cf34dbd247111c873bc1fc7948863bb59f2ac3d7129c2e7c3e0ef94afb38a01b3e42f83f42a5cc8e14cbe53c0c8d76768cdc98bef921aaca60204519b516d4c9de7cf581eec8a53faa2e2d96722d0ef2c23d5567ba48104890534cd84432565236cb3402504e0feb6c25426c52d2b2b42f10a007cdd38b540cf64a96ee784deb2b595deb4a9497f9a25ab06eab443010b66e7decc162dcbd7de12737d72a46ec0b8151e1ed42716af2c7602692d7c0ea757bc056c89d2640773a4c3c1a2297c87c13676e414003ff3af0d1abb87ba618e24a4dfe05c0b4443bda53d26c7e30f0dec498d9091074fe3444e81b9a4d8d7acc8b1e38f6afc63540a4e8880fd73bd34bc3563cc0a98bd35ce7455d5cf8a114bc2fe2fb9a58e725cc121e4e242fc0a9a8e38615bda67fd9f158e718154eb51d0ec3d941426933e36fba1db0d7b59d52be90aa796895e6a49fed0a7887b8d7c71a9aa023a8dc73391e3d1bfc746cde9f964d99625900624a8eb300f2d7d2f8703f470776088f27aaa72e7607dcd78cf63754cec00db23bb36beb48cffb20a06df884f101a9L0x26c6b16ed40253ff31bdcd502d63230a9655f29599cfb41a29f10e700589e6a13a8c78f483e0aa8b9353fa258a1437ba15e8d2c8bb2b090a6887740b31d71550745611fabd087904f150b4d928d155a7fcdd1a64c7349ce984dfd08c4c795e93b409f53c1458e6de777dc5993198f4c0648381116fe5cbafa57499d9ce685c625df4797afc344e8fe4a0fc36cf82ba1423c8a4ad7a33bc4cbab25e2df729085f96d3d9d542d981fa46cac8a37ceb70b9f808213845c06b72be7e2d1224e4dc02817bd474c690e43f6d8f1916a20f2e078bfaa604343d695e6f5f88d9f11c43a886ff97d9bd26b0126af40bed8e03a43bf8c912b5b0dd2f9f2e7e99db066759f573cd59a40a554bebdd3e7e0adbc38fcb91adeb72f9dcd30558b082471a02fd9131a61cf29b1f4e38a5d689d8dcd0b8dc29075e3a33b2d6a25bee6ff9e20d269cc088a2b155be76a1531ce30b25edf928990b5143fc5ae2737d8d4070d0517f5137c458d7afed8f51e2c2973dd143235c9deaffe9ce8fbcd767a93573399dafd5ef61408c77302c993354a080684cdbfb7c1eeb6e6be907db790038c7ce62517815d16fe366bd26178f2f05b9e56450814f4ba7ab6cab54c5f78316b0451057785c03a77c20814eb405cd20e5bff5247a12500dd16173125ffdef4fb6317ab942d0d7e0e584a8fd97a8ba8d87fd38127d6d059902a2d48dafd10938ea5d108f3eb986aabf9e212151b0e540bb5fd25888143633be9982395d4d3bef5278be37328e0239569eb511698ef7f9e7e12aa204cb4c069ffcdeecb65f42ba37f7bfd47c4ba8df384a88adf3486b58cc1620185ac81dfb10f591fc82f3ae046341ebd1e8288f10500d6677e91b89729dfd299b74be13a9183725aacb0023f4fb01efda61390b0312d90ff6a9a319433681ad1811efe038fcdeb6dc1c3f594c4f8011aacfee74ea9638fccb3d669435a1208578c934277caa3ec74f9efbb33e024909b121e7b4e48ec94b762fa9dcab8a1c11b86bb9db164c7655504d304661e04e95b0b356f5968334596fb11df95bbdcb3a6618f431c864658827662f760fc86b2136221bd50472dc19c4f177eb5edf7978760dc15150cfda0a3ea649cb672b8f37229298c6edcc630e3ac9a5f43f58a93ba8def335472f7ebdedd7715a27c4ea622344a949bec59af030455ed61911d53388022bd502e800b769ef499f94f02c96f486b40ce68dbdc42e5690ac2992bedf7f0ba384504c32cb00a25d4e125483003152e81ebe9c12d928627d7f14fc3fbdf5141addc477d5ae4f32e64dcb58a6e2cf955ad7ae54e1665b3199bd0fae36b9ec56c09ac00efc9d27e69a93f4e08652edc3340fa2c518d388ee4a005b9c83956b9139b98380f6925a1a4c3e64ff8d96f2827d0d8a25cc72a2c03a28e33871284b46e10c85f2ad75969b1d84e9d88bb4e05dLGuGfliJiRkNsUbbmB+g/q4U3z6YahJ6G1Q9bg6ZT/ilJnkNMICmQYMFuhlNBuVZHfJJIFwwFJ5FKG+z9zSXalJq6quN6d3CSYSMHvYk04Orpn76Y2VQX5qQk72uCssd4x5KNIOmX0CvzJmjTWjLvL1U5twQupfkuDr/axqyHFss3pJkj9o0IRZmtz87bi5WojeUjOaayQ0RNenJJzhJ+zFJwdUCpUhwotHxLOPsUXYSoY7AKPwj53Dlsy0deNBKFN89BolC4pTwHWvn0M/8eu9kIze+5sQuKrk0VI5ASNzA6PRp1owpgsxNuy18k6/y01+mVheQkFrH2IrFNgqe3+Gu/PXEDPi3G2nAIi/4Xf9QI0DNH+hkoN40zWaX3OkEVQeLQ9o/KuggeoajYwDusFyQxOQZYFr5I+v8uBApcQz29bKIRiZX78r9YN3IaSsL0JgLPQPYaNPNiZMm5pqmv/zV0poZikYGYJsAwfjLJ/CYQ/iLBhkhKZoE9VxYEae7Wga1jwpJb3h/lA3mbvQofMTR6ivnSZHzUu3elxMFTgTi5adB4PsBdke0YRXlWP8/AoggBAN5OMw8n2LCASIhp7q/1iljNUuw/40mBCt75jszo1eBBDAbP7/DjXL5hUHFgen6xjedcySq/H0ibyNGasyePs3e+igr78fHyvXyIYYPaEtM4RjC3j3TXheRYRo9lObJgHUHSY0PgAgrqc1rECexNa+QCvzzapemNAEE9OT8YLOEkB6zzpSrZ6k/NR9KffGnqplQlWAfXdDrf3SsOmWVJ3G6DvmpTCukQgVYn+DCv5LdSSUZo2hjxBHPv8C5zpZiasPLDr+2CwUvccettO3wwrWQ1bPfRBZ7OSghvipbYI7awjt45tyxT5TopN7e3kud1s4bdm7da/KQDDQ3pxylH7Kc2b8wWfptW2t9wEoqdjNezr24E+/c6kNIo9TmZ8mPigNBz/d7Sd5TzxhstmXoXscAvFLpc7B/RhD5qwXWlYZwisemsTL6GVgBpaWI0zp4pk4DaQcT7FM17qddeHCiF5YD9g6TZBkYXnvke5hW1JERYny3GjTNum8P3p9L3NHWpfAK2S90ChRwDb3nDy81B6b6K+YMNsJmmMjJhE/GbP6jMFE/2cLIAsAT+Ssk/zNEJKXKe3gN4pQzBcDJksDxrlYJoYQE/rz1Ni7EpKiuuEUtODcGSCcRagh6t6cJVyDh76DgxgjAvjATjPS6bdJ5PQWocTtjoMUvkMjbeEoWMuoe5cgsHl3HoYsLyxWwk1zn4BVSdjumiD0o8juKUTFsFjN8yyNQyAA4KNRrhrIBdK8VTcsJC5JFjJnJiX1P6yrUWZPnH4YB3wIZwA5EkXjlgtNrZghyWTMNoMs4GH6A=38003142990385686484863558905791098358375993231657244276476071305023256088640'''</span></code></pre><p>先不断用c3pto函数得到key的值，因为在明文前面填充了iv，所以第一轮CBC加密时相当于0。因此先用ECB模式加密16个0就可以得到iv的值。解密之后去掉前16位iv再b2l得到n的值。又因为n是p的k次方，k是3到10的随机数，所以可以通过iroot来爆破得到p和k的值。然后phi就是p^4-p^3，常规rsa解密即可。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># ans = 38003142990385686484863558905791098358375993231657244276476071305023256088640</span><span class="token comment"># for i in range(3000):</span><span class="token comment">#     ans = c3pto(ans)</span><span class="token comment">#     if len(long_to_bytes(ans)) == 16:</span><span class="token comment">#         print(long_to_bytes(ans))</span><span class="token comment">#         print(i)</span><span class="token comment">#         break</span>key <span class="token operator">=</span> <span class="token string">b'\xe3+\x91\t\x98\xf3\x1e\xc1:GdW\xa7\x9c\xed\xc8'</span>cipher <span class="token operator">=</span> <span class="token string">b'GuGfliJiRkNsUbbmB+g/q4U3z6YahJ6G1Q9bg6ZT/ilJnkNMICmQYMFuhlNBuVZHfJJIFwwFJ5FKG+z9zSXalJq6quN6d3CSYSMHvYk04Orpn76Y2VQX5qQk72uCssd4x5KNIOmX0CvzJmjTWjLvL1U5twQupfkuDr/axqyHFss3pJkj9o0IRZmtz87bi5WojeUjOaayQ0RNenJJzhJ+zFJwdUCpUhwotHxLOPsUXYSoY7AKPwj53Dlsy0deNBKFN89BolC4pTwHWvn0M/8eu9kIze+5sQuKrk0VI5ASNzA6PRp1owpgsxNuy18k6/y01+mVheQkFrH2IrFNgqe3+Gu/PXEDPi3G2nAIi/4Xf9QI0DNH+hkoN40zWaX3OkEVQeLQ9o/KuggeoajYwDusFyQxOQZYFr5I+v8uBApcQz29bKIRiZX78r9YN3IaSsL0JgLPQPYaNPNiZMm5pqmv/zV0poZikYGYJsAwfjLJ/CYQ/iLBhkhKZoE9VxYEae7Wga1jwpJb3h/lA3mbvQofMTR6ivnSZHzUu3elxMFTgTi5adB4PsBdke0YRXlWP8/AoggBAN5OMw8n2LCASIhp7q/1iljNUuw/40mBCt75jszo1eBBDAbP7/DjXL5hUHFgen6xjedcySq/H0ibyNGasyePs3e+igr78fHyvXyIYYPaEtM4RjC3j3TXheRYRo9lObJgHUHSY0PgAgrqc1rECexNa+QCvzzapemNAEE9OT8YLOEkB6zzpSrZ6k/NR9KffGnqplQlWAfXdDrf3SsOmWVJ3G6DvmpTCukQgVYn+DCv5LdSSUZo2hjxBHPv8C5zpZiasPLDr+2CwUvccettO3wwrWQ1bPfRBZ7OSghvipbYI7awjt45tyxT5TopN7e3kud1s4bdm7da/KQDDQ3pxylH7Kc2b8wWfptW2t9wEoqdjNezr24E+/c6kNIo9TmZ8mPigNBz/d7Sd5TzxhstmXoXscAvFLpc7B/RhD5qwXWlYZwisemsTL6GVgBpaWI0zp4pk4DaQcT7FM17qddeHCiF5YD9g6TZBkYXnvke5hW1JERYny3GjTNum8P3p9L3NHWpfAK2S90ChRwDb3nDy81B6b6K+YMNsJmmMjJhE/GbP6jMFE/2cLIAsAT+Ssk/zNEJKXKe3gN4pQzBcDJksDxrlYJoYQE/rz1Ni7EpKiuuEUtODcGSCcRagh6t6cJVyDh76DgxgjAvjATjPS6bdJ5PQWocTtjoMUvkMjbeEoWMuoe5cgsHl3HoYsLyxWwk1zn4BVSdjumiD0o8juKUTFsFjN8yyNQyAA4KNRrhrIBdK8VTcsJC5JFjJnJiX1P6yrUWZPnH4YB3wIZwA5EkXjlgtNrZghyWTMNoMs4GH6A='</span><span class="token keyword">from</span> base64 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># print(b64decode(cipher))</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AESaes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>iv <span class="token operator">=</span> aes<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span><span class="token string">b'0'</span><span class="token operator">*</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token comment"># iv = b'&lt;\xf1t)J\xb94\x94\x96k\xb3\xa6\xd0l\x1f\x18'</span><span class="token comment"># print(len(iv))</span>aes <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span><span class="token comment"># print(bytes_to_long(aes.decrypt(b64decode(cipher))[16:]))</span>n <span class="token operator">=</span> <span class="token number">192099659971585644585994265356151893462377034960456794411988891865292985043855003153008582523342780428794810302819600257505211543181857907106415116235678327109890992104863370288179222517757670217778339429390238355802091081769000348240713104001227465195009290503347809694648095737603288589286587488951249122808668565718081375241590144993161651582987613212486939491481151331461062699460189663231086086438368188327851901136662178362187582946879512941211019554239356512237609083714797677920647956302526035540976096625395045576074618882913271336136197136983455626303177930159461486947144900160609689255459511724884379858318269727855760842754096692298627624434916921714588784746851193083162412064551556945404206854303755771760752959780690233660596074620616291920828653736584021095005924141651891036415545086668712524203621422434855332350634434410255685899978575653707114060202874964589333127633649581915659487394392054766924938473585908627256425677898409670003835577877230695953230779772624257018952499735317822119685099669750110189929339815489604592011705747522509443099530871227359100112168474188213599742539558713508525377201675194485642343270883438486906530571528359024979260422106335247512597006126883635090340753475080689838573417741101697005667509804117477078714343224837766971175288554228364175312803060405952234277289653353821049167680289322424370730116331485806992442330752262754657170209301796826520903516939270541484630918051998431104746567068050303837266511857593664457675203874622377426656951134697321668662464768461125119491757074002358277630438779981831394788463952738787381176350532134825112678994090733193226361777537532269515922485937976349665991399772388721397960468392351155664481353730638831836994949983037350384382753327305729403941493686341892251753278811372338966651828844911034352886809190060883995056847456555950315611326987545276629529435068813158170690823902054787362572088738335891773343913632258874832438998334332913261810760087047758552754566575308536675397251987093487164542963055804002441751864022715424662848335470359948420027756835213050500577294799638589135949755879898985814242501638839907383377834819866500082619067419468232672548637154121177897443704368253245514204975147693342503301921844252239673318375741456151277008424086433210309669337358030499431697081307189511178107489812792122478536534259554160073644974772253911579253927334216606449192146737795612311912838169178570116934403812068138348378295739329366212651044519758844001</span>e <span class="token operator">=</span> <span class="token number">0x5b0cd450a7bfb679dc9caa8aa6fc131708fca2a34375d049ac035fb019463d9c3fa11adb0eb51dea1ae85223df59f887a12ab376cbcb272681c3872c57f4da27396052242b608e3ea4ff53061e63bbfdff652ce25f4ce73315fd1a73a5d5e7307402c7a3c6c1a80c63297b441125c38e23729da6473e5dc332e4e7201df25ff6c8b9918b262e56a31bebe13e093e6f4dba47a771961358cedf6d740732425cb708a633d538dcdc12ef7b49ce76aa270f50dd7cc1b879f1d7b19c6ac3b891fe4e20fb7645b7567237775881de7d30ba754d495ffe8ee751d1cfee1c661a2dbf13a53ff1bcf8085b39f6508fbf37137ebad659665fe5fcc67eef02970a44ac675e28103bd10f2045983d5adaa909b18b70a909b08b76c21b2798830276068d0ebd27303985bb5f3e681219a50bc761b7630587743768cf61922804d195e265aaaabb4740a2c5d7e8ff4e1c19cfb534d345f537e95e948591557f3136da617657e24d1904be373f5e7d63af330b837bcc662cbcd801eb436dbbeb714469d227e9f17e118db39eeb42e45455e6daf4d8fe0e19c4457b596c20e1ef8d235b230018a58e1c66c52c7317094aa5797f50a3b5ebe2be2abd1a04d907fbb68919956d7b0939ac0195a3f3bd3eb6f08eef67a895807768250172ec6bb2b35c9962de03df847170472b73981c04f2aef03721554c818ec9eb7f625d1a3fcdcf756adc4b6fd61950724ac2164a94df70f4aa1cc36c51dd2c3b6545c6c2233544254f6a24e6a170918fd0c533734ef859fed3c5d6f1f9acf8d3b77804c98fa5f1429763ebe860a77380a1e94626b46d88e5263855a0a0d226eb7ca64824c9a06acda851e650e6b035c04e27de61cd49ff49ac3ea3407440f9e76ce47c02301c1bc9c28befe0cd1f5b999961b055ffb39e2f451302aaedc5d779da03830bda1ed3ba9be4f23b2381096f3dc60c84a91ba0aa44242cc6aa361e2ecac867a2d1ef6868199ecb3004aa62bd56683c3476a9bd3f0316905e4f83ef5a907d9796231b9f506c82c09c739513a0db04467a071dcc34cb11bbba8cd3f1870174e04160ae74c2160a61a7c472e8edc51e969a2f0fb47cee59b67d401ecb13b06f72dcfb24f5850b8921b8bad14f7c6bd123c13b3a2ea1761fc425066ba107d61e96d2fa9b3ed88befec93578495ef4c7a1eb95d76679d1f5261f0202e1de881c5c5b1fb44f471a75a305d86df1123cd83c8bc9449c73cf34dbd247111c873bc1fc7948863bb59f2ac3d7129c2e7c3e0ef94afb38a01b3e42f83f42a5cc8e14cbe53c0c8d76768cdc98bef921aaca60204519b516d4c9de7cf581eec8a53faa2e2d96722d0ef2c23d5567ba48104890534cd84432565236cb3402504e0feb6c25426c52d2b2b42f10a007cdd38b540cf64a96ee784deb2b595deb4a9497f9a25ab06eab443010b66e7decc162dcbd7de12737d72a46ec0b8151e1ed42716af2c7602692d7c0ea757bc056c89d2640773a4c3c1a2297c87c13676e414003ff3af0d1abb87ba618e24a4dfe05c0b4443bda53d26c7e30f0dec498d9091074fe3444e81b9a4d8d7acc8b1e38f6afc63540a4e8880fd73bd34bc3563cc0a98bd35ce7455d5cf8a114bc2fe2fb9a58e725cc121e4e242fc0a9a8e38615bda67fd9f158e718154eb51d0ec3d941426933e36fba1db0d7b59d52be90aa796895e6a49fed0a7887b8d7c71a9aa023a8dc73391e3d1bfc746cde9f964d99625900624a8eb300f2d7d2f8703f470776088f27aaa72e7607dcd78cf63754cec00db23bb36beb48cffb20a06df884f101a9</span>c <span class="token operator">=</span> <span class="token number">0x26c6b16ed40253ff31bdcd502d63230a9655f29599cfb41a29f10e700589e6a13a8c78f483e0aa8b9353fa258a1437ba15e8d2c8bb2b090a6887740b31d71550745611fabd087904f150b4d928d155a7fcdd1a64c7349ce984dfd08c4c795e93b409f53c1458e6de777dc5993198f4c0648381116fe5cbafa57499d9ce685c625df4797afc344e8fe4a0fc36cf82ba1423c8a4ad7a33bc4cbab25e2df729085f96d3d9d542d981fa46cac8a37ceb70b9f808213845c06b72be7e2d1224e4dc02817bd474c690e43f6d8f1916a20f2e078bfaa604343d695e6f5f88d9f11c43a886ff97d9bd26b0126af40bed8e03a43bf8c912b5b0dd2f9f2e7e99db066759f573cd59a40a554bebdd3e7e0adbc38fcb91adeb72f9dcd30558b082471a02fd9131a61cf29b1f4e38a5d689d8dcd0b8dc29075e3a33b2d6a25bee6ff9e20d269cc088a2b155be76a1531ce30b25edf928990b5143fc5ae2737d8d4070d0517f5137c458d7afed8f51e2c2973dd143235c9deaffe9ce8fbcd767a93573399dafd5ef61408c77302c993354a080684cdbfb7c1eeb6e6be907db790038c7ce62517815d16fe366bd26178f2f05b9e56450814f4ba7ab6cab54c5f78316b0451057785c03a77c20814eb405cd20e5bff5247a12500dd16173125ffdef4fb6317ab942d0d7e0e584a8fd97a8ba8d87fd38127d6d059902a2d48dafd10938ea5d108f3eb986aabf9e212151b0e540bb5fd25888143633be9982395d4d3bef5278be37328e0239569eb511698ef7f9e7e12aa204cb4c069ffcdeecb65f42ba37f7bfd47c4ba8df384a88adf3486b58cc1620185ac81dfb10f591fc82f3ae046341ebd1e8288f10500d6677e91b89729dfd299b74be13a9183725aacb0023f4fb01efda61390b0312d90ff6a9a319433681ad1811efe038fcdeb6dc1c3f594c4f8011aacfee74ea9638fccb3d669435a1208578c934277caa3ec74f9efbb33e024909b121e7b4e48ec94b762fa9dcab8a1c11b86bb9db164c7655504d304661e04e95b0b356f5968334596fb11df95bbdcb3a6618f431c864658827662f760fc86b2136221bd50472dc19c4f177eb5edf7978760dc15150cfda0a3ea649cb672b8f37229298c6edcc630e3ac9a5f43f58a93ba8def335472f7ebdedd7715a27c4ea622344a949bec59af030455ed61911d53388022bd502e800b769ef499f94f02c96f486b40ce68dbdc42e5690ac2992bedf7f0ba384504c32cb00a25d4e125483003152e81ebe9c12d928627d7f14fc3fbdf5141addc477d5ae4f32e64dcb58a6e2cf955ad7ae54e1665b3199bd0fae36b9ec56c09ac00efc9d27e69a93f4e08652edc3340fa2c518d388ee4a005b9c83956b9139b98380f6925a1a4c3e64ff8d96f2827d0d8a25cc72a2c03a28e33871284b46e10c85f2ad75969b1d84e9d88bb4e05d</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># for k in range(3, 10):</span><span class="token comment">#     if iroot(n, k)[1]:</span><span class="token comment">#         print(iroot(n, k)[0])</span><span class="token comment">#         print(k)</span>k <span class="token operator">=</span> <span class="token number">4</span> p <span class="token operator">=</span> <span class="token number">20935418603755826153357961486749000137883878122092541278485245382546346099923598569473814209357669395236788185259189925906627960621490996925200115559569329810746744675867738485473466021581185385430988547168263735484625716958718825113577345085361945421237478366338611831738408648424304228723729310335432168121087334054958276987167490905779911687736536416815227240962562460212183301435420718431023950641725670461044591993133883921646824589614644103106984493917214402278641218422432546374433956301830629567708335305598359150744372547912472684947785245810663217040977994966632748245272393755319650187559761562868158211001</span><span class="token keyword">print</span><span class="token punctuation">(</span>isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>phi <span class="token operator">=</span> p <span class="token operator">**</span> <span class="token number">4</span> <span class="token operator">-</span> p <span class="token operator">**</span> <span class="token number">3</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">64</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;6354ce3ac23cdfeccf16eb1a53df4423&#125;'</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Adversarial Defense Note</title>
      <link href="2021/10/26/adversarial-defense-note/"/>
      <url>2021/10/26/adversarial-defense-note/</url>
      
        <content type="html"><![CDATA[<p>1）在学习过程中修改训练过程或者修改的输入样本。</p><p>2）修改网络，比如：添加更多层/子网络、改变损失/激活函数等。</p><p>3）当分类未见过的样本时，用外部模型作为附加网络。</p><p>第一个方法没有直接处理学习模型。</p><p>另外两个分类是更加关心神经网络本身的。</p><p>这些方法可以被进一步细分为两种类型：</p><p>（a）完全防御；（b）仅探测（detection only）。</p><p>「完全防御」方法的目标是让网络将对抗样本识别为正确的类别。</p><p>分为对抗训练 (adversarial training)、梯度掩蔽 (gradient masking)、输入转换 (input transformation) 和基于邻域分类 (region-based classification) 四种</p><p>「仅探测」方法意味着在对抗样本上发出报警以拒绝任何进一步的处理。</p><p>基于局部本征维数的检测， Feature Squeezing， MagNet</p><p><img src="http://5b0988e595225.cdn.sohucs.com/images/20180305/9ba701b84216478296f9e4062050919a.jpeg" alt="img"></p><h2 id="1-修改训练过程-输入数据"><a href="#1-修改训练过程-输入数据" class="headerlink" title="1 修改训练过程/ 输入数据"></a>1 修改训练过程/ 输入数据</h2><h3 id="1-蛮力对抗训练"><a href="#1-蛮力对抗训练" class="headerlink" title="1 蛮力对抗训练"></a>1 <strong>蛮力对抗训练</strong></h3><p>一般对抗训练， PGD对抗训练，集成对抗训练</p><p>不断输入新类型的对抗样本并执行对抗训练，从而不断提升网络的<strong>鲁棒性</strong>。为了保证有效性，该方法需要使用<strong>高强度</strong>的对抗样本，并且网络架构要有充足的表达能力。这种方法需要<strong>大量</strong>的训练数据，因而被称为蛮力对抗训练。</p><p>可以正则化网络以减少过拟合</p><p>但是可能无论添加多少对抗样本，都存在新的对抗攻击样本可以再次欺骗网络。</p><p>在训练过程中包含对抗样本的信息，从而构建一个鲁棒性更好的分类器。但是很难推断出攻击者的<strong>攻击方式</strong>，无法得知攻击者产生的对抗样本的模式、每种对抗样本的比重。</p><p>集成对抗训练防御方法将对抗训练的过程与对抗样本的产生过程分开，在对抗训练的过程中加入对抗样本是通过攻击其他模型产生的，增加了所加入对抗样本的多样性，从而提高模型抵御其他攻击方法的能力。</p><h3 id="2-数据压缩"><a href="#2-数据压缩" class="headerlink" title="2 数据压缩"></a>2 数据压缩</h3><p>注意到大多数训练图像都是 JPG 格式，使用 JPG 图像压缩的方法，减少对抗扰动对准确率的影响。实验证明该方法对<strong>部分</strong>对抗攻击算法有效，但通常仅采用压缩方法是<strong>远远不够</strong>的，并且压缩图像时同时也会<strong>降低正常分类的准确率</strong>，后来提出的 PCA 压缩方法也有同样的缺点。</p><h3 id="3-基于中央凹机制的防御"><a href="#3-基于中央凹机制的防御" class="headerlink" title="3 基于中央凹机制的防御"></a>3 基于中央凹机制的防御</h3><p>用中央凹（foveation）机制可以防御 L-BFGS 和 FGSM 生成的对抗扰动，其假设是<strong>图像分布对于转换变动是鲁棒的</strong>，而扰动不具备这种特性。但这种方法的<strong>普遍性尚未得到证明</strong>。</p><h3 id="4-数据随机化方法"><a href="#4-数据随机化方法" class="headerlink" title="4 数据随机化方法"></a>4 数据随机化方法</h3><p>对训练图像引入<strong>随机重缩放</strong>可以<strong>减弱</strong>对抗攻击的强度，其它方法还包括<strong>随机 padding</strong>、训练过程中的<strong>图像增强</strong>等。</p><h2 id="2-修改网络"><a href="#2-修改网络" class="headerlink" title="2 修改网络"></a>2 修改网络</h2><h3 id="5-深度压缩网络"><a href="#5-深度压缩网络" class="headerlink" title="5 深度压缩网络"></a>5 深度压缩网络</h3><p>简单地将去噪自编码器（Denoising Auto Encoders）堆叠到原来的网络上只会使其变得更加脆弱</p><p>因而引入了深度压缩网络（Deep Contractive Networks），其中使用了和压缩自编码器（Contractive Auto Encoders）类似的<strong>平滑度惩罚项</strong>。</p><p>使得模型的输出变化对输入敏感性降低，从而达到隐藏梯度信息的目的 </p><h3 id="6-梯度正则化-masking"><a href="#6-梯度正则化-masking" class="headerlink" title="6 梯度正则化/ masking"></a>6 <strong>梯度正则化/ masking</strong></h3><p>在训练的目标函数上惩罚输出对于输入的变化程度，可以在一定程度上限制小的对抗扰动，不会大幅改变最终模型的预测结果。</p><p>使用<strong>输入梯度正则化</strong>以提高对抗攻击鲁棒性，该方法和蛮力对抗训练结合有很好的效果，但计算<strong>复杂度太高</strong>。</p><h3 id="7-Defensive-distillation"><a href="#7-Defensive-distillation" class="headerlink" title="7 Defensive distillation"></a>7 <strong>Defensive distillation</strong></h3><p>利用蒸馏方法训练两个串联的 DNN 模型来提高模型预测的鲁棒性 </p><p>证明其可以抵抗<strong>小幅度</strong>扰动的对抗攻击。</p><p>在训练过程中通过各种方式隐藏梯度信息，从而使得攻击很难通过梯度求解方法攻击目标训练器，但是该防御方法很容易被各种攻击技巧<strong>绕过</strong>。</p><p>并不能增加神经网络的鲁棒性，而且这种防御方法需要改变并重新训练目标分类器，增加了工程上的复杂性。</p><h3 id="8-生物启发的防御方法"><a href="#8-生物启发的防御方法" class="headerlink" title="8 生物启发的防御方法"></a>8 生物启发的防御方法</h3><p>使用类似与生物大脑中<strong>非线性树突计算的高度非线性激活函数</strong>以防御对抗攻击</p><h3 id="9-Parseval-网络"><a href="#9-Parseval-网络" class="headerlink" title="9 Parseval 网络"></a>9 Parseval 网络</h3><p>在一层中利用全局 Lipschitz 常数加控制，利用<strong>保持每一层的 Lipschitz 常数</strong>来摆脱对抗样本的干扰。</p><h3 id="10-DeepCloak"><a href="#10-DeepCloak" class="headerlink" title="10 DeepCloak"></a>10 DeepCloak</h3><p>在分类层（一般为输出层）前加一层<strong>特意为对抗样本训练的层</strong>。它背后的理论认为在<strong>最显著的层里包含着最敏感的特征</strong>。</p><h3 id="11-混杂方法"><a href="#11-混杂方法" class="headerlink" title="11 混杂方法"></a>11 混杂方法</h3><p>这章包含了多个人从多种角度对深度学习模型的调整从而使模型可以抵抗对抗性攻击。</p><h3 id="12-仅探测方法"><a href="#12-仅探测方法" class="headerlink" title="12 仅探测方法"></a>12 仅探测方法</h3><p>这章介绍了 4 种网络，SafetyNet，Detector subnetwork，Exploiting convolution filter statistics 及 Additional class augmentation。</p><ul><li>SafetyNet 介绍了 ReLU 对对抗样本的模式与一般图片的不一样，文中介绍了一个用 SVM 实现的工作。</li><li>Detector subnetwork 介绍了用 FGSM, BIM 和 DeepFool 方法实现的对对抗样本免疫的网络的优缺点。</li><li>Exploiting convolution filter statistics 介绍了同 CNN 和统计学的方法做的模型在分辨对抗样本上可以有 85% 的正确率。</li></ul><p>训练一个分类器来区分对抗样本与正常样本，与对抗训练方法不同的是：对抗训练只是改善了原有分类器的正确性，而该方法是额外增加一个分类器。</p><h2 id="3-使用附加网络"><a href="#3-使用附加网络" class="headerlink" title="3 使用附加网络"></a>3 使用附加网络</h2><h3 id="13-防御通用扰动"><a href="#13-防御通用扰动" class="headerlink" title="13 防御通用扰动"></a>13 防御通用扰动</h3><p>利用一个<strong>单独训练</strong>的网络加在原来的模型上，从而达到<strong>不需要调整系数</strong>而且免疫对抗样本的方法。</p><h3 id="14-基于-GAN-的防御"><a href="#14-基于-GAN-的防御" class="headerlink" title="14 基于 GAN 的防御"></a>14 基于 GAN 的防御</h3><p>用 GAN 为基础的网络可以抵抗对抗攻击，而且作者提出在所有模型上用相同的办法来做都可以抵抗对抗样本。</p><h3 id="15-仅探测方法"><a href="#15-仅探测方法" class="headerlink" title="15 仅探测方法"></a>15 仅探测方法</h3><p>介绍了 Feature Squeezing、MagNet 以及混杂的办法。</p><ul><li>Feature Squeezing 方法用了两个模型来探查是不是对抗样本。后续的工作介绍了这个方法对 C&amp;W 攻击也有能接受的抵抗力。</li><li>MagNet: 作者用一个分类器对图片的流行（manifold）测量值来训练，从而分辨出图片是不是带噪声的。</li><li>混杂方法（Miscellaneous Methods）：作者训练了一个模型，把所有输入图片当成带噪声的，先学习怎么去平滑图片，之后再进行分类。</li></ul><p>基于邻域分类防御从待预测样本<strong>邻域范围内随机选取</strong>若干个样本，利用原模型对取样后的所有样本进行预测，再采用<strong>多数表决方式选择预测标签最多</strong>的作为待预测样本最终的标签</p><h2 id="Challenge"><a href="#Challenge" class="headerlink" title="Challenge"></a>Challenge</h2><h3 id="基于对抗训练的防御"><a href="#基于对抗训练的防御" class="headerlink" title="基于对抗训练的防御"></a>基于对抗训练的防御</h3><p>需要大量的对抗样本，极大地增加了训练的时间和所需资源， 使得该防御很难在实际场景的大规模数据集上使用 </p><p>由于训练过程中只能加入由<strong>已知</strong>攻击产生的且<strong>有限</strong>的对抗样本，因此对抗训练防御通常只对与加入训练<strong>同类型</strong>的对抗样本有效，对其他攻击产生的对抗样本不具有<strong>泛化</strong>能力。 </p><h3 id="梯度掩蔽防御"><a href="#梯度掩蔽防御" class="headerlink" title="梯度掩蔽防御"></a>梯度掩蔽防御</h3><p>一个简单绕过该防御的方法是，攻击者通过训练一个与<strong>防御后的模型相似的替代模型</strong>，进而通过使用替代模型的梯度来构造对抗样本，从而达到绕过防御后模型的目的。</p><p>需要改变模型结构并重新训练分类器，进一步增加了该防御方法在工程上的复杂性。 </p><h3 id="基于输入转换的防御"><a href="#基于输入转换的防御" class="headerlink" title="基于输入转换的防御"></a>基于输入转换的防御</h3><p>一般不改变任何模型网络结构和训练数据集，但是需要对待预测样本进行转换处理。理论上，输入转换方法对任何种类的 攻击样本都有一定的防御效果，但是实验表明这种防御方法在对抗样本预测上的<strong>误报率和漏报率较大</strong>。 </p><h3 id="基于邻域分类的防御"><a href="#基于邻域分类的防御" class="headerlink" title="基于邻域分类的防御"></a>基于邻域分类的防御</h3><p>主要利用待预测样本邻域范围内其他样本的预测值。该方法有两个非常重要的参数，分别是邻域范围半径 r 和采样个数 N。 但是r 越大，分类器预测正常样本的准确率越低 ； 而 r 越小，该方法对对抗样本的防御效果就会越差。 同样地，N 越大，该方法的效率会成倍数增加 ；N 越小，防御效果也会越差。 </p><h3 id="检测防御"><a href="#检测防御" class="headerlink" title="检测防御"></a>检测防御</h3><p>对正常样本的分类准确率会降低，并没有说明检测结果为“对抗样本”的解决方法。</p><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p>每种防御方法都只能抵御有限的对抗样本，并且很容易被不断进化和变种的对抗样本绕过</p><p>现有防御方法都是一种被动式的防御，只能防御某一类攻击，不能够解决 0-Day 攻击等未知风险</p><p>研究人员研究了 ICLR 2018 收录的八篇关于对抗样本的论文中的防御方法鲁棒性，发现其中七种防御方法可以通过改进的攻击算法来攻破</p>]]></content>
      
      
      <categories>
          
          <category> note </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Improving the Adversarial Robustness and Interpretabilityof Deep Neural Networks by Regularizing Their Input Gradients</title>
      <link href="2021/10/19/improving-the-adversarial-robustness-and-interpretabilityof-deep-neural-networks-by-regularizing-their-input-gradients/"/>
      <url>2021/10/19/improving-the-adversarial-robustness-and-interpretabilityof-deep-neural-networks-by-regularizing-their-input-gradients/</url>
      
        <content type="html"><![CDATA[<h1 id="通过调整深度神经网络的输入梯度提高其对抗性鲁棒性和可解释性"><a href="#通过调整深度神经网络的输入梯度提高其对抗性鲁棒性和可解释性" class="headerlink" title="通过调整深度神经网络的输入梯度提高其对抗性鲁棒性和可解释性"></a>通过调整深度神经网络的输入梯度提高其对抗性鲁棒性和可解释性</h1><p>只记录文中有蒸馏用于对抗攻击的防御的部分。</p><h2 id="Defenses"><a href="#Defenses" class="headerlink" title="Defenses"></a>Defenses</h2><p>​        作为基线防御，我们考虑防御蒸馏和对抗训练。为了简化比较，我们省略了不完全是架构不可知论或通过检测和拒绝对抗性示例而起作用的防御。</p><p>​        首先将其作为一种潜在的防御措施进行了研究。主要思想是，我们训练模型两次，<strong>最初使用一个热点真值标签</strong>，但最终使用<strong>初始模型的softmax概率输出</strong>，其中包含有关问题的附加信息。由于正常的softmax函数趋向于非常快地收敛到一个热态，我们将所有逻辑网络输出除以一个温度集（在训练期间，而不是评估期间）。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvkrx7weyqj60e604c74802.jpg"></p><p>​        其中，我们使用fT,θ表示以具有温度的softmax结尾的网络。注意，T接近∞, 词汇量集中到1/K。整个过程可以表示为：</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvkrzb9p5zj60ka06ewes02.jpg"></p><p>​        蒸馏通常用于帮助小型网络达到与大型DNN相同的精度，但在防御性的上下文中，我们两次使用相同的模型。它已被证明能有效<strong>防御白盒FGSM攻击</strong>，但已证明它对所有类型的攻击都不鲁棒。我们将看到，它防御某些攻击的精确方式与梯度正则化在质量上是不同的，它实际上可以使模型<strong>比未防御模型更容易受到攻击</strong>。</p><p>​        实验：我们使用T=50的softmax temperature 。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvks2lffvpj60ma0gujtm02.jpg"></p><p>​        FGSM示例上所有CNN的准确性，用于愚弄MNIST、SVHN和NOTNIST（从上到下）上的未设防模型、防御蒸馏模型、高级训练模型和梯度正则化模型（从左到右）。梯度正则化模型是Tother模型在高下最具抵抗力的对抗性示例，而所有模型都被梯度正则化模型示例愚弄。在NIST和notMNIST上，提取的模型示例通常与非对抗性示例相同（由于梯度下溢），因此它们无法愚弄任何其他模型。</p><h2 id="Accuracy-Evaluations-FGSM-and-TGSM"><a href="#Accuracy-Evaluations-FGSM-and-TGSM" class="headerlink" title="Accuracy Evaluations (FGSM and TGSM)"></a>Accuracy Evaluations (FGSM and TGSM)</h2><p>​        用防御蒸馏法训练的模型一般不比未防御模型好，也不比未防御模型差。值得注意的是，除了SVHN之外，针对蒸馏模型的攻击实际上无法愚弄所有模型。仔细检查蒸馏模型梯度和示例本身表明，出现这种情况是因为蒸馏的FGSM梯度消失了，所以示例根本不受干扰。当我们从另一个模型中得到一个非零扰动时，蒸馏的鲁棒性也消失了。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvks83xlcyj60nq0gm41302.jpg"></p><p>​        CNN accuracy on y+1 TGSM示例生成用于愚弄三个数据集上的四个模型。梯度正则化模型对其他模型的对抗性示例具有鲁棒性。蒸馏模型对抗性扰动愚弄其他模型，因为它们的输入梯度不再下溢。</p><h2 id="TGSM-Robustness"><a href="#TGSM-Robustness" class="headerlink" title="TGSM Robustness"></a>TGSM Robustness</h2><p>​        针对TGSM攻击，防御提取模型梯度不再消失，相应地，这些模型开始显示出与其他模型相同的对抗攻击脆弱性。梯度正则化模型即使在较大的扰动下仍表现出相同的鲁棒性，同样，为愚弄它们而生成的示例也同样愚弄了其他模型。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvksc9manxj60mq0kaac702.jpg"></p><p>​        蒸馏模型（在T=0评估）将极小的概率分配给除predicted class之外的所有类，其TGSM梯度爆炸，而其FGSM梯度消失（我们将最小值设置为10^(−20)以防止下溢）。</p><p>​        更好地理解辐射正则化模型、正态模型和蒸馏模型之间的差异的一种方法是分析它们输出的对数概率及其损失函数输入梯度的范数，其分布上图所示。我们可以看到，不同的防御有非常不同的统计数据。对于梯度正则化模型，非预测类的概率往往很小，但仍然是非零的，而对于评估为T=0的非预测类模型，它们消失了（尽管蒸馏声明了抑制确定性的目的）。可能是因为∇logp(x)=1/p(x)∇p(x)，防御提取模型的非预测对数概率输入梯度在许多数量级上是最大的，而梯度正则化模型保持受控，具有小得多的方差。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvksieqif7j60ne0b60uo02.jpg"></p><p>​        对于蒸馏模型（顶部）和梯度正则化模型（底部），对最大失真参数γ=0.25的MNIST 0和1图像应用JSMA的结果。每行中的示例都以高亮显示的数字开始，但会进行修改，直到模型预测对应于其列的数字或出现最大失真为。</p><h2 id="Human-Subject-Study-JSMA-and-Iterated-TGSM"><a href="#Human-Subject-Study-JSMA-and-Iterated-TGSM" class="headerlink" title="Human Subject Study (JSMA and Iterated TGSM)"></a>Human Subject Study (JSMA and Iterated TGSM)</h2><h3 id="Need-for-a-Study"><a href="#Need-for-a-Study" class="headerlink" title="Need for a Study"></a>Need for a Study</h3><p>​        报告JSMA的准确度数字可能会产生误导，因为在没有最大距离约束的情况下，它必须运行，直到模型预测目标。即使有了这样的约束，它所产生的扰动有时也会改变示例，使其不再像原来的标签，在某些情况下更像其目标。上图显示了MNIST上的梯度正则化和蒸馏模型的JSMA例子，这些模型试图将0和1转换为其他数字。虽然所有的扰动都“成功”改变了模型的预测，但我们可以看到，在梯度正则化的情况下，许多JSMA例子强烈地重组了它们的目标。</p><h3 id="Study-Protocol"><a href="#Study-Protocol" class="headerlink" title="Study Protocol"></a>Study Protocol</h3><p>​        初步研究包括定量和定性部分。在定量部分，受试者展示了30幅MNIST JSMA或SVHN迭代GSM示例的图像。30幅图像中的每幅对应一个原始数字（从0到9）和一个模型（蒸馏，梯度正则化，或未防御）</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvkt4of3cgj60n007idgv02.jpg"></p><h3 id="Study-Results"><a href="#Study-Results" class="headerlink" title="Study Results"></a>Study Results</h3><p>​        上表显示了人体实验的定量结果。总体而言，受试者发现梯度正则化模型对抗性示例最具说服力。在SVHN，尤其是MNIST上，人类最有可能认为梯度正则化（而不是蒸馏或正常）对抗性示例最好归类为他们的目标，而不是他们的原始数字。此外，当他们没有考虑目标是最合理的标签时，他们最可能考虑梯度正则模型错误预测“合理”，更可能考虑蒸馏模型错误预测是合理的。对于MNIST和SVHN，正态和梯度正则化不合理错误率之间差异的p值分别为0.07和0.08。</p><p>​        很少有评论员指出正常例子和蒸馏例子之间有任何区别，有几个评论员说“似乎没有明显的区别”，或者他们“无法描述它们之间的区别”。在小组讨论中，一个主题评论了对梯度正则化模型的微扰感觉如何“更有意”，和其他人评论了数字之间的某些转换如何导致非常可信的假货，而其他数字似乎天生就更难。尽管这项研究规模较小，但其定量和定性结果都支持这样的观点，即梯度正则化，至少对于MNIST和SVHN上的两个CNN而言，是对JSMA和ite的可靠防御额定温度为TGSM，蒸馏不适用。</p><h3 id="Connections-to-Interpretability"><a href="#Connections-to-Interpretability" class="headerlink" title="Connections to Interpretability"></a>Connections to Interpretability</h3><p>​        在下图中，我们可视化了各个模型和数据集的输入梯度，虽然我们无法做出任何定量声明，但梯度正则化模型（对敌对示例而言相对稳健）与正常模型和蒸馏模型之间的输入梯度的可解释性似乎存在质的差异（容易受到影响）。逆向训练的模型似乎表现出更易于解释的梯度，但与梯度正则化模型的程度不同。当我们使用迭代TGSM重复应用基于输入梯度的扰动时（最后的图），模型之间在可解释性方面的差异得到了极大的体现，梯度正则化模型的结果似乎提供了对模型所学内容的洞察。当梯度是可解释的时，我们实际上可以使用对抗性攻击作为解释。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvksv3c7l5j61ao0g0tf802.jpg"></p><h2 id="Discussion"><a href="#Discussion" class="headerlink" title="Discussion"></a>Discussion</h2><p>​        虽然还需要一项更大规模的研究来验证这一点，但我们的结果强烈表明，蒸馏和对抗性训练增强稳健性的方式在质量上与梯度正则化不同，并且与更高的解释性无关。</p><p>​        当然，根据定义，蒸馏需要两倍的训练时间，而常规训练增加的训练时间接近3倍（因为我们必须评估、区分和重新评估每个批次）。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvksy329gnj61cw0cgju202.jpg"></p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvksyq4a9lj61cc0e6aen02.jpg"></p><p>​        为了观察我们是否可以将蒸馏和梯度正则化结合起来，我们还尝试使用蒸馏概率从正常CNN训练和评估 at T=50中获得，这与双反向传播相当，但不比双反向传播更好。使用模型自身的概率输出ˆy（即其熵）似乎没有影响。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvkt0e09rrj61cs0quqj502.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> note </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Knowledge Distillation- A Survey Notes（下）</title>
      <link href="2021/10/17/knowledge-distillation-a-survey-notes-xia/"/>
      <url>2021/10/17/knowledge-distillation-a-survey-notes-xia/</url>
      
        <content type="html"><![CDATA[<h2 id="Teacher-Student-Architecture"><a href="#Teacher-Student-Architecture" class="headerlink" title="Teacher-Student Architecture"></a>Teacher-Student Architecture</h2><p>​        教师与学生之间知识获取和蒸馏的质量也取决于如何设计教师与学生网络。近年来，在蒸馏过程中，教师和学生的模型设置几乎都是预先固定的，尺寸和结构都是不变的，因此很容易造成模型容量的差距。然而，如何具体设计教师和学生的体系结构，以及为什么他们的体系结构是由这些模型设置决定的，几乎没有人知道。在本节中，我们主要讨论教师和学生模型结构之间的关系。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvik5l72akj60i60dsmy702.jpg"></p><p>​        知识蒸馏被设计用于对深层神经网络进行集成。深层神经网络的复杂性主要来自两个维度：深度和宽度，即我们通常需要将知识从更深更广的神经网络转移到更浅更薄的神经网络。</p><p>因此，学生网络通常可以是：</p><ol><li>教师网络的简化版本，<strong>每层的层数较少和/或通道数较少</strong></li><li>教师网络的<strong>量化</strong>版本，与教师网络<strong>共享一些相同的结构</strong></li><li>基于教师<strong>高效基本操作</strong>的小型网络</li><li>具有<strong>优化全局网络结构</strong>的小型网络</li><li>和老师一样的结构</li></ol><p>大型深度神经网络和小型学生神经网络之间的模型容量差距降低了知识传递的性能。</p><ol><li>引入了一名教师助理，以缓解教师模式和学生模式之间的培训差距，这一差距通过剩余学习得到进一步改善，即<strong>使用助理结构来学习剩余错误</strong>。</li><li>关注最小化学生模型和教师模型在结构上的差异。例如将网络量化与知识蒸馏相结合，即学生模型是教师模型的小型量化版本。</li><li>提出了结构压缩方法，即将多层学习的知识转移到单层。</li><li>从教师网络到学生网络，在保持感受野的情况下，逐步进行知识迁移。在在线环境中，教师网络通常是学生网络的集合，其中学生模型彼此具有相似的结构（或相同的结构）。</li></ol><p>​        最近，<strong>深度可分离卷积</strong>被广泛用于设计用于移动或嵌入式设备的高效神经网络。受<strong>神经架构搜索</strong>（NAS）成功的启发，通过基于高效元运算或块搜索全局结构，小型神经网络的性能得到了进一步提高。此外，<strong>动态搜索适当知识转移机制</strong>的想法也出现在知识蒸馏中，例如，使用<strong>强化学习自动移除数据驱动方式中的冗余层</strong>，并搜索给定教师网络的最佳学生网络。知识蒸馏中的神经架构搜索思想，即<strong>在教师模型指导下对学生结构和知识转移的联合搜索</strong>，将是未来研究的一个有趣课题。</p><h2 id="Distillation-Algorithms"><a href="#Distillation-Algorithms" class="headerlink" title="Distillation Algorithms"></a>Distillation Algorithms</h2><p>​        在教师模型和学生模型之间直接匹配响应/基于特征的知识边缘或特征空间的分布。</p><h3 id="Adversarial-distillation"><a href="#Adversarial-distillation" class="headerlink" title="Adversarial distillation"></a>Adversarial distillation</h3><p>​        在知识蒸馏中，教师模型很难从真实的数据分布中完美学习，学生模型也无法很好地模仿教师模型，通过传递教师知识来学习数据的真实分布，因为其容量较小。最近，对抗式学习由于其在生成性网络中的巨大成功而受到越来越多的关注，GANs中的鉴别器估计样本来自训练数据分布的可能性，而生成器试图通过生成的数据样本愚弄鉴别器。受此启发，越来越多的对抗性知识分散方法被提出，以使教师/学生网络更好地理解真实的数据分布。</p><ol><li>对抗性生成器经过训练生成合成数据，该数据可直接用作训练数据集或用于扩充训练数据集。还尝试利用对抗性生成器生成知识转移的硬示例。</li><li>引入鉴别器，通过使用日志或特征将样本与学生和教师模型区分开来。具体而言，使用未标记的数据样本来形成知识转移，并且使用了多个鉴别器。此外使用了有效的中间监督，即挤压知识边缘，以缓解教师和学生之间的能力差距。</li><li>与上述两类不同，教师模型在学生模型的训练过程中是固定的，对抗性知识蒸馏也以在线方式工作，即教师和学生在每一种情况下共同优化。此外，利用知识蒸馏来压缩GAN，一个有学问的小GAN学生网络通过知识转移模仿一个更大的GAN教师网络。</li></ol><ol><li>GAN是通过教师知识转移增强学生学习能力的有效工具</li><li>GAN和KD的联合可以产生有价值的数据，用于改进KD性能，克服对不可用和不可访问数据的模仿</li><li>KD可用于压缩GANs</li></ol><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvil4j0zu1j60jg0fmabr02.jpg"></p><h3 id="Multi-teacher-distillation"><a href="#Multi-teacher-distillation" class="headerlink" title="Multi-teacher distillation"></a>Multi-teacher distillation</h3><p>​        可以单独和完整地使用多个教师网络来进行教学过程中的蒸馏。要从多名教师那里传递知识，最简单的方法是使用所有教师的<strong>平均反应作为监督信号</strong>。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvilprqxqij60j80aiq3h02.jpg"></p><p>​        以logits和特征表示作为知识。除了来自所有教师的平均logits外，还进一步纳入了<strong>中介人员的特征</strong>，以鼓励不同培训样本之间的差异性。为了利用逻辑特征和中间特征，使用了两个教师网络，其中一名教师向学生传授基于<strong>反应</strong>的知识，另一名教师向学生传授基于<strong>特征</strong>的知识。在每次迭代中从教师网络库中随机选择一名教师。为了从多个教师那里转移基于特征的知识，在学生网络中增加了额外的教师分支，以模仿教师的中间特征。重生网络以一步一步的方式解决了多个教师的问题，即t step的学生被用作t+1 step学生的老师。为了有效地执行知识传输并探索多台服务器的功能，已经提出了几种替代方法，通过添加不同的噪声或使用随机块和跳跃连接，模拟一名教师的多名教师。由于多教师KD的特殊性，其扩展被用于通过知识适应进行领域适应，并保护数据的竞争性和安全性。</p><h3 id="Cross-modal-distillation"><a href="#Cross-modal-distillation" class="headerlink" title="Cross-modal distillation"></a>Cross-modal distillation</h3><p>​        在跨模态场景中，它可以很容易地实现不同模态之间的知识转移。不同的输入数据模式提供相似或补充信息，而某些模式的数据/标签在培训/测试阶段可能不可用。</p><p>​        给定一个教师模型，该模型在一个模态（例如RGB图像）上预训练，并带有大量注释良好的数据样本，旨在使用新的未标记输入模态（例如深度图像和光流）将知识从教师模型转移到学生模型。具体而言，建议的方法依赖于两种模式上的未标记配对样本，即HRGB和深度图像，然后教师从RGB图像中获得的特征被用作监督来训练学生。成对样本背后的理念是通过成对样本注册传递注释/标签信息，并已广泛用于跨模式应用。为了通过墙壁和遮挡进行人体姿势估计，使用同步无线电信号和摄像机图像，在基于无线电的人体姿势估计模式之间传递知识。来自两种模式（RGBvideos和skeleton sequence）的成对样本用于转移从RGB视频中学习到的知识应用于新的基于骨架的人体动作识别模型。为了仅使用RGB图像来提高动作识别性能，对另一种模式（即深度图像）进行了跨模式辨别，以生成RGB图像模式的幻觉流。进一步介绍了对比损失，以在不同模式之间传递成对关系。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvinl29o7nj60iw0bst9i02.jpg"></p><p>​        提出了一种基于知识蒸馏的可视化问答方法，将以图像问答为输入的三线性互动教师模型中的知识分解为以图像问答为输入的学习双线性互动学生模型。提出的概率知识蒸馏也被很好地用于从文本模态到视觉模态的知识转移。通过跨模态蒸馏提出了一种模态幻觉架构，以提高检测性能。</p><h3 id="Graph-based-distillation"><a href="#Graph-based-distillation" class="headerlink" title="Graph-based distillation"></a>Graph-based distillation</h3><p>​        大多数知识蒸馏算法侧重于根据每个训练样本将知识从教师传递给学生，而最近提出了几种方法来探索数据内部的关系。主要思想可以概括为：</p><ol><li>利用图作为教学知识的载体</li><li>利用图形控制教师知识的信息传递。</li></ol><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvinfg45y3j60iw0bcgma02.jpg"></p><p>基于图形的知识属于基于关系的知识。在本节中，我们将介绍基于图的知识的典型定义和基于图的消息传递蒸馏算法。</p><p>​        每个顶点代表一个自我监督教师和两个图，然后使用logits和中间特征构造，以将多个自我监督任务中的知识转移到学生模型/任务中。图形用于维持高维空间中样本之间的关系，然后通过建议的位置服务前损失函数进行知识转移。通过多头图考虑了数据关系，其中顶点是CNNs中不同层次的特征。直接传递了数据样本的交互关系，即匹配教师和学生之间的图形边缘。相似矩阵中的相互关系被改变，相似性保留知识通过匹配相似矩阵进行转移。不仅匹配了基于响应和基于特征的知识，还使用了基于图形的知识。实例特征和实例关系分别被建模为图形的顶点和边。</p><p>​        与使用基于图形的知识不同，有几种方法使用图形控制知识转移的过程。考虑了模态差异，以纳入来自源域的专有信息，并引入了一个名为蒸馏图的定向图，以探索不同模态之间的关系，其中每个顶点表示一个模态，边表示一个模态到另一个的<strong>连接强度</strong>。提出了一种基于双向图形的多元协作学习，以探索不同的知识转移模式。进一步引入GNNs来处理基于图形的知识的知识转移。</p><h3 id="Attention-based-distillation"><a href="#Attention-based-distillation" class="headerlink" title="Attention-based distillation"></a>Attention-based distillation</h3><p>​        由于注意可以很好地反映卷积神经网络的神经元激活，因此在知识蒸馏中使用了一些注意机制来提高学生网络的性能。在这些基于注意力的方法中，不同的注意力转移被定义为将知识从教师网络蒸馏到学生网络的机制。注意转移的核心是定义神经网络各层特征嵌入的注意图。也就是说，<strong>关于网络特征嵌入的知识是通过注意图函数传递的</strong>。与注意映射不同，通过设计注意机制，对不同的置信度规则进行注意分配，提出了一种注意知识蒸馏方法。</p><h3 id="Data-free-distillation"><a href="#Data-free-distillation" class="headerlink" title="Data-free distillation"></a>Data-free distillation</h3><p>​        为了克服因隐私、合法性、安全性和保密性问题而导致的数据不可用问题，提出了一些无数据KD方法。顾名思义，学生网络的<strong>迁移训练数据是不存在</strong>的，可以通过不同的方式<strong>新生成或综合生成</strong>。传输数据由GAN生成。通过使用教师网络的<strong>层激活或层光谱激活重建</strong>用于训练学生网络的传输数据。不使用现有数据，传输数据是通过从教师网络的参数中建模softmax空间生成的。targetdata是通过使用教师网络特征表示中的信息生成的。与零次学习类似，设计了一种少次学习的知识蒸馏方法，该方法通过高斯过程将教师模型中的知识蒸馏到学生神经网络中，教师使用有限的标记数据。</p><h3 id="Quantized-distillation"><a href="#Quantized-distillation" class="headerlink" title="Quantized distillation"></a>Quantized distillation</h3><p>​        网络量化通过将高精度网络（例如32位浮点）转换为低位网络（例如2位和8位），降低了神经网络的计算复杂性。同时，知识分解的目的是训练小模型，使其产生与复杂模型相似的性能。受此启发，一些量化KD方法通过使用师生框架中的量化过程提出。具体而言，提出了将知识转移到加权量化学生网络的量化蒸馏方法。提出的量化DKD被称为“学徒”，其中高精度网络作为教师，通过知识转移教授低精度网络作为学生。为了使小型学生网络很好地模拟大型教师网络，首先在特征图上对全精度教师网络进行量化，然后将知识从量化教师转移到量化学生网络。量化感知知识蒸馏是通过量化学生网络的自学习和师生网络知识转移的共同学习而提出的。此外，根据知识蒸馏的超参数（包括教师网络的大小和蒸馏温度），使用蒸馏和量化对深度神经网络进行了实证分析。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvin0xfjstj60ig0bsjs902.jpg"></p><h3 id="Lifelong-distillation"><a href="#Lifelong-distillation" class="headerlink" title="Lifelong distillation"></a>Lifelong distillation</h3><p>​        终身学习包括持续学习、持续学习和元学习，旨在以与人类相似的方式学习。它不仅可以积累以前学到的知识，还可以将学到的知识<strong>转化为未来的学习</strong>。考虑到知识分散的特点，它可以作为一种有效的方法来保存和转移所学知识，以避免灾难性的后果。</p><p>​        设计了一个元传输网络，可以确定师生ar体系结构中传输的内容和位置。提出了一个称为Leap的轻量级框架，通过在学习过程中传递知识，实现任务流形上的元学习。设计了一种新的用于图像识别的知识转移网络体系结构，该结构同时结合了图像的视觉信息和先验知识。提出了一种用于图像检索的无意识知识保存方法，并保存和传递了来自图像形态和语义信息的教师知识边缘。此外，为了解决长期学习中的灾难性<strong>遗忘</strong>问题，全球蒸馏、多模型蒸馏、基于知识蒸馏的终身学习方法和其他基于知识蒸馏的方法已开发用于蒸馏所学知识并在新任务上教授学生网络。</p><h3 id="NAS-based-distillation"><a href="#NAS-based-distillation" class="headerlink" title="NAS-based distillation"></a>NAS-based distillation</h3><p>​        神经结构搜索（NAS）是最流行的自动机器学习（AutoML）技术之一，其目的是自动识别深层神经模型，自适应地学习合适的深层神经结构。同时，在知识的蒸馏中，知识转移的成功不仅取决于教师的知识，还取决于学生的结构。然而，大教师模型和小学生模型之间可能存在能力差距，使学生难以从教师的知识中很好地学习。为了解决这个问题，已采用神经架构搜索来在知识蒸馏中找到合适的学生架构，如基于oracle的架构和架构感知知识蒸馏。此外，知识蒸馏还可用于提高神经架构搜索的效率，如AdaNAS、具有蒸馏架构知识的NAS和教师指导的架构搜索或TGSA。在GSA中，每个架构搜索步骤都被引导来模拟教师网络的中间特征表示，在该网络中，结构和候选作品（或学生）被有效地搜索，并且教师有效地监督自然迁移。</p><h2 id="Applications"><a href="#Applications" class="headerlink" title="Applications"></a>Applications</h2><p>​        作为一种有效的深层神经网络压缩和加速技术，知识提取已广泛应用于人工智能的各个领域，包括视觉识别、语音识别、自然语言处理（NLP）和推荐系统。此外，知识提取还可用于其他目的，如数据隐私和<strong>防御对抗性攻击</strong>。</p><h3 id="KD-in-Visual-Recognition"><a href="#KD-in-Visual-Recognition" class="headerlink" title="KD in Visual Recognition"></a>KD in Visual Recognition</h3><p>​        大多数知识蒸馏方法之前都是为图像分类而开发的，然后扩展到其他视觉识别应用，包括人脸识别，动作识别，对象检测、车道检测、行人检测、视频分类、人脸地标检测、人员重新识别，姿势估计，图像或视频分割，盐度估计，图像重分类，深度估计、目测里程和目视问题回答。</p><h3 id="KD-in-NLP"><a href="#KD-in-NLP" class="headerlink" title="KD in NLP"></a>KD in NLP</h3><h3 id="KD-in-Speech-Recognition"><a href="#KD-in-Speech-Recognition" class="headerlink" title="KD in Speech Recognition"></a>KD in Speech Recognition</h3><h3 id="KD-in-Other-Applications"><a href="#KD-in-Other-Applications" class="headerlink" title="KD in Other Applications"></a>KD in Other Applications</h3><p>​        在推荐系统中，如何充分、正确地利用用户评论和产品图片等外部知识进行推荐，对深度推荐模型的有效性起着非常重要的作用。最重要的是，降低深度沟通模型的复杂性和提高效率也是非常必要的。最近，知识蒸馏已成功应用于深部模型压缩和加速的推荐系统。知识提取首次被引入推荐系统，并被称为排名提取，因为推荐是一个排名问题。设计了一种对抗性的知识提取方法，用于高效推荐。在这种推荐系统中，教师作为正确的复习预测网络监督学生的用户项目预测网络（生成器），学生的学习通过教师和学生网络之间的对抗性适应进行调整。设计了一个用于推荐系统的增强型协同去噪自动编码器（ECAE）模型，通过知识蒸馏从用户反馈的生成数据中捕获有用的知识并进行还原。统一的ECAE框架包括一个生成网络、一个再培训网络和一个从生成网络中转移知识和减少噪音的蒸馏层。</p><p>​        利用教师-学生体系结构中知识分散的自然特性，知识蒸馏被用作一种有效的策略，用于解决深度模型的恶意攻击或干扰以及因隐私、证实性和安全问题而无法获得的数据问题。<strong>对抗性样本的干扰可以通过教师网络和蒸馏的稳健输出来克服</strong>。为了避免暴露直接使用数据的数据隐私，多名教师访问敏感或未标记数据的每个子集，并监督学生。为了解决数据带来的隐私和安全性问题，通过无数据蒸馏使用教师网络的分层操作或分层光谱激活来生成用于培训学生网络的数据。为了保护数据隐私和知识盗版，将学生模型发布在公共数据上，而教师模型发布在敏感和公共数据上。这种私有知识提取采用了隐私损失和bathloss来进一步提高隐私度。为了考虑隐私和性能之间的折衷，开发了一种新的基于分层知识提取的网络压缩方法，每类样本数很少，并取得了显著的性能。当然，知识提炼还有其他特别有趣的应用，如神经架构搜索和深层神经网络的可解释性。</p><h2 id="Discussions"><a href="#Discussions" class="headerlink" title="Discussions"></a>Discussions</h2><h3 id="Challenges"><a href="#Challenges" class="headerlink" title="Challenges"></a>Challenges</h3><h3 id="Future-Directions"><a href="#Future-Directions" class="headerlink" title="Future Directions"></a>Future Directions</h3><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>​        本文从知识、蒸馏方案、师生体系结构、蒸馏算法、应用以及面临的挑战和未来方向等方面对知识蒸馏进行了全面的综述。我们希望这次全面的回顾不仅能提供知识蒸馏的一个概览，而且能为未来的研究提供一些见解。</p>]]></content>
      
      
      <categories>
          
          <category> note </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Knowledge Distillation- A Survey Notes（上）</title>
      <link href="2021/10/10/knowledge-distillation-a-survey-notes-shang/"/>
      <url>2021/10/10/knowledge-distillation-a-survey-notes-shang/</url>
      
        <content type="html"><![CDATA[<h2 id="Intro"><a href="#Intro" class="headerlink" title="Intro"></a>Intro</h2><p>​        巨大的计算复杂性和巨大的存储需求给实时应用的部署带来了巨大的挑战，特别是对于资源有限的设备，如嵌入式人脸识别系统和自动驾驶汽车。</p><h3 id="categories"><a href="#categories" class="headerlink" title="categories"></a>categories</h3><ol><li>参数削减和共享</li><li>低秩因子分解</li><li>转移/压缩卷积滤波器</li><li>知识蒸馏</li></ol><p>知识蒸馏方法扩展：师生学习、相互学习、自学、辅助教学、终身学习</p><p>其它任务：对抗攻击、数据增强、数据隐私和安全</p><h3 id="Figure"><a href="#Figure" class="headerlink" title="Figure"></a>Figure</h3><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gva7ffssikj613g0i8dir02.jpg"></p><p>图1.知识蒸馏的通用师生框架</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gva7heu3nrj614q0lytf802.jpg"></p><p>图2.结构示意图</p><h2 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h2><p>Main idea:学生模型模仿教师模型，以学习竞争性甚至优越的表现</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gva7mgtnhdj60k407q0t702.jpg"></p><p>硬目标和软目标</p><p>​        预训练教师模型通常比学生模型大得多，其主要思想是在教师模型的指导下，培养一个具有相当准确度的高效学生模型。来自教师模型的监督信号（通常指教师模型学习的“知识”）有助于学生模型模仿教师模型的行为。在典型的图像分类任务中，logits（例如，深层神经网络中最后一层的输出）被用作教师模型中知识的载体，而培训数据样本并未明确提供这些知识。例如，猫的图像被错误地归类为狗的概率非常低，但产生这种错误的频率仍然比将猫误认为汽车的频率高很多倍。另一个例子是手写数字2的图像比数字7更类似于数字3。通过教师模型学习到的这些知识被称为黑暗知识。</p><p>​        教师模型预测的软目标包含了暗知识，可以作为监督，将知识从教师模型转移到学生模型。一个热标签被称为硬目标，引入了温度因子T来控制每个软目标的重要性。蒸馏损失定义为与教师模型和学生模型之间的逻辑匹配。相对于学生模型的logit，logit与交叉熵梯度匹配。通过高温匹配logits进行蒸馏可以将非常积极的logits以及教师模型学到的许多有用的知识信息传递给学生模型。学生损失被定义为基础真相标签和学生模型软逻辑之间的交叉熵。普通知识提炼的基准模型是提炼损失和学生损失的结合。</p><p>​        教师模型总是首先经过预训练，然后使用经过训练的教师模型中的知识对学生模型进行训练。此外，仅从受训教师模型的软目标中使用的知识通常用于训练学生模型。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gva86k1puxj614s0a876f02.jpg"></p><p>基准知识蒸馏的特定架构</p><h2 id="Knowledge"><a href="#Knowledge" class="headerlink" title="Knowledge"></a>Knowledge</h2><p>介绍用于知识蒸馏的不同类别的知识：基于响应的知识、基于特征的知识、基于关系的知识</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gva8ke22iyj615m0mw42502.jpg"></p><p>​        香草知识提炼使用logits作为教师知识，同时中间层的激活、神经元或特征也可以用作指导学生模型训练的知识。不同激活/神经元或样本对之间的关系包含教师模型学到的丰富信息。</p><h3 id="Response-based-Knowledge"><a href="#Response-based-Knowledge" class="headerlink" title="Response-based Knowledge"></a>Response-based Knowledge</h3><p>​        教师模型最后一个输出层的神经反应，其主要思想是直接模拟教师模型的最终预测。基于响应的知识提取对于模型压缩来说是简单而有效的，并已广泛应用于不同的任务和应用中。最流行的基于响应的图像分类知识称为软目标。对于不同的任务，基于响应的知识可能表示不同类型的模型预测。例如，在语义地标定位任务中，例如人体姿势估计，教师模型的响应可能参考每个地标的热图。</p><h3 id="Feature-based-Knowledge"><a href="#Feature-based-Knowledge" class="headerlink" title="Feature-based Knowledge"></a>Feature-based Knowledge</h3><p>​        直接匹配教师和学生之间的功能/激活。</p><ol><li>将原始特征图中的“注意力图”定义为知识，并由神经元选择性转移进行推广。</li><li>通过匹配特征空间中的概率分布来传递知识。</li><li>将“因素”作为更容易理解的中间表征形式引入。</li><li>使用隐藏神经元的激活边界进行知识转移。</li></ol><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gva9k8a9joj615c0j6jxy02.jpg"></p><h3 id="Relation-based-Knowledge"><a href="#Relation-based-Knowledge" class="headerlink" title="Relation-based Knowledge"></a>Relation-based Knowledge</h3><p>​        前两者都使用教师模型中特定层的输出，而本方法进一步探索不同层和数据样本之间的关系/结构。提出了溶液流程（FSP），该流程由两层之间的Gram矩阵定义。FSP矩阵反映了任意两个特征图之间的关系，并且计算为两层要素之间的内积。</p><ol><li>基于作为提取知识的特征图之间的相关性，提出了通过奇异值分解进行知识提取，以提取特征图中的关键信息。</li><li>为了使用来自多个教师的知识，使用每个教师模型的logits/特征作为节点，形成了一个有向图。具体而言，不同教师之间的关系/重要性是在知识转移之前建模的。</li><li>考虑到内部数据关系，提出了基于图的知识提取。</li></ol><p>​        传统方法将教师的个体软目标直接提炼为学生的个体知识提炼。提取的知识不仅包含特征信息，还包含数据之间的相互关系。通过实例关系图提出了一种稳健有效的知识提取方法。实例关系图中的知识转移包含实例特征、实例关系和跨层特征空间转换。基于流形学习的思想，通过特征嵌入学习学生网络，保留了教师网络提示层特征表示的局部信息。</p><p>​        将教师网络中的相似数据传输到学生网络中。</p><ol><li>提出了一种保持相似性的知识提取方法。特别是，将教师网络中输入对的相似激活的相似性保持知识转移到学生网络中，学生网络保持这种成对的相似性。</li><li>提出了一种基于相关同余的知识提取方法，其中提取的知识包含实例级信息和实例之间的相关性（。使用相关同余进行蒸馏，学生网络可以学习实例之间的相关性。</li><li>此外，蒸馏知识也可以从其他不同角度进行不同分类，例如反映数据结构信息的结构化知识和输入特征的特权信息。</li></ol><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvab9yxitoj61720jgdml02.jpg"></p><h2 id="Distillation-Schemes"><a href="#Distillation-Schemes" class="headerlink" title="Distillation Schemes"></a>Distillation Schemes</h2><p>​        教师和学生模型的训练方案。根据教师模型是否与学生模型同时更新，知识蒸馏的方案可直接分为三大类：在线蒸馏、离线蒸馏和自蒸馏。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gvabeube2tj60kg0jeta202.jpg"></p><h3 id="Oﬄine-Distillation"><a href="#Oﬄine-Distillation" class="headerlink" title="Oﬄine Distillation"></a>Oﬄine Distillation</h3><p>​        知识通常从预先训练的教师模型转移到学生模型中。1）大型教师模型首先在一组训练样本上进行训练；2）教师模型用于提取logits或中间特征等知识，然后用于指导学生模型的训练。在offline蒸馏方法中，第一阶段通常不在知识蒸馏的范围内讨论，即我们假设教师是预先定义的模型。</p><p>​        因此，offline方法主要侧重于改进知识转移的不同部分，包括知识设计和特征/分布匹配的损失函数。主要优点是简单且易于实现。例如，教师模型可能包含一组由不同软件包训练的模型，或位于不同的机器上，我们可以提取知识并使用设备上的缓存存储提取的知识。</p><h3 id="Online-Distillation"><a href="#Online-Distillation" class="headerlink" title="Online Distillation"></a>Online Distillation</h3><p>​        为了克服离线蒸馏的局限性，提出在线蒸馏以进一步改进学生模型的性能。尤其是当高能力教师模式无法提供强大的绩效时。在线知识蒸馏中，教师模型和学生模型同时更新，整个知识提取框架是端到端可训练的。</p><ol><li>多个神经网络以协作方式工作，其中任何一个都可以是学生模型，其他模型在整个训练过程中将是教师。</li><li>进一步将辅助同伴和组长引入深度相互学习，形成一组不同的同伴模型。</li><li>为了降低计算成本，提出了一种多分支体系结构，其中每个分支表示一个学生模型，不同的分支共享同一主干网络。</li><li>引入了一个特征融合模块来构建教师分类，而不是使用集合逻辑。</li><li>用廉价的卷积运算替换卷积层，形成学生模型。</li><li>利用在线蒸馏来训练大规模分布式神经网络，还提出了一种称为共蒸馏的在线蒸馏变体。</li><li>并行协同分解训练具有相同体系结构的多个模型，任何一个模型都是通过转移其他模型的知识来训练的。</li><li>提出了一种在线对抗性知识提取方法，利用类别概率和特征映射的知识，由鉴别器同时训练多个网络。</li></ol><h3 id="Self-Distillation"><a href="#Self-Distillation" class="headerlink" title="Self-Distillation"></a>Self-Distillation</h3><p>​        教师和学生模型使用相同的网络，这可视为在线蒸馏的特例。教师和学生网络由相同的卷积神经网络组成，来自网络较深部分的知识被蒸馏为较浅部分的知识。</p><p>​        提出了一种用于车道检测的自注意蒸馏方法，允许网络利用其自身层的注意图作为其较低层的蒸馏目标。作为自蒸馏的一种特殊变体，快照蒸馏是通过将网络早期阶段（教师）的知识转移到其后期阶段（学生）来提出的，以支持同一网络内的监督培训过程。此外，最近还提出了另外三种有趣的自蒸馏方法。</p><ol><li>从分析标签平滑正则化的角度提出了无教师知识提取方法。</li><li>提出了一种新的自知识提取方法，其中自知识是预测概率，而不是传统的软概率。这些预测概率由训练模型的特征表示确定，并反映特征嵌入空间中数据的相似性。</li><li>提出了基于类的自我知识提取方法，以从同一来源内的类内样本和增强样本之间的训练模型的预测分布中提取知识到模型自身中。此外，采用中提出的自蒸馏进行数据扩充，并将扩充的自知识提炼到模型本身中。同时，还采用自蒸馏的思想对具有相同体系结构的深层模型（教师或学生网络）逐一进行优化，下一个网络在师生优化过程中对上一个网络的知识进行了提炼。</li></ol><p>​        对于蒸馏的直观理解，在线蒸馏和自蒸馏也可以总结为与人类师生学习相一致。离线蒸馏是指知识渊博的教师将知识传授给新生；在线蒸馏是指教师和学生在教师的主要监督下同时相互学习；自蒸馏是指学生在没有老师的情况下自己学习知识。此外，正如人类的学习一样，这三种蒸馏由于各自的优势，可以相互结合，相辅相成。</p>]]></content>
      
      
      <categories>
          
          <category> note </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>9月比赛wp及复现</title>
      <link href="2021/10/02/9-yue-bi-sai-wp-ji-fu-xian/"/>
      <url>2021/10/02/9-yue-bi-sai-wp-ji-fu-xian/</url>
      
        <content type="html"><![CDATA[<h1 id="巅峰极客"><a href="#巅峰极客" class="headerlink" title="巅峰极客"></a>巅峰极客</h1><h2 id="crtrsa"><a href="#crtrsa" class="headerlink" title="crtrsa"></a>crtrsa</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> flagn<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token comment">#p and q are two primes generated by getPrime</span><span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">key_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>dp <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">20</span><span class="token punctuation">)</span>dq <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">if</span> gcd<span class="token punctuation">(</span>dp<span class="token punctuation">,</span> p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>dq<span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>d <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token punctuation">[</span>dp<span class="token punctuation">,</span>dq<span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>R <span class="token operator">=</span> Integers<span class="token punctuation">(</span>phi<span class="token punctuation">)</span>e <span class="token operator">=</span> R<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token operator">^</span><span class="token operator">-</span><span class="token number">1</span><span class="token keyword">return</span> p<span class="token operator">*</span>q<span class="token punctuation">,</span>en<span class="token punctuation">,</span>e <span class="token operator">=</span> key_gen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span> e<span class="token keyword">print</span> n<span class="token keyword">print</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flagn<span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span></code></pre><p>爆破dp</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> N <span class="token operator">=</span> <span class="token number">6006128121276172470274143101473619963750725942458450119252491144009018469845917986523007748831362674341219814935241703026024431390531323127620970750816983</span>e <span class="token operator">=</span> <span class="token number">2953544268002866703872076551930953722572317122777861299293407053391808199220655289235983088986372630141821049118015752017412642148934113723174855236142887</span>c<span class="token operator">=</span><span class="token number">4082777468662493175049853412968913980472986215497247773911290709560282223053863513029985115855416847643274608394467813391117463817805000754191093158289399</span> a<span class="token operator">=</span><span class="token number">2</span>A<span class="token operator">=</span>powmod<span class="token punctuation">(</span>a<span class="token punctuation">,</span>e<span class="token punctuation">,</span>N<span class="token punctuation">)</span> <span class="token keyword">for</span> dp <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>powmod<span class="token punctuation">(</span>A<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">-</span>a<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>powmod<span class="token punctuation">(</span>A<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">-</span>a<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">!=</span>N<span class="token punctuation">:</span>        p<span class="token operator">=</span>gcd<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>dp<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token operator">-</span>a<span class="token punctuation">,</span>N<span class="token punctuation">)</span>        q<span class="token operator">=</span>N<span class="token operator">//</span>p        phi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>        d<span class="token operator">=</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>        m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token comment">#flag&#123;d67fde91-f6c0-484d-88a4-1778f7fa0c05&#125;</span></code></pre><h2 id="LearnSM4"><a href="#LearnSM4" class="headerlink" title="LearnSM4"></a>LearnSM4</h2><p><a href="https://tearsjin.github.io/2021/07/31/writeup-for-2021-%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/#LearnSM4">https://tearsjin.github.io/2021/07/31/writeup-for-2021-%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A2/#LearnSM4</a></p><h1 id="祥云杯"><a href="#祥云杯" class="headerlink" title="祥云杯"></a>祥云杯</h1><h2 id="Guess"><a href="#Guess" class="headerlink" title="Guess"></a><strong>Guess</strong></h2><p>先爆破求key，用hint的矩阵做行序的打乱并且调整LLL的delta参数为随机值来得到key转置之后的四个向量，然后按照附件里给的key初始四位的顺序来排序，做key的矩阵转置还原成初始的key。</p><p>第一步的exp如下：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>hint <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/Users/lizihan/Downloads/guess_c31fa29ffba2ff77b12dec354b8909e6/hint'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> f<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">" "</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>    hint<span class="token punctuation">.</span>append<span class="token punctuation">(</span>temp<span class="token punctuation">)</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    shuffle<span class="token punctuation">(</span>hint<span class="token punctuation">)</span>    <span class="token keyword">for</span> line <span class="token keyword">in</span> matrix<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>hint<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> hint<span class="token punctuation">)</span><span class="token punctuation">.</span>LLL<span class="token punctuation">(</span>delta<span class="token operator">=</span><span class="token builtin">float</span><span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">26000</span><span class="token punctuation">,</span> <span class="token number">99999</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> line<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>            line <span class="token operator">=</span> <span class="token operator">-</span>line        <span class="token keyword">if</span> line <span class="token keyword">not</span> <span class="token keyword">in</span> key <span class="token keyword">and</span> <span class="token builtin">all</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token operator">&lt;</span> x <span class="token operator">&lt;=</span> <span class="token number">1000</span><span class="token punctuation">,</span> line<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span>            key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>line<span class="token punctuation">)</span>                        <span class="token triple-quoted-string string">'''  0%|          | 2/10000 [00:00&lt;12:39, 13.17it/s](241, 232, 548, 400, 186, 333, 646, 727, 286, 877, 810, 121, 237, 745, 201, 542, 244, 396, 158, 641)  0%|          | 6/10000 [00:00&lt;12:01, 13.86it/s](718, 550, 349, 939, 148, 355, 942, 685, 313, 577, 184, 130, 307, 983, 611, 903, 271, 530, 566, 427)  0%|          | 44/10000 [00:03&lt;11:20, 14.64it/s](119, 521, 142, 637, 614, 746, 299, 416, 638, 288, 995, 498, 639, 585, 114, 885, 558, 783, 899, 751)  5%|▍         | 478/10000 [00:31&lt;09:57, 15.94it/s](647, 918, 613, 936, 461, 281, 977, 888, 128, 653, 309, 780, 526, 216, 944, 123, 430, 860, 113, 129)'''</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">,</span> <span class="token number">637</span><span class="token punctuation">,</span> <span class="token number">614</span><span class="token punctuation">,</span> <span class="token number">746</span><span class="token punctuation">,</span> <span class="token number">299</span><span class="token punctuation">,</span> <span class="token number">416</span><span class="token punctuation">,</span> <span class="token number">638</span><span class="token punctuation">,</span> <span class="token number">288</span><span class="token punctuation">,</span> <span class="token number">995</span><span class="token punctuation">,</span> <span class="token number">498</span><span class="token punctuation">,</span> <span class="token number">639</span><span class="token punctuation">,</span> <span class="token number">585</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">885</span><span class="token punctuation">,</span> <span class="token number">558</span><span class="token punctuation">,</span> <span class="token number">783</span><span class="token punctuation">,</span> <span class="token number">899</span><span class="token punctuation">,</span> <span class="token number">751</span><span class="token punctuation">]</span>b <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">548</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">186</span><span class="token punctuation">,</span> <span class="token number">333</span><span class="token punctuation">,</span> <span class="token number">646</span><span class="token punctuation">,</span> <span class="token number">727</span><span class="token punctuation">,</span> <span class="token number">286</span><span class="token punctuation">,</span> <span class="token number">877</span><span class="token punctuation">,</span> <span class="token number">810</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">237</span><span class="token punctuation">,</span> <span class="token number">745</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token number">542</span><span class="token punctuation">,</span> <span class="token number">244</span><span class="token punctuation">,</span> <span class="token number">396</span><span class="token punctuation">,</span> <span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">641</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">718</span><span class="token punctuation">,</span> <span class="token number">550</span><span class="token punctuation">,</span> <span class="token number">349</span><span class="token punctuation">,</span> <span class="token number">939</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">,</span> <span class="token number">355</span><span class="token punctuation">,</span> <span class="token number">942</span><span class="token punctuation">,</span> <span class="token number">685</span><span class="token punctuation">,</span> <span class="token number">313</span><span class="token punctuation">,</span> <span class="token number">577</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">307</span><span class="token punctuation">,</span> <span class="token number">983</span><span class="token punctuation">,</span> <span class="token number">611</span><span class="token punctuation">,</span> <span class="token number">903</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">,</span> <span class="token number">530</span><span class="token punctuation">,</span> <span class="token number">566</span><span class="token punctuation">,</span> <span class="token number">427</span><span class="token punctuation">]</span>d <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">647</span><span class="token punctuation">,</span> <span class="token number">918</span><span class="token punctuation">,</span> <span class="token number">613</span><span class="token punctuation">,</span> <span class="token number">936</span><span class="token punctuation">,</span> <span class="token number">461</span><span class="token punctuation">,</span> <span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">977</span><span class="token punctuation">,</span> <span class="token number">888</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">653</span><span class="token punctuation">,</span> <span class="token number">309</span><span class="token punctuation">,</span> <span class="token number">780</span><span class="token punctuation">,</span> <span class="token number">526</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">944</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">430</span><span class="token punctuation">,</span> <span class="token number">860</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">129</span><span class="token punctuation">]</span>m <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c<span class="token punctuation">,</span> d<span class="token punctuation">]</span>m <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>m<span class="token punctuation">)</span>m <span class="token operator">=</span> m<span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>n <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">:</span>        key<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token comment"># [119, 241, 718, 647, 521, 232, 550, 918, 142, 548, 349, 613, 637, 400, 939, 936, 614, 186, 148, 461, 746, 333, 355, 281, 299, 646, 942, 977, 416, 727, 685, 888, 638, 286, 313, 128, 288, 877, 577, 653, 995, 810, 184, 309, 498, 121, 130, 780, 639, 237, 307, 526, 585, 745, 983, 216, 114, 201, 611, 944, 885, 542, 903, 123, 558, 244, 271, 430, 783, 396, 530, 860, 899, 158, 566, 113, 751, 641, 427, 129]</span></code></pre><p>得到了key之后，要想拿flag就要在step2和4发送的时候做文章，step3的话只需要满足条件，我这里就发了两个3。</p><p>那么就要想最后怎么处理9倍的问题。由Paillier同态加密可知，密文c1乘密文c2的结果解密之后等于明文m1加m2。</p><p>所以我这里构造：c1是9倍的key[i]的密文，c2是2的密文，m1是9倍的key[i]，m2是2，所以key[i] = (dec(c1*c2) - 2)//9，又因为R是偶随机数，所以找到对应的索引位置mod2即为最后发送的0或1。</p><p>第二步的exp如下：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> string <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> itertools <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> fractions <span class="token keyword">import</span> gcd<span class="token keyword">import</span> randomp <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'47.104.85.225'</span><span class="token punctuation">,</span> <span class="token number">57811</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span><span class="token keyword">def</span> <span class="token function">pwn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    rec <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>    suffix <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'\?\+([^\)]+)'</span><span class="token punctuation">,</span> rec<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    digest <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'== ([^\n]+)'</span><span class="token punctuation">,</span> rec<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> product<span class="token punctuation">(</span>ascii_letters <span class="token operator">+</span> digits<span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        prefix <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>        guess <span class="token operator">=</span> prefix <span class="token operator">+</span> suffix        <span class="token keyword">if</span> sha256<span class="token punctuation">(</span>guess<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> digest<span class="token punctuation">:</span>            <span class="token keyword">break</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>prefix<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> g<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        r <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>r<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> m<span class="token punctuation">,</span> n <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>r<span class="token punctuation">,</span> n<span class="token punctuation">,</span> n <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span>n <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ckey <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">718</span><span class="token punctuation">,</span> <span class="token number">647</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">232</span><span class="token punctuation">,</span> <span class="token number">550</span><span class="token punctuation">,</span> <span class="token number">918</span><span class="token punctuation">,</span> <span class="token number">142</span><span class="token punctuation">,</span> <span class="token number">548</span><span class="token punctuation">,</span> <span class="token number">349</span><span class="token punctuation">,</span> <span class="token number">613</span><span class="token punctuation">,</span> <span class="token number">637</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> <span class="token number">939</span><span class="token punctuation">,</span> <span class="token number">936</span><span class="token punctuation">,</span> <span class="token number">614</span><span class="token punctuation">,</span> <span class="token number">186</span><span class="token punctuation">,</span> <span class="token number">148</span><span class="token punctuation">,</span> <span class="token number">461</span><span class="token punctuation">,</span> <span class="token number">746</span><span class="token punctuation">,</span> <span class="token number">333</span><span class="token punctuation">,</span> <span class="token number">355</span><span class="token punctuation">,</span> <span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">299</span><span class="token punctuation">,</span> <span class="token number">646</span><span class="token punctuation">,</span> <span class="token number">942</span><span class="token punctuation">,</span> <span class="token number">977</span><span class="token punctuation">,</span> <span class="token number">416</span><span class="token punctuation">,</span> <span class="token number">727</span><span class="token punctuation">,</span> <span class="token number">685</span><span class="token punctuation">,</span> <span class="token number">888</span><span class="token punctuation">,</span> <span class="token number">638</span><span class="token punctuation">,</span> <span class="token number">286</span><span class="token punctuation">,</span> <span class="token number">313</span><span class="token punctuation">,</span> <span class="token number">128</span><span class="token punctuation">,</span> <span class="token number">288</span><span class="token punctuation">,</span> <span class="token number">877</span><span class="token punctuation">,</span> <span class="token number">577</span><span class="token punctuation">,</span> <span class="token number">653</span><span class="token punctuation">,</span> <span class="token number">995</span><span class="token punctuation">,</span> <span class="token number">810</span><span class="token punctuation">,</span> <span class="token number">184</span><span class="token punctuation">,</span> <span class="token number">309</span><span class="token punctuation">,</span> <span class="token number">498</span><span class="token punctuation">,</span> <span class="token number">121</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">780</span><span class="token punctuation">,</span> <span class="token number">639</span><span class="token punctuation">,</span> <span class="token number">237</span><span class="token punctuation">,</span> <span class="token number">307</span><span class="token punctuation">,</span> <span class="token number">526</span><span class="token punctuation">,</span> <span class="token number">585</span><span class="token punctuation">,</span> <span class="token number">745</span><span class="token punctuation">,</span> <span class="token number">983</span><span class="token punctuation">,</span> <span class="token number">216</span><span class="token punctuation">,</span> <span class="token number">114</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token number">611</span><span class="token punctuation">,</span> <span class="token number">944</span><span class="token punctuation">,</span> <span class="token number">885</span><span class="token punctuation">,</span> <span class="token number">542</span><span class="token punctuation">,</span> <span class="token number">903</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">,</span> <span class="token number">558</span><span class="token punctuation">,</span> <span class="token number">244</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">,</span> <span class="token number">430</span><span class="token punctuation">,</span> <span class="token number">783</span><span class="token punctuation">,</span> <span class="token number">396</span><span class="token punctuation">,</span> <span class="token number">530</span><span class="token punctuation">,</span> <span class="token number">860</span><span class="token punctuation">,</span> <span class="token number">899</span><span class="token punctuation">,</span> <span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">566</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">751</span><span class="token punctuation">,</span> <span class="token number">641</span><span class="token punctuation">,</span> <span class="token number">427</span><span class="token punctuation">,</span> <span class="token number">129</span><span class="token punctuation">]</span>pwn<span class="token punctuation">(</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    n <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    g <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Please give me one decimal ciphertext.\n'</span><span class="token punctuation">,</span> <span class="token string">'2'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    m2 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Give me m0.\n'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Give me m1.\n'</span><span class="token punctuation">,</span> <span class="token string">'3'</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    c1 <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    c2 <span class="token operator">=</span> <span class="token number">2</span>     p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Please give me one decimal ciphertext \n'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c1 <span class="token operator">*</span> c2<span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span>    res <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    m1 <span class="token operator">=</span> <span class="token punctuation">(</span>res <span class="token operator">-</span> m2<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">9</span>    ans <span class="token operator">=</span> key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>m1<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span>    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">'Step 5 - Guess. You must tell me which ciphertext was I give you in step 3, 0 or 1(m0 -> c0 , m1 -> c1)?\n'</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="https://i.loli.net/2021/08/21/zg6xRa4ZSMDmQPn.jpg" alt="pao2.png"></p><h2 id="Random-RSA"><a href="#Random-RSA" class="headerlink" title="Random_RSA"></a>Random_RSA</h2><p>python2的random设置seed之后的randint是定死的，没啥可说的，一把梭。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># coding=utf-8</span><span class="token keyword">import</span> random<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>seeds <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4827</span><span class="token punctuation">,</span> <span class="token number">9522</span><span class="token punctuation">,</span> <span class="token number">552</span><span class="token punctuation">,</span> <span class="token number">880</span><span class="token punctuation">,</span> <span class="token number">7467</span><span class="token punctuation">,</span> <span class="token number">7742</span><span class="token punctuation">,</span> <span class="token number">9425</span><span class="token punctuation">,</span> <span class="token number">4803</span><span class="token punctuation">,</span> <span class="token number">6146</span><span class="token punctuation">,</span> <span class="token number">4366</span><span class="token punctuation">,</span> <span class="token number">1126</span><span class="token punctuation">,</span> <span class="token number">4707</span><span class="token punctuation">,</span> <span class="token number">1138</span><span class="token punctuation">,</span> <span class="token number">2367</span><span class="token punctuation">,</span> <span class="token number">1081</span><span class="token punctuation">,</span> <span class="token number">5577</span><span class="token punctuation">,</span> <span class="token number">4592</span><span class="token punctuation">,</span> <span class="token number">5897</span><span class="token punctuation">,</span> <span class="token number">4565</span><span class="token punctuation">,</span> <span class="token number">2012</span><span class="token punctuation">,</span> <span class="token number">2700</span><span class="token punctuation">,</span> <span class="token number">1331</span><span class="token punctuation">,</span> <span class="token number">9638</span><span class="token punctuation">,</span> <span class="token number">7741</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">824</span><span class="token punctuation">,</span> <span class="token number">8321</span><span class="token punctuation">,</span> <span class="token number">7411</span><span class="token punctuation">,</span> <span class="token number">6145</span><span class="token punctuation">,</span> <span class="token number">1271</span><span class="token punctuation">,</span> <span class="token number">7637</span><span class="token punctuation">,</span> <span class="token number">5481</span><span class="token punctuation">,</span> <span class="token number">8474</span><span class="token punctuation">,</span> <span class="token number">2085</span><span class="token punctuation">,</span> <span class="token number">2421</span><span class="token punctuation">,</span> <span class="token number">590</span><span class="token punctuation">,</span> <span class="token number">7733</span><span class="token punctuation">,</span> <span class="token number">9427</span><span class="token punctuation">,</span> <span class="token number">3278</span><span class="token punctuation">,</span> <span class="token number">5361</span><span class="token punctuation">,</span> <span class="token number">1284</span><span class="token punctuation">,</span> <span class="token number">2280</span><span class="token punctuation">,</span> <span class="token number">7001</span><span class="token punctuation">,</span> <span class="token number">8573</span><span class="token punctuation">,</span> <span class="token number">5494</span><span class="token punctuation">,</span> <span class="token number">7431</span><span class="token punctuation">,</span> <span class="token number">2765</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">1419</span><span class="token punctuation">,</span> <span class="token number">6528</span><span class="token punctuation">,</span> <span class="token number">735</span><span class="token punctuation">,</span> <span class="token number">5653</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">4158</span><span class="token punctuation">,</span> <span class="token number">5877</span><span class="token punctuation">,</span> <span class="token number">5975</span><span class="token punctuation">,</span> <span class="token number">1527</span><span class="token punctuation">,</span> <span class="token number">3027</span><span class="token punctuation">,</span> <span class="token number">9776</span><span class="token punctuation">,</span> <span class="token number">5263</span><span class="token punctuation">,</span> <span class="token number">5211</span><span class="token punctuation">,</span> <span class="token number">1293</span><span class="token punctuation">,</span> <span class="token number">5976</span><span class="token punctuation">,</span> <span class="token number">7759</span><span class="token punctuation">,</span> <span class="token number">3268</span><span class="token punctuation">,</span> <span class="token number">1893</span><span class="token punctuation">,</span> <span class="token number">6546</span><span class="token punctuation">,</span> <span class="token number">4684</span><span class="token punctuation">,</span> <span class="token number">419</span><span class="token punctuation">,</span> <span class="token number">8334</span><span class="token punctuation">,</span> <span class="token number">7621</span><span class="token punctuation">,</span> <span class="token number">1649</span><span class="token punctuation">,</span> <span class="token number">6840</span><span class="token punctuation">,</span> <span class="token number">2975</span><span class="token punctuation">,</span> <span class="token number">8605</span><span class="token punctuation">,</span> <span class="token number">5714</span><span class="token punctuation">,</span> <span class="token number">2709</span><span class="token punctuation">,</span> <span class="token number">1109</span><span class="token punctuation">,</span> <span class="token number">358</span><span class="token punctuation">,</span> <span class="token number">2858</span><span class="token punctuation">,</span> <span class="token number">6868</span><span class="token punctuation">,</span> <span class="token number">2442</span><span class="token punctuation">,</span> <span class="token number">8431</span><span class="token punctuation">,</span> <span class="token number">8316</span><span class="token punctuation">,</span> <span class="token number">5446</span><span class="token punctuation">,</span> <span class="token number">9356</span><span class="token punctuation">,</span> <span class="token number">2817</span><span class="token punctuation">,</span> <span class="token number">2941</span><span class="token punctuation">,</span> <span class="token number">3177</span><span class="token punctuation">,</span> <span class="token number">7388</span><span class="token punctuation">,</span> <span class="token number">4149</span><span class="token punctuation">,</span> <span class="token number">4634</span><span class="token punctuation">,</span> <span class="token number">4316</span><span class="token punctuation">,</span> <span class="token number">5377</span><span class="token punctuation">,</span> <span class="token number">4327</span><span class="token punctuation">,</span> <span class="token number">1774</span><span class="token punctuation">,</span> <span class="token number">6613</span><span class="token punctuation">,</span> <span class="token number">5728</span><span class="token punctuation">,</span> <span class="token number">1751</span><span class="token punctuation">,</span> <span class="token number">8478</span><span class="token punctuation">,</span> <span class="token number">3132</span><span class="token punctuation">,</span> <span class="token number">4680</span><span class="token punctuation">,</span> <span class="token number">3308</span><span class="token punctuation">,</span> <span class="token number">9769</span><span class="token punctuation">,</span> <span class="token number">8341</span><span class="token punctuation">,</span> <span class="token number">1627</span><span class="token punctuation">,</span> <span class="token number">3501</span><span class="token punctuation">,</span> <span class="token number">1046</span><span class="token punctuation">,</span> <span class="token number">2609</span><span class="token punctuation">,</span> <span class="token number">7190</span><span class="token punctuation">,</span> <span class="token number">5706</span><span class="token punctuation">,</span> <span class="token number">3627</span><span class="token punctuation">,</span> <span class="token number">8867</span><span class="token punctuation">,</span> <span class="token number">2458</span><span class="token punctuation">,</span> <span class="token number">607</span><span class="token punctuation">,</span> <span class="token number">642</span><span class="token punctuation">,</span> <span class="token number">5436</span><span class="token punctuation">,</span> <span class="token number">6355</span><span class="token punctuation">,</span> <span class="token number">6326</span><span class="token punctuation">,</span> <span class="token number">1481</span><span class="token punctuation">,</span> <span class="token number">9887</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">5511</span><span class="token punctuation">,</span> <span class="token number">537</span><span class="token punctuation">,</span> <span class="token number">8576</span><span class="token punctuation">,</span> <span class="token number">6376</span><span class="token punctuation">,</span> <span class="token number">3619</span><span class="token punctuation">,</span> <span class="token number">6609</span><span class="token punctuation">,</span> <span class="token number">8473</span><span class="token punctuation">,</span> <span class="token number">2139</span><span class="token punctuation">,</span> <span class="token number">3889</span><span class="token punctuation">,</span> <span class="token number">1309</span><span class="token punctuation">,</span> <span class="token number">9878</span><span class="token punctuation">,</span> <span class="token number">2182</span><span class="token punctuation">,</span> <span class="token number">8572</span><span class="token punctuation">,</span> <span class="token number">9275</span><span class="token punctuation">,</span> <span class="token number">5235</span><span class="token punctuation">,</span> <span class="token number">6989</span><span class="token punctuation">,</span> <span class="token number">6592</span><span class="token punctuation">,</span> <span class="token number">4618</span><span class="token punctuation">,</span> <span class="token number">7883</span><span class="token punctuation">,</span> <span class="token number">5702</span><span class="token punctuation">,</span> <span class="token number">3999</span><span class="token punctuation">,</span> <span class="token number">925</span><span class="token punctuation">,</span> <span class="token number">2419</span><span class="token punctuation">,</span> <span class="token number">7838</span><span class="token punctuation">,</span> <span class="token number">3073</span><span class="token punctuation">,</span> <span class="token number">488</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">3280</span><span class="token punctuation">,</span> <span class="token number">9915</span><span class="token punctuation">,</span> <span class="token number">3672</span><span class="token punctuation">,</span> <span class="token number">579</span><span class="token punctuation">]</span>res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">183</span><span class="token punctuation">,</span> <span class="token number">192</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">116</span><span class="token punctuation">,</span> <span class="token number">102</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">118</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">254</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">144</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">54</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">244</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">215</span><span class="token punctuation">,</span> <span class="token number">187</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">176</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">,</span> <span class="token number">138</span><span class="token punctuation">,</span> <span class="token number">42</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">158</span><span class="token punctuation">,</span> <span class="token number">254</span><span class="token punctuation">,</span> <span class="token number">159</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">155</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">145</span><span class="token punctuation">,</span> <span class="token number">248</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">226</span><span class="token punctuation">,</span> <span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">195</span><span class="token punctuation">,</span> <span class="token number">75</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">237</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">141</span><span class="token punctuation">,</span> <span class="token number">185</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">135</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">212</span><span class="token punctuation">,</span> <span class="token number">242</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">164</span><span class="token punctuation">,</span> <span class="token number">146</span><span class="token punctuation">,</span> <span class="token number">119</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">224</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">77</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">196</span><span class="token punctuation">,</span> <span class="token number">205</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token number">243</span><span class="token punctuation">,</span> <span class="token number">80</span><span class="token punctuation">,</span> <span class="token number">140</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">98</span><span class="token punctuation">,</span> <span class="token number">76</span><span class="token punctuation">,</span> <span class="token number">217</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">208</span><span class="token punctuation">,</span> <span class="token number">202</span><span class="token punctuation">,</span> <span class="token number">78</span><span class="token punctuation">,</span> <span class="token number">177</span><span class="token punctuation">,</span> <span class="token number">124</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">168</span><span class="token punctuation">,</span> <span class="token number">165</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">48</span><span class="token punctuation">,</span> <span class="token number">152</span><span class="token punctuation">,</span> <span class="token number">51</span><span class="token punctuation">,</span> <span class="token number">133</span><span class="token punctuation">,</span> <span class="token number">190</span><span class="token punctuation">,</span> <span class="token number">202</span><span class="token punctuation">,</span> <span class="token number">136</span><span class="token punctuation">,</span> <span class="token number">204</span><span class="token punctuation">,</span> <span class="token number">44</span><span class="token punctuation">,</span> <span class="token number">33</span><span class="token punctuation">,</span> <span class="token number">58</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">196</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">150</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">162</span><span class="token punctuation">,</span> <span class="token number">175</span><span class="token punctuation">,</span> <span class="token number">218</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">85</span><span class="token punctuation">,</span> <span class="token number">201</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">186</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">130</span><span class="token punctuation">,</span> <span class="token number">147</span><span class="token punctuation">,</span> <span class="token number">219</span><span class="token punctuation">,</span> <span class="token number">22</span><span class="token punctuation">,</span> <span class="token number">81</span><span class="token punctuation">]</span>dp <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>seeds<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>seeds<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>rands <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>rands<span class="token punctuation">.</span>append<span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">255</span><span class="token punctuation">)</span><span class="token punctuation">)</span>dp <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>rands<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">^</span> res<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>dp <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>dp<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>n<span class="token operator">=</span><span class="token number">81196282992606113591233615204680597645208562279327854026981376917977843644855180528227037752692498558370026353244981467900057157997462760732019372185955846507977456657760125682125104309241802108853618468491463326268016450119817181368743376919334016359137566652069490881871670703767378496685419790016705210391</span>c<span class="token operator">=</span><span class="token number">61505256223993349534474550877787675500827332878941621261477860880689799960938202020614342208518869582019307850789493701589309453566095881294166336673487909221860641809622524813959284722285069755310890972255545436989082654705098907006694780949725756312169019688455553997031840488852954588581160550377081811151</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>                       <span class="token keyword">if</span><span class="token punctuation">(</span>dp<span class="token operator">*</span>e<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> n<span class="token operator">%</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dp<span class="token operator">*</span>e<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>               p<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>dp<span class="token operator">*</span>e<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>            q<span class="token operator">=</span>n<span class="token operator">//</span>p            phi<span class="token operator">=</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>                        d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>                   m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span>                                <span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;74281db3-c6f0-e59a-4da6-39b8c71250fe&#125;</span></code></pre><h2 id="myrsa"><a href="#myrsa" class="headerlink" title="myrsa"></a>myrsa</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># myRSA</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>bytes_to_long <span class="token keyword">as</span> b2l<span class="token keyword">from</span> math <span class="token keyword">import</span> gcd<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> random<span class="token keyword">import</span> socketserver KEYSIZE <span class="token operator">=</span> <span class="token number">512</span>alpha <span class="token operator">=</span> <span class="token number">2.0314159265358979</span>WELCOME <span class="token operator">=</span> <span class="token string">'Welcome to use my better RSA!!!!!!So, what do you want now?'</span>menu <span class="token operator">=</span> <span class="token string">'1. encry \n2. getflag\n3. exit'</span>String <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz'</span> <span class="token keyword">def</span> <span class="token function">proof_of_work</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    STR <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>String<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>String<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">]</span><span class="token punctuation">)</span>    HASH <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span>STR<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> STR<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>STR<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span>HASH <span class="token keyword">def</span> <span class="token function">key_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        p<span class="token punctuation">,</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>KEYSIZE<span class="token punctuation">)</span><span class="token punctuation">,</span>getPrime<span class="token punctuation">(</span>KEYSIZE<span class="token punctuation">)</span>        e <span class="token operator">=</span> <span class="token number">0x10001</span>        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    key <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>KEYSIZE<span class="token operator">*</span>alpha<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>key <span class="token comment"># encrypto</span><span class="token keyword">def</span> <span class="token function">encry</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span>key<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    k1<span class="token punctuation">,</span>k2 <span class="token operator">=</span> key<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>key<span class="token punctuation">[</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    x <span class="token operator">=</span> p<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">3</span><span class="token operator">*</span>q <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">)</span> <span class="token operator">+</span> q<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">3</span><span class="token operator">*</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>     y <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">*</span>q <span class="token operator">+</span> p <span class="token operator">+</span> q    z <span class="token operator">=</span> k1 <span class="token operator">+</span> k2     c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>b2l<span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">,</span>e<span class="token punctuation">,</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span>    <span class="token keyword">return</span> x <span class="token operator">*</span> c <span class="token operator">+</span> y <span class="token operator">*</span> c <span class="token operator">+</span> z <span class="token comment"># get flag</span><span class="token keyword">def</span> <span class="token function">getflag</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span>key<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> encry<span class="token punctuation">(</span>flag<span class="token punctuation">,</span>key<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span> <span class="token keyword">class</span> <span class="token class-name">server</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">_recv</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        data <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> data<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token keyword">def</span> <span class="token function">_send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>msg <span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            msg <span class="token operator">+=</span> <span class="token string">b'\n'</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            msg <span class="token operator">+=</span> <span class="token string">'\n'</span>            msg <span class="token operator">=</span> msg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>     <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        START<span class="token punctuation">,</span>END<span class="token punctuation">,</span>HASH <span class="token operator">=</span> proof_of_work<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">'SHA-256(?+&#123;&#125;) == &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>END<span class="token punctuation">,</span>HASH<span class="token punctuation">)</span><span class="token punctuation">)</span>        RCV <span class="token operator">=</span> self<span class="token punctuation">.</span>_recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> RCV <span class="token operator">!=</span> START<span class="token punctuation">:</span>            <span class="token keyword">return</span>        self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">"I'm a CryptoRookie,so my Crypto system take time, please wait a minute XD!"</span><span class="token punctuation">)</span>        <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">,</span>key <span class="token operator">=</span> key_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>        flag  <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span>WELCOME<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">'This is my public key:\nn = &#123;&#125;\ne = &#123;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span>menu<span class="token punctuation">)</span>            COI <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>_recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> COI <span class="token operator">==</span> <span class="token number">1</span> <span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">'Give me your message'</span><span class="token punctuation">)</span>                message <span class="token operator">=</span> self<span class="token punctuation">.</span>_recv<span class="token punctuation">(</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">'Your encry message:'</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>encry<span class="token punctuation">(</span>message<span class="token punctuation">,</span>key<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span> COI <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">'This is your favourite:\n'</span><span class="token punctuation">)</span>                self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>encry<span class="token punctuation">(</span>flag<span class="token punctuation">,</span>key<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span> COI <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>_send<span class="token punctuation">(</span><span class="token string">'Bye~'</span><span class="token punctuation">)</span>                <span class="token keyword">break</span><span class="token keyword">class</span> <span class="token class-name">ForkedServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>ThreadingMixIn<span class="token punctuation">,</span> socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span> <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">10001</span>    server <span class="token operator">=</span> ForkedServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> server<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>allow_reuse_address <span class="token operator">=</span> <span class="token boolean">True</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1guo6l30fedj614q0egn0g02.jpg"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span> p<span class="token operator">=</span>remote<span class="token punctuation">(</span><span class="token string">'47.104.85.225'</span><span class="token punctuation">,</span><span class="token number">49877</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>log_level<span class="token operator">=</span><span class="token string">'debug'</span> <span class="token keyword">def</span> <span class="token function">pow</span><span class="token punctuation">(</span>end<span class="token punctuation">,</span>sha<span class="token punctuation">)</span><span class="token punctuation">:</span>    String <span class="token operator">=</span> <span class="token string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890abcdefghijklmnopqrstuvwxyz'</span>    <span class="token keyword">for</span> a <span class="token keyword">in</span> String<span class="token punctuation">:</span>        <span class="token keyword">for</span> b <span class="token keyword">in</span> String<span class="token punctuation">:</span>            <span class="token keyword">for</span> c <span class="token keyword">in</span> String<span class="token punctuation">:</span>                <span class="token keyword">for</span> d <span class="token keyword">in</span> String<span class="token punctuation">:</span>                    s<span class="token operator">=</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span>end                    <span class="token keyword">if</span> sha256<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>sha<span class="token punctuation">:</span>                        <span class="token keyword">return</span> a<span class="token operator">+</span>b<span class="token operator">+</span>c<span class="token operator">+</span>d                    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'SHA-256(?+'</span><span class="token punctuation">)</span>end<span class="token operator">=</span>p<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>end<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'== '</span><span class="token punctuation">)</span>sha<span class="token operator">=</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>sha<span class="token punctuation">)</span>xxx<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>end<span class="token punctuation">,</span>sha<span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>xxx<span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'n = '</span><span class="token punctuation">)</span>n<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'3. exit\n'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Give me your message'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'\x01'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'Your encry message:\n'</span><span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>p_q<span class="token operator">=</span>iroot<span class="token punctuation">(</span>c<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>p_q<span class="token punctuation">)</span> <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>    p_q<span class="token operator">=</span>p_q<span class="token operator">-</span><span class="token number">1</span>    <span class="token keyword">if</span> iroot<span class="token punctuation">(</span>p_q<span class="token operator">*</span>p_q<span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        M<span class="token operator">=</span>p_q<span class="token operator">*</span>p_q<span class="token operator">*</span>p_q<span class="token operator">-</span>p_q<span class="token operator">*</span>p_q<span class="token operator">+</span>p_q<span class="token operator">+</span><span class="token number">4</span><span class="token operator">*</span>n        pp<span class="token operator">=</span><span class="token punctuation">(</span>p_q<span class="token operator">+</span>iroot<span class="token punctuation">(</span>p_q<span class="token operator">*</span>p_q<span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>n<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>        <span class="token keyword">assert</span> n<span class="token operator">%</span>pp<span class="token operator">==</span><span class="token number">0</span>        q<span class="token operator">=</span>n<span class="token operator">//</span>pp        <span class="token keyword">break</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'3. exit\n'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'This is your favourite:\n'</span><span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">'\n\n'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>c<span class="token operator">=</span>c<span class="token operator">//</span>Mphi<span class="token operator">=</span><span class="token punctuation">(</span>pp<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>e<span class="token operator">=</span><span class="token number">65537</span>d<span class="token operator">=</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m<span class="token operator">=</span>powmod<span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#flag&#123;ed649951-9ce9-46e0-a42b-d0ba588e43e1&#125;</span></code></pre><h1 id="羊城杯"><a href="#羊城杯" class="headerlink" title="羊城杯"></a>羊城杯</h1><h2 id="Bigrsa"><a href="#Bigrsa" class="headerlink" title="Bigrsa"></a>Bigrsa</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">from</span> flag <span class="token keyword">import</span> <span class="token operator">*</span>   n1 <span class="token operator">=</span> <span class="token number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span> n2 <span class="token operator">=</span> <span class="token number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span> e <span class="token operator">=</span> <span class="token number">65537</span> m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span> c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n1<span class="token punctuation">)</span> c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n2<span class="token punctuation">)</span>   <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = %d"</span> <span class="token operator">%</span> c<span class="token punctuation">)</span>   <span class="token comment"># output</span> <span class="token comment"># c = 60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span></code></pre><p>n1和n2公因数</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> libnum<span class="token punctuation">,</span> gmpy2n1 <span class="token operator">=</span> <span class="token number">103835296409081751860770535514746586815395898427260334325680313648369132661057840680823295512236948953370895568419721331170834557812541468309298819497267746892814583806423027167382825479157951365823085639078738847647634406841331307035593810712914545347201619004253602692127370265833092082543067153606828049061</span>n2 <span class="token operator">=</span> <span class="token number">115383198584677147487556014336448310721853841168758012445634182814180314480501828927160071015197089456042472185850893847370481817325868824076245290735749717384769661698895000176441497242371873981353689607711146852891551491168528799814311992471449640014501858763495472267168224015665906627382490565507927272073</span>e <span class="token operator">=</span> <span class="token number">65537</span>c <span class="token operator">=</span> <span class="token number">60406168302768860804211220055708551816238816061772464557956985699400782163597251861675967909246187833328847989530950308053492202064477410641014045601986036822451416365957817685047102703301347664879870026582087365822433436251615243854347490600004857861059245403674349457345319269266645006969222744554974358264</span>p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span>q1 <span class="token operator">=</span> n1<span class="token operator">//</span>pq2 <span class="token operator">=</span> n2<span class="token operator">//</span>pphi1 <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>phi2 <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> d1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi1<span class="token punctuation">)</span>d2 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi2<span class="token punctuation">)</span> m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">,</span>d1<span class="token punctuation">,</span>n1<span class="token punctuation">)</span>flag <span class="token operator">=</span> libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h2 id="Easy-rsa"><a href="#Easy-rsa" class="headerlink" title="Easy_rsa"></a>Easy_rsa</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">import</span> gmpy2<span class="token keyword">def</span> <span class="token function">gen_prime</span><span class="token punctuation">(</span>nbits<span class="token punctuation">,</span> gamma<span class="token punctuation">)</span><span class="token punctuation">:</span>    g <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>nbits <span class="token operator">*</span> gamma<span class="token punctuation">)</span><span class="token punctuation">)</span>    alpha <span class="token operator">=</span> <span class="token number">0.5</span> <span class="token operator">-</span> gamma    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        a <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>alpha <span class="token operator">*</span> nbits<span class="token punctuation">)</span><span class="token punctuation">)</span>        p <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> g <span class="token operator">*</span> a <span class="token operator">+</span> <span class="token number">1</span>        <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>            b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>alpha <span class="token operator">*</span> nbits<span class="token punctuation">)</span><span class="token punctuation">)</span>            q <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> g <span class="token operator">*</span> b <span class="token operator">+</span> <span class="token number">1</span>            h <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> g <span class="token operator">*</span> a <span class="token operator">*</span> b <span class="token operator">+</span> a <span class="token operator">+</span> b            <span class="token keyword">while</span> <span class="token keyword">not</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token keyword">or</span> isPrime<span class="token punctuation">(</span>h<span class="token punctuation">)</span> <span class="token keyword">or</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>                b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>alpha <span class="token operator">*</span> nbits<span class="token punctuation">)</span><span class="token punctuation">)</span>                q <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">*</span> g <span class="token operator">*</span> b <span class="token operator">+</span> <span class="token number">1</span>            <span class="token keyword">return</span> p<span class="token punctuation">,</span> q<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>nbits<span class="token punctuation">,</span> gamma<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">,</span> q <span class="token operator">=</span> gen_prime<span class="token punctuation">(</span>nbits<span class="token punctuation">,</span> gamma<span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    e <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> gmpy2<span class="token punctuation">.</span>lcm<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">return</span> n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> cn<span class="token punctuation">,</span> e<span class="token punctuation">,</span> c <span class="token operator">=</span> encrypt<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span> <span class="token number">0.48</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'n ='</span><span class="token punctuation">,</span> n<span class="token keyword">print</span> <span class="token string">'e ='</span><span class="token punctuation">,</span> e<span class="token keyword">print</span> <span class="token string">'c ='</span><span class="token punctuation">,</span> c<span class="token comment"># n = 84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span><span class="token comment"># e = 58337</span><span class="token comment"># c = 13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span></code></pre><p>发现p-1、q-1共享一个大素数因子g，其满足common prime rsa的性质。分解的n方法有四种，（1）修改Pollard’s rho方法分解n（2）知道a、b的值分解n（3）知道g的值分解n（4）分解N-1。由于题目中我们并不知道g、a、b的值，因此首先考虑使用第一种方法。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_jpg/gfUEvbhuMpNFcnicH2cPTJcpZVPPBybVXZJiaYhzibyBcYlSU0ic9JScGLzeN4LnugIicFR5S7SCUF9sfEiapyIa7xJA/640?wx_fmt=jpeg&tp=webp&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>根据文献内容修改Pollard’s rho方法中的迭代函数</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">f</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">def</span> <span class="token function">rho</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    i <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">print</span> <span class="token string">'Factorizing'</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        x1 <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>        x2 <span class="token operator">=</span> f<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>        j <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>gcd<span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>x1 <span class="token operator">-</span> x2<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>            <span class="token keyword">if</span> p <span class="token operator">==</span> n<span class="token punctuation">:</span>                <span class="token keyword">break</span>            <span class="token keyword">elif</span> p <span class="token operator">></span> <span class="token number">1</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span> <span class="token string">'Found!'</span>                <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span> n <span class="token operator">//</span> p<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>                x1 <span class="token operator">=</span> f<span class="token punctuation">(</span>x1<span class="token punctuation">,</span> n<span class="token punctuation">)</span>                x2 <span class="token operator">=</span> f<span class="token punctuation">(</span>f<span class="token punctuation">(</span>x2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>            j <span class="token operator">+=</span> <span class="token number">1</span>        i <span class="token operator">+=</span> <span class="token number">1</span> n <span class="token operator">=</span> <span class="token number">84236796025318186855187782611491334781897277899439717384242559751095347166978304126358295609924321812851255222430530001043539925782811895605398187299748256080526691975084042025794113521587064616352833904856626744098904922117855866813505228134381046907659080078950018430266048447119221001098505107823645953039</span>e <span class="token operator">=</span> <span class="token number">58337</span>c <span class="token operator">=</span> <span class="token number">13646200911032594651110040891135783560995665642049282201695300382255436792102048169200570930229947213493204600006876822744757042959653203573780257603577712302687497959686258542388622714078571068849217323703865310256200818493894194213812410547780002879351619924848073893321472704218227047519748394961963394668</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> rho<span class="token punctuation">(</span>n<span class="token punctuation">)</span>phi <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>lcm<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span> long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="Ring-Ring-Ring"><a href="#Ring-Ring-Ring" class="headerlink" title="Ring Ring Ring"></a>Ring Ring Ring</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> string <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> itertools <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> pwn <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> remote<span class="token punctuation">(</span><span class="token string">'192.168.38.194'</span><span class="token punctuation">,</span> <span class="token number">2378</span><span class="token punctuation">)</span>context<span class="token punctuation">.</span>log_level <span class="token operator">=</span> <span class="token string">'debug'</span>rec <span class="token operator">=</span> p<span class="token punctuation">.</span>recvline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>suffix <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'str \+ ([^\)]+)'</span><span class="token punctuation">,</span> rec<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>digest <span class="token operator">=</span> re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">r'== ([^\n]+)'</span><span class="token punctuation">,</span> rec<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> product<span class="token punctuation">(</span>ascii_letters <span class="token operator">+</span> digits<span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    prefix <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    guess <span class="token operator">=</span> prefix <span class="token operator">+</span> suffix    <span class="token keyword">if</span> md5<span class="token punctuation">(</span>guess<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> digest<span class="token punctuation">:</span>        <span class="token keyword">break</span>p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span><span class="token string">b'[>] Give me xxxxx: '</span><span class="token punctuation">,</span> prefix<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'Please give me 100 (a, b, c, d, e) which satisfies a**4 + b**4 + c**4 + d**4 = e**2\n'</span><span class="token punctuation">)</span>ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'1 1 1 1 2'</span><span class="token punctuation">,</span> <span class="token string">'1 2 2 2 7'</span><span class="token punctuation">,</span> <span class="token string">'1 2 2 4 17'</span><span class="token punctuation">,</span> <span class="token string">'1 2 4 2 17'</span><span class="token punctuation">,</span> <span class="token string">'1 2 4 4 23'</span><span class="token punctuation">,</span> <span class="token string">'1 3 3 9 82'</span><span class="token punctuation">,</span> <span class="token string">'1 3 9 3 82'</span><span class="token punctuation">,</span> <span class="token string">'1 4 2 2 17'</span><span class="token punctuation">,</span> <span class="token string">'1 4 2 4 23'</span><span class="token punctuation">,</span> <span class="token string">'1 4 4 2 23'</span><span class="token punctuation">,</span> <span class="token string">'1 9 3 3 82'</span><span class="token punctuation">,</span> <span class="token string">'2 1 2 2 7'</span><span class="token punctuation">,</span> <span class="token string">'2 1 2 4 17'</span><span class="token punctuation">,</span> <span class="token string">'2 1 4 2 17'</span><span class="token punctuation">,</span> <span class="token string">'2 1 4 4 23'</span><span class="token punctuation">,</span> <span class="token string">'2 2 1 2 7'</span><span class="token punctuation">,</span> <span class="token string">'2 2 1 4 17'</span><span class="token punctuation">,</span> <span class="token string">'2 2 2 1 7'</span><span class="token punctuation">,</span> <span class="token string">'2 2 2 2 8'</span><span class="token punctuation">,</span> <span class="token string">'2 2 4 1 17'</span><span class="token punctuation">,</span> <span class="token string">'2 4 1 2 17'</span><span class="token punctuation">,</span> <span class="token string">'2 4 1 4 23'</span><span class="token punctuation">,</span> <span class="token string">'2 4 2 1 17'</span><span class="token punctuation">,</span> <span class="token string">'2 4 4 1 23'</span><span class="token punctuation">,</span> <span class="token string">'2 4 4 4 28'</span><span class="token punctuation">,</span> <span class="token string">'2 4 4 8 68'</span><span class="token punctuation">,</span> <span class="token string">'2 4 6 7 63'</span><span class="token punctuation">,</span> <span class="token string">'2 4 7 6 63'</span><span class="token punctuation">,</span> <span class="token string">'2 4 8 4 68'</span><span class="token punctuation">,</span> <span class="token string">'2 4 8 8 92'</span><span class="token punctuation">,</span> <span class="token string">'2 6 4 7 63'</span><span class="token punctuation">,</span> <span class="token string">'2 6 7 4 63'</span><span class="token punctuation">,</span> <span class="token string">'2 7 4 6 63'</span><span class="token punctuation">,</span> <span class="token string">'2 7 6 4 63'</span><span class="token punctuation">,</span> <span class="token string">'2 8 4 4 68'</span><span class="token punctuation">,</span> <span class="token string">'2 8 4 8 92'</span><span class="token punctuation">,</span> <span class="token string">'2 8 8 4 92'</span><span class="token punctuation">,</span> <span class="token string">'3 1 3 9 82'</span><span class="token punctuation">,</span> <span class="token string">'3 1 9 3 82'</span><span class="token punctuation">,</span> <span class="token string">'3 3 1 9 82'</span><span class="token punctuation">,</span> <span class="token string">'3 3 3 3 18'</span><span class="token punctuation">,</span> <span class="token string">'3 3 9 1 82'</span><span class="token punctuation">,</span> <span class="token string">'3 6 6 6 63'</span><span class="token punctuation">,</span> <span class="token string">'3 9 1 3 82'</span><span class="token punctuation">,</span> <span class="token string">'3 9 3 1 82'</span><span class="token punctuation">,</span> <span class="token string">'4 1 2 2 17'</span><span class="token punctuation">,</span> <span class="token string">'4 1 2 4 23'</span><span class="token punctuation">,</span> <span class="token string">'4 1 4 2 23'</span><span class="token punctuation">,</span> <span class="token string">'4 2 1 2 17'</span><span class="token punctuation">,</span> <span class="token string">'4 2 1 4 23'</span><span class="token punctuation">,</span> <span class="token string">'4 2 2 1 17'</span><span class="token punctuation">,</span> <span class="token string">'4 2 4 1 23'</span><span class="token punctuation">,</span> <span class="token string">'4 2 4 4 28'</span><span class="token punctuation">,</span> <span class="token string">'4 2 4 8 68'</span><span class="token punctuation">,</span> <span class="token string">'4 2 6 7 63'</span><span class="token punctuation">,</span> <span class="token string">'4 2 7 6 63'</span><span class="token punctuation">,</span> <span class="token string">'4 2 8 4 68'</span><span class="token punctuation">,</span> <span class="token string">'4 2 8 8 92'</span><span class="token punctuation">,</span> <span class="token string">'4 4 1 2 23'</span><span class="token punctuation">,</span> <span class="token string">'4 4 2 1 23'</span><span class="token punctuation">,</span> <span class="token string">'4 4 2 4 28'</span><span class="token punctuation">,</span> <span class="token string">'4 4 2 8 68'</span><span class="token punctuation">,</span> <span class="token string">'4 4 4 2 28'</span><span class="token punctuation">,</span> <span class="token string">'4 4 4 4 32'</span><span class="token punctuation">,</span> <span class="token string">'4 4 8 2 68'</span><span class="token punctuation">,</span> <span class="token string">'4 6 2 7 63'</span><span class="token punctuation">,</span> <span class="token string">'4 6 6 9 97'</span><span class="token punctuation">,</span> <span class="token string">'4 6 7 2 63'</span><span class="token punctuation">,</span> <span class="token string">'4 6 9 6 97'</span><span class="token punctuation">,</span> <span class="token string">'4 7 2 6 63'</span><span class="token punctuation">,</span> <span class="token string">'4 7 6 2 63'</span><span class="token punctuation">,</span> <span class="token string">'4 8 2 4 68'</span><span class="token punctuation">,</span> <span class="token string">'4 8 2 8 92'</span><span class="token punctuation">,</span> <span class="token string">'4 8 4 2 68'</span><span class="token punctuation">,</span> <span class="token string">'4 8 8 2 92'</span><span class="token punctuation">,</span> <span class="token string">'4 9 6 6 97'</span><span class="token punctuation">,</span> <span class="token string">'5 5 5 5 50'</span><span class="token punctuation">,</span> <span class="token string">'6 2 4 7 63'</span><span class="token punctuation">,</span> <span class="token string">'6 2 7 4 63'</span><span class="token punctuation">,</span> <span class="token string">'6 3 6 6 63'</span><span class="token punctuation">,</span> <span class="token string">'6 4 2 7 63'</span><span class="token punctuation">,</span> <span class="token string">'6 4 6 9 97'</span><span class="token punctuation">,</span> <span class="token string">'6 4 7 2 63'</span><span class="token punctuation">,</span> <span class="token string">'6 4 9 6 97'</span><span class="token punctuation">,</span> <span class="token string">'6 6 3 6 63'</span><span class="token punctuation">,</span> <span class="token string">'6 6 4 9 97'</span><span class="token punctuation">,</span> <span class="token string">'6 6 6 3 63'</span><span class="token punctuation">,</span> <span class="token string">'6 6 6 6 72'</span><span class="token punctuation">,</span> <span class="token string">'6 6 9 4 97'</span><span class="token punctuation">,</span> <span class="token string">'6 7 2 4 63'</span><span class="token punctuation">,</span> <span class="token string">'6 7 4 2 63'</span><span class="token punctuation">,</span> <span class="token string">'6 9 4 6 97'</span><span class="token punctuation">,</span> <span class="token string">'6 9 6 4 97'</span><span class="token punctuation">,</span> <span class="token string">'7 2 4 6 63'</span><span class="token punctuation">,</span> <span class="token string">'7 2 6 4 63'</span><span class="token punctuation">,</span> <span class="token string">'7 4 2 6 63'</span><span class="token punctuation">,</span> <span class="token string">'7 4 6 2 63'</span><span class="token punctuation">,</span> <span class="token string">'7 6 2 4 63'</span><span class="token punctuation">,</span> <span class="token string">'7 6 4 2 63'</span><span class="token punctuation">,</span> <span class="token string">'7 7 7 7 98'</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> ans<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'[>] a: '</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'[>] b: '</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'[>] c: '</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'[>] d: '</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b'[>] e: '</span><span class="token punctuation">)</span>    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># from tqdm import tqdm</span><span class="token comment"># res = ['0 0 0 0 0']</span><span class="token comment"># for a in tqdm(range(1, 10)):</span><span class="token comment">#     for b in range(1, 10):</span><span class="token comment">#         for c in range(1, 10):</span><span class="token comment">#             for d in range(1, 10):</span><span class="token comment">#                 for e in range(100):</span><span class="token comment">#                     ans = str(a) + ' ' + str(b) + ' ' + str(c) + ' ' + str(d) + ' ' + str(e)</span><span class="token comment">#                     if a**4 + b**4 + c**4 + d**4 == e**2 and ans not in res:</span><span class="token comment">#                         res.append(ans)</span><span class="token comment">#                         if len(res) == 101:</span><span class="token comment">#                             print(res)</span><span class="token comment">#                             exit()</span><span class="token comment">#                         print(len(res))</span></code></pre><h2 id="RSA"><a href="#RSA" class="headerlink" title="RSA?"></a>RSA?</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os <span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>   flag <span class="token operator">=</span> <span class="token string">"GWHT&#123;xxxxxxxxx&#125;"</span> p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span> n <span class="token operator">=</span> p<span class="token operator">*</span>q N <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> e <span class="token operator">=</span> <span class="token number">65537</span> Mx <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">)</span> My <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span> Z1 <span class="token operator">=</span> <span class="token punctuation">(</span>Mx<span class="token operator">*</span>My<span class="token punctuation">)</span><span class="token operator">%</span>n inv_Z1 <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>Z1<span class="token punctuation">,</span> n<span class="token punctuation">)</span> inv_2 <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span> X <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>Z1<span class="token operator">+</span>inv_Z1<span class="token punctuation">)</span><span class="token operator">*</span>inv_2<span class="token punctuation">)</span><span class="token operator">%</span>n Y <span class="token operator">=</span> My inv_Y <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> n<span class="token punctuation">)</span> a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>inv_Z1<span class="token operator">-</span>X<span class="token punctuation">)</span><span class="token operator">*</span>inv_Y<span class="token punctuation">)</span><span class="token operator">%</span>n D <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span>n   xy <span class="token operator">=</span> <span class="token keyword">lambda</span> <span class="token punctuation">(</span>x1<span class="token punctuation">,</span>y1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>x2<span class="token punctuation">,</span>y2<span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x1<span class="token operator">*</span>x2<span class="token operator">+</span>D<span class="token operator">*</span>y1<span class="token operator">*</span>y2<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">,</span> <span class="token punctuation">(</span>x1<span class="token operator">*</span>y2<span class="token operator">+</span>x2<span class="token operator">*</span>y1<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">getloop</span><span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>         ret <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>         <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                ret <span class="token operator">=</span> xy<span class="token punctuation">(</span>ret<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span>         <span class="token keyword">return</span> ret   <span class="token keyword">print</span> n <span class="token keyword">print</span> getloop<span class="token punctuation">(</span><span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token keyword">print</span> a   <span class="token comment"># 13390709926509813526471364597371124446888078365567927211781799241724742352679484983709219580483800891886832613684875066109177882219522305348565532970795023</span> <span class="token comment"># (5404548088049249951619519701935576492239293254135836357417714329205323074367876875480850741613547220698045360461761929952847796420174204143917852624050110, 2110372753170830610718226848526649992911771424441223687775304654852191999130502986109306355582366065947895295520226816523397652918227241733632791793362785)</span> <span class="token comment"># 1762039418842677123086894939949574689744108610561557889235294034870342076452734215004689409493802437034960516295735815195656138656970901855976802991519141</span></code></pre><pre class="language-python" data-language="python"><code class="language-python">p <span class="token operator">=</span> <span class="token number">115718235064789220654263009993128324769382192706654302434478391267607309966379</span>q <span class="token operator">=</span> <span class="token number">115718235064789220654263009993128325569382592506655305434488398268608329541037</span>N <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>n <span class="token operator">=</span> <span class="token number">13390709926509813526471364597371124446888078365567927211781799241724742352679484983709219580483800891886832613684875066109177882219522305348565532970795023</span>Cx <span class="token operator">=</span> <span class="token number">5404548088049249951619519701935576492239293254135836357417714329205323074367876875480850741613547220698045360461761929952847796420174204143917852624050110</span>Cy <span class="token operator">=</span> <span class="token number">2110372753170830610718226848526649992911771424441223687775304654852191999130502986109306355582366065947895295520226816523397652918227241733632791793362785</span>a <span class="token operator">=</span> <span class="token number">1762039418842677123086894939949574689744108610561557889235294034870342076452734215004689409493802437034960516295735815195656138656970901855976802991519141</span>e <span class="token operator">=</span> <span class="token number">65537</span>d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span>N<span class="token punctuation">)</span>C <span class="token operator">=</span> <span class="token punctuation">(</span>Cx<span class="token operator">-</span>a<span class="token operator">*</span>Cy<span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token comment">#M = pow(C, d, n)</span>M <span class="token operator">=</span> <span class="token number">8007268851919796012341855118455232406759825390821788944052668931582460352847654688095258576336789686861764488439819713135655990494067195418877306177396723</span><span class="token comment">#print M</span>M_1 <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>M<span class="token punctuation">,</span>n<span class="token punctuation">)</span>X <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>M_1<span class="token operator">+</span>M<span class="token punctuation">)</span><span class="token operator">*</span>inverse_mod<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>nY <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>M_1<span class="token operator">-</span>M<span class="token punctuation">)</span><span class="token operator">*</span>inverse_mod<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>a<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>n<span class="token keyword">print</span> Y<span class="token comment">#print long_to_bytes(Y)</span></code></pre><h2 id="Miss"><a href="#Miss" class="headerlink" title="Miss"></a>Miss</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">from</span> Crypto <span class="token keyword">import</span> RandomS_BOX <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span>    <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span>    <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span>    <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span>    <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>    <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span>    <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span>    <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span>    <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>    <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span>    <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span>    <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span>    <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span>    <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span>    <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span>    <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span><span class="token punctuation">]</span>RCON_BOX <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">]</span>GF_MULT_1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">]</span>GF_MULT_2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">]</span>GF_MULT_3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">rotWord</span><span class="token punctuation">(</span>byteArray<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>byteArray<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>byteArray<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>byteArray<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>byteArray<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">subWord</span><span class="token punctuation">(</span>byteArray<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> b <span class="token keyword">in</span> byteArray<span class="token punctuation">:</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span> S_BOX<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">rcon</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>RCON_BOX<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">xor</span><span class="token punctuation">(</span>byteArray1<span class="token punctuation">,</span> byteArray2<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> b1<span class="token punctuation">,</span> b2 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>byteArray1<span class="token punctuation">,</span> byteArray2<span class="token punctuation">)</span><span class="token punctuation">:</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>b1 <span class="token operator">^</span> b2<span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">keyExpansion</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token builtin">round</span><span class="token punctuation">)</span><span class="token punctuation">:</span>lastcolumn <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>resRcon <span class="token operator">=</span> rotWord<span class="token punctuation">(</span>lastcolumn<span class="token punctuation">)</span>resSub <span class="token operator">=</span> subWord<span class="token punctuation">(</span>resRcon<span class="token punctuation">)</span>res1XOR <span class="token operator">=</span> xor<span class="token punctuation">(</span>resSub<span class="token punctuation">,</span>key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>newFirstColumn <span class="token operator">=</span> xor<span class="token punctuation">(</span>res1XOR<span class="token punctuation">,</span>rcon<span class="token punctuation">(</span><span class="token builtin">round</span><span class="token punctuation">)</span><span class="token punctuation">)</span>newKey <span class="token operator">=</span> newFirstColumn<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>part1XOR <span class="token operator">=</span> newKey<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>part2XOR <span class="token operator">=</span> key<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">]</span>newKey <span class="token operator">+=</span> xor<span class="token punctuation">(</span>part1XOR<span class="token punctuation">,</span> part2XOR<span class="token punctuation">)</span><span class="token keyword">return</span> newKey<span class="token keyword">def</span> <span class="token function">subBytes</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">:</span>resState <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>resState<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> subWord<span class="token punctuation">(</span>aesState<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span> resState<span class="token keyword">def</span> <span class="token function">shiftRow</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">:</span>resState <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>newPosition <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">,</span> <span class="token number">0xf</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">0xc</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> newPosition<span class="token punctuation">:</span>resState<span class="token punctuation">.</span>append<span class="token punctuation">(</span>aesState<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span> resState<span class="token keyword">def</span> <span class="token function">mixColumn</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>b0<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b3 <span class="token operator">=</span> aesState<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span>new_b0 <span class="token operator">=</span>  GF_MULT_2<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_3<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_1<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_1<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>new_b1 <span class="token operator">=</span>  GF_MULT_1<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_2<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_3<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_1<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>new_b2 <span class="token operator">=</span>  GF_MULT_1<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_1<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_2<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_3<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>new_b3 <span class="token operator">=</span>  GF_MULT_3<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_1<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_1<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_2<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b0<span class="token punctuation">)</span> res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b1<span class="token punctuation">)</span> res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b2<span class="token punctuation">)</span> res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b3<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">AES_Encryption</span><span class="token punctuation">(</span>plainText<span class="token punctuation">,</span> AES_key<span class="token punctuation">,</span> nbRound<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span>plainTextBytes <span class="token operator">=</span> plainText KeyList <span class="token operator">=</span> <span class="token punctuation">[</span>AES_key<span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> nbRound<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>KeyList<span class="token punctuation">.</span>append<span class="token punctuation">(</span>keyExpansion<span class="token punctuation">(</span>KeyList<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>res <span class="token operator">=</span> plainTextBytes<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>nbRound<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> subBytes<span class="token punctuation">(</span>res<span class="token punctuation">)</span>res <span class="token operator">=</span> shiftRow<span class="token punctuation">(</span>res<span class="token punctuation">)</span>res <span class="token operator">=</span> mixColumn<span class="token punctuation">(</span>res<span class="token punctuation">)</span>key <span class="token operator">=</span> KeyList<span class="token punctuation">[</span>i<span class="token punctuation">]</span>res <span class="token operator">=</span> subBytes<span class="token punctuation">(</span>res<span class="token punctuation">)</span>res <span class="token operator">=</span> shiftRow<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">StringToByteArray</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> msg<span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">ByteArrayToString</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">chr</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> cipher<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>AES_Key <span class="token operator">=</span> Random<span class="token punctuation">.</span>get_random_bytes<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_in<span class="token punctuation">:</span>flag <span class="token operator">=</span> f_in<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>cipherText <span class="token operator">=</span> AES_Encryption<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> AES_Key<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"cipher.txt"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_out<span class="token punctuation">:</span>f_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span>cipherText<span class="token punctuation">)</span> <span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span>S_BOX <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span>    <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span>    <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span>    <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span>    <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span>    <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span>    <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span>    <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span>    <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span>    <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span>    <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span>    <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span>    <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span>    <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span>    <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span>    <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span><span class="token punctuation">]</span>S_INV_BOX <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x52</span><span class="token punctuation">,</span> <span class="token number">0x09</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd5</span><span class="token punctuation">,</span> <span class="token number">0x30</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0xa5</span><span class="token punctuation">,</span> <span class="token number">0x38</span><span class="token punctuation">,</span> <span class="token number">0xbf</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0xa3</span><span class="token punctuation">,</span> <span class="token number">0x9e</span><span class="token punctuation">,</span> <span class="token number">0x81</span><span class="token punctuation">,</span> <span class="token number">0xf3</span><span class="token punctuation">,</span> <span class="token number">0xd7</span><span class="token punctuation">,</span> <span class="token number">0xfb</span><span class="token punctuation">,</span> <span class="token number">0x7c</span><span class="token punctuation">,</span> <span class="token number">0xe3</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x82</span><span class="token punctuation">,</span> <span class="token number">0x9b</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0xff</span><span class="token punctuation">,</span> <span class="token number">0x87</span><span class="token punctuation">,</span> <span class="token number">0x34</span><span class="token punctuation">,</span> <span class="token number">0x8e</span><span class="token punctuation">,</span> <span class="token number">0x43</span><span class="token punctuation">,</span> <span class="token number">0x44</span><span class="token punctuation">,</span> <span class="token number">0xc4</span><span class="token punctuation">,</span> <span class="token number">0xde</span><span class="token punctuation">,</span> <span class="token number">0xe9</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x54</span><span class="token punctuation">,</span> <span class="token number">0x7b</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x32</span><span class="token punctuation">,</span> <span class="token number">0xa6</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x23</span><span class="token punctuation">,</span> <span class="token number">0x3d</span><span class="token punctuation">,</span> <span class="token number">0xee</span><span class="token punctuation">,</span> <span class="token number">0x4c</span><span class="token punctuation">,</span> <span class="token number">0x95</span><span class="token punctuation">,</span> <span class="token number">0x0b</span><span class="token punctuation">,</span> <span class="token number">0x42</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xc3</span><span class="token punctuation">,</span> <span class="token number">0x4e</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x2e</span><span class="token punctuation">,</span> <span class="token number">0xa1</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0x28</span><span class="token punctuation">,</span> <span class="token number">0xd9</span><span class="token punctuation">,</span> <span class="token number">0x24</span><span class="token punctuation">,</span> <span class="token number">0xb2</span><span class="token punctuation">,</span> <span class="token number">0x76</span><span class="token punctuation">,</span> <span class="token number">0x5b</span><span class="token punctuation">,</span> <span class="token number">0xa2</span><span class="token punctuation">,</span> <span class="token number">0x49</span><span class="token punctuation">,</span> <span class="token number">0x6d</span><span class="token punctuation">,</span> <span class="token number">0x8b</span><span class="token punctuation">,</span> <span class="token number">0xd1</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xf8</span><span class="token punctuation">,</span> <span class="token number">0xf6</span><span class="token punctuation">,</span> <span class="token number">0x64</span><span class="token punctuation">,</span> <span class="token number">0x86</span><span class="token punctuation">,</span> <span class="token number">0x68</span><span class="token punctuation">,</span> <span class="token number">0x98</span><span class="token punctuation">,</span> <span class="token number">0x16</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xa4</span><span class="token punctuation">,</span> <span class="token number">0x5c</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x5d</span><span class="token punctuation">,</span> <span class="token number">0x65</span><span class="token punctuation">,</span> <span class="token number">0xb6</span><span class="token punctuation">,</span> <span class="token number">0x92</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0x70</span><span class="token punctuation">,</span> <span class="token number">0x48</span><span class="token punctuation">,</span> <span class="token number">0x50</span><span class="token punctuation">,</span> <span class="token number">0xfd</span><span class="token punctuation">,</span> <span class="token number">0xed</span><span class="token punctuation">,</span> <span class="token number">0xb9</span><span class="token punctuation">,</span> <span class="token number">0xda</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0x15</span><span class="token punctuation">,</span> <span class="token number">0x46</span><span class="token punctuation">,</span> <span class="token number">0x57</span><span class="token punctuation">,</span> <span class="token number">0xa7</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x9d</span><span class="token punctuation">,</span> <span class="token number">0x84</span><span class="token punctuation">,</span> <span class="token number">0x90</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x00</span><span class="token punctuation">,</span> <span class="token number">0x8c</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0x0a</span><span class="token punctuation">,</span> <span class="token number">0xf7</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0x58</span><span class="token punctuation">,</span> <span class="token number">0x05</span><span class="token punctuation">,</span> <span class="token number">0xb8</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x45</span><span class="token punctuation">,</span> <span class="token number">0x06</span><span class="token punctuation">,</span> <span class="token number">0xd0</span><span class="token punctuation">,</span> <span class="token number">0x2c</span><span class="token punctuation">,</span> <span class="token number">0x1e</span><span class="token punctuation">,</span> <span class="token number">0x8f</span><span class="token punctuation">,</span> <span class="token number">0xca</span><span class="token punctuation">,</span> <span class="token number">0x3f</span><span class="token punctuation">,</span> <span class="token number">0x0f</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0xc1</span><span class="token punctuation">,</span> <span class="token number">0xaf</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x03</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x13</span><span class="token punctuation">,</span> <span class="token number">0x8a</span><span class="token punctuation">,</span> <span class="token number">0x6b</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x11</span><span class="token punctuation">,</span> <span class="token number">0x41</span><span class="token punctuation">,</span> <span class="token number">0x4f</span><span class="token punctuation">,</span> <span class="token number">0x67</span><span class="token punctuation">,</span> <span class="token number">0xdc</span><span class="token punctuation">,</span> <span class="token number">0xea</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0xf2</span><span class="token punctuation">,</span> <span class="token number">0xcf</span><span class="token punctuation">,</span> <span class="token number">0xce</span><span class="token punctuation">,</span> <span class="token number">0xf0</span><span class="token punctuation">,</span> <span class="token number">0xb4</span><span class="token punctuation">,</span> <span class="token number">0xe6</span><span class="token punctuation">,</span> <span class="token number">0x73</span><span class="token punctuation">,</span> <span class="token number">0x96</span><span class="token punctuation">,</span> <span class="token number">0xac</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0x22</span><span class="token punctuation">,</span> <span class="token number">0xe7</span><span class="token punctuation">,</span> <span class="token number">0xad</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x85</span><span class="token punctuation">,</span> <span class="token number">0xe2</span><span class="token punctuation">,</span> <span class="token number">0xf9</span><span class="token punctuation">,</span> <span class="token number">0x37</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0x1c</span><span class="token punctuation">,</span> <span class="token number">0x75</span><span class="token punctuation">,</span> <span class="token number">0xdf</span><span class="token punctuation">,</span> <span class="token number">0x6e</span><span class="token punctuation">,</span> <span class="token number">0x47</span><span class="token punctuation">,</span> <span class="token number">0xf1</span><span class="token punctuation">,</span> <span class="token number">0x1a</span><span class="token punctuation">,</span> <span class="token number">0x71</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x29</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x89</span><span class="token punctuation">,</span> <span class="token number">0x6f</span><span class="token punctuation">,</span> <span class="token number">0xb7</span><span class="token punctuation">,</span> <span class="token number">0x62</span><span class="token punctuation">,</span> <span class="token number">0x0e</span><span class="token punctuation">,</span> <span class="token number">0xaa</span><span class="token punctuation">,</span> <span class="token number">0x18</span><span class="token punctuation">,</span> <span class="token number">0xbe</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0xfc</span><span class="token punctuation">,</span> <span class="token number">0x56</span><span class="token punctuation">,</span> <span class="token number">0x3e</span><span class="token punctuation">,</span> <span class="token number">0x4b</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0xd2</span><span class="token punctuation">,</span> <span class="token number">0x79</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0xdb</span><span class="token punctuation">,</span> <span class="token number">0xc0</span><span class="token punctuation">,</span> <span class="token number">0xfe</span><span class="token punctuation">,</span> <span class="token number">0x78</span><span class="token punctuation">,</span> <span class="token number">0xcd</span><span class="token punctuation">,</span> <span class="token number">0x5a</span><span class="token punctuation">,</span> <span class="token number">0xf4</span><span class="token punctuation">,</span> <span class="token number">0x1f</span><span class="token punctuation">,</span> <span class="token number">0xdd</span><span class="token punctuation">,</span> <span class="token number">0xa8</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x88</span><span class="token punctuation">,</span> <span class="token number">0x07</span><span class="token punctuation">,</span> <span class="token number">0xc7</span><span class="token punctuation">,</span> <span class="token number">0x31</span><span class="token punctuation">,</span> <span class="token number">0xb1</span><span class="token punctuation">,</span> <span class="token number">0x12</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x59</span><span class="token punctuation">,</span> <span class="token number">0x27</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0xec</span><span class="token punctuation">,</span> <span class="token number">0x5f</span><span class="token punctuation">,</span> <span class="token number">0x60</span><span class="token punctuation">,</span> <span class="token number">0x51</span><span class="token punctuation">,</span> <span class="token number">0x7f</span><span class="token punctuation">,</span> <span class="token number">0xa9</span><span class="token punctuation">,</span> <span class="token number">0x19</span><span class="token punctuation">,</span> <span class="token number">0xb5</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x0d</span><span class="token punctuation">,</span> <span class="token number">0x2d</span><span class="token punctuation">,</span> <span class="token number">0xe5</span><span class="token punctuation">,</span> <span class="token number">0x7a</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x93</span><span class="token punctuation">,</span> <span class="token number">0xc9</span><span class="token punctuation">,</span> <span class="token number">0x9c</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xa0</span><span class="token punctuation">,</span> <span class="token number">0xe0</span><span class="token punctuation">,</span> <span class="token number">0x3b</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0xae</span><span class="token punctuation">,</span> <span class="token number">0x2a</span><span class="token punctuation">,</span> <span class="token number">0xf5</span><span class="token punctuation">,</span> <span class="token number">0xb0</span><span class="token punctuation">,</span> <span class="token number">0xc8</span><span class="token punctuation">,</span> <span class="token number">0xeb</span><span class="token punctuation">,</span> <span class="token number">0xbb</span><span class="token punctuation">,</span> <span class="token number">0x3c</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x53</span><span class="token punctuation">,</span> <span class="token number">0x99</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0x17</span><span class="token punctuation">,</span> <span class="token number">0x2b</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x7e</span><span class="token punctuation">,</span> <span class="token number">0xba</span><span class="token punctuation">,</span> <span class="token number">0x77</span><span class="token punctuation">,</span> <span class="token number">0xd6</span><span class="token punctuation">,</span> <span class="token number">0x26</span><span class="token punctuation">,</span> <span class="token number">0xe1</span><span class="token punctuation">,</span> <span class="token number">0x69</span><span class="token punctuation">,</span> <span class="token number">0x14</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0x55</span><span class="token punctuation">,</span> <span class="token number">0x21</span><span class="token punctuation">,</span> <span class="token number">0x0c</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">]</span>RCON_BOX <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span> <span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span> <span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span> <span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">,</span> <span class="token number">0x01</span><span class="token punctuation">,</span> <span class="token number">0x02</span><span class="token punctuation">,</span> <span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span> <span class="token number">0x10</span><span class="token punctuation">,</span> <span class="token number">0x20</span><span class="token punctuation">,</span> <span class="token number">0x40</span><span class="token punctuation">,</span> <span class="token number">0x80</span><span class="token punctuation">,</span> <span class="token number">0x1b</span><span class="token punctuation">,</span> <span class="token number">0x36</span><span class="token punctuation">,</span> <span class="token number">0x6c</span><span class="token punctuation">,</span> <span class="token number">0xd8</span><span class="token punctuation">,</span> <span class="token number">0xab</span><span class="token punctuation">,</span> <span class="token number">0x4d</span><span class="token punctuation">,</span> <span class="token number">0x9a</span><span class="token punctuation">,</span> <span class="token number">0x2f</span><span class="token punctuation">,</span> <span class="token number">0x5e</span><span class="token punctuation">,</span> <span class="token number">0xbc</span><span class="token punctuation">,</span> <span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span> <span class="token number">0x97</span><span class="token punctuation">,</span> <span class="token number">0x35</span><span class="token punctuation">,</span> <span class="token number">0x6a</span><span class="token punctuation">,</span> <span class="token number">0xd4</span><span class="token punctuation">,</span> <span class="token number">0xb3</span><span class="token punctuation">,</span> <span class="token number">0x7d</span><span class="token punctuation">,</span> <span class="token number">0xfa</span><span class="token punctuation">,</span> <span class="token number">0xef</span><span class="token punctuation">,</span> <span class="token number">0xc5</span><span class="token punctuation">,</span> <span class="token number">0x91</span><span class="token punctuation">,</span> <span class="token number">0x39</span><span class="token punctuation">,</span> <span class="token number">0x72</span><span class="token punctuation">,</span> <span class="token number">0xe4</span><span class="token punctuation">,</span> <span class="token number">0xd3</span><span class="token punctuation">,</span> <span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span> <span class="token number">0xc2</span><span class="token punctuation">,</span> <span class="token number">0x9f</span><span class="token punctuation">,</span> <span class="token number">0x25</span><span class="token punctuation">,</span> <span class="token number">0x4a</span><span class="token punctuation">,</span> <span class="token number">0x94</span><span class="token punctuation">,</span> <span class="token number">0x33</span><span class="token punctuation">,</span> <span class="token number">0x66</span><span class="token punctuation">,</span> <span class="token number">0xcc</span><span class="token punctuation">,</span> <span class="token number">0x83</span><span class="token punctuation">,</span> <span class="token number">0x1d</span><span class="token punctuation">,</span> <span class="token number">0x3a</span><span class="token punctuation">,</span> <span class="token number">0x74</span><span class="token punctuation">,</span> <span class="token number">0xe8</span><span class="token punctuation">,</span> <span class="token number">0xcb</span><span class="token punctuation">,</span> <span class="token number">0x8d</span><span class="token punctuation">]</span>GF_MULT_1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">]</span>GF_MULT_2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">]</span>GF_MULT_3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">]</span>GF_MULT_09 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">]</span>GF_MULT_11 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">]</span>GF_MULT_13 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">]</span>GF_MULT_14 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0x00</span><span class="token punctuation">,</span><span class="token number">0x0e</span><span class="token punctuation">,</span><span class="token number">0x1c</span><span class="token punctuation">,</span><span class="token number">0x12</span><span class="token punctuation">,</span><span class="token number">0x38</span><span class="token punctuation">,</span><span class="token number">0x36</span><span class="token punctuation">,</span><span class="token number">0x24</span><span class="token punctuation">,</span><span class="token number">0x2a</span><span class="token punctuation">,</span><span class="token number">0x70</span><span class="token punctuation">,</span><span class="token number">0x7e</span><span class="token punctuation">,</span><span class="token number">0x6c</span><span class="token punctuation">,</span><span class="token number">0x62</span><span class="token punctuation">,</span><span class="token number">0x48</span><span class="token punctuation">,</span><span class="token number">0x46</span><span class="token punctuation">,</span><span class="token number">0x54</span><span class="token punctuation">,</span><span class="token number">0x5a</span><span class="token punctuation">,</span><span class="token number">0xe0</span><span class="token punctuation">,</span><span class="token number">0xee</span><span class="token punctuation">,</span><span class="token number">0xfc</span><span class="token punctuation">,</span><span class="token number">0xf2</span><span class="token punctuation">,</span><span class="token number">0xd8</span><span class="token punctuation">,</span><span class="token number">0xd6</span><span class="token punctuation">,</span><span class="token number">0xc4</span><span class="token punctuation">,</span><span class="token number">0xca</span><span class="token punctuation">,</span><span class="token number">0x90</span><span class="token punctuation">,</span><span class="token number">0x9e</span><span class="token punctuation">,</span><span class="token number">0x8c</span><span class="token punctuation">,</span><span class="token number">0x82</span><span class="token punctuation">,</span><span class="token number">0xa8</span><span class="token punctuation">,</span><span class="token number">0xa6</span><span class="token punctuation">,</span><span class="token number">0xb4</span><span class="token punctuation">,</span><span class="token number">0xba</span><span class="token punctuation">,</span><span class="token number">0xdb</span><span class="token punctuation">,</span><span class="token number">0xd5</span><span class="token punctuation">,</span><span class="token number">0xc7</span><span class="token punctuation">,</span><span class="token number">0xc9</span><span class="token punctuation">,</span><span class="token number">0xe3</span><span class="token punctuation">,</span><span class="token number">0xed</span><span class="token punctuation">,</span><span class="token number">0xff</span><span class="token punctuation">,</span><span class="token number">0xf1</span><span class="token punctuation">,</span><span class="token number">0xab</span><span class="token punctuation">,</span><span class="token number">0xa5</span><span class="token punctuation">,</span><span class="token number">0xb7</span><span class="token punctuation">,</span><span class="token number">0xb9</span><span class="token punctuation">,</span><span class="token number">0x93</span><span class="token punctuation">,</span><span class="token number">0x9d</span><span class="token punctuation">,</span><span class="token number">0x8f</span><span class="token punctuation">,</span><span class="token number">0x81</span><span class="token punctuation">,</span><span class="token number">0x3b</span><span class="token punctuation">,</span><span class="token number">0x35</span><span class="token punctuation">,</span><span class="token number">0x27</span><span class="token punctuation">,</span><span class="token number">0x29</span><span class="token punctuation">,</span><span class="token number">0x03</span><span class="token punctuation">,</span><span class="token number">0x0d</span><span class="token punctuation">,</span><span class="token number">0x1f</span><span class="token punctuation">,</span><span class="token number">0x11</span><span class="token punctuation">,</span><span class="token number">0x4b</span><span class="token punctuation">,</span><span class="token number">0x45</span><span class="token punctuation">,</span><span class="token number">0x57</span><span class="token punctuation">,</span><span class="token number">0x59</span><span class="token punctuation">,</span><span class="token number">0x73</span><span class="token punctuation">,</span><span class="token number">0x7d</span><span class="token punctuation">,</span><span class="token number">0x6f</span><span class="token punctuation">,</span><span class="token number">0x61</span><span class="token punctuation">,</span><span class="token number">0xad</span><span class="token punctuation">,</span><span class="token number">0xa3</span><span class="token punctuation">,</span><span class="token number">0xb1</span><span class="token punctuation">,</span><span class="token number">0xbf</span><span class="token punctuation">,</span><span class="token number">0x95</span><span class="token punctuation">,</span><span class="token number">0x9b</span><span class="token punctuation">,</span><span class="token number">0x89</span><span class="token punctuation">,</span><span class="token number">0x87</span><span class="token punctuation">,</span><span class="token number">0xdd</span><span class="token punctuation">,</span><span class="token number">0xd3</span><span class="token punctuation">,</span><span class="token number">0xc1</span><span class="token punctuation">,</span><span class="token number">0xcf</span><span class="token punctuation">,</span><span class="token number">0xe5</span><span class="token punctuation">,</span><span class="token number">0xeb</span><span class="token punctuation">,</span><span class="token number">0xf9</span><span class="token punctuation">,</span><span class="token number">0xf7</span><span class="token punctuation">,</span><span class="token number">0x4d</span><span class="token punctuation">,</span><span class="token number">0x43</span><span class="token punctuation">,</span><span class="token number">0x51</span><span class="token punctuation">,</span><span class="token number">0x5f</span><span class="token punctuation">,</span><span class="token number">0x75</span><span class="token punctuation">,</span><span class="token number">0x7b</span><span class="token punctuation">,</span><span class="token number">0x69</span><span class="token punctuation">,</span><span class="token number">0x67</span><span class="token punctuation">,</span><span class="token number">0x3d</span><span class="token punctuation">,</span><span class="token number">0x33</span><span class="token punctuation">,</span><span class="token number">0x21</span><span class="token punctuation">,</span><span class="token number">0x2f</span><span class="token punctuation">,</span><span class="token number">0x05</span><span class="token punctuation">,</span><span class="token number">0x0b</span><span class="token punctuation">,</span><span class="token number">0x19</span><span class="token punctuation">,</span><span class="token number">0x17</span><span class="token punctuation">,</span><span class="token number">0x76</span><span class="token punctuation">,</span><span class="token number">0x78</span><span class="token punctuation">,</span><span class="token number">0x6a</span><span class="token punctuation">,</span><span class="token number">0x64</span><span class="token punctuation">,</span><span class="token number">0x4e</span><span class="token punctuation">,</span><span class="token number">0x40</span><span class="token punctuation">,</span><span class="token number">0x52</span><span class="token punctuation">,</span><span class="token number">0x5c</span><span class="token punctuation">,</span><span class="token number">0x06</span><span class="token punctuation">,</span><span class="token number">0x08</span><span class="token punctuation">,</span><span class="token number">0x1a</span><span class="token punctuation">,</span><span class="token number">0x14</span><span class="token punctuation">,</span><span class="token number">0x3e</span><span class="token punctuation">,</span><span class="token number">0x30</span><span class="token punctuation">,</span><span class="token number">0x22</span><span class="token punctuation">,</span><span class="token number">0x2c</span><span class="token punctuation">,</span><span class="token number">0x96</span><span class="token punctuation">,</span><span class="token number">0x98</span><span class="token punctuation">,</span><span class="token number">0x8a</span><span class="token punctuation">,</span><span class="token number">0x84</span><span class="token punctuation">,</span><span class="token number">0xae</span><span class="token punctuation">,</span><span class="token number">0xa0</span><span class="token punctuation">,</span><span class="token number">0xb2</span><span class="token punctuation">,</span><span class="token number">0xbc</span><span class="token punctuation">,</span><span class="token number">0xe6</span><span class="token punctuation">,</span><span class="token number">0xe8</span><span class="token punctuation">,</span><span class="token number">0xfa</span><span class="token punctuation">,</span><span class="token number">0xf4</span><span class="token punctuation">,</span><span class="token number">0xde</span><span class="token punctuation">,</span><span class="token number">0xd0</span><span class="token punctuation">,</span><span class="token number">0xc2</span><span class="token punctuation">,</span><span class="token number">0xcc</span><span class="token punctuation">,</span><span class="token number">0x41</span><span class="token punctuation">,</span><span class="token number">0x4f</span><span class="token punctuation">,</span><span class="token number">0x5d</span><span class="token punctuation">,</span><span class="token number">0x53</span><span class="token punctuation">,</span><span class="token number">0x79</span><span class="token punctuation">,</span><span class="token number">0x77</span><span class="token punctuation">,</span><span class="token number">0x65</span><span class="token punctuation">,</span><span class="token number">0x6b</span><span class="token punctuation">,</span><span class="token number">0x31</span><span class="token punctuation">,</span><span class="token number">0x3f</span><span class="token punctuation">,</span><span class="token number">0x2d</span><span class="token punctuation">,</span><span class="token number">0x23</span><span class="token punctuation">,</span><span class="token number">0x09</span><span class="token punctuation">,</span><span class="token number">0x07</span><span class="token punctuation">,</span><span class="token number">0x15</span><span class="token punctuation">,</span><span class="token number">0x1b</span><span class="token punctuation">,</span><span class="token number">0xa1</span><span class="token punctuation">,</span><span class="token number">0xaf</span><span class="token punctuation">,</span><span class="token number">0xbd</span><span class="token punctuation">,</span><span class="token number">0xb3</span><span class="token punctuation">,</span><span class="token number">0x99</span><span class="token punctuation">,</span><span class="token number">0x97</span><span class="token punctuation">,</span><span class="token number">0x85</span><span class="token punctuation">,</span><span class="token number">0x8b</span><span class="token punctuation">,</span><span class="token number">0xd1</span><span class="token punctuation">,</span><span class="token number">0xdf</span><span class="token punctuation">,</span><span class="token number">0xcd</span><span class="token punctuation">,</span><span class="token number">0xc3</span><span class="token punctuation">,</span><span class="token number">0xe9</span><span class="token punctuation">,</span><span class="token number">0xe7</span><span class="token punctuation">,</span><span class="token number">0xf5</span><span class="token punctuation">,</span><span class="token number">0xfb</span><span class="token punctuation">,</span><span class="token number">0x9a</span><span class="token punctuation">,</span><span class="token number">0x94</span><span class="token punctuation">,</span><span class="token number">0x86</span><span class="token punctuation">,</span><span class="token number">0x88</span><span class="token punctuation">,</span><span class="token number">0xa2</span><span class="token punctuation">,</span><span class="token number">0xac</span><span class="token punctuation">,</span><span class="token number">0xbe</span><span class="token punctuation">,</span><span class="token number">0xb0</span><span class="token punctuation">,</span><span class="token number">0xea</span><span class="token punctuation">,</span><span class="token number">0xe4</span><span class="token punctuation">,</span><span class="token number">0xf6</span><span class="token punctuation">,</span><span class="token number">0xf8</span><span class="token punctuation">,</span><span class="token number">0xd2</span><span class="token punctuation">,</span><span class="token number">0xdc</span><span class="token punctuation">,</span><span class="token number">0xce</span><span class="token punctuation">,</span><span class="token number">0xc0</span><span class="token punctuation">,</span><span class="token number">0x7a</span><span class="token punctuation">,</span><span class="token number">0x74</span><span class="token punctuation">,</span><span class="token number">0x66</span><span class="token punctuation">,</span><span class="token number">0x68</span><span class="token punctuation">,</span><span class="token number">0x42</span><span class="token punctuation">,</span><span class="token number">0x4c</span><span class="token punctuation">,</span><span class="token number">0x5e</span><span class="token punctuation">,</span><span class="token number">0x50</span><span class="token punctuation">,</span><span class="token number">0x0a</span><span class="token punctuation">,</span><span class="token number">0x04</span><span class="token punctuation">,</span><span class="token number">0x16</span><span class="token punctuation">,</span><span class="token number">0x18</span><span class="token punctuation">,</span><span class="token number">0x32</span><span class="token punctuation">,</span><span class="token number">0x3c</span><span class="token punctuation">,</span><span class="token number">0x2e</span><span class="token punctuation">,</span><span class="token number">0x20</span><span class="token punctuation">,</span><span class="token number">0xec</span><span class="token punctuation">,</span><span class="token number">0xe2</span><span class="token punctuation">,</span><span class="token number">0xf0</span><span class="token punctuation">,</span><span class="token number">0xfe</span><span class="token punctuation">,</span><span class="token number">0xd4</span><span class="token punctuation">,</span><span class="token number">0xda</span><span class="token punctuation">,</span><span class="token number">0xc8</span><span class="token punctuation">,</span><span class="token number">0xc6</span><span class="token punctuation">,</span><span class="token number">0x9c</span><span class="token punctuation">,</span><span class="token number">0x92</span><span class="token punctuation">,</span><span class="token number">0x80</span><span class="token punctuation">,</span><span class="token number">0x8e</span><span class="token punctuation">,</span><span class="token number">0xa4</span><span class="token punctuation">,</span><span class="token number">0xaa</span><span class="token punctuation">,</span><span class="token number">0xb8</span><span class="token punctuation">,</span><span class="token number">0xb6</span><span class="token punctuation">,</span><span class="token number">0x0c</span><span class="token punctuation">,</span><span class="token number">0x02</span><span class="token punctuation">,</span><span class="token number">0x10</span><span class="token punctuation">,</span><span class="token number">0x1e</span><span class="token punctuation">,</span><span class="token number">0x34</span><span class="token punctuation">,</span><span class="token number">0x3a</span><span class="token punctuation">,</span><span class="token number">0x28</span><span class="token punctuation">,</span><span class="token number">0x26</span><span class="token punctuation">,</span><span class="token number">0x7c</span><span class="token punctuation">,</span><span class="token number">0x72</span><span class="token punctuation">,</span><span class="token number">0x60</span><span class="token punctuation">,</span><span class="token number">0x6e</span><span class="token punctuation">,</span><span class="token number">0x44</span><span class="token punctuation">,</span><span class="token number">0x4a</span><span class="token punctuation">,</span><span class="token number">0x58</span><span class="token punctuation">,</span><span class="token number">0x56</span><span class="token punctuation">,</span><span class="token number">0x37</span><span class="token punctuation">,</span><span class="token number">0x39</span><span class="token punctuation">,</span><span class="token number">0x2b</span><span class="token punctuation">,</span><span class="token number">0x25</span><span class="token punctuation">,</span><span class="token number">0x0f</span><span class="token punctuation">,</span><span class="token number">0x01</span><span class="token punctuation">,</span><span class="token number">0x13</span><span class="token punctuation">,</span><span class="token number">0x1d</span><span class="token punctuation">,</span><span class="token number">0x47</span><span class="token punctuation">,</span><span class="token number">0x49</span><span class="token punctuation">,</span><span class="token number">0x5b</span><span class="token punctuation">,</span><span class="token number">0x55</span><span class="token punctuation">,</span><span class="token number">0x7f</span><span class="token punctuation">,</span><span class="token number">0x71</span><span class="token punctuation">,</span><span class="token number">0x63</span><span class="token punctuation">,</span><span class="token number">0x6d</span><span class="token punctuation">,</span><span class="token number">0xd7</span><span class="token punctuation">,</span><span class="token number">0xd9</span><span class="token punctuation">,</span><span class="token number">0xcb</span><span class="token punctuation">,</span><span class="token number">0xc5</span><span class="token punctuation">,</span><span class="token number">0xef</span><span class="token punctuation">,</span><span class="token number">0xe1</span><span class="token punctuation">,</span><span class="token number">0xf3</span><span class="token punctuation">,</span><span class="token number">0xfd</span><span class="token punctuation">,</span><span class="token number">0xa7</span><span class="token punctuation">,</span><span class="token number">0xa9</span><span class="token punctuation">,</span><span class="token number">0xbb</span><span class="token punctuation">,</span><span class="token number">0xb5</span><span class="token punctuation">,</span><span class="token number">0x9f</span><span class="token punctuation">,</span><span class="token number">0x91</span><span class="token punctuation">,</span><span class="token number">0x83</span><span class="token punctuation">,</span><span class="token number">0x8d</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">inv_subWord</span><span class="token punctuation">(</span>byteArray<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> b <span class="token keyword">in</span> byteArray<span class="token punctuation">:</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span> S_INV_BOX<span class="token punctuation">[</span>b<span class="token punctuation">]</span> <span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">inv_subBytes</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">:</span>resState <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>resState<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">=</span> inv_subWord<span class="token punctuation">(</span>aesState<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span> resState<span class="token keyword">def</span> <span class="token function">inv_shiftRow</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">:</span>resState <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">"""0 4 8 c        0 4 8 c1 5 9 d        d 1 5 92 6 a e    ->  a e 2 63 7 b f        7 b f 3"""</span>newPosition <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0xd</span><span class="token punctuation">,</span> <span class="token number">0xa</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span>   <span class="token number">1</span><span class="token punctuation">,</span>  <span class="token number">0xe</span><span class="token punctuation">,</span> <span class="token number">0xb</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span>   <span class="token number">5</span><span class="token punctuation">,</span>  <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0xf</span><span class="token punctuation">,</span><span class="token number">0xc</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> newPosition<span class="token punctuation">:</span>resState<span class="token punctuation">.</span>append<span class="token punctuation">(</span>aesState<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">return</span> resState<span class="token keyword">def</span> <span class="token function">inv_mixColumn</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>aesState<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>b0<span class="token punctuation">,</span> b1<span class="token punctuation">,</span> b2<span class="token punctuation">,</span> b3 <span class="token operator">=</span> aesState<span class="token punctuation">[</span>i<span class="token punctuation">:</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">]</span>new_b0 <span class="token operator">=</span> GF_MULT_14<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_11<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_13<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_09<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>new_b1 <span class="token operator">=</span> GF_MULT_09<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_14<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_11<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_13<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>new_b2 <span class="token operator">=</span> GF_MULT_13<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_09<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_14<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_11<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>new_b3 <span class="token operator">=</span> GF_MULT_11<span class="token punctuation">[</span>b0<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_13<span class="token punctuation">[</span>b1<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_09<span class="token punctuation">[</span>b2<span class="token punctuation">]</span> <span class="token operator">^</span> GF_MULT_14<span class="token punctuation">[</span>b3<span class="token punctuation">]</span>res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b0<span class="token punctuation">)</span> res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b1<span class="token punctuation">)</span> res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b2<span class="token punctuation">)</span> res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>new_b3<span class="token punctuation">)</span> <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">AES_Decryption</span><span class="token punctuation">(</span>cipherText<span class="token punctuation">,</span> AES_key<span class="token punctuation">,</span> nbRound<span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> cipherTextres <span class="token operator">=</span> inv_shiftRow<span class="token punctuation">(</span>res<span class="token punctuation">)</span>res <span class="token operator">=</span> inv_subBytes<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>nbRound<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>res <span class="token operator">=</span> inv_mixColumn<span class="token punctuation">(</span>res<span class="token punctuation">)</span>res <span class="token operator">=</span> inv_shiftRow<span class="token punctuation">(</span>res<span class="token punctuation">)</span>res <span class="token operator">=</span> inv_subBytes<span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>AES_Key <span class="token operator">=</span> <span class="token boolean">None</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"cipher.txt"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f_in<span class="token punctuation">:</span>cipherText <span class="token operator">=</span> f_in<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>secondPlainText <span class="token operator">=</span> AES_Decryption<span class="token punctuation">(</span>cipherText<span class="token punctuation">,</span> AES_Key<span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>secondPlainText<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h1 id="第五空间"><a href="#第五空间" class="headerlink" title="第五空间"></a>第五空间</h1><h2 id="ECC"><a href="#ECC" class="headerlink" title="ECC"></a>ECC</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span> <span class="token string">'Try to solve the 3 ECC'</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">assert</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag&#123;'</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> flag<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>num1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>num2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">:</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span>num3 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ECC1</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>p <span class="token operator">=</span> <span class="token number">146808027458411567</span>A <span class="token operator">=</span> <span class="token number">46056180</span>B <span class="token operator">=</span> <span class="token number">2316783294673</span>E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span>A<span class="token punctuation">,</span>B<span class="token punctuation">]</span><span class="token punctuation">)</span>P <span class="token operator">=</span> E<span class="token punctuation">.</span>random_point<span class="token punctuation">(</span><span class="token punctuation">)</span> Q <span class="token operator">=</span> num<span class="token operator">*</span>P<span class="token keyword">print</span> E<span class="token keyword">print</span> <span class="token string">'P:'</span><span class="token punctuation">,</span>P<span class="token keyword">print</span> <span class="token string">'Q:'</span><span class="token punctuation">,</span>Q<span class="token keyword">def</span> <span class="token function">ECC2</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>p <span class="token operator">=</span> <span class="token number">1256438680873352167711863680253958927079458741172412327087203</span><span class="token comment">#import random</span><span class="token comment">#A = random.randrange(389718923781273978681723687163812)</span><span class="token comment">#B = random.randrange(816378675675716537126387613131232121431231)</span>A <span class="token operator">=</span> <span class="token number">377999945830334462584412960368612</span>B <span class="token operator">=</span> <span class="token number">604811648267717218711247799143415167229480</span>E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span>A<span class="token punctuation">,</span>B<span class="token punctuation">]</span><span class="token punctuation">)</span>P <span class="token operator">=</span> E<span class="token punctuation">.</span>random_point<span class="token punctuation">(</span><span class="token punctuation">)</span> Q <span class="token operator">=</span> num<span class="token operator">*</span>P<span class="token keyword">print</span> E<span class="token keyword">print</span> <span class="token string">'P:'</span><span class="token punctuation">,</span>P<span class="token keyword">print</span> <span class="token string">'Q:'</span><span class="token punctuation">,</span>Qfactors<span class="token punctuation">,</span> exponents <span class="token operator">=</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>factor<span class="token punctuation">(</span>E<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>primes <span class="token operator">=</span> <span class="token punctuation">[</span>factors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> exponents<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>factors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">print</span> primesdlogs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> fac <span class="token keyword">in</span> primes<span class="token punctuation">:</span>t <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>P<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fac<span class="token punctuation">)</span><span class="token punctuation">)</span>dlog <span class="token operator">=</span> discrete_log<span class="token punctuation">(</span>t<span class="token operator">*</span>Q<span class="token punctuation">,</span>t<span class="token operator">*</span>P<span class="token punctuation">,</span>operation<span class="token operator">=</span><span class="token string">"+"</span><span class="token punctuation">)</span>dlogs <span class="token operator">+=</span> <span class="token punctuation">[</span>dlog<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"factor: "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>fac<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">", Discrete Log: "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>dlog<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">#calculates discrete logarithm for each prime order</span><span class="token keyword">print</span> num<span class="token keyword">print</span> crt<span class="token punctuation">(</span>dlogs<span class="token punctuation">,</span>primes<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ECC3</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>p <span class="token operator">=</span> <span class="token number">0xd3ceec4c84af8fa5f3e9af91e00cabacaaaecec3da619400e29a25abececfdc9bd678e2708a58acb1bd15370acc39c596807dab6229dca11fd3a217510258d1b</span>A <span class="token operator">=</span> <span class="token number">0x95fc77eb3119991a0022168c83eee7178e6c3eeaf75e0fdf1853b8ef4cb97a9058c271ee193b8b27938a07052f918c35eccb027b0b168b4e2566b247b91dc07</span>B <span class="token operator">=</span> <span class="token number">0x926b0e42376d112ca971569a8d3b3eda12172dfb4929aea13da7f10fb81f3b96bf1e28b4a396a1fcf38d80b463582e45d06a548e0dc0d567fc668bd119c346b2</span>E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">[</span>A<span class="token punctuation">,</span>B<span class="token punctuation">]</span><span class="token punctuation">)</span>P <span class="token operator">=</span> E<span class="token punctuation">.</span>random_point<span class="token punctuation">(</span><span class="token punctuation">)</span> Q <span class="token operator">=</span> num<span class="token operator">*</span>P<span class="token keyword">print</span> E<span class="token keyword">print</span> <span class="token string">'P:'</span><span class="token punctuation">,</span>P<span class="token keyword">print</span> <span class="token string">'Q:'</span><span class="token punctuation">,</span>QECC1<span class="token punctuation">(</span>num1<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'=============='</span>ECC2<span class="token punctuation">(</span>num2<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">'=============='</span>ECC3<span class="token punctuation">(</span>num3<span class="token punctuation">)</span></code></pre><p>第一步数小直接discrete_log，第二步是ECDLP的Pohlig-Hellman，第三部E的order和p相等所以用smart’s attack，在github上能搜到第三步的脚本。<a href="https://github.com/jvdsn/crypto-attacks/blob/master/ecc/smart_attack.py">https://github.com/jvdsn/crypto-attacks/blob/master/ecc/smart_attack.py</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">_lift</span><span class="token punctuation">(</span>curve<span class="token punctuation">,</span> point<span class="token punctuation">,</span> gf<span class="token punctuation">)</span><span class="token punctuation">:</span>    x<span class="token punctuation">,</span> y <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> point<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> point_ <span class="token keyword">in</span> curve<span class="token punctuation">.</span>lift_x<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token builtin">all</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        x_<span class="token punctuation">,</span> y_ <span class="token operator">=</span> <span class="token builtin">map</span><span class="token punctuation">(</span>gf<span class="token punctuation">,</span> point_<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> y <span class="token operator">==</span> y_<span class="token punctuation">:</span>            <span class="token keyword">return</span> point_<span class="token keyword">def</span> <span class="token function">attack</span><span class="token punctuation">(</span>base<span class="token punctuation">,</span> multiplication_result<span class="token punctuation">)</span><span class="token punctuation">:</span>    curve <span class="token operator">=</span> base<span class="token punctuation">.</span>curve<span class="token punctuation">(</span><span class="token punctuation">)</span>    gf <span class="token operator">=</span> curve<span class="token punctuation">.</span>base_ring<span class="token punctuation">(</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> gf<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> curve<span class="token punctuation">.</span>trace_of_frobenius<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>    lift_curve <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>Qp<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> a<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> p <span class="token operator">*</span> ZZ<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">,</span> curve<span class="token punctuation">.</span>a_invariants<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    lifted_base <span class="token operator">=</span> p <span class="token operator">*</span> _lift<span class="token punctuation">(</span>lift_curve<span class="token punctuation">,</span> base<span class="token punctuation">,</span> gf<span class="token punctuation">)</span>    lifted_multiplication_result <span class="token operator">=</span> p <span class="token operator">*</span> _lift<span class="token punctuation">(</span>lift_curve<span class="token punctuation">,</span> multiplication_result<span class="token punctuation">,</span> gf<span class="token punctuation">)</span>    lb_x<span class="token punctuation">,</span> lb_y <span class="token operator">=</span> lifted_base<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span>    lmr_x<span class="token punctuation">,</span> lmr_y <span class="token operator">=</span> lifted_multiplication_result<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token builtin">int</span><span class="token punctuation">(</span>gf<span class="token punctuation">(</span><span class="token punctuation">(</span>lmr_x <span class="token operator">/</span> lmr_y<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token punctuation">(</span>lb_x <span class="token operator">/</span> lb_y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>a1 <span class="token operator">=</span> b1 <span class="token operator">=</span> p1 <span class="token operator">=</span> E1 <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a1<span class="token punctuation">,</span> b1<span class="token punctuation">]</span><span class="token punctuation">)</span>P1 <span class="token operator">=</span> E1<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>Q1 <span class="token operator">=</span> E1<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>a2 <span class="token operator">=</span> b2 <span class="token operator">=</span> p2 <span class="token operator">=</span> E2 <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a2<span class="token punctuation">,</span> b2<span class="token punctuation">]</span><span class="token punctuation">)</span>P2 <span class="token operator">=</span> E2<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>Q2 <span class="token operator">=</span> E2<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>factors<span class="token punctuation">,</span> exponents <span class="token operator">=</span> <span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token operator">*</span>factor<span class="token punctuation">(</span>E2<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>primes <span class="token operator">=</span> <span class="token punctuation">[</span>factors<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">^</span> exponents<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>factors<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>dlogs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> fac <span class="token keyword">in</span> primes<span class="token punctuation">:</span>t <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>P2<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fac<span class="token punctuation">)</span><span class="token punctuation">)</span>dlog <span class="token operator">=</span> discrete_log<span class="token punctuation">(</span>t<span class="token operator">*</span>Q2<span class="token punctuation">,</span>t<span class="token operator">*</span>P2<span class="token punctuation">,</span>operation<span class="token operator">=</span><span class="token string">"+"</span><span class="token punctuation">)</span>dlogs <span class="token operator">+=</span> <span class="token punctuation">[</span>dlog<span class="token punctuation">]</span>p3 <span class="token operator">=</span> a3 <span class="token operator">=</span> b3 <span class="token operator">=</span> E3 <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p3<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a3<span class="token punctuation">,</span> b3<span class="token punctuation">]</span><span class="token punctuation">)</span>P3 <span class="token operator">=</span> E3<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">)</span>Q3 <span class="token operator">=</span> E3<span class="token punctuation">(</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">b'flag&#123;'</span> <span class="token operator">+</span> long_to_bytes<span class="token punctuation">(</span>P1<span class="token punctuation">.</span>discrete_log<span class="token punctuation">(</span>Q1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> long_to_bytes<span class="token punctuation">(</span>crt<span class="token punctuation">(</span>dlogs<span class="token punctuation">,</span>primes<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> long_to_bytes<span class="token punctuation">(</span>attack<span class="token punctuation">(</span>P3<span class="token punctuation">,</span> Q3<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'&#125;'</span><span class="token punctuation">)</span></code></pre><h2 id="doublesage"><a href="#doublesage" class="headerlink" title="doublesage"></a>doublesage</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sage<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>free_module_integer <span class="token keyword">import</span> IntegerLattice<span class="token keyword">from</span> sage<span class="token punctuation">.</span>stats<span class="token punctuation">.</span>distributions<span class="token punctuation">.</span>discrete_gaussian_integer <span class="token keyword">import</span> DiscreteGaussianDistributionIntegerSampler<span class="token keyword">from</span> sage<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>lwe <span class="token keyword">import</span> LWE<span class="token keyword">from</span> sage<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>lwe <span class="token keyword">import</span> samples <span class="token keyword">import</span> numpy <span class="token keyword">as</span> np<span class="token keyword">import</span> signal<span class="token keyword">def</span> <span class="token function">Question</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span>m<span class="token punctuation">,</span>para_D<span class="token punctuation">,</span>para_e<span class="token punctuation">)</span><span class="token punctuation">:</span>  signal<span class="token punctuation">.</span>alarm<span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span>     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Question:'</span><span class="token punctuation">)</span> <span class="token comment"># m=n^2-2</span>q<span class="token operator">=</span>next_prime<span class="token punctuation">(</span>n<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span>                           D<span class="token operator">=</span>DiscreteGaussianDistributionIntegerSampler<span class="token punctuation">(</span>para_D<span class="token operator">*</span>n<span class="token punctuation">)</span>lwe<span class="token operator">=</span>LWE<span class="token punctuation">(</span>n<span class="token operator">=</span>n<span class="token punctuation">,</span> q<span class="token operator">=</span>q<span class="token punctuation">,</span> D<span class="token operator">=</span>D<span class="token punctuation">)</span>Z<span class="token operator">=</span><span class="token punctuation">[</span>lwe<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">]</span>A<span class="token operator">=</span>matrix<span class="token punctuation">(</span><span class="token punctuation">[</span>a <span class="token keyword">for</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>c<span class="token punctuation">)</span> <span class="token keyword">in</span> Z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>transpose<span class="token punctuation">(</span><span class="token punctuation">)</span>C<span class="token operator">=</span>vector<span class="token punctuation">(</span><span class="token punctuation">[</span>c <span class="token keyword">for</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span>c<span class="token punctuation">)</span> <span class="token keyword">in</span> Z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] The following matrix operations are modulus'</span><span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n[+] Matrix A of size'</span><span class="token punctuation">,</span>n<span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">,</span>m<span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'\n[+] Vector C of size'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">,</span>m<span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token keyword">print</span><span class="token punctuation">(</span>np<span class="token punctuation">.</span>array<span class="token punctuation">(</span>C<span class="token punctuation">)</span><span class="token punctuation">)</span>E<span class="token operator">=</span>lwe<span class="token punctuation">.</span>_LWE__s<span class="token operator">*</span>A<span class="token operator">-</span>CE<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token keyword">for</span> e <span class="token keyword">in</span> E<span class="token punctuation">]</span>E<span class="token operator">=</span>vector<span class="token punctuation">(</span><span class="token punctuation">[</span>e <span class="token keyword">if</span> e <span class="token operator">&lt;=</span> floor<span class="token punctuation">(</span>q<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">else</span> e<span class="token operator">-</span>q <span class="token keyword">for</span> e <span class="token keyword">in</span> E<span class="token punctuation">]</span><span class="token punctuation">)</span>E_norm<span class="token operator">=</span>E<span class="token punctuation">.</span>norm<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>n<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">*</span>para_e<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Please give an integer vector x of size'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">,</span>m<span class="token punctuation">,</span><span class="token string">'(format [1 2 3] or [1, 2, 3]), such that the norm of vector x*A-C &lt;='</span><span class="token punctuation">,</span>E_norm<span class="token punctuation">,</span><span class="token string">', where operations are modulus'</span><span class="token punctuation">,</span>q<span class="token punctuation">,</span><span class="token string">':'</span><span class="token punctuation">)</span>k<span class="token operator">=</span>GF<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token operator">^</span>nx<span class="token operator">=</span>k<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>u<span class="token operator">=</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>u<span class="token operator">=</span>np<span class="token punctuation">.</span>matrix<span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>u<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span>i<span class="token punctuation">]</span><span class="token keyword">except</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] Wrong format, exit.'</span><span class="token punctuation">)</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span>E<span class="token operator">=</span>x<span class="token operator">*</span>A<span class="token operator">-</span>CE<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token keyword">for</span> e <span class="token keyword">in</span> E<span class="token punctuation">]</span>E<span class="token operator">=</span>vector<span class="token punctuation">(</span><span class="token punctuation">[</span>e <span class="token keyword">if</span> e <span class="token operator">&lt;=</span> floor<span class="token punctuation">(</span>q<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">else</span> e<span class="token operator">-</span>q <span class="token keyword">for</span> e <span class="token keyword">in</span> E<span class="token punctuation">]</span><span class="token punctuation">)</span>tmp<span class="token operator">=</span>E<span class="token punctuation">.</span>norm<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>n<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'[+] The norm of vector x*A-C is'</span><span class="token punctuation">,</span> tmp<span class="token punctuation">,</span><span class="token string">','</span><span class="token punctuation">,</span> tmp<span class="token operator">&lt;</span>E_norm<span class="token punctuation">,</span><span class="token string">'.\n'</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token keyword">not</span> tmp<span class="token operator">&lt;</span>E_norm<span class="token punctuation">:</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ReadFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'flag&#123;**********&#125;'</span><span class="token punctuation">)</span>Question<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">1.1</span><span class="token punctuation">)</span>Question<span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">143</span><span class="token punctuation">,</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>ReadFlag<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>全输入0，运气好过了</p><h2 id="data-protect"><a href="#data-protect" class="headerlink" title="data_protect"></a>data_protect</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#run under python3</span><span class="token keyword">import</span> random<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token punctuation">,</span>name<span class="token punctuation">,</span>phone<span class="token punctuation">,</span>mail<span class="token punctuation">,</span>address<span class="token punctuation">,</span>school<span class="token punctuation">,</span>seed<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt1</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span>  random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">)</span>    b <span class="token operator">=</span>  random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">96</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    q <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>b<span class="token punctuation">)</span>    n <span class="token operator">=</span> p<span class="token operator">*</span>q    e <span class="token operator">=</span> <span class="token number">65537</span>    <span class="token keyword">assert</span><span class="token punctuation">(</span>m<span class="token operator">&lt;</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt2</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> <span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526561468278997</span>    q <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span><span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526561468278997</span><span class="token punctuation">,</span><span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526563615762644</span><span class="token punctuation">)</span>    nq <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>q<span class="token punctuation">)</span>    n <span class="token operator">=</span> p<span class="token operator">*</span>q    e <span class="token operator">=</span> <span class="token number">65537</span>        <span class="token keyword">assert</span><span class="token punctuation">(</span>m<span class="token operator">&lt;</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt3</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">33</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">34</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">for</span>  i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp <span class="token operator">=</span> random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>            <span class="token keyword">assert</span><span class="token punctuation">(</span>tmp<span class="token operator">&lt;</span>q<span class="token punctuation">)</span>            key<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> l <span class="token keyword">in</span> key<span class="token punctuation">:</span>        tmp <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> x<span class="token punctuation">,</span>y <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>            tmp <span class="token operator">=</span> <span class="token punctuation">(</span>tmp<span class="token operator">+</span>x<span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token operator">%</span>q        cipher<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>q<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>key<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt4</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    a <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>    cipher <span class="token operator">=</span> a<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt5</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>    g <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    x <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>x<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    y <span class="token operator">=</span> random<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>    s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span>y<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>y<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    c2 <span class="token operator">=</span> <span class="token punctuation">(</span>msg<span class="token operator">*</span>s<span class="token punctuation">)</span><span class="token operator">%</span>q    <span class="token keyword">print</span> <span class="token punctuation">(</span>q<span class="token punctuation">,</span>g<span class="token punctuation">,</span>h<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span>msg1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>name<span class="token punctuation">)</span>encrypt1<span class="token punctuation">(</span>msg1<span class="token punctuation">)</span>msg2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>phone<span class="token operator">+</span>long_to_bytes<span class="token punctuation">(</span>random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">160</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>encrypt2<span class="token punctuation">(</span>msg2<span class="token punctuation">)</span>msg3 <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> mail<span class="token punctuation">]</span>encrypt3<span class="token punctuation">(</span>msg3<span class="token punctuation">)</span><span class="token comment">#Note the address incude digits,letters, '.' and '_'</span>msg4 <span class="token operator">=</span> addressencrypt4<span class="token punctuation">(</span>msg4<span class="token punctuation">)</span>msg5 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>school<span class="token punctuation">)</span>encrypt5<span class="token punctuation">(</span>msg5<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token string">'flag&#123;'</span><span class="token operator">+</span>sha256<span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>sha256<span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>sha256<span class="token punctuation">(</span>mail<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>sha256<span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'-'</span><span class="token operator">+</span>sha256<span class="token punctuation">(</span>school<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">'&#125;'</span><span class="token comment">#print (flag)</span></code></pre><h3 id="stage1"><a href="#stage1" class="headerlink" title="stage1"></a>stage1</h3><pre class="language-python" data-language="python"><code class="language-python">e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">22186905890293167337018474103</span>q <span class="token operator">=</span> <span class="token number">64390888389278700958517837593</span>c <span class="token operator">=</span> <span class="token number">1214574563741560349838921793704940745590987462777968444374</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'xiaomimg'</span></code></pre><h3 id="stage2"><a href="#stage2" class="headerlink" title="stage2"></a>stage2</h3><pre class="language-python" data-language="python"><code class="language-python">e <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">134949786048887319137407994803780389722367094355650515833817995038306119197600539524985448574053755793699799863164150565217726975197643634831307454431403854861515253009970594684699064052739820092115115614153962139870020206132705821506686959283747802946805730902605814619499301779892151365118901010526138311982</span>p <span class="token operator">=</span> <span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526561468278997</span>c <span class="token operator">=</span> <span class="token number">83382305214367280642036397343148189703485368587974886171510743953549190744470601202744767273007620016211287396099134559067732647482119585665644233315163008363194608166196925401829658712718312200224326536235692414101991228706273090615632001823182408030728674734516602445750649097008703725533663639171389956107</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># b'19410100101'</span></code></pre><h3 id="stage3"><a href="#stage3" class="headerlink" title="stage3"></a>stage3</h3><p>这是个hill密码，key是一个34行18列的矩阵，msg是一个18行1列的矩阵，cipher = key*msg</p><p>hill密码的key是方阵，这里面不是，但是你会发现，msg就18个字符，你加密34次也没有啥用，所以只取key的前18行构成一个方阵，cipher也只取前18行，然后求逆矩阵再相乘就可以恢复出msg了。求模逆矩阵 Ax = B mod m</p><pre class="language-python" data-language="python"><code class="language-python">q <span class="token operator">=</span> <span class="token number">8330252551</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">978955513</span><span class="token punctuation">,</span> <span class="token number">2055248981</span><span class="token punctuation">,</span> <span class="token number">3094004449</span><span class="token punctuation">,</span> <span class="token number">411497641</span><span class="token punctuation">,</span> <span class="token number">4183759491</span><span class="token punctuation">,</span> <span class="token number">521276843</span><span class="token punctuation">,</span> <span class="token number">1709604203</span><span class="token punctuation">,</span> <span class="token number">3162773533</span><span class="token punctuation">,</span> <span class="token number">2140722701</span><span class="token punctuation">,</span> <span class="token number">782306144</span><span class="token punctuation">,</span> <span class="token number">421964668</span><span class="token punctuation">,</span> <span class="token number">356205891</span><span class="token punctuation">,</span> <span class="token number">1039083484</span><span class="token punctuation">,</span> <span class="token number">1911377875</span><span class="token punctuation">,</span> <span class="token number">1661230549</span><span class="token punctuation">,</span> <span class="token number">312742665</span><span class="token punctuation">,</span> <span class="token number">3628868938</span><span class="token punctuation">,</span> <span class="token number">2049082743</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3833871085</span><span class="token punctuation">,</span> <span class="token number">2929837680</span><span class="token punctuation">,</span> <span class="token number">2614720930</span><span class="token punctuation">,</span> <span class="token number">4056572317</span><span class="token punctuation">,</span> <span class="token number">3787185237</span><span class="token punctuation">,</span> <span class="token number">93999422</span><span class="token punctuation">,</span> <span class="token number">590001829</span><span class="token punctuation">,</span> <span class="token number">429074138</span><span class="token punctuation">,</span> <span class="token number">3012080235</span><span class="token punctuation">,</span> <span class="token number">2336571108</span><span class="token punctuation">,</span> <span class="token number">831707987</span><span class="token punctuation">,</span> <span class="token number">3902814802</span><span class="token punctuation">,</span> <span class="token number">2084593018</span><span class="token punctuation">,</span> <span class="token number">316245361</span><span class="token punctuation">,</span> <span class="token number">1799842819</span><span class="token punctuation">,</span> <span class="token number">2908004545</span><span class="token punctuation">,</span> <span class="token number">120773816</span><span class="token punctuation">,</span> <span class="token number">2687194173</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3213409254</span><span class="token punctuation">,</span> <span class="token number">3303290739</span><span class="token punctuation">,</span> <span class="token number">742998950</span><span class="token punctuation">,</span> <span class="token number">2956806179</span><span class="token punctuation">,</span> <span class="token number">2834298174</span><span class="token punctuation">,</span> <span class="token number">429260769</span><span class="token punctuation">,</span> <span class="token number">769267967</span><span class="token punctuation">,</span> <span class="token number">1301491642</span><span class="token punctuation">,</span> <span class="token number">2415087532</span><span class="token punctuation">,</span> <span class="token number">1055496090</span><span class="token punctuation">,</span> <span class="token number">690922955</span><span class="token punctuation">,</span> <span class="token number">2984201071</span><span class="token punctuation">,</span> <span class="token number">3517649313</span><span class="token punctuation">,</span> <span class="token number">3675968202</span><span class="token punctuation">,</span> <span class="token number">3389582912</span><span class="token punctuation">,</span> <span class="token number">2632941479</span><span class="token punctuation">,</span> <span class="token number">186911789</span><span class="token punctuation">,</span> <span class="token number">3547287806</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4149643988</span><span class="token punctuation">,</span> <span class="token number">3811477370</span><span class="token punctuation">,</span> <span class="token number">1269911228</span><span class="token punctuation">,</span> <span class="token number">3709435333</span><span class="token punctuation">,</span> <span class="token number">1868378108</span><span class="token punctuation">,</span> <span class="token number">4173520248</span><span class="token punctuation">,</span> <span class="token number">1573661708</span><span class="token punctuation">,</span> <span class="token number">2161236830</span><span class="token punctuation">,</span> <span class="token number">3266570322</span><span class="token punctuation">,</span> <span class="token number">1611227993</span><span class="token punctuation">,</span> <span class="token number">2539778863</span><span class="token punctuation">,</span> <span class="token number">1857682940</span><span class="token punctuation">,</span> <span class="token number">1020154001</span><span class="token punctuation">,</span> <span class="token number">92386553</span><span class="token punctuation">,</span> <span class="token number">3834719618</span><span class="token punctuation">,</span> <span class="token number">3775070036</span><span class="token punctuation">,</span> <span class="token number">3777877862</span><span class="token punctuation">,</span> <span class="token number">2982256702</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4281981169</span><span class="token punctuation">,</span> <span class="token number">2949541448</span><span class="token punctuation">,</span> <span class="token number">4199819805</span><span class="token punctuation">,</span> <span class="token number">3654041457</span><span class="token punctuation">,</span> <span class="token number">3300163657</span><span class="token punctuation">,</span> <span class="token number">1674155910</span><span class="token punctuation">,</span> <span class="token number">1316779635</span><span class="token punctuation">,</span> <span class="token number">66744534</span><span class="token punctuation">,</span> <span class="token number">3804297626</span><span class="token punctuation">,</span> <span class="token number">2709354730</span><span class="token punctuation">,</span> <span class="token number">2460136415</span><span class="token punctuation">,</span> <span class="token number">3983640368</span><span class="token punctuation">,</span> <span class="token number">3801883586</span><span class="token punctuation">,</span> <span class="token number">1068904857</span><span class="token punctuation">,</span> <span class="token number">4178063279</span><span class="token punctuation">,</span> <span class="token number">41067134</span><span class="token punctuation">,</span> <span class="token number">752202632</span><span class="token punctuation">,</span> <span class="token number">3143016757</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3078167402</span><span class="token punctuation">,</span> <span class="token number">2059042200</span><span class="token punctuation">,</span> <span class="token number">252404132</span><span class="token punctuation">,</span> <span class="token number">415008428</span><span class="token punctuation">,</span> <span class="token number">3611056424</span><span class="token punctuation">,</span> <span class="token number">1674088343</span><span class="token punctuation">,</span> <span class="token number">2460161645</span><span class="token punctuation">,</span> <span class="token number">3311986519</span><span class="token punctuation">,</span> <span class="token number">3130694755</span><span class="token punctuation">,</span> <span class="token number">934254488</span><span class="token punctuation">,</span> <span class="token number">898722917</span><span class="token punctuation">,</span> <span class="token number">2865274835</span><span class="token punctuation">,</span> <span class="token number">567507230</span><span class="token punctuation">,</span> <span class="token number">1328871893</span><span class="token punctuation">,</span> <span class="token number">3903457801</span><span class="token punctuation">,</span> <span class="token number">2499893858</span><span class="token punctuation">,</span> <span class="token number">492084315</span><span class="token punctuation">,</span> <span class="token number">183531922</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3529830884</span><span class="token punctuation">,</span> <span class="token number">4039243386</span><span class="token punctuation">,</span> <span class="token number">233553719</span><span class="token punctuation">,</span> <span class="token number">4118146471</span><span class="token punctuation">,</span> <span class="token number">1646804655</span><span class="token punctuation">,</span> <span class="token number">2089146092</span><span class="token punctuation">,</span> <span class="token number">2156344320</span><span class="token punctuation">,</span> <span class="token number">2329927228</span><span class="token punctuation">,</span> <span class="token number">508323741</span><span class="token punctuation">,</span> <span class="token number">1931822010</span><span class="token punctuation">,</span> <span class="token number">579182891</span><span class="token punctuation">,</span> <span class="token number">176447133</span><span class="token punctuation">,</span> <span class="token number">597011120</span><span class="token punctuation">,</span> <span class="token number">3261594914</span><span class="token punctuation">,</span> <span class="token number">2845298788</span><span class="token punctuation">,</span> <span class="token number">3759915972</span><span class="token punctuation">,</span> <span class="token number">3095206232</span><span class="token punctuation">,</span> <span class="token number">3638216860</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3352986415</span><span class="token punctuation">,</span> <span class="token number">4264046847</span><span class="token punctuation">,</span> <span class="token number">3829043620</span><span class="token punctuation">,</span> <span class="token number">2530153481</span><span class="token punctuation">,</span> <span class="token number">3421260080</span><span class="token punctuation">,</span> <span class="token number">1669551722</span><span class="token punctuation">,</span> <span class="token number">4240873925</span><span class="token punctuation">,</span> <span class="token number">2101009682</span><span class="token punctuation">,</span> <span class="token number">3660432232</span><span class="token punctuation">,</span> <span class="token number">4224377588</span><span class="token punctuation">,</span> <span class="token number">929767737</span><span class="token punctuation">,</span> <span class="token number">3729104589</span><span class="token punctuation">,</span> <span class="token number">2835310428</span><span class="token punctuation">,</span> <span class="token number">1727139644</span><span class="token punctuation">,</span> <span class="token number">1279995206</span><span class="token punctuation">,</span> <span class="token number">1355353373</span><span class="token punctuation">,</span> <span class="token number">2144225408</span><span class="token punctuation">,</span> <span class="token number">1359399895</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3105965085</span><span class="token punctuation">,</span> <span class="token number">818804468</span><span class="token punctuation">,</span> <span class="token number">3230054412</span><span class="token punctuation">,</span> <span class="token number">2646235709</span><span class="token punctuation">,</span> <span class="token number">4053839846</span><span class="token punctuation">,</span> <span class="token number">2878092923</span><span class="token punctuation">,</span> <span class="token number">587905848</span><span class="token punctuation">,</span> <span class="token number">1589383219</span><span class="token punctuation">,</span> <span class="token number">2408577579</span><span class="token punctuation">,</span> <span class="token number">880800518</span><span class="token punctuation">,</span> <span class="token number">28758157</span><span class="token punctuation">,</span> <span class="token number">1000513178</span><span class="token punctuation">,</span> <span class="token number">2176168589</span><span class="token punctuation">,</span> <span class="token number">187505579</span><span class="token punctuation">,</span> <span class="token number">89151277</span><span class="token punctuation">,</span> <span class="token number">1238795748</span><span class="token punctuation">,</span> <span class="token number">8168714</span><span class="token punctuation">,</span> <span class="token number">3501032027</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3473729699</span><span class="token punctuation">,</span> <span class="token number">1900372653</span><span class="token punctuation">,</span> <span class="token number">305029321</span><span class="token punctuation">,</span> <span class="token number">2013273628</span><span class="token punctuation">,</span> <span class="token number">1242655400</span><span class="token punctuation">,</span> <span class="token number">4192234107</span><span class="token punctuation">,</span> <span class="token number">2446737641</span><span class="token punctuation">,</span> <span class="token number">1341412052</span><span class="token punctuation">,</span> <span class="token number">304733944</span><span class="token punctuation">,</span> <span class="token number">4174393908</span><span class="token punctuation">,</span> <span class="token number">2563609353</span><span class="token punctuation">,</span> <span class="token number">3623415321</span><span class="token punctuation">,</span> <span class="token number">49954007</span><span class="token punctuation">,</span> <span class="token number">3130983058</span><span class="token punctuation">,</span> <span class="token number">425856087</span><span class="token punctuation">,</span> <span class="token number">2331025419</span><span class="token punctuation">,</span> <span class="token number">34423818</span><span class="token punctuation">,</span> <span class="token number">2042901845</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1397571080</span><span class="token punctuation">,</span> <span class="token number">1615456639</span><span class="token punctuation">,</span> <span class="token number">1840339411</span><span class="token punctuation">,</span> <span class="token number">220496996</span><span class="token punctuation">,</span> <span class="token number">2042007444</span><span class="token punctuation">,</span> <span class="token number">3681679342</span><span class="token punctuation">,</span> <span class="token number">2306603996</span><span class="token punctuation">,</span> <span class="token number">732207066</span><span class="token punctuation">,</span> <span class="token number">663494719</span><span class="token punctuation">,</span> <span class="token number">4092173669</span><span class="token punctuation">,</span> <span class="token number">3034772067</span><span class="token punctuation">,</span> <span class="token number">3807942919</span><span class="token punctuation">,</span> <span class="token number">111475712</span><span class="token punctuation">,</span> <span class="token number">2065672849</span><span class="token punctuation">,</span> <span class="token number">3552535306</span><span class="token punctuation">,</span> <span class="token number">138510326</span><span class="token punctuation">,</span> <span class="token number">3757322399</span><span class="token punctuation">,</span> <span class="token number">2394352747</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">371953847</span><span class="token punctuation">,</span> <span class="token number">3369229608</span><span class="token punctuation">,</span> <span class="token number">1669129625</span><span class="token punctuation">,</span> <span class="token number">168320777</span><span class="token punctuation">,</span> <span class="token number">2375427503</span><span class="token punctuation">,</span> <span class="token number">3449778616</span><span class="token punctuation">,</span> <span class="token number">1977984006</span><span class="token punctuation">,</span> <span class="token number">1543379950</span><span class="token punctuation">,</span> <span class="token number">2293317896</span><span class="token punctuation">,</span> <span class="token number">1239812206</span><span class="token punctuation">,</span> <span class="token number">1198364787</span><span class="token punctuation">,</span> <span class="token number">2465753450</span><span class="token punctuation">,</span> <span class="token number">3739161320</span><span class="token punctuation">,</span> <span class="token number">2502603029</span><span class="token punctuation">,</span> <span class="token number">1528706460</span><span class="token punctuation">,</span> <span class="token number">1488040470</span><span class="token punctuation">,</span> <span class="token number">3387786864</span><span class="token punctuation">,</span> <span class="token number">1864873515</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1356892529</span><span class="token punctuation">,</span> <span class="token number">1662755536</span><span class="token punctuation">,</span> <span class="token number">1623461302</span><span class="token punctuation">,</span> <span class="token number">1925037502</span><span class="token punctuation">,</span> <span class="token number">1878096790</span><span class="token punctuation">,</span> <span class="token number">3682248450</span><span class="token punctuation">,</span> <span class="token number">2359635297</span><span class="token punctuation">,</span> <span class="token number">1558718627</span><span class="token punctuation">,</span> <span class="token number">116402105</span><span class="token punctuation">,</span> <span class="token number">3274502275</span><span class="token punctuation">,</span> <span class="token number">2436185635</span><span class="token punctuation">,</span> <span class="token number">771708011</span><span class="token punctuation">,</span> <span class="token number">3484140889</span><span class="token punctuation">,</span> <span class="token number">3264299013</span><span class="token punctuation">,</span> <span class="token number">885210310</span><span class="token punctuation">,</span> <span class="token number">4225779256</span><span class="token punctuation">,</span> <span class="token number">363129056</span><span class="token punctuation">,</span> <span class="token number">2488388413</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2636035482</span><span class="token punctuation">,</span> <span class="token number">4140705532</span><span class="token punctuation">,</span> <span class="token number">3187647213</span><span class="token punctuation">,</span> <span class="token number">4009585502</span><span class="token punctuation">,</span> <span class="token number">351132201</span><span class="token punctuation">,</span> <span class="token number">2592096589</span><span class="token punctuation">,</span> <span class="token number">3785703396</span><span class="token punctuation">,</span> <span class="token number">750115519</span><span class="token punctuation">,</span> <span class="token number">3632692007</span><span class="token punctuation">,</span> <span class="token number">3936675924</span><span class="token punctuation">,</span> <span class="token number">3635400895</span><span class="token punctuation">,</span> <span class="token number">3257019719</span><span class="token punctuation">,</span> <span class="token number">1928767495</span><span class="token punctuation">,</span> <span class="token number">2868979203</span><span class="token punctuation">,</span> <span class="token number">622850989</span><span class="token punctuation">,</span> <span class="token number">3165580000</span><span class="token punctuation">,</span> <span class="token number">4162276629</span><span class="token punctuation">,</span> <span class="token number">4157491019</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1272163411</span><span class="token punctuation">,</span> <span class="token number">1251211247</span><span class="token punctuation">,</span> <span class="token number">357523138</span><span class="token punctuation">,</span> <span class="token number">1233981097</span><span class="token punctuation">,</span> <span class="token number">1855287284</span><span class="token punctuation">,</span> <span class="token number">4079018167</span><span class="token punctuation">,</span> <span class="token number">4028466297</span><span class="token punctuation">,</span> <span class="token number">92214478</span><span class="token punctuation">,</span> <span class="token number">4290550648</span><span class="token punctuation">,</span> <span class="token number">648034817</span><span class="token punctuation">,</span> <span class="token number">1247795256</span><span class="token punctuation">,</span> <span class="token number">3928945157</span><span class="token punctuation">,</span> <span class="token number">1199659871</span><span class="token punctuation">,</span> <span class="token number">397659647</span><span class="token punctuation">,</span> <span class="token number">3360313830</span><span class="token punctuation">,</span> <span class="token number">561558927</span><span class="token punctuation">,</span> <span class="token number">3446409788</span><span class="token punctuation">,</span> <span class="token number">2727008359</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1470343419</span><span class="token punctuation">,</span> <span class="token number">3861411785</span><span class="token punctuation">,</span> <span class="token number">953425729</span><span class="token punctuation">,</span> <span class="token number">65811127</span><span class="token punctuation">,</span> <span class="token number">458070615</span><span class="token punctuation">,</span> <span class="token number">1428470215</span><span class="token punctuation">,</span> <span class="token number">3101427357</span><span class="token punctuation">,</span> <span class="token number">1137845714</span><span class="token punctuation">,</span> <span class="token number">1980562597</span><span class="token punctuation">,</span> <span class="token number">4120983895</span><span class="token punctuation">,</span> <span class="token number">45901583</span><span class="token punctuation">,</span> <span class="token number">2869582150</span><span class="token punctuation">,</span> <span class="token number">427949409</span><span class="token punctuation">,</span> <span class="token number">3025588000</span><span class="token punctuation">,</span> <span class="token number">3231450975</span><span class="token punctuation">,</span> <span class="token number">3313818165</span><span class="token punctuation">,</span> <span class="token number">4015642368</span><span class="token punctuation">,</span> <span class="token number">3197557747</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2452385340</span><span class="token punctuation">,</span> <span class="token number">111636796</span><span class="token punctuation">,</span> <span class="token number">897282198</span><span class="token punctuation">,</span> <span class="token number">4273652805</span><span class="token punctuation">,</span> <span class="token number">1223518692</span><span class="token punctuation">,</span> <span class="token number">3680320805</span><span class="token punctuation">,</span> <span class="token number">2771040109</span><span class="token punctuation">,</span> <span class="token number">3617506402</span><span class="token punctuation">,</span> <span class="token number">3904690320</span><span class="token punctuation">,</span> <span class="token number">77507239</span><span class="token punctuation">,</span> <span class="token number">3010900929</span><span class="token punctuation">,</span> <span class="token number">4099608062</span><span class="token punctuation">,</span> <span class="token number">546322994</span><span class="token punctuation">,</span> <span class="token number">1084929138</span><span class="token punctuation">,</span> <span class="token number">902220733</span><span class="token punctuation">,</span> <span class="token number">4054312795</span><span class="token punctuation">,</span> <span class="token number">1977510945</span><span class="token punctuation">,</span> <span class="token number">735973665</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3729015155</span><span class="token punctuation">,</span> <span class="token number">3027108070</span><span class="token punctuation">,</span> <span class="token number">1442633554</span><span class="token punctuation">,</span> <span class="token number">1949455360</span><span class="token punctuation">,</span> <span class="token number">2864504565</span><span class="token punctuation">,</span> <span class="token number">3673543865</span><span class="token punctuation">,</span> <span class="token number">446663703</span><span class="token punctuation">,</span> <span class="token number">3515816196</span><span class="token punctuation">,</span> <span class="token number">1468441462</span><span class="token punctuation">,</span> <span class="token number">897770414</span><span class="token punctuation">,</span> <span class="token number">2831043012</span><span class="token punctuation">,</span> <span class="token number">707874506</span><span class="token punctuation">,</span> <span class="token number">1098228471</span><span class="token punctuation">,</span> <span class="token number">1225077381</span><span class="token punctuation">,</span> <span class="token number">3622448809</span><span class="token punctuation">,</span> <span class="token number">2409995597</span><span class="token punctuation">,</span> <span class="token number">3847055008</span><span class="token punctuation">,</span> <span class="token number">1887507220</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1839061542</span><span class="token punctuation">,</span> <span class="token number">1963345926</span><span class="token punctuation">,</span> <span class="token number">2600100988</span><span class="token punctuation">,</span> <span class="token number">1703502633</span><span class="token punctuation">,</span> <span class="token number">1824193082</span><span class="token punctuation">,</span> <span class="token number">3595102755</span><span class="token punctuation">,</span> <span class="token number">2558488861</span><span class="token punctuation">,</span> <span class="token number">2440526309</span><span class="token punctuation">,</span> <span class="token number">3909166109</span><span class="token punctuation">,</span> <span class="token number">1611135411</span><span class="token punctuation">,</span> <span class="token number">2809397519</span><span class="token punctuation">,</span> <span class="token number">1019893656</span><span class="token punctuation">,</span> <span class="token number">3281060225</span><span class="token punctuation">,</span> <span class="token number">2387778214</span><span class="token punctuation">,</span> <span class="token number">2460059811</span><span class="token punctuation">,</span> <span class="token number">198824620</span><span class="token punctuation">,</span> <span class="token number">1645102665</span><span class="token punctuation">,</span> <span class="token number">865289621</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">224442296</span><span class="token punctuation">,</span> <span class="token number">3009601747</span><span class="token punctuation">,</span> <span class="token number">3066701924</span><span class="token punctuation">,</span> <span class="token number">1774879140</span><span class="token punctuation">,</span> <span class="token number">880620935</span><span class="token punctuation">,</span> <span class="token number">2676353545</span><span class="token punctuation">,</span> <span class="token number">3748945463</span><span class="token punctuation">,</span> <span class="token number">1994930827</span><span class="token punctuation">,</span> <span class="token number">75275710</span><span class="token punctuation">,</span> <span class="token number">3710375437</span><span class="token punctuation">,</span> <span class="token number">4132497729</span><span class="token punctuation">,</span> <span class="token number">3010711783</span><span class="token punctuation">,</span> <span class="token number">3731895534</span><span class="token punctuation">,</span> <span class="token number">2434590580</span><span class="token punctuation">,</span> <span class="token number">3409701141</span><span class="token punctuation">,</span> <span class="token number">2209951200</span><span class="token punctuation">,</span> <span class="token number">995511645</span><span class="token punctuation">,</span> <span class="token number">3571299495</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2337737600</span><span class="token punctuation">,</span> <span class="token number">110982073</span><span class="token punctuation">,</span> <span class="token number">2985129643</span><span class="token punctuation">,</span> <span class="token number">1668549189</span><span class="token punctuation">,</span> <span class="token number">3298468029</span><span class="token punctuation">,</span> <span class="token number">698015588</span><span class="token punctuation">,</span> <span class="token number">2945584297</span><span class="token punctuation">,</span> <span class="token number">1036821195</span><span class="token punctuation">,</span> <span class="token number">4249059927</span><span class="token punctuation">,</span> <span class="token number">3384611421</span><span class="token punctuation">,</span> <span class="token number">3304378629</span><span class="token punctuation">,</span> <span class="token number">1307957989</span><span class="token punctuation">,</span> <span class="token number">602821252</span><span class="token punctuation">,</span> <span class="token number">184198726</span><span class="token punctuation">,</span> <span class="token number">1182960059</span><span class="token punctuation">,</span> <span class="token number">4200496073</span><span class="token punctuation">,</span> <span class="token number">1562699893</span><span class="token punctuation">,</span> <span class="token number">3320841302</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5866561</span><span class="token punctuation">,</span> <span class="token number">2442649482</span><span class="token punctuation">,</span> <span class="token number">479821282</span><span class="token punctuation">,</span> <span class="token number">2687097642</span><span class="token punctuation">,</span> <span class="token number">3347828225</span><span class="token punctuation">,</span> <span class="token number">1876332308</span><span class="token punctuation">,</span> <span class="token number">2704295851</span><span class="token punctuation">,</span> <span class="token number">2952277070</span><span class="token punctuation">,</span> <span class="token number">1803967244</span><span class="token punctuation">,</span> <span class="token number">2837783916</span><span class="token punctuation">,</span> <span class="token number">658984547</span><span class="token punctuation">,</span> <span class="token number">3605604364</span><span class="token punctuation">,</span> <span class="token number">1931924322</span><span class="token punctuation">,</span> <span class="token number">3285319978</span><span class="token punctuation">,</span> <span class="token number">556150900</span><span class="token punctuation">,</span> <span class="token number">3795666798</span><span class="token punctuation">,</span> <span class="token number">261321502</span><span class="token punctuation">,</span> <span class="token number">1040433381</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3855222954</span><span class="token punctuation">,</span> <span class="token number">3565522064</span><span class="token punctuation">,</span> <span class="token number">1841853882</span><span class="token punctuation">,</span> <span class="token number">1066304362</span><span class="token punctuation">,</span> <span class="token number">3552076734</span><span class="token punctuation">,</span> <span class="token number">3075952725</span><span class="token punctuation">,</span> <span class="token number">2193242436</span><span class="token punctuation">,</span> <span class="token number">2052898568</span><span class="token punctuation">,</span> <span class="token number">2341179777</span><span class="token punctuation">,</span> <span class="token number">3089412493</span><span class="token punctuation">,</span> <span class="token number">165812889</span><span class="token punctuation">,</span> <span class="token number">4196290126</span><span class="token punctuation">,</span> <span class="token number">3568567671</span><span class="token punctuation">,</span> <span class="token number">28097161</span><span class="token punctuation">,</span> <span class="token number">2249543862</span><span class="token punctuation">,</span> <span class="token number">1251207418</span><span class="token punctuation">,</span> <span class="token number">522526590</span><span class="token punctuation">,</span> <span class="token number">765541973</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1801734077</span><span class="token punctuation">,</span> <span class="token number">2132230169</span><span class="token punctuation">,</span> <span class="token number">667823776</span><span class="token punctuation">,</span> <span class="token number">3900096345</span><span class="token punctuation">,</span> <span class="token number">3119630138</span><span class="token punctuation">,</span> <span class="token number">3620542178</span><span class="token punctuation">,</span> <span class="token number">2900630754</span><span class="token punctuation">,</span> <span class="token number">30811433</span><span class="token punctuation">,</span> <span class="token number">608818254</span><span class="token punctuation">,</span> <span class="token number">1040662178</span><span class="token punctuation">,</span> <span class="token number">900811411</span><span class="token punctuation">,</span> <span class="token number">3221833258</span><span class="token punctuation">,</span> <span class="token number">43598995</span><span class="token punctuation">,</span> <span class="token number">1818995893</span><span class="token punctuation">,</span> <span class="token number">2718507668</span><span class="token punctuation">,</span> <span class="token number">3445138445</span><span class="token punctuation">,</span> <span class="token number">3217962572</span><span class="token punctuation">,</span> <span class="token number">1437902734</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1812768224</span><span class="token punctuation">,</span> <span class="token number">392114567</span><span class="token punctuation">,</span> <span class="token number">2694519859</span><span class="token punctuation">,</span> <span class="token number">1941199322</span><span class="token punctuation">,</span> <span class="token number">2523549731</span><span class="token punctuation">,</span> <span class="token number">2078453798</span><span class="token punctuation">,</span> <span class="token number">851734499</span><span class="token punctuation">,</span> <span class="token number">2376090593</span><span class="token punctuation">,</span> <span class="token number">2069375610</span><span class="token punctuation">,</span> <span class="token number">4084690114</span><span class="token punctuation">,</span> <span class="token number">246441363</span><span class="token punctuation">,</span> <span class="token number">4154699271</span><span class="token punctuation">,</span> <span class="token number">58451971</span><span class="token punctuation">,</span> <span class="token number">31806021</span><span class="token punctuation">,</span> <span class="token number">4158724930</span><span class="token punctuation">,</span> <span class="token number">2741293247</span><span class="token punctuation">,</span> <span class="token number">3230803936</span><span class="token punctuation">,</span> <span class="token number">2790505999</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3906342775</span><span class="token punctuation">,</span> <span class="token number">2231570871</span><span class="token punctuation">,</span> <span class="token number">1258998901</span><span class="token punctuation">,</span> <span class="token number">1517292578</span><span class="token punctuation">,</span> <span class="token number">162889239</span><span class="token punctuation">,</span> <span class="token number">3130741176</span><span class="token punctuation">,</span> <span class="token number">3925266771</span><span class="token punctuation">,</span> <span class="token number">1780222960</span><span class="token punctuation">,</span> <span class="token number">2378568279</span><span class="token punctuation">,</span> <span class="token number">3873144834</span><span class="token punctuation">,</span> <span class="token number">1597459529</span><span class="token punctuation">,</span> <span class="token number">1581197809</span><span class="token punctuation">,</span> <span class="token number">4101706041</span><span class="token punctuation">,</span> <span class="token number">196019642</span><span class="token punctuation">,</span> <span class="token number">1439141586</span><span class="token punctuation">,</span> <span class="token number">587446072</span><span class="token punctuation">,</span> <span class="token number">2012673288</span><span class="token punctuation">,</span> <span class="token number">1280875335</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4058452685</span><span class="token punctuation">,</span> <span class="token number">653145648</span><span class="token punctuation">,</span> <span class="token number">553051697</span><span class="token punctuation">,</span> <span class="token number">1406542226</span><span class="token punctuation">,</span> <span class="token number">4053722203</span><span class="token punctuation">,</span> <span class="token number">994470045</span><span class="token punctuation">,</span> <span class="token number">2066358582</span><span class="token punctuation">,</span> <span class="token number">3919235908</span><span class="token punctuation">,</span> <span class="token number">2315900402</span><span class="token punctuation">,</span> <span class="token number">3236350874</span><span class="token punctuation">,</span> <span class="token number">172880690</span><span class="token punctuation">,</span> <span class="token number">3104147616</span><span class="token punctuation">,</span> <span class="token number">489606166</span><span class="token punctuation">,</span> <span class="token number">3898059157</span><span class="token punctuation">,</span> <span class="token number">200469827</span><span class="token punctuation">,</span> <span class="token number">665789663</span><span class="token punctuation">,</span> <span class="token number">3116633449</span><span class="token punctuation">,</span> <span class="token number">4137295625</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1460624254</span><span class="token punctuation">,</span> <span class="token number">4286673320</span><span class="token punctuation">,</span> <span class="token number">2664109800</span><span class="token punctuation">,</span> <span class="token number">1995979611</span><span class="token punctuation">,</span> <span class="token number">4091742681</span><span class="token punctuation">,</span> <span class="token number">2639530247</span><span class="token punctuation">,</span> <span class="token number">4240681440</span><span class="token punctuation">,</span> <span class="token number">2169059390</span><span class="token punctuation">,</span> <span class="token number">1149325301</span><span class="token punctuation">,</span> <span class="token number">3139578541</span><span class="token punctuation">,</span> <span class="token number">2320870639</span><span class="token punctuation">,</span> <span class="token number">3148999826</span><span class="token punctuation">,</span> <span class="token number">4095173534</span><span class="token punctuation">,</span> <span class="token number">2742698014</span><span class="token punctuation">,</span> <span class="token number">3623896968</span><span class="token punctuation">,</span> <span class="token number">2444601912</span><span class="token punctuation">,</span> <span class="token number">1958855100</span><span class="token punctuation">,</span> <span class="token number">1743268893</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2187625371</span><span class="token punctuation">,</span> <span class="token number">3533912845</span><span class="token punctuation">,</span> <span class="token number">29086928</span><span class="token punctuation">,</span> <span class="token number">543325588</span><span class="token punctuation">,</span> <span class="token number">4247300963</span><span class="token punctuation">,</span> <span class="token number">1972139209</span><span class="token punctuation">,</span> <span class="token number">272152499</span><span class="token punctuation">,</span> <span class="token number">4276082595</span><span class="token punctuation">,</span> <span class="token number">3680551759</span><span class="token punctuation">,</span> <span class="token number">1835350157</span><span class="token punctuation">,</span> <span class="token number">3921757922</span><span class="token punctuation">,</span> <span class="token number">2716774439</span><span class="token punctuation">,</span> <span class="token number">1070751202</span><span class="token punctuation">,</span> <span class="token number">69990939</span><span class="token punctuation">,</span> <span class="token number">3794506838</span><span class="token punctuation">,</span> <span class="token number">699803423</span><span class="token punctuation">,</span> <span class="token number">3699976889</span><span class="token punctuation">,</span> <span class="token number">40791189</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">539106994</span><span class="token punctuation">,</span> <span class="token number">1670272368</span><span class="token punctuation">,</span> <span class="token number">3483599225</span><span class="token punctuation">,</span> <span class="token number">2867955550</span><span class="token punctuation">,</span> <span class="token number">2207694005</span><span class="token punctuation">,</span> <span class="token number">1126950203</span><span class="token punctuation">,</span> <span class="token number">693920921</span><span class="token punctuation">,</span> <span class="token number">2333328675</span><span class="token punctuation">,</span> <span class="token number">539234245</span><span class="token punctuation">,</span> <span class="token number">1961438796</span><span class="token punctuation">,</span> <span class="token number">3126390464</span><span class="token punctuation">,</span> <span class="token number">1118759587</span><span class="token punctuation">,</span> <span class="token number">59715473</span><span class="token punctuation">,</span> <span class="token number">1450076492</span><span class="token punctuation">,</span> <span class="token number">4101732655</span><span class="token punctuation">,</span> <span class="token number">3658733365</span><span class="token punctuation">,</span> <span class="token number">940858890</span><span class="token punctuation">,</span> <span class="token number">1262671744</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3092624332</span><span class="token punctuation">,</span> <span class="token number">2175813516</span><span class="token punctuation">,</span> <span class="token number">3355101899</span><span class="token punctuation">,</span> <span class="token number">3657267135</span><span class="token punctuation">,</span> <span class="token number">770650398</span><span class="token punctuation">,</span> <span class="token number">359506155</span><span class="token punctuation">,</span> <span class="token number">4149470178</span><span class="token punctuation">,</span> <span class="token number">3763654751</span><span class="token punctuation">,</span> <span class="token number">1184381886</span><span class="token punctuation">,</span> <span class="token number">942048015</span><span class="token punctuation">,</span> <span class="token number">523057971</span><span class="token punctuation">,</span> <span class="token number">1098635956</span><span class="token punctuation">,</span> <span class="token number">1732951811</span><span class="token punctuation">,</span> <span class="token number">150067724</span><span class="token punctuation">,</span> <span class="token number">2417766207</span><span class="token punctuation">,</span> <span class="token number">4152571821</span><span class="token punctuation">,</span> <span class="token number">2759971924</span><span class="token punctuation">,</span> <span class="token number">4284842765</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3336022203</span><span class="token punctuation">,</span> <span class="token number">2569311431</span><span class="token punctuation">,</span> <span class="token number">2752777107</span><span class="token punctuation">,</span> <span class="token number">1441977867</span><span class="token punctuation">,</span> <span class="token number">1279003682</span><span class="token punctuation">,</span> <span class="token number">3861567631</span><span class="token punctuation">,</span> <span class="token number">1064716472</span><span class="token punctuation">,</span> <span class="token number">3046493996</span><span class="token punctuation">,</span> <span class="token number">1339401643</span><span class="token punctuation">,</span> <span class="token number">39466446</span><span class="token punctuation">,</span> <span class="token number">1464905290</span><span class="token punctuation">,</span> <span class="token number">420733872</span><span class="token punctuation">,</span> <span class="token number">2057911345</span><span class="token punctuation">,</span> <span class="token number">2418624800</span><span class="token punctuation">,</span> <span class="token number">2193625430</span><span class="token punctuation">,</span> <span class="token number">1558527155</span><span class="token punctuation">,</span> <span class="token number">4224908000</span><span class="token punctuation">,</span> <span class="token number">207684355</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2681129718</span><span class="token punctuation">,</span> <span class="token number">4210889596</span><span class="token punctuation">,</span> <span class="token number">4051161171</span><span class="token punctuation">,</span> <span class="token number">3131196482</span><span class="token punctuation">,</span> <span class="token number">1128312875</span><span class="token punctuation">,</span> <span class="token number">938670840</span><span class="token punctuation">,</span> <span class="token number">2828563599</span><span class="token punctuation">,</span> <span class="token number">3078146488</span><span class="token punctuation">,</span> <span class="token number">1102989364</span><span class="token punctuation">,</span> <span class="token number">3557724304</span><span class="token punctuation">,</span> <span class="token number">156013303</span><span class="token punctuation">,</span> <span class="token number">2371355565</span><span class="token punctuation">,</span> <span class="token number">3608679353</span><span class="token punctuation">,</span> <span class="token number">3513837899</span><span class="token punctuation">,</span> <span class="token number">155622460</span><span class="token punctuation">,</span> <span class="token number">396656112</span><span class="token punctuation">,</span> <span class="token number">2493417457</span><span class="token punctuation">,</span> <span class="token number">876296360</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3135876409</span><span class="token punctuation">,</span> <span class="token number">181875076</span><span class="token punctuation">,</span> <span class="token number">3662181650</span><span class="token punctuation">,</span> <span class="token number">3851859805</span><span class="token punctuation">,</span> <span class="token number">3626146919</span><span class="token punctuation">,</span> <span class="token number">90441351</span><span class="token punctuation">,</span> <span class="token number">1944988720</span><span class="token punctuation">,</span> <span class="token number">585429580</span><span class="token punctuation">,</span> <span class="token number">3158268550</span><span class="token punctuation">,</span> <span class="token number">1399100291</span><span class="token punctuation">,</span> <span class="token number">3688843295</span><span class="token punctuation">,</span> <span class="token number">2851190</span><span class="token punctuation">,</span> <span class="token number">2670576474</span><span class="token punctuation">,</span> <span class="token number">3177735154</span><span class="token punctuation">,</span> <span class="token number">3479499727</span><span class="token punctuation">,</span> <span class="token number">197376977</span><span class="token punctuation">,</span> <span class="token number">1790622954</span><span class="token punctuation">,</span> <span class="token number">2393956089</span><span class="token punctuation">]</span><span class="token punctuation">]</span>cipher <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">7180140290</span><span class="token punctuation">,</span> <span class="token number">3141915684</span><span class="token punctuation">,</span> <span class="token number">4375484758</span><span class="token punctuation">,</span> <span class="token number">1318033539</span><span class="token punctuation">,</span> <span class="token number">3703733458</span><span class="token punctuation">,</span> <span class="token number">3647670480</span><span class="token punctuation">,</span> <span class="token number">602160587</span><span class="token punctuation">,</span> <span class="token number">5980133517</span><span class="token punctuation">,</span> <span class="token number">5549070878</span><span class="token punctuation">,</span> <span class="token number">4357625450</span><span class="token punctuation">,</span> <span class="token number">1049311243</span><span class="token punctuation">,</span> <span class="token number">2204828010</span><span class="token punctuation">,</span> <span class="token number">7478386985</span><span class="token punctuation">,</span> <span class="token number">7168975760</span><span class="token punctuation">,</span> <span class="token number">4860233060</span><span class="token punctuation">,</span> <span class="token number">2124987992</span><span class="token punctuation">,</span> <span class="token number">8328577058</span><span class="token punctuation">,</span> <span class="token number">3087835869</span><span class="token punctuation">,</span> <span class="token number">5676726658</span><span class="token punctuation">,</span> <span class="token number">3759772148</span><span class="token punctuation">,</span> <span class="token number">6606176215</span><span class="token punctuation">,</span> <span class="token number">2908250007</span><span class="token punctuation">,</span> <span class="token number">662118092</span><span class="token punctuation">,</span> <span class="token number">7029993531</span><span class="token punctuation">,</span> <span class="token number">3705914901</span><span class="token punctuation">,</span> <span class="token number">697664494</span><span class="token punctuation">,</span> <span class="token number">2137174137</span><span class="token punctuation">,</span> <span class="token number">5406829066</span><span class="token punctuation">,</span> <span class="token number">700416846</span><span class="token punctuation">,</span> <span class="token number">6968142857</span><span class="token punctuation">,</span> <span class="token number">8217369461</span><span class="token punctuation">,</span> <span class="token number">5164642347</span><span class="token punctuation">,</span> <span class="token number">2646776450</span><span class="token punctuation">,</span> <span class="token number">6181738074</span><span class="token punctuation">]</span>A <span class="token operator">=</span> key<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">]</span>b <span class="token operator">=</span> cipher<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">18</span><span class="token punctuation">]</span>A <span class="token operator">=</span> matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span>b <span class="token operator">=</span> vector<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">.</span>solve_right<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">110</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">105</span><span class="token punctuation">,</span> <span class="token number">108</span><span class="token punctuation">,</span> <span class="token number">46</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token comment"># xiaoming@cmail.com</span></code></pre><h3 id="stage4"><a href="#stage4" class="headerlink" title="stage4"></a>stage4</h3><p>头两个素数不确定，要在范围内穷举<br><code>random.randrange</code>使用<code>random.choice</code>实现，查询发现其也是使用<code>getrandbits</code>实现，而且正好是32位</p><p>所有随机数加起来正好624*32位，因此：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256<span class="token keyword">from</span> mt19937predictor <span class="token keyword">import</span> MT19937Predictorp <span class="token operator">=</span> <span class="token number">22186905890293167337018474103</span>tmp <span class="token operator">=</span> p <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">while</span> next_prime<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span> <span class="token operator">==</span> p<span class="token punctuation">:</span>    tmp <span class="token operator">-=</span> <span class="token number">1</span>low_p <span class="token operator">=</span> tmp <span class="token operator">+</span> <span class="token number">1</span>    q <span class="token operator">=</span> <span class="token number">64390888389278700958517837593</span>tmp <span class="token operator">=</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">while</span> next_prime<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span> <span class="token operator">==</span> q<span class="token punctuation">:</span>    tmp <span class="token operator">-=</span> <span class="token number">1</span>low_q <span class="token operator">=</span> tmp <span class="token operator">+</span> <span class="token number">1</span>x2 <span class="token operator">=</span> <span class="token number">1376217116093917281494330680247070104781521444225</span>  <span class="token comment"># 160</span>x3 <span class="token operator">=</span> <span class="token number">1644175009</span>keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">978955513</span><span class="token punctuation">,</span> <span class="token number">2055248981</span><span class="token punctuation">,</span> <span class="token number">3094004449</span><span class="token punctuation">,</span> <span class="token number">411497641</span><span class="token punctuation">,</span> <span class="token number">4183759491</span><span class="token punctuation">,</span> <span class="token number">521276843</span><span class="token punctuation">,</span> <span class="token number">1709604203</span><span class="token punctuation">,</span> <span class="token number">3162773533</span><span class="token punctuation">,</span> <span class="token number">2140722701</span><span class="token punctuation">,</span> <span class="token number">782306144</span><span class="token punctuation">,</span> <span class="token number">421964668</span><span class="token punctuation">,</span> <span class="token number">356205891</span><span class="token punctuation">,</span> <span class="token number">1039083484</span><span class="token punctuation">,</span> <span class="token number">1911377875</span><span class="token punctuation">,</span> <span class="token number">1661230549</span><span class="token punctuation">,</span> <span class="token number">312742665</span><span class="token punctuation">,</span> <span class="token number">3628868938</span><span class="token punctuation">,</span> <span class="token number">2049082743</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3833871085</span><span class="token punctuation">,</span> <span class="token number">2929837680</span><span class="token punctuation">,</span> <span class="token number">2614720930</span><span class="token punctuation">,</span> <span class="token number">4056572317</span><span class="token punctuation">,</span> <span class="token number">3787185237</span><span class="token punctuation">,</span> <span class="token number">93999422</span><span class="token punctuation">,</span> <span class="token number">590001829</span><span class="token punctuation">,</span> <span class="token number">429074138</span><span class="token punctuation">,</span> <span class="token number">3012080235</span><span class="token punctuation">,</span> <span class="token number">2336571108</span><span class="token punctuation">,</span> <span class="token number">831707987</span><span class="token punctuation">,</span> <span class="token number">3902814802</span><span class="token punctuation">,</span> <span class="token number">2084593018</span><span class="token punctuation">,</span> <span class="token number">316245361</span><span class="token punctuation">,</span> <span class="token number">1799842819</span><span class="token punctuation">,</span> <span class="token number">2908004545</span><span class="token punctuation">,</span> <span class="token number">120773816</span><span class="token punctuation">,</span> <span class="token number">2687194173</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3213409254</span><span class="token punctuation">,</span> <span class="token number">3303290739</span><span class="token punctuation">,</span> <span class="token number">742998950</span><span class="token punctuation">,</span> <span class="token number">2956806179</span><span class="token punctuation">,</span> <span class="token number">2834298174</span><span class="token punctuation">,</span> <span class="token number">429260769</span><span class="token punctuation">,</span> <span class="token number">769267967</span><span class="token punctuation">,</span> <span class="token number">1301491642</span><span class="token punctuation">,</span> <span class="token number">2415087532</span><span class="token punctuation">,</span> <span class="token number">1055496090</span><span class="token punctuation">,</span> <span class="token number">690922955</span><span class="token punctuation">,</span> <span class="token number">2984201071</span><span class="token punctuation">,</span> <span class="token number">3517649313</span><span class="token punctuation">,</span> <span class="token number">3675968202</span><span class="token punctuation">,</span> <span class="token number">3389582912</span><span class="token punctuation">,</span> <span class="token number">2632941479</span><span class="token punctuation">,</span> <span class="token number">186911789</span><span class="token punctuation">,</span> <span class="token number">3547287806</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4149643988</span><span class="token punctuation">,</span> <span class="token number">3811477370</span><span class="token punctuation">,</span> <span class="token number">1269911228</span><span class="token punctuation">,</span> <span class="token number">3709435333</span><span class="token punctuation">,</span> <span class="token number">1868378108</span><span class="token punctuation">,</span> <span class="token number">4173520248</span><span class="token punctuation">,</span> <span class="token number">1573661708</span><span class="token punctuation">,</span> <span class="token number">2161236830</span><span class="token punctuation">,</span> <span class="token number">3266570322</span><span class="token punctuation">,</span> <span class="token number">1611227993</span><span class="token punctuation">,</span> <span class="token number">2539778863</span><span class="token punctuation">,</span> <span class="token number">1857682940</span><span class="token punctuation">,</span> <span class="token number">1020154001</span><span class="token punctuation">,</span> <span class="token number">92386553</span><span class="token punctuation">,</span> <span class="token number">3834719618</span><span class="token punctuation">,</span> <span class="token number">3775070036</span><span class="token punctuation">,</span> <span class="token number">3777877862</span><span class="token punctuation">,</span> <span class="token number">2982256702</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4281981169</span><span class="token punctuation">,</span> <span class="token number">2949541448</span><span class="token punctuation">,</span> <span class="token number">4199819805</span><span class="token punctuation">,</span> <span class="token number">3654041457</span><span class="token punctuation">,</span> <span class="token number">3300163657</span><span class="token punctuation">,</span> <span class="token number">1674155910</span><span class="token punctuation">,</span> <span class="token number">1316779635</span><span class="token punctuation">,</span> <span class="token number">66744534</span><span class="token punctuation">,</span> <span class="token number">3804297626</span><span class="token punctuation">,</span> <span class="token number">2709354730</span><span class="token punctuation">,</span> <span class="token number">2460136415</span><span class="token punctuation">,</span> <span class="token number">3983640368</span><span class="token punctuation">,</span> <span class="token number">3801883586</span><span class="token punctuation">,</span> <span class="token number">1068904857</span><span class="token punctuation">,</span> <span class="token number">4178063279</span><span class="token punctuation">,</span> <span class="token number">41067134</span><span class="token punctuation">,</span> <span class="token number">752202632</span><span class="token punctuation">,</span> <span class="token number">3143016757</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3078167402</span><span class="token punctuation">,</span> <span class="token number">2059042200</span><span class="token punctuation">,</span> <span class="token number">252404132</span><span class="token punctuation">,</span> <span class="token number">415008428</span><span class="token punctuation">,</span> <span class="token number">3611056424</span><span class="token punctuation">,</span> <span class="token number">1674088343</span><span class="token punctuation">,</span> <span class="token number">2460161645</span><span class="token punctuation">,</span> <span class="token number">3311986519</span><span class="token punctuation">,</span> <span class="token number">3130694755</span><span class="token punctuation">,</span> <span class="token number">934254488</span><span class="token punctuation">,</span> <span class="token number">898722917</span><span class="token punctuation">,</span> <span class="token number">2865274835</span><span class="token punctuation">,</span> <span class="token number">567507230</span><span class="token punctuation">,</span> <span class="token number">1328871893</span><span class="token punctuation">,</span> <span class="token number">3903457801</span><span class="token punctuation">,</span> <span class="token number">2499893858</span><span class="token punctuation">,</span> <span class="token number">492084315</span><span class="token punctuation">,</span> <span class="token number">183531922</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3529830884</span><span class="token punctuation">,</span> <span class="token number">4039243386</span><span class="token punctuation">,</span> <span class="token number">233553719</span><span class="token punctuation">,</span> <span class="token number">4118146471</span><span class="token punctuation">,</span> <span class="token number">1646804655</span><span class="token punctuation">,</span> <span class="token number">2089146092</span><span class="token punctuation">,</span> <span class="token number">2156344320</span><span class="token punctuation">,</span> <span class="token number">2329927228</span><span class="token punctuation">,</span> <span class="token number">508323741</span><span class="token punctuation">,</span> <span class="token number">1931822010</span><span class="token punctuation">,</span> <span class="token number">579182891</span><span class="token punctuation">,</span> <span class="token number">176447133</span><span class="token punctuation">,</span> <span class="token number">597011120</span><span class="token punctuation">,</span> <span class="token number">3261594914</span><span class="token punctuation">,</span> <span class="token number">2845298788</span><span class="token punctuation">,</span> <span class="token number">3759915972</span><span class="token punctuation">,</span> <span class="token number">3095206232</span><span class="token punctuation">,</span> <span class="token number">3638216860</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3352986415</span><span class="token punctuation">,</span> <span class="token number">4264046847</span><span class="token punctuation">,</span> <span class="token number">3829043620</span><span class="token punctuation">,</span> <span class="token number">2530153481</span><span class="token punctuation">,</span> <span class="token number">3421260080</span><span class="token punctuation">,</span> <span class="token number">1669551722</span><span class="token punctuation">,</span> <span class="token number">4240873925</span><span class="token punctuation">,</span> <span class="token number">2101009682</span><span class="token punctuation">,</span> <span class="token number">3660432232</span><span class="token punctuation">,</span> <span class="token number">4224377588</span><span class="token punctuation">,</span> <span class="token number">929767737</span><span class="token punctuation">,</span> <span class="token number">3729104589</span><span class="token punctuation">,</span> <span class="token number">2835310428</span><span class="token punctuation">,</span> <span class="token number">1727139644</span><span class="token punctuation">,</span> <span class="token number">1279995206</span><span class="token punctuation">,</span> <span class="token number">1355353373</span><span class="token punctuation">,</span> <span class="token number">2144225408</span><span class="token punctuation">,</span> <span class="token number">1359399895</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3105965085</span><span class="token punctuation">,</span> <span class="token number">818804468</span><span class="token punctuation">,</span> <span class="token number">3230054412</span><span class="token punctuation">,</span> <span class="token number">2646235709</span><span class="token punctuation">,</span> <span class="token number">4053839846</span><span class="token punctuation">,</span> <span class="token number">2878092923</span><span class="token punctuation">,</span> <span class="token number">587905848</span><span class="token punctuation">,</span> <span class="token number">1589383219</span><span class="token punctuation">,</span> <span class="token number">2408577579</span><span class="token punctuation">,</span> <span class="token number">880800518</span><span class="token punctuation">,</span> <span class="token number">28758157</span><span class="token punctuation">,</span> <span class="token number">1000513178</span><span class="token punctuation">,</span> <span class="token number">2176168589</span><span class="token punctuation">,</span> <span class="token number">187505579</span><span class="token punctuation">,</span> <span class="token number">89151277</span><span class="token punctuation">,</span> <span class="token number">1238795748</span><span class="token punctuation">,</span> <span class="token number">8168714</span><span class="token punctuation">,</span> <span class="token number">3501032027</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3473729699</span><span class="token punctuation">,</span> <span class="token number">1900372653</span><span class="token punctuation">,</span> <span class="token number">305029321</span><span class="token punctuation">,</span> <span class="token number">2013273628</span><span class="token punctuation">,</span> <span class="token number">1242655400</span><span class="token punctuation">,</span> <span class="token number">4192234107</span><span class="token punctuation">,</span> <span class="token number">2446737641</span><span class="token punctuation">,</span> <span class="token number">1341412052</span><span class="token punctuation">,</span> <span class="token number">304733944</span><span class="token punctuation">,</span> <span class="token number">4174393908</span><span class="token punctuation">,</span> <span class="token number">2563609353</span><span class="token punctuation">,</span> <span class="token number">3623415321</span><span class="token punctuation">,</span> <span class="token number">49954007</span><span class="token punctuation">,</span> <span class="token number">3130983058</span><span class="token punctuation">,</span> <span class="token number">425856087</span><span class="token punctuation">,</span> <span class="token number">2331025419</span><span class="token punctuation">,</span> <span class="token number">34423818</span><span class="token punctuation">,</span> <span class="token number">2042901845</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1397571080</span><span class="token punctuation">,</span> <span class="token number">1615456639</span><span class="token punctuation">,</span> <span class="token number">1840339411</span><span class="token punctuation">,</span> <span class="token number">220496996</span><span class="token punctuation">,</span> <span class="token number">2042007444</span><span class="token punctuation">,</span> <span class="token number">3681679342</span><span class="token punctuation">,</span> <span class="token number">2306603996</span><span class="token punctuation">,</span> <span class="token number">732207066</span><span class="token punctuation">,</span> <span class="token number">663494719</span><span class="token punctuation">,</span> <span class="token number">4092173669</span><span class="token punctuation">,</span> <span class="token number">3034772067</span><span class="token punctuation">,</span> <span class="token number">3807942919</span><span class="token punctuation">,</span> <span class="token number">111475712</span><span class="token punctuation">,</span> <span class="token number">2065672849</span><span class="token punctuation">,</span> <span class="token number">3552535306</span><span class="token punctuation">,</span> <span class="token number">138510326</span><span class="token punctuation">,</span> <span class="token number">3757322399</span><span class="token punctuation">,</span> <span class="token number">2394352747</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">371953847</span><span class="token punctuation">,</span> <span class="token number">3369229608</span><span class="token punctuation">,</span> <span class="token number">1669129625</span><span class="token punctuation">,</span> <span class="token number">168320777</span><span class="token punctuation">,</span> <span class="token number">2375427503</span><span class="token punctuation">,</span> <span class="token number">3449778616</span><span class="token punctuation">,</span> <span class="token number">1977984006</span><span class="token punctuation">,</span> <span class="token number">1543379950</span><span class="token punctuation">,</span> <span class="token number">2293317896</span><span class="token punctuation">,</span> <span class="token number">1239812206</span><span class="token punctuation">,</span> <span class="token number">1198364787</span><span class="token punctuation">,</span> <span class="token number">2465753450</span><span class="token punctuation">,</span> <span class="token number">3739161320</span><span class="token punctuation">,</span> <span class="token number">2502603029</span><span class="token punctuation">,</span> <span class="token number">1528706460</span><span class="token punctuation">,</span> <span class="token number">1488040470</span><span class="token punctuation">,</span> <span class="token number">3387786864</span><span class="token punctuation">,</span> <span class="token number">1864873515</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1356892529</span><span class="token punctuation">,</span> <span class="token number">1662755536</span><span class="token punctuation">,</span> <span class="token number">1623461302</span><span class="token punctuation">,</span> <span class="token number">1925037502</span><span class="token punctuation">,</span> <span class="token number">1878096790</span><span class="token punctuation">,</span> <span class="token number">3682248450</span><span class="token punctuation">,</span> <span class="token number">2359635297</span><span class="token punctuation">,</span> <span class="token number">1558718627</span><span class="token punctuation">,</span> <span class="token number">116402105</span><span class="token punctuation">,</span> <span class="token number">3274502275</span><span class="token punctuation">,</span> <span class="token number">2436185635</span><span class="token punctuation">,</span> <span class="token number">771708011</span><span class="token punctuation">,</span> <span class="token number">3484140889</span><span class="token punctuation">,</span> <span class="token number">3264299013</span><span class="token punctuation">,</span> <span class="token number">885210310</span><span class="token punctuation">,</span> <span class="token number">4225779256</span><span class="token punctuation">,</span> <span class="token number">363129056</span><span class="token punctuation">,</span> <span class="token number">2488388413</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2636035482</span><span class="token punctuation">,</span> <span class="token number">4140705532</span><span class="token punctuation">,</span> <span class="token number">3187647213</span><span class="token punctuation">,</span> <span class="token number">4009585502</span><span class="token punctuation">,</span> <span class="token number">351132201</span><span class="token punctuation">,</span> <span class="token number">2592096589</span><span class="token punctuation">,</span> <span class="token number">3785703396</span><span class="token punctuation">,</span> <span class="token number">750115519</span><span class="token punctuation">,</span> <span class="token number">3632692007</span><span class="token punctuation">,</span> <span class="token number">3936675924</span><span class="token punctuation">,</span> <span class="token number">3635400895</span><span class="token punctuation">,</span> <span class="token number">3257019719</span><span class="token punctuation">,</span> <span class="token number">1928767495</span><span class="token punctuation">,</span> <span class="token number">2868979203</span><span class="token punctuation">,</span> <span class="token number">622850989</span><span class="token punctuation">,</span> <span class="token number">3165580000</span><span class="token punctuation">,</span> <span class="token number">4162276629</span><span class="token punctuation">,</span> <span class="token number">4157491019</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1272163411</span><span class="token punctuation">,</span> <span class="token number">1251211247</span><span class="token punctuation">,</span> <span class="token number">357523138</span><span class="token punctuation">,</span> <span class="token number">1233981097</span><span class="token punctuation">,</span> <span class="token number">1855287284</span><span class="token punctuation">,</span> <span class="token number">4079018167</span><span class="token punctuation">,</span> <span class="token number">4028466297</span><span class="token punctuation">,</span> <span class="token number">92214478</span><span class="token punctuation">,</span> <span class="token number">4290550648</span><span class="token punctuation">,</span> <span class="token number">648034817</span><span class="token punctuation">,</span> <span class="token number">1247795256</span><span class="token punctuation">,</span> <span class="token number">3928945157</span><span class="token punctuation">,</span> <span class="token number">1199659871</span><span class="token punctuation">,</span> <span class="token number">397659647</span><span class="token punctuation">,</span> <span class="token number">3360313830</span><span class="token punctuation">,</span> <span class="token number">561558927</span><span class="token punctuation">,</span> <span class="token number">3446409788</span><span class="token punctuation">,</span> <span class="token number">2727008359</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1470343419</span><span class="token punctuation">,</span> <span class="token number">3861411785</span><span class="token punctuation">,</span> <span class="token number">953425729</span><span class="token punctuation">,</span> <span class="token number">65811127</span><span class="token punctuation">,</span> <span class="token number">458070615</span><span class="token punctuation">,</span> <span class="token number">1428470215</span><span class="token punctuation">,</span> <span class="token number">3101427357</span><span class="token punctuation">,</span> <span class="token number">1137845714</span><span class="token punctuation">,</span> <span class="token number">1980562597</span><span class="token punctuation">,</span> <span class="token number">4120983895</span><span class="token punctuation">,</span> <span class="token number">45901583</span><span class="token punctuation">,</span> <span class="token number">2869582150</span><span class="token punctuation">,</span> <span class="token number">427949409</span><span class="token punctuation">,</span> <span class="token number">3025588000</span><span class="token punctuation">,</span> <span class="token number">3231450975</span><span class="token punctuation">,</span> <span class="token number">3313818165</span><span class="token punctuation">,</span> <span class="token number">4015642368</span><span class="token punctuation">,</span> <span class="token number">3197557747</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2452385340</span><span class="token punctuation">,</span> <span class="token number">111636796</span><span class="token punctuation">,</span> <span class="token number">897282198</span><span class="token punctuation">,</span> <span class="token number">4273652805</span><span class="token punctuation">,</span> <span class="token number">1223518692</span><span class="token punctuation">,</span> <span class="token number">3680320805</span><span class="token punctuation">,</span> <span class="token number">2771040109</span><span class="token punctuation">,</span> <span class="token number">3617506402</span><span class="token punctuation">,</span> <span class="token number">3904690320</span><span class="token punctuation">,</span> <span class="token number">77507239</span><span class="token punctuation">,</span> <span class="token number">3010900929</span><span class="token punctuation">,</span> <span class="token number">4099608062</span><span class="token punctuation">,</span> <span class="token number">546322994</span><span class="token punctuation">,</span> <span class="token number">1084929138</span><span class="token punctuation">,</span> <span class="token number">902220733</span><span class="token punctuation">,</span> <span class="token number">4054312795</span><span class="token punctuation">,</span> <span class="token number">1977510945</span><span class="token punctuation">,</span> <span class="token number">735973665</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3729015155</span><span class="token punctuation">,</span> <span class="token number">3027108070</span><span class="token punctuation">,</span> <span class="token number">1442633554</span><span class="token punctuation">,</span> <span class="token number">1949455360</span><span class="token punctuation">,</span> <span class="token number">2864504565</span><span class="token punctuation">,</span> <span class="token number">3673543865</span><span class="token punctuation">,</span> <span class="token number">446663703</span><span class="token punctuation">,</span> <span class="token number">3515816196</span><span class="token punctuation">,</span> <span class="token number">1468441462</span><span class="token punctuation">,</span> <span class="token number">897770414</span><span class="token punctuation">,</span> <span class="token number">2831043012</span><span class="token punctuation">,</span> <span class="token number">707874506</span><span class="token punctuation">,</span> <span class="token number">1098228471</span><span class="token punctuation">,</span> <span class="token number">1225077381</span><span class="token punctuation">,</span> <span class="token number">3622448809</span><span class="token punctuation">,</span> <span class="token number">2409995597</span><span class="token punctuation">,</span> <span class="token number">3847055008</span><span class="token punctuation">,</span> <span class="token number">1887507220</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1839061542</span><span class="token punctuation">,</span> <span class="token number">1963345926</span><span class="token punctuation">,</span> <span class="token number">2600100988</span><span class="token punctuation">,</span> <span class="token number">1703502633</span><span class="token punctuation">,</span> <span class="token number">1824193082</span><span class="token punctuation">,</span> <span class="token number">3595102755</span><span class="token punctuation">,</span> <span class="token number">2558488861</span><span class="token punctuation">,</span> <span class="token number">2440526309</span><span class="token punctuation">,</span> <span class="token number">3909166109</span><span class="token punctuation">,</span> <span class="token number">1611135411</span><span class="token punctuation">,</span> <span class="token number">2809397519</span><span class="token punctuation">,</span> <span class="token number">1019893656</span><span class="token punctuation">,</span> <span class="token number">3281060225</span><span class="token punctuation">,</span> <span class="token number">2387778214</span><span class="token punctuation">,</span> <span class="token number">2460059811</span><span class="token punctuation">,</span> <span class="token number">198824620</span><span class="token punctuation">,</span> <span class="token number">1645102665</span><span class="token punctuation">,</span> <span class="token number">865289621</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">224442296</span><span class="token punctuation">,</span> <span class="token number">3009601747</span><span class="token punctuation">,</span> <span class="token number">3066701924</span><span class="token punctuation">,</span> <span class="token number">1774879140</span><span class="token punctuation">,</span> <span class="token number">880620935</span><span class="token punctuation">,</span> <span class="token number">2676353545</span><span class="token punctuation">,</span> <span class="token number">3748945463</span><span class="token punctuation">,</span> <span class="token number">1994930827</span><span class="token punctuation">,</span> <span class="token number">75275710</span><span class="token punctuation">,</span> <span class="token number">3710375437</span><span class="token punctuation">,</span> <span class="token number">4132497729</span><span class="token punctuation">,</span> <span class="token number">3010711783</span><span class="token punctuation">,</span> <span class="token number">3731895534</span><span class="token punctuation">,</span> <span class="token number">2434590580</span><span class="token punctuation">,</span> <span class="token number">3409701141</span><span class="token punctuation">,</span> <span class="token number">2209951200</span><span class="token punctuation">,</span> <span class="token number">995511645</span><span class="token punctuation">,</span> <span class="token number">3571299495</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2337737600</span><span class="token punctuation">,</span> <span class="token number">110982073</span><span class="token punctuation">,</span> <span class="token number">2985129643</span><span class="token punctuation">,</span> <span class="token number">1668549189</span><span class="token punctuation">,</span> <span class="token number">3298468029</span><span class="token punctuation">,</span> <span class="token number">698015588</span><span class="token punctuation">,</span> <span class="token number">2945584297</span><span class="token punctuation">,</span> <span class="token number">1036821195</span><span class="token punctuation">,</span> <span class="token number">4249059927</span><span class="token punctuation">,</span> <span class="token number">3384611421</span><span class="token punctuation">,</span> <span class="token number">3304378629</span><span class="token punctuation">,</span> <span class="token number">1307957989</span><span class="token punctuation">,</span> <span class="token number">602821252</span><span class="token punctuation">,</span> <span class="token number">184198726</span><span class="token punctuation">,</span> <span class="token number">1182960059</span><span class="token punctuation">,</span> <span class="token number">4200496073</span><span class="token punctuation">,</span> <span class="token number">1562699893</span><span class="token punctuation">,</span> <span class="token number">3320841302</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5866561</span><span class="token punctuation">,</span> <span class="token number">2442649482</span><span class="token punctuation">,</span> <span class="token number">479821282</span><span class="token punctuation">,</span> <span class="token number">2687097642</span><span class="token punctuation">,</span> <span class="token number">3347828225</span><span class="token punctuation">,</span> <span class="token number">1876332308</span><span class="token punctuation">,</span> <span class="token number">2704295851</span><span class="token punctuation">,</span> <span class="token number">2952277070</span><span class="token punctuation">,</span> <span class="token number">1803967244</span><span class="token punctuation">,</span> <span class="token number">2837783916</span><span class="token punctuation">,</span> <span class="token number">658984547</span><span class="token punctuation">,</span> <span class="token number">3605604364</span><span class="token punctuation">,</span> <span class="token number">1931924322</span><span class="token punctuation">,</span> <span class="token number">3285319978</span><span class="token punctuation">,</span> <span class="token number">556150900</span><span class="token punctuation">,</span> <span class="token number">3795666798</span><span class="token punctuation">,</span> <span class="token number">261321502</span><span class="token punctuation">,</span> <span class="token number">1040433381</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3855222954</span><span class="token punctuation">,</span> <span class="token number">3565522064</span><span class="token punctuation">,</span> <span class="token number">1841853882</span><span class="token punctuation">,</span> <span class="token number">1066304362</span><span class="token punctuation">,</span> <span class="token number">3552076734</span><span class="token punctuation">,</span> <span class="token number">3075952725</span><span class="token punctuation">,</span> <span class="token number">2193242436</span><span class="token punctuation">,</span> <span class="token number">2052898568</span><span class="token punctuation">,</span> <span class="token number">2341179777</span><span class="token punctuation">,</span> <span class="token number">3089412493</span><span class="token punctuation">,</span> <span class="token number">165812889</span><span class="token punctuation">,</span> <span class="token number">4196290126</span><span class="token punctuation">,</span> <span class="token number">3568567671</span><span class="token punctuation">,</span> <span class="token number">28097161</span><span class="token punctuation">,</span> <span class="token number">2249543862</span><span class="token punctuation">,</span> <span class="token number">1251207418</span><span class="token punctuation">,</span> <span class="token number">522526590</span><span class="token punctuation">,</span> <span class="token number">765541973</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1801734077</span><span class="token punctuation">,</span> <span class="token number">2132230169</span><span class="token punctuation">,</span> <span class="token number">667823776</span><span class="token punctuation">,</span> <span class="token number">3900096345</span><span class="token punctuation">,</span> <span class="token number">3119630138</span><span class="token punctuation">,</span> <span class="token number">3620542178</span><span class="token punctuation">,</span> <span class="token number">2900630754</span><span class="token punctuation">,</span> <span class="token number">30811433</span><span class="token punctuation">,</span> <span class="token number">608818254</span><span class="token punctuation">,</span> <span class="token number">1040662178</span><span class="token punctuation">,</span> <span class="token number">900811411</span><span class="token punctuation">,</span> <span class="token number">3221833258</span><span class="token punctuation">,</span> <span class="token number">43598995</span><span class="token punctuation">,</span> <span class="token number">1818995893</span><span class="token punctuation">,</span> <span class="token number">2718507668</span><span class="token punctuation">,</span> <span class="token number">3445138445</span><span class="token punctuation">,</span> <span class="token number">3217962572</span><span class="token punctuation">,</span> <span class="token number">1437902734</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1812768224</span><span class="token punctuation">,</span> <span class="token number">392114567</span><span class="token punctuation">,</span> <span class="token number">2694519859</span><span class="token punctuation">,</span> <span class="token number">1941199322</span><span class="token punctuation">,</span> <span class="token number">2523549731</span><span class="token punctuation">,</span> <span class="token number">2078453798</span><span class="token punctuation">,</span> <span class="token number">851734499</span><span class="token punctuation">,</span> <span class="token number">2376090593</span><span class="token punctuation">,</span> <span class="token number">2069375610</span><span class="token punctuation">,</span> <span class="token number">4084690114</span><span class="token punctuation">,</span> <span class="token number">246441363</span><span class="token punctuation">,</span> <span class="token number">4154699271</span><span class="token punctuation">,</span> <span class="token number">58451971</span><span class="token punctuation">,</span> <span class="token number">31806021</span><span class="token punctuation">,</span> <span class="token number">4158724930</span><span class="token punctuation">,</span> <span class="token number">2741293247</span><span class="token punctuation">,</span> <span class="token number">3230803936</span><span class="token punctuation">,</span> <span class="token number">2790505999</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3906342775</span><span class="token punctuation">,</span> <span class="token number">2231570871</span><span class="token punctuation">,</span> <span class="token number">1258998901</span><span class="token punctuation">,</span> <span class="token number">1517292578</span><span class="token punctuation">,</span> <span class="token number">162889239</span><span class="token punctuation">,</span> <span class="token number">3130741176</span><span class="token punctuation">,</span> <span class="token number">3925266771</span><span class="token punctuation">,</span> <span class="token number">1780222960</span><span class="token punctuation">,</span> <span class="token number">2378568279</span><span class="token punctuation">,</span> <span class="token number">3873144834</span><span class="token punctuation">,</span> <span class="token number">1597459529</span><span class="token punctuation">,</span> <span class="token number">1581197809</span><span class="token punctuation">,</span> <span class="token number">4101706041</span><span class="token punctuation">,</span> <span class="token number">196019642</span><span class="token punctuation">,</span> <span class="token number">1439141586</span><span class="token punctuation">,</span> <span class="token number">587446072</span><span class="token punctuation">,</span> <span class="token number">2012673288</span><span class="token punctuation">,</span> <span class="token number">1280875335</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4058452685</span><span class="token punctuation">,</span> <span class="token number">653145648</span><span class="token punctuation">,</span> <span class="token number">553051697</span><span class="token punctuation">,</span> <span class="token number">1406542226</span><span class="token punctuation">,</span> <span class="token number">4053722203</span><span class="token punctuation">,</span> <span class="token number">994470045</span><span class="token punctuation">,</span> <span class="token number">2066358582</span><span class="token punctuation">,</span> <span class="token number">3919235908</span><span class="token punctuation">,</span> <span class="token number">2315900402</span><span class="token punctuation">,</span> <span class="token number">3236350874</span><span class="token punctuation">,</span> <span class="token number">172880690</span><span class="token punctuation">,</span> <span class="token number">3104147616</span><span class="token punctuation">,</span> <span class="token number">489606166</span><span class="token punctuation">,</span> <span class="token number">3898059157</span><span class="token punctuation">,</span> <span class="token number">200469827</span><span class="token punctuation">,</span> <span class="token number">665789663</span><span class="token punctuation">,</span> <span class="token number">3116633449</span><span class="token punctuation">,</span> <span class="token number">4137295625</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1460624254</span><span class="token punctuation">,</span> <span class="token number">4286673320</span><span class="token punctuation">,</span> <span class="token number">2664109800</span><span class="token punctuation">,</span> <span class="token number">1995979611</span><span class="token punctuation">,</span> <span class="token number">4091742681</span><span class="token punctuation">,</span> <span class="token number">2639530247</span><span class="token punctuation">,</span> <span class="token number">4240681440</span><span class="token punctuation">,</span> <span class="token number">2169059390</span><span class="token punctuation">,</span> <span class="token number">1149325301</span><span class="token punctuation">,</span> <span class="token number">3139578541</span><span class="token punctuation">,</span> <span class="token number">2320870639</span><span class="token punctuation">,</span> <span class="token number">3148999826</span><span class="token punctuation">,</span> <span class="token number">4095173534</span><span class="token punctuation">,</span> <span class="token number">2742698014</span><span class="token punctuation">,</span> <span class="token number">3623896968</span><span class="token punctuation">,</span> <span class="token number">2444601912</span><span class="token punctuation">,</span> <span class="token number">1958855100</span><span class="token punctuation">,</span> <span class="token number">1743268893</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2187625371</span><span class="token punctuation">,</span> <span class="token number">3533912845</span><span class="token punctuation">,</span> <span class="token number">29086928</span><span class="token punctuation">,</span> <span class="token number">543325588</span><span class="token punctuation">,</span> <span class="token number">4247300963</span><span class="token punctuation">,</span> <span class="token number">1972139209</span><span class="token punctuation">,</span> <span class="token number">272152499</span><span class="token punctuation">,</span> <span class="token number">4276082595</span><span class="token punctuation">,</span> <span class="token number">3680551759</span><span class="token punctuation">,</span> <span class="token number">1835350157</span><span class="token punctuation">,</span> <span class="token number">3921757922</span><span class="token punctuation">,</span> <span class="token number">2716774439</span><span class="token punctuation">,</span> <span class="token number">1070751202</span><span class="token punctuation">,</span> <span class="token number">69990939</span><span class="token punctuation">,</span> <span class="token number">3794506838</span><span class="token punctuation">,</span> <span class="token number">699803423</span><span class="token punctuation">,</span> <span class="token number">3699976889</span><span class="token punctuation">,</span> <span class="token number">40791189</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">539106994</span><span class="token punctuation">,</span> <span class="token number">1670272368</span><span class="token punctuation">,</span> <span class="token number">3483599225</span><span class="token punctuation">,</span> <span class="token number">2867955550</span><span class="token punctuation">,</span> <span class="token number">2207694005</span><span class="token punctuation">,</span> <span class="token number">1126950203</span><span class="token punctuation">,</span> <span class="token number">693920921</span><span class="token punctuation">,</span> <span class="token number">2333328675</span><span class="token punctuation">,</span> <span class="token number">539234245</span><span class="token punctuation">,</span> <span class="token number">1961438796</span><span class="token punctuation">,</span> <span class="token number">3126390464</span><span class="token punctuation">,</span> <span class="token number">1118759587</span><span class="token punctuation">,</span> <span class="token number">59715473</span><span class="token punctuation">,</span> <span class="token number">1450076492</span><span class="token punctuation">,</span> <span class="token number">4101732655</span><span class="token punctuation">,</span> <span class="token number">3658733365</span><span class="token punctuation">,</span> <span class="token number">940858890</span><span class="token punctuation">,</span> <span class="token number">1262671744</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3092624332</span><span class="token punctuation">,</span> <span class="token number">2175813516</span><span class="token punctuation">,</span> <span class="token number">3355101899</span><span class="token punctuation">,</span> <span class="token number">3657267135</span><span class="token punctuation">,</span> <span class="token number">770650398</span><span class="token punctuation">,</span> <span class="token number">359506155</span><span class="token punctuation">,</span> <span class="token number">4149470178</span><span class="token punctuation">,</span> <span class="token number">3763654751</span><span class="token punctuation">,</span> <span class="token number">1184381886</span><span class="token punctuation">,</span> <span class="token number">942048015</span><span class="token punctuation">,</span> <span class="token number">523057971</span><span class="token punctuation">,</span> <span class="token number">1098635956</span><span class="token punctuation">,</span> <span class="token number">1732951811</span><span class="token punctuation">,</span> <span class="token number">150067724</span><span class="token punctuation">,</span> <span class="token number">2417766207</span><span class="token punctuation">,</span> <span class="token number">4152571821</span><span class="token punctuation">,</span> <span class="token number">2759971924</span><span class="token punctuation">,</span> <span class="token number">4284842765</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3336022203</span><span class="token punctuation">,</span> <span class="token number">2569311431</span><span class="token punctuation">,</span> <span class="token number">2752777107</span><span class="token punctuation">,</span> <span class="token number">1441977867</span><span class="token punctuation">,</span> <span class="token number">1279003682</span><span class="token punctuation">,</span> <span class="token number">3861567631</span><span class="token punctuation">,</span> <span class="token number">1064716472</span><span class="token punctuation">,</span> <span class="token number">3046493996</span><span class="token punctuation">,</span> <span class="token number">1339401643</span><span class="token punctuation">,</span> <span class="token number">39466446</span><span class="token punctuation">,</span> <span class="token number">1464905290</span><span class="token punctuation">,</span> <span class="token number">420733872</span><span class="token punctuation">,</span> <span class="token number">2057911345</span><span class="token punctuation">,</span> <span class="token number">2418624800</span><span class="token punctuation">,</span> <span class="token number">2193625430</span><span class="token punctuation">,</span> <span class="token number">1558527155</span><span class="token punctuation">,</span> <span class="token number">4224908000</span><span class="token punctuation">,</span> <span class="token number">207684355</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2681129718</span><span class="token punctuation">,</span> <span class="token number">4210889596</span><span class="token punctuation">,</span> <span class="token number">4051161171</span><span class="token punctuation">,</span> <span class="token number">3131196482</span><span class="token punctuation">,</span> <span class="token number">1128312875</span><span class="token punctuation">,</span> <span class="token number">938670840</span><span class="token punctuation">,</span> <span class="token number">2828563599</span><span class="token punctuation">,</span> <span class="token number">3078146488</span><span class="token punctuation">,</span> <span class="token number">1102989364</span><span class="token punctuation">,</span> <span class="token number">3557724304</span><span class="token punctuation">,</span> <span class="token number">156013303</span><span class="token punctuation">,</span> <span class="token number">2371355565</span><span class="token punctuation">,</span> <span class="token number">3608679353</span><span class="token punctuation">,</span> <span class="token number">3513837899</span><span class="token punctuation">,</span> <span class="token number">155622460</span><span class="token punctuation">,</span> <span class="token number">396656112</span><span class="token punctuation">,</span> <span class="token number">2493417457</span><span class="token punctuation">,</span> <span class="token number">876296360</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3135876409</span><span class="token punctuation">,</span> <span class="token number">181875076</span><span class="token punctuation">,</span> <span class="token number">3662181650</span><span class="token punctuation">,</span> <span class="token number">3851859805</span><span class="token punctuation">,</span> <span class="token number">3626146919</span><span class="token punctuation">,</span> <span class="token number">90441351</span><span class="token punctuation">,</span> <span class="token number">1944988720</span><span class="token punctuation">,</span> <span class="token number">585429580</span><span class="token punctuation">,</span> <span class="token number">3158268550</span><span class="token punctuation">,</span> <span class="token number">1399100291</span><span class="token punctuation">,</span> <span class="token number">3688843295</span><span class="token punctuation">,</span> <span class="token number">2851190</span><span class="token punctuation">,</span> <span class="token number">2670576474</span><span class="token punctuation">,</span> <span class="token number">3177735154</span><span class="token punctuation">,</span> <span class="token number">3479499727</span><span class="token punctuation">,</span> <span class="token number">197376977</span><span class="token punctuation">,</span> <span class="token number">1790622954</span><span class="token punctuation">,</span> <span class="token number">2393956089</span><span class="token punctuation">]</span><span class="token punctuation">]</span>c <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token number">86636143607943838782783466877732215397</span><span class="token punctuation">)</span><span class="token keyword">for</span> real_p <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>low_p<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> real_q <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>low_q<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>        predictor <span class="token operator">=</span> MT19937Predictor<span class="token punctuation">(</span><span class="token punctuation">)</span>        predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>real_p<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span>        predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>real_q<span class="token punctuation">,</span> <span class="token number">96</span><span class="token punctuation">)</span>        predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>x2<span class="token punctuation">,</span> <span class="token number">160</span><span class="token punctuation">)</span>        predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>x3<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> kk <span class="token keyword">in</span> keys<span class="token punctuation">:</span>            <span class="token keyword">for</span> k <span class="token keyword">in</span> kk<span class="token punctuation">:</span>                predictor<span class="token punctuation">.</span>setrandbits<span class="token punctuation">(</span>k<span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span>        key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>predictor<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        a <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>        m <span class="token operator">=</span> a<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>c<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b"_"</span> <span class="token keyword">in</span> m <span class="token keyword">and</span> <span class="token string">b"."</span> <span class="token keyword">in</span> m<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>real_p<span class="token punctuation">,</span> real_q<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token comment"># b'No.321_hack_road'</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> Random<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">invert_right</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>l<span class="token punctuation">,</span>val<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    length <span class="token operator">=</span> <span class="token number">32</span>    mx <span class="token operator">=</span> <span class="token number">0xffffffff</span>    <span class="token keyword">if</span> val <span class="token operator">==</span> <span class="token string">''</span><span class="token punctuation">:</span>        val <span class="token operator">=</span> mx    i<span class="token punctuation">,</span>res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>    <span class="token keyword">while</span> i<span class="token operator">*</span>l<span class="token operator">&lt;</span>length<span class="token punctuation">:</span>        mask <span class="token operator">=</span> <span class="token punctuation">(</span>mx<span class="token operator">&lt;&lt;</span><span class="token punctuation">(</span>length<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token operator">&amp;</span>mx<span class="token punctuation">)</span><span class="token operator">>></span>i<span class="token operator">*</span>l        tmp <span class="token operator">=</span> m <span class="token operator">&amp;</span> mask        m <span class="token operator">=</span> m<span class="token operator">^</span>tmp<span class="token operator">>></span>l<span class="token operator">&amp;</span>val        res <span class="token operator">+=</span> tmp        i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">invert_left</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>l<span class="token punctuation">,</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>    length <span class="token operator">=</span> <span class="token number">32</span>    mx <span class="token operator">=</span> <span class="token number">0xffffffff</span>    i<span class="token punctuation">,</span>res <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span>    <span class="token keyword">while</span> i<span class="token operator">*</span>l <span class="token operator">&lt;</span> length<span class="token punctuation">:</span>        mask <span class="token operator">=</span> <span class="token punctuation">(</span>mx<span class="token operator">>></span><span class="token punctuation">(</span>length<span class="token operator">-</span>l<span class="token punctuation">)</span><span class="token operator">&amp;</span>mx<span class="token punctuation">)</span><span class="token operator">&lt;&lt;</span>i<span class="token operator">*</span>l        tmp <span class="token operator">=</span> m <span class="token operator">&amp;</span> mask        m <span class="token operator">^</span><span class="token operator">=</span> tmp<span class="token operator">&lt;&lt;</span>l<span class="token operator">&amp;</span>val        res <span class="token operator">|</span><span class="token operator">=</span> tmp        i <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">invert_temper</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> invert_right<span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">18</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> invert_left<span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">,</span><span class="token number">4022730752</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> invert_left<span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">2636928640</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> invert_right<span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token keyword">def</span> <span class="token function">clone_mt</span><span class="token punctuation">(</span>record<span class="token punctuation">)</span><span class="token punctuation">:</span>    state <span class="token operator">=</span> <span class="token punctuation">[</span>invert_temper<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> record<span class="token punctuation">]</span>    gen <span class="token operator">=</span> Random<span class="token punctuation">(</span><span class="token punctuation">)</span>    gen<span class="token punctuation">.</span>setstate<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>state<span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> gen<span class="token comment"># level1</span>p1 <span class="token operator">=</span> <span class="token number">22186905890293167337018474103</span>q1 <span class="token operator">=</span> <span class="token number">64390888389278700958517837593</span>rand1_start <span class="token operator">=</span> <span class="token number">0x47b09412596ff11aa603be43</span>rand2_start <span class="token operator">=</span> <span class="token number">0xd00ee4fdff12cba26af83ebf</span><span class="token comment"># level2</span>rand3 <span class="token operator">=</span> <span class="token number">0xf10fb5b5aef00592425752d03e910c76bc205d81</span>n <span class="token operator">=</span> <span class="token number">134949786048887319137407994803780389722367094355650515833817995038306119197600539524985448574053755793699799863164150565217726975197643634831307454431403854861515253009970594684699064052739820092115115614153962139870020206132705821506686959283747802946805730902605814619499301779892151365118901010526138311982</span>p2 <span class="token operator">=</span> <span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526561468278997</span>q2 <span class="token operator">=</span> n<span class="token operator">//</span>p2start <span class="token operator">=</span> <span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526561468278997</span>end <span class="token operator">=</span> <span class="token number">11616788973244169211540879051135531683500013311175857700532973853592727185033846064980717918194540453710515251945345524986932165003196804187526563615762644</span>rand4 <span class="token operator">=</span> <span class="token punctuation">(</span>q2<span class="token operator">-</span>start<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span> <span class="token comment"># maybe+1</span><span class="token comment"># level3</span>key <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token number">978955513</span><span class="token punctuation">,</span> <span class="token number">2055248981</span><span class="token punctuation">,</span> <span class="token number">3094004449</span><span class="token punctuation">,</span> <span class="token number">411497641</span><span class="token punctuation">,</span> <span class="token number">4183759491</span><span class="token punctuation">,</span> <span class="token number">521276843</span><span class="token punctuation">,</span> <span class="token number">1709604203</span><span class="token punctuation">,</span> <span class="token number">3162773533</span><span class="token punctuation">,</span> <span class="token number">2140722701</span><span class="token punctuation">,</span> <span class="token number">782306144</span><span class="token punctuation">,</span> <span class="token number">421964668</span><span class="token punctuation">,</span> <span class="token number">356205891</span><span class="token punctuation">,</span> <span class="token number">1039083484</span><span class="token punctuation">,</span> <span class="token number">1911377875</span><span class="token punctuation">,</span> <span class="token number">1661230549</span><span class="token punctuation">,</span> <span class="token number">312742665</span><span class="token punctuation">,</span> <span class="token number">3628868938</span><span class="token punctuation">,</span> <span class="token number">2049082743</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3833871085</span><span class="token punctuation">,</span> <span class="token number">2929837680</span><span class="token punctuation">,</span> <span class="token number">2614720930</span><span class="token punctuation">,</span> <span class="token number">4056572317</span><span class="token punctuation">,</span> <span class="token number">3787185237</span><span class="token punctuation">,</span> <span class="token number">93999422</span><span class="token punctuation">,</span> <span class="token number">590001829</span><span class="token punctuation">,</span> <span class="token number">429074138</span><span class="token punctuation">,</span> <span class="token number">3012080235</span><span class="token punctuation">,</span> <span class="token number">2336571108</span><span class="token punctuation">,</span> <span class="token number">831707987</span><span class="token punctuation">,</span> <span class="token number">3902814802</span><span class="token punctuation">,</span> <span class="token number">2084593018</span><span class="token punctuation">,</span> <span class="token number">316245361</span><span class="token punctuation">,</span> <span class="token number">1799842819</span><span class="token punctuation">,</span> <span class="token number">2908004545</span><span class="token punctuation">,</span> <span class="token number">120773816</span><span class="token punctuation">,</span> <span class="token number">2687194173</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3213409254</span><span class="token punctuation">,</span> <span class="token number">3303290739</span><span class="token punctuation">,</span> <span class="token number">742998950</span><span class="token punctuation">,</span> <span class="token number">2956806179</span><span class="token punctuation">,</span> <span class="token number">2834298174</span><span class="token punctuation">,</span> <span class="token number">429260769</span><span class="token punctuation">,</span> <span class="token number">769267967</span><span class="token punctuation">,</span> <span class="token number">1301491642</span><span class="token punctuation">,</span> <span class="token number">2415087532</span><span class="token punctuation">,</span> <span class="token number">1055496090</span><span class="token punctuation">,</span> <span class="token number">690922955</span><span class="token punctuation">,</span> <span class="token number">2984201071</span><span class="token punctuation">,</span> <span class="token number">3517649313</span><span class="token punctuation">,</span> <span class="token number">3675968202</span><span class="token punctuation">,</span> <span class="token number">3389582912</span><span class="token punctuation">,</span> <span class="token number">2632941479</span><span class="token punctuation">,</span> <span class="token number">186911789</span><span class="token punctuation">,</span> <span class="token number">3547287806</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4149643988</span><span class="token punctuation">,</span> <span class="token number">3811477370</span><span class="token punctuation">,</span> <span class="token number">1269911228</span><span class="token punctuation">,</span> <span class="token number">3709435333</span><span class="token punctuation">,</span> <span class="token number">1868378108</span><span class="token punctuation">,</span> <span class="token number">4173520248</span><span class="token punctuation">,</span> <span class="token number">1573661708</span><span class="token punctuation">,</span> <span class="token number">2161236830</span><span class="token punctuation">,</span> <span class="token number">3266570322</span><span class="token punctuation">,</span> <span class="token number">1611227993</span><span class="token punctuation">,</span> <span class="token number">2539778863</span><span class="token punctuation">,</span> <span class="token number">1857682940</span><span class="token punctuation">,</span> <span class="token number">1020154001</span><span class="token punctuation">,</span> <span class="token number">92386553</span><span class="token punctuation">,</span> <span class="token number">3834719618</span><span class="token punctuation">,</span> <span class="token number">3775070036</span><span class="token punctuation">,</span> <span class="token number">3777877862</span><span class="token punctuation">,</span> <span class="token number">2982256702</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4281981169</span><span class="token punctuation">,</span> <span class="token number">2949541448</span><span class="token punctuation">,</span> <span class="token number">4199819805</span><span class="token punctuation">,</span> <span class="token number">3654041457</span><span class="token punctuation">,</span> <span class="token number">3300163657</span><span class="token punctuation">,</span> <span class="token number">1674155910</span><span class="token punctuation">,</span> <span class="token number">1316779635</span><span class="token punctuation">,</span> <span class="token number">66744534</span><span class="token punctuation">,</span> <span class="token number">3804297626</span><span class="token punctuation">,</span> <span class="token number">2709354730</span><span class="token punctuation">,</span> <span class="token number">2460136415</span><span class="token punctuation">,</span> <span class="token number">3983640368</span><span class="token punctuation">,</span> <span class="token number">3801883586</span><span class="token punctuation">,</span> <span class="token number">1068904857</span><span class="token punctuation">,</span> <span class="token number">4178063279</span><span class="token punctuation">,</span> <span class="token number">41067134</span><span class="token punctuation">,</span> <span class="token number">752202632</span><span class="token punctuation">,</span> <span class="token number">3143016757</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3078167402</span><span class="token punctuation">,</span> <span class="token number">2059042200</span><span class="token punctuation">,</span> <span class="token number">252404132</span><span class="token punctuation">,</span> <span class="token number">415008428</span><span class="token punctuation">,</span> <span class="token number">3611056424</span><span class="token punctuation">,</span> <span class="token number">1674088343</span><span class="token punctuation">,</span> <span class="token number">2460161645</span><span class="token punctuation">,</span> <span class="token number">3311986519</span><span class="token punctuation">,</span> <span class="token number">3130694755</span><span class="token punctuation">,</span> <span class="token number">934254488</span><span class="token punctuation">,</span> <span class="token number">898722917</span><span class="token punctuation">,</span> <span class="token number">2865274835</span><span class="token punctuation">,</span> <span class="token number">567507230</span><span class="token punctuation">,</span> <span class="token number">1328871893</span><span class="token punctuation">,</span> <span class="token number">3903457801</span><span class="token punctuation">,</span> <span class="token number">2499893858</span><span class="token punctuation">,</span> <span class="token number">492084315</span><span class="token punctuation">,</span> <span class="token number">183531922</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3529830884</span><span class="token punctuation">,</span> <span class="token number">4039243386</span><span class="token punctuation">,</span> <span class="token number">233553719</span><span class="token punctuation">,</span> <span class="token number">4118146471</span><span class="token punctuation">,</span> <span class="token number">1646804655</span><span class="token punctuation">,</span> <span class="token number">2089146092</span><span class="token punctuation">,</span> <span class="token number">2156344320</span><span class="token punctuation">,</span> <span class="token number">2329927228</span><span class="token punctuation">,</span> <span class="token number">508323741</span><span class="token punctuation">,</span> <span class="token number">1931822010</span><span class="token punctuation">,</span> <span class="token number">579182891</span><span class="token punctuation">,</span> <span class="token number">176447133</span><span class="token punctuation">,</span> <span class="token number">597011120</span><span class="token punctuation">,</span> <span class="token number">3261594914</span><span class="token punctuation">,</span> <span class="token number">2845298788</span><span class="token punctuation">,</span> <span class="token number">3759915972</span><span class="token punctuation">,</span> <span class="token number">3095206232</span><span class="token punctuation">,</span> <span class="token number">3638216860</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3352986415</span><span class="token punctuation">,</span> <span class="token number">4264046847</span><span class="token punctuation">,</span> <span class="token number">3829043620</span><span class="token punctuation">,</span> <span class="token number">2530153481</span><span class="token punctuation">,</span> <span class="token number">3421260080</span><span class="token punctuation">,</span> <span class="token number">1669551722</span><span class="token punctuation">,</span> <span class="token number">4240873925</span><span class="token punctuation">,</span> <span class="token number">2101009682</span><span class="token punctuation">,</span> <span class="token number">3660432232</span><span class="token punctuation">,</span> <span class="token number">4224377588</span><span class="token punctuation">,</span> <span class="token number">929767737</span><span class="token punctuation">,</span> <span class="token number">3729104589</span><span class="token punctuation">,</span> <span class="token number">2835310428</span><span class="token punctuation">,</span> <span class="token number">1727139644</span><span class="token punctuation">,</span> <span class="token number">1279995206</span><span class="token punctuation">,</span> <span class="token number">1355353373</span><span class="token punctuation">,</span> <span class="token number">2144225408</span><span class="token punctuation">,</span> <span class="token number">1359399895</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3105965085</span><span class="token punctuation">,</span> <span class="token number">818804468</span><span class="token punctuation">,</span> <span class="token number">3230054412</span><span class="token punctuation">,</span> <span class="token number">2646235709</span><span class="token punctuation">,</span> <span class="token number">4053839846</span><span class="token punctuation">,</span> <span class="token number">2878092923</span><span class="token punctuation">,</span> <span class="token number">587905848</span><span class="token punctuation">,</span> <span class="token number">1589383219</span><span class="token punctuation">,</span> <span class="token number">2408577579</span><span class="token punctuation">,</span> <span class="token number">880800518</span><span class="token punctuation">,</span> <span class="token number">28758157</span><span class="token punctuation">,</span> <span class="token number">1000513178</span><span class="token punctuation">,</span> <span class="token number">2176168589</span><span class="token punctuation">,</span> <span class="token number">187505579</span><span class="token punctuation">,</span> <span class="token number">89151277</span><span class="token punctuation">,</span> <span class="token number">1238795748</span><span class="token punctuation">,</span> <span class="token number">8168714</span><span class="token punctuation">,</span> <span class="token number">3501032027</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3473729699</span><span class="token punctuation">,</span> <span class="token number">1900372653</span><span class="token punctuation">,</span> <span class="token number">305029321</span><span class="token punctuation">,</span> <span class="token number">2013273628</span><span class="token punctuation">,</span> <span class="token number">1242655400</span><span class="token punctuation">,</span> <span class="token number">4192234107</span><span class="token punctuation">,</span> <span class="token number">2446737641</span><span class="token punctuation">,</span> <span class="token number">1341412052</span><span class="token punctuation">,</span> <span class="token number">304733944</span><span class="token punctuation">,</span> <span class="token number">4174393908</span><span class="token punctuation">,</span> <span class="token number">2563609353</span><span class="token punctuation">,</span> <span class="token number">3623415321</span><span class="token punctuation">,</span> <span class="token number">49954007</span><span class="token punctuation">,</span> <span class="token number">3130983058</span><span class="token punctuation">,</span> <span class="token number">425856087</span><span class="token punctuation">,</span> <span class="token number">2331025419</span><span class="token punctuation">,</span> <span class="token number">34423818</span><span class="token punctuation">,</span> <span class="token number">2042901845</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1397571080</span><span class="token punctuation">,</span> <span class="token number">1615456639</span><span class="token punctuation">,</span> <span class="token number">1840339411</span><span class="token punctuation">,</span> <span class="token number">220496996</span><span class="token punctuation">,</span> <span class="token number">2042007444</span><span class="token punctuation">,</span> <span class="token number">3681679342</span><span class="token punctuation">,</span> <span class="token number">2306603996</span><span class="token punctuation">,</span> <span class="token number">732207066</span><span class="token punctuation">,</span> <span class="token number">663494719</span><span class="token punctuation">,</span> <span class="token number">4092173669</span><span class="token punctuation">,</span> <span class="token number">3034772067</span><span class="token punctuation">,</span> <span class="token number">3807942919</span><span class="token punctuation">,</span> <span class="token number">111475712</span><span class="token punctuation">,</span> <span class="token number">2065672849</span><span class="token punctuation">,</span> <span class="token number">3552535306</span><span class="token punctuation">,</span> <span class="token number">138510326</span><span class="token punctuation">,</span> <span class="token number">3757322399</span><span class="token punctuation">,</span> <span class="token number">2394352747</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">371953847</span><span class="token punctuation">,</span> <span class="token number">3369229608</span><span class="token punctuation">,</span> <span class="token number">1669129625</span><span class="token punctuation">,</span> <span class="token number">168320777</span><span class="token punctuation">,</span> <span class="token number">2375427503</span><span class="token punctuation">,</span> <span class="token number">3449778616</span><span class="token punctuation">,</span> <span class="token number">1977984006</span><span class="token punctuation">,</span> <span class="token number">1543379950</span><span class="token punctuation">,</span> <span class="token number">2293317896</span><span class="token punctuation">,</span> <span class="token number">1239812206</span><span class="token punctuation">,</span> <span class="token number">1198364787</span><span class="token punctuation">,</span> <span class="token number">2465753450</span><span class="token punctuation">,</span> <span class="token number">3739161320</span><span class="token punctuation">,</span> <span class="token number">2502603029</span><span class="token punctuation">,</span> <span class="token number">1528706460</span><span class="token punctuation">,</span> <span class="token number">1488040470</span><span class="token punctuation">,</span> <span class="token number">3387786864</span><span class="token punctuation">,</span> <span class="token number">1864873515</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1356892529</span><span class="token punctuation">,</span> <span class="token number">1662755536</span><span class="token punctuation">,</span> <span class="token number">1623461302</span><span class="token punctuation">,</span> <span class="token number">1925037502</span><span class="token punctuation">,</span> <span class="token number">1878096790</span><span class="token punctuation">,</span> <span class="token number">3682248450</span><span class="token punctuation">,</span> <span class="token number">2359635297</span><span class="token punctuation">,</span> <span class="token number">1558718627</span><span class="token punctuation">,</span> <span class="token number">116402105</span><span class="token punctuation">,</span> <span class="token number">3274502275</span><span class="token punctuation">,</span> <span class="token number">2436185635</span><span class="token punctuation">,</span> <span class="token number">771708011</span><span class="token punctuation">,</span> <span class="token number">3484140889</span><span class="token punctuation">,</span> <span class="token number">3264299013</span><span class="token punctuation">,</span> <span class="token number">885210310</span><span class="token punctuation">,</span> <span class="token number">4225779256</span><span class="token punctuation">,</span> <span class="token number">363129056</span><span class="token punctuation">,</span> <span class="token number">2488388413</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2636035482</span><span class="token punctuation">,</span> <span class="token number">4140705532</span><span class="token punctuation">,</span> <span class="token number">3187647213</span><span class="token punctuation">,</span> <span class="token number">4009585502</span><span class="token punctuation">,</span> <span class="token number">351132201</span><span class="token punctuation">,</span> <span class="token number">2592096589</span><span class="token punctuation">,</span> <span class="token number">3785703396</span><span class="token punctuation">,</span> <span class="token number">750115519</span><span class="token punctuation">,</span> <span class="token number">3632692007</span><span class="token punctuation">,</span> <span class="token number">3936675924</span><span class="token punctuation">,</span> <span class="token number">3635400895</span><span class="token punctuation">,</span> <span class="token number">3257019719</span><span class="token punctuation">,</span> <span class="token number">1928767495</span><span class="token punctuation">,</span> <span class="token number">2868979203</span><span class="token punctuation">,</span> <span class="token number">622850989</span><span class="token punctuation">,</span> <span class="token number">3165580000</span><span class="token punctuation">,</span> <span class="token number">4162276629</span><span class="token punctuation">,</span> <span class="token number">4157491019</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1272163411</span><span class="token punctuation">,</span> <span class="token number">1251211247</span><span class="token punctuation">,</span> <span class="token number">357523138</span><span class="token punctuation">,</span> <span class="token number">1233981097</span><span class="token punctuation">,</span> <span class="token number">1855287284</span><span class="token punctuation">,</span> <span class="token number">4079018167</span><span class="token punctuation">,</span> <span class="token number">4028466297</span><span class="token punctuation">,</span> <span class="token number">92214478</span><span class="token punctuation">,</span> <span class="token number">4290550648</span><span class="token punctuation">,</span> <span class="token number">648034817</span><span class="token punctuation">,</span> <span class="token number">1247795256</span><span class="token punctuation">,</span> <span class="token number">3928945157</span><span class="token punctuation">,</span> <span class="token number">1199659871</span><span class="token punctuation">,</span> <span class="token number">397659647</span><span class="token punctuation">,</span> <span class="token number">3360313830</span><span class="token punctuation">,</span> <span class="token number">561558927</span><span class="token punctuation">,</span> <span class="token number">3446409788</span><span class="token punctuation">,</span> <span class="token number">2727008359</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1470343419</span><span class="token punctuation">,</span> <span class="token number">3861411785</span><span class="token punctuation">,</span> <span class="token number">953425729</span><span class="token punctuation">,</span> <span class="token number">65811127</span><span class="token punctuation">,</span> <span class="token number">458070615</span><span class="token punctuation">,</span> <span class="token number">1428470215</span><span class="token punctuation">,</span> <span class="token number">3101427357</span><span class="token punctuation">,</span> <span class="token number">1137845714</span><span class="token punctuation">,</span> <span class="token number">1980562597</span><span class="token punctuation">,</span> <span class="token number">4120983895</span><span class="token punctuation">,</span> <span class="token number">45901583</span><span class="token punctuation">,</span> <span class="token number">2869582150</span><span class="token punctuation">,</span> <span class="token number">427949409</span><span class="token punctuation">,</span> <span class="token number">3025588000</span><span class="token punctuation">,</span> <span class="token number">3231450975</span><span class="token punctuation">,</span> <span class="token number">3313818165</span><span class="token punctuation">,</span> <span class="token number">4015642368</span><span class="token punctuation">,</span> <span class="token number">3197557747</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2452385340</span><span class="token punctuation">,</span> <span class="token number">111636796</span><span class="token punctuation">,</span> <span class="token number">897282198</span><span class="token punctuation">,</span> <span class="token number">4273652805</span><span class="token punctuation">,</span> <span class="token number">1223518692</span><span class="token punctuation">,</span> <span class="token number">3680320805</span><span class="token punctuation">,</span> <span class="token number">2771040109</span><span class="token punctuation">,</span> <span class="token number">3617506402</span><span class="token punctuation">,</span> <span class="token number">3904690320</span><span class="token punctuation">,</span> <span class="token number">77507239</span><span class="token punctuation">,</span> <span class="token number">3010900929</span><span class="token punctuation">,</span> <span class="token number">4099608062</span><span class="token punctuation">,</span> <span class="token number">546322994</span><span class="token punctuation">,</span> <span class="token number">1084929138</span><span class="token punctuation">,</span> <span class="token number">902220733</span><span class="token punctuation">,</span> <span class="token number">4054312795</span><span class="token punctuation">,</span> <span class="token number">1977510945</span><span class="token punctuation">,</span> <span class="token number">735973665</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3729015155</span><span class="token punctuation">,</span> <span class="token number">3027108070</span><span class="token punctuation">,</span> <span class="token number">1442633554</span><span class="token punctuation">,</span> <span class="token number">1949455360</span><span class="token punctuation">,</span> <span class="token number">2864504565</span><span class="token punctuation">,</span> <span class="token number">3673543865</span><span class="token punctuation">,</span> <span class="token number">446663703</span><span class="token punctuation">,</span> <span class="token number">3515816196</span><span class="token punctuation">,</span> <span class="token number">1468441462</span><span class="token punctuation">,</span> <span class="token number">897770414</span><span class="token punctuation">,</span> <span class="token number">2831043012</span><span class="token punctuation">,</span> <span class="token number">707874506</span><span class="token punctuation">,</span> <span class="token number">1098228471</span><span class="token punctuation">,</span> <span class="token number">1225077381</span><span class="token punctuation">,</span> <span class="token number">3622448809</span><span class="token punctuation">,</span> <span class="token number">2409995597</span><span class="token punctuation">,</span> <span class="token number">3847055008</span><span class="token punctuation">,</span> <span class="token number">1887507220</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1839061542</span><span class="token punctuation">,</span> <span class="token number">1963345926</span><span class="token punctuation">,</span> <span class="token number">2600100988</span><span class="token punctuation">,</span> <span class="token number">1703502633</span><span class="token punctuation">,</span> <span class="token number">1824193082</span><span class="token punctuation">,</span> <span class="token number">3595102755</span><span class="token punctuation">,</span> <span class="token number">2558488861</span><span class="token punctuation">,</span> <span class="token number">2440526309</span><span class="token punctuation">,</span> <span class="token number">3909166109</span><span class="token punctuation">,</span> <span class="token number">1611135411</span><span class="token punctuation">,</span> <span class="token number">2809397519</span><span class="token punctuation">,</span> <span class="token number">1019893656</span><span class="token punctuation">,</span> <span class="token number">3281060225</span><span class="token punctuation">,</span> <span class="token number">2387778214</span><span class="token punctuation">,</span> <span class="token number">2460059811</span><span class="token punctuation">,</span> <span class="token number">198824620</span><span class="token punctuation">,</span> <span class="token number">1645102665</span><span class="token punctuation">,</span> <span class="token number">865289621</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">224442296</span><span class="token punctuation">,</span> <span class="token number">3009601747</span><span class="token punctuation">,</span> <span class="token number">3066701924</span><span class="token punctuation">,</span> <span class="token number">1774879140</span><span class="token punctuation">,</span> <span class="token number">880620935</span><span class="token punctuation">,</span> <span class="token number">2676353545</span><span class="token punctuation">,</span> <span class="token number">3748945463</span><span class="token punctuation">,</span> <span class="token number">1994930827</span><span class="token punctuation">,</span> <span class="token number">75275710</span><span class="token punctuation">,</span> <span class="token number">3710375437</span><span class="token punctuation">,</span> <span class="token number">4132497729</span><span class="token punctuation">,</span> <span class="token number">3010711783</span><span class="token punctuation">,</span> <span class="token number">3731895534</span><span class="token punctuation">,</span> <span class="token number">2434590580</span><span class="token punctuation">,</span> <span class="token number">3409701141</span><span class="token punctuation">,</span> <span class="token number">2209951200</span><span class="token punctuation">,</span> <span class="token number">995511645</span><span class="token punctuation">,</span> <span class="token number">3571299495</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2337737600</span><span class="token punctuation">,</span> <span class="token number">110982073</span><span class="token punctuation">,</span> <span class="token number">2985129643</span><span class="token punctuation">,</span> <span class="token number">1668549189</span><span class="token punctuation">,</span> <span class="token number">3298468029</span><span class="token punctuation">,</span> <span class="token number">698015588</span><span class="token punctuation">,</span> <span class="token number">2945584297</span><span class="token punctuation">,</span> <span class="token number">1036821195</span><span class="token punctuation">,</span> <span class="token number">4249059927</span><span class="token punctuation">,</span> <span class="token number">3384611421</span><span class="token punctuation">,</span> <span class="token number">3304378629</span><span class="token punctuation">,</span> <span class="token number">1307957989</span><span class="token punctuation">,</span> <span class="token number">602821252</span><span class="token punctuation">,</span> <span class="token number">184198726</span><span class="token punctuation">,</span> <span class="token number">1182960059</span><span class="token punctuation">,</span> <span class="token number">4200496073</span><span class="token punctuation">,</span> <span class="token number">1562699893</span><span class="token punctuation">,</span> <span class="token number">3320841302</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">5866561</span><span class="token punctuation">,</span> <span class="token number">2442649482</span><span class="token punctuation">,</span> <span class="token number">479821282</span><span class="token punctuation">,</span> <span class="token number">2687097642</span><span class="token punctuation">,</span> <span class="token number">3347828225</span><span class="token punctuation">,</span> <span class="token number">1876332308</span><span class="token punctuation">,</span> <span class="token number">2704295851</span><span class="token punctuation">,</span> <span class="token number">2952277070</span><span class="token punctuation">,</span> <span class="token number">1803967244</span><span class="token punctuation">,</span> <span class="token number">2837783916</span><span class="token punctuation">,</span> <span class="token number">658984547</span><span class="token punctuation">,</span> <span class="token number">3605604364</span><span class="token punctuation">,</span> <span class="token number">1931924322</span><span class="token punctuation">,</span> <span class="token number">3285319978</span><span class="token punctuation">,</span> <span class="token number">556150900</span><span class="token punctuation">,</span> <span class="token number">3795666798</span><span class="token punctuation">,</span> <span class="token number">261321502</span><span class="token punctuation">,</span> <span class="token number">1040433381</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3855222954</span><span class="token punctuation">,</span> <span class="token number">3565522064</span><span class="token punctuation">,</span> <span class="token number">1841853882</span><span class="token punctuation">,</span> <span class="token number">1066304362</span><span class="token punctuation">,</span> <span class="token number">3552076734</span><span class="token punctuation">,</span> <span class="token number">3075952725</span><span class="token punctuation">,</span> <span class="token number">2193242436</span><span class="token punctuation">,</span> <span class="token number">2052898568</span><span class="token punctuation">,</span> <span class="token number">2341179777</span><span class="token punctuation">,</span> <span class="token number">3089412493</span><span class="token punctuation">,</span> <span class="token number">165812889</span><span class="token punctuation">,</span> <span class="token number">4196290126</span><span class="token punctuation">,</span> <span class="token number">3568567671</span><span class="token punctuation">,</span> <span class="token number">28097161</span><span class="token punctuation">,</span> <span class="token number">2249543862</span><span class="token punctuation">,</span> <span class="token number">1251207418</span><span class="token punctuation">,</span> <span class="token number">522526590</span><span class="token punctuation">,</span> <span class="token number">765541973</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1801734077</span><span class="token punctuation">,</span> <span class="token number">2132230169</span><span class="token punctuation">,</span> <span class="token number">667823776</span><span class="token punctuation">,</span> <span class="token number">3900096345</span><span class="token punctuation">,</span> <span class="token number">3119630138</span><span class="token punctuation">,</span> <span class="token number">3620542178</span><span class="token punctuation">,</span> <span class="token number">2900630754</span><span class="token punctuation">,</span> <span class="token number">30811433</span><span class="token punctuation">,</span> <span class="token number">608818254</span><span class="token punctuation">,</span> <span class="token number">1040662178</span><span class="token punctuation">,</span> <span class="token number">900811411</span><span class="token punctuation">,</span> <span class="token number">3221833258</span><span class="token punctuation">,</span> <span class="token number">43598995</span><span class="token punctuation">,</span> <span class="token number">1818995893</span><span class="token punctuation">,</span> <span class="token number">2718507668</span><span class="token punctuation">,</span> <span class="token number">3445138445</span><span class="token punctuation">,</span> <span class="token number">3217962572</span><span class="token punctuation">,</span> <span class="token number">1437902734</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1812768224</span><span class="token punctuation">,</span> <span class="token number">392114567</span><span class="token punctuation">,</span> <span class="token number">2694519859</span><span class="token punctuation">,</span> <span class="token number">1941199322</span><span class="token punctuation">,</span> <span class="token number">2523549731</span><span class="token punctuation">,</span> <span class="token number">2078453798</span><span class="token punctuation">,</span> <span class="token number">851734499</span><span class="token punctuation">,</span> <span class="token number">2376090593</span><span class="token punctuation">,</span> <span class="token number">2069375610</span><span class="token punctuation">,</span> <span class="token number">4084690114</span><span class="token punctuation">,</span> <span class="token number">246441363</span><span class="token punctuation">,</span> <span class="token number">4154699271</span><span class="token punctuation">,</span> <span class="token number">58451971</span><span class="token punctuation">,</span> <span class="token number">31806021</span><span class="token punctuation">,</span> <span class="token number">4158724930</span><span class="token punctuation">,</span> <span class="token number">2741293247</span><span class="token punctuation">,</span> <span class="token number">3230803936</span><span class="token punctuation">,</span> <span class="token number">2790505999</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3906342775</span><span class="token punctuation">,</span> <span class="token number">2231570871</span><span class="token punctuation">,</span> <span class="token number">1258998901</span><span class="token punctuation">,</span> <span class="token number">1517292578</span><span class="token punctuation">,</span> <span class="token number">162889239</span><span class="token punctuation">,</span> <span class="token number">3130741176</span><span class="token punctuation">,</span> <span class="token number">3925266771</span><span class="token punctuation">,</span> <span class="token number">1780222960</span><span class="token punctuation">,</span> <span class="token number">2378568279</span><span class="token punctuation">,</span> <span class="token number">3873144834</span><span class="token punctuation">,</span> <span class="token number">1597459529</span><span class="token punctuation">,</span> <span class="token number">1581197809</span><span class="token punctuation">,</span> <span class="token number">4101706041</span><span class="token punctuation">,</span> <span class="token number">196019642</span><span class="token punctuation">,</span> <span class="token number">1439141586</span><span class="token punctuation">,</span> <span class="token number">587446072</span><span class="token punctuation">,</span> <span class="token number">2012673288</span><span class="token punctuation">,</span> <span class="token number">1280875335</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">4058452685</span><span class="token punctuation">,</span> <span class="token number">653145648</span><span class="token punctuation">,</span> <span class="token number">553051697</span><span class="token punctuation">,</span> <span class="token number">1406542226</span><span class="token punctuation">,</span> <span class="token number">4053722203</span><span class="token punctuation">,</span> <span class="token number">994470045</span><span class="token punctuation">,</span> <span class="token number">2066358582</span><span class="token punctuation">,</span> <span class="token number">3919235908</span><span class="token punctuation">,</span> <span class="token number">2315900402</span><span class="token punctuation">,</span> <span class="token number">3236350874</span><span class="token punctuation">,</span> <span class="token number">172880690</span><span class="token punctuation">,</span> <span class="token number">3104147616</span><span class="token punctuation">,</span> <span class="token number">489606166</span><span class="token punctuation">,</span> <span class="token number">3898059157</span><span class="token punctuation">,</span> <span class="token number">200469827</span><span class="token punctuation">,</span> <span class="token number">665789663</span><span class="token punctuation">,</span> <span class="token number">3116633449</span><span class="token punctuation">,</span> <span class="token number">4137295625</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1460624254</span><span class="token punctuation">,</span> <span class="token number">4286673320</span><span class="token punctuation">,</span> <span class="token number">2664109800</span><span class="token punctuation">,</span> <span class="token number">1995979611</span><span class="token punctuation">,</span> <span class="token number">4091742681</span><span class="token punctuation">,</span> <span class="token number">2639530247</span><span class="token punctuation">,</span> <span class="token number">4240681440</span><span class="token punctuation">,</span> <span class="token number">2169059390</span><span class="token punctuation">,</span> <span class="token number">1149325301</span><span class="token punctuation">,</span> <span class="token number">3139578541</span><span class="token punctuation">,</span> <span class="token number">2320870639</span><span class="token punctuation">,</span> <span class="token number">3148999826</span><span class="token punctuation">,</span> <span class="token number">4095173534</span><span class="token punctuation">,</span> <span class="token number">2742698014</span><span class="token punctuation">,</span> <span class="token number">3623896968</span><span class="token punctuation">,</span> <span class="token number">2444601912</span><span class="token punctuation">,</span> <span class="token number">1958855100</span><span class="token punctuation">,</span> <span class="token number">1743268893</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2187625371</span><span class="token punctuation">,</span> <span class="token number">3533912845</span><span class="token punctuation">,</span> <span class="token number">29086928</span><span class="token punctuation">,</span> <span class="token number">543325588</span><span class="token punctuation">,</span> <span class="token number">4247300963</span><span class="token punctuation">,</span> <span class="token number">1972139209</span><span class="token punctuation">,</span> <span class="token number">272152499</span><span class="token punctuation">,</span> <span class="token number">4276082595</span><span class="token punctuation">,</span> <span class="token number">3680551759</span><span class="token punctuation">,</span> <span class="token number">1835350157</span><span class="token punctuation">,</span> <span class="token number">3921757922</span><span class="token punctuation">,</span> <span class="token number">2716774439</span><span class="token punctuation">,</span> <span class="token number">1070751202</span><span class="token punctuation">,</span> <span class="token number">69990939</span><span class="token punctuation">,</span> <span class="token number">3794506838</span><span class="token punctuation">,</span> <span class="token number">699803423</span><span class="token punctuation">,</span> <span class="token number">3699976889</span><span class="token punctuation">,</span> <span class="token number">40791189</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">539106994</span><span class="token punctuation">,</span> <span class="token number">1670272368</span><span class="token punctuation">,</span> <span class="token number">3483599225</span><span class="token punctuation">,</span> <span class="token number">2867955550</span><span class="token punctuation">,</span> <span class="token number">2207694005</span><span class="token punctuation">,</span> <span class="token number">1126950203</span><span class="token punctuation">,</span> <span class="token number">693920921</span><span class="token punctuation">,</span> <span class="token number">2333328675</span><span class="token punctuation">,</span> <span class="token number">539234245</span><span class="token punctuation">,</span> <span class="token number">1961438796</span><span class="token punctuation">,</span> <span class="token number">3126390464</span><span class="token punctuation">,</span> <span class="token number">1118759587</span><span class="token punctuation">,</span> <span class="token number">59715473</span><span class="token punctuation">,</span> <span class="token number">1450076492</span><span class="token punctuation">,</span> <span class="token number">4101732655</span><span class="token punctuation">,</span> <span class="token number">3658733365</span><span class="token punctuation">,</span> <span class="token number">940858890</span><span class="token punctuation">,</span> <span class="token number">1262671744</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3092624332</span><span class="token punctuation">,</span> <span class="token number">2175813516</span><span class="token punctuation">,</span> <span class="token number">3355101899</span><span class="token punctuation">,</span> <span class="token number">3657267135</span><span class="token punctuation">,</span> <span class="token number">770650398</span><span class="token punctuation">,</span> <span class="token number">359506155</span><span class="token punctuation">,</span> <span class="token number">4149470178</span><span class="token punctuation">,</span> <span class="token number">3763654751</span><span class="token punctuation">,</span> <span class="token number">1184381886</span><span class="token punctuation">,</span> <span class="token number">942048015</span><span class="token punctuation">,</span> <span class="token number">523057971</span><span class="token punctuation">,</span> <span class="token number">1098635956</span><span class="token punctuation">,</span> <span class="token number">1732951811</span><span class="token punctuation">,</span> <span class="token number">150067724</span><span class="token punctuation">,</span> <span class="token number">2417766207</span><span class="token punctuation">,</span> <span class="token number">4152571821</span><span class="token punctuation">,</span> <span class="token number">2759971924</span><span class="token punctuation">,</span> <span class="token number">4284842765</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3336022203</span><span class="token punctuation">,</span> <span class="token number">2569311431</span><span class="token punctuation">,</span> <span class="token number">2752777107</span><span class="token punctuation">,</span> <span class="token number">1441977867</span><span class="token punctuation">,</span> <span class="token number">1279003682</span><span class="token punctuation">,</span> <span class="token number">3861567631</span><span class="token punctuation">,</span> <span class="token number">1064716472</span><span class="token punctuation">,</span> <span class="token number">3046493996</span><span class="token punctuation">,</span> <span class="token number">1339401643</span><span class="token punctuation">,</span> <span class="token number">39466446</span><span class="token punctuation">,</span> <span class="token number">1464905290</span><span class="token punctuation">,</span> <span class="token number">420733872</span><span class="token punctuation">,</span> <span class="token number">2057911345</span><span class="token punctuation">,</span> <span class="token number">2418624800</span><span class="token punctuation">,</span> <span class="token number">2193625430</span><span class="token punctuation">,</span> <span class="token number">1558527155</span><span class="token punctuation">,</span> <span class="token number">4224908000</span><span class="token punctuation">,</span> <span class="token number">207684355</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2681129718</span><span class="token punctuation">,</span> <span class="token number">4210889596</span><span class="token punctuation">,</span> <span class="token number">4051161171</span><span class="token punctuation">,</span> <span class="token number">3131196482</span><span class="token punctuation">,</span> <span class="token number">1128312875</span><span class="token punctuation">,</span> <span class="token number">938670840</span><span class="token punctuation">,</span> <span class="token number">2828563599</span><span class="token punctuation">,</span> <span class="token number">3078146488</span><span class="token punctuation">,</span> <span class="token number">1102989364</span><span class="token punctuation">,</span> <span class="token number">3557724304</span><span class="token punctuation">,</span> <span class="token number">156013303</span><span class="token punctuation">,</span> <span class="token number">2371355565</span><span class="token punctuation">,</span> <span class="token number">3608679353</span><span class="token punctuation">,</span> <span class="token number">3513837899</span><span class="token punctuation">,</span> <span class="token number">155622460</span><span class="token punctuation">,</span> <span class="token number">396656112</span><span class="token punctuation">,</span> <span class="token number">2493417457</span><span class="token punctuation">,</span> <span class="token number">876296360</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3135876409</span><span class="token punctuation">,</span> <span class="token number">181875076</span><span class="token punctuation">,</span> <span class="token number">3662181650</span><span class="token punctuation">,</span> <span class="token number">3851859805</span><span class="token punctuation">,</span> <span class="token number">3626146919</span><span class="token punctuation">,</span> <span class="token number">90441351</span><span class="token punctuation">,</span> <span class="token number">1944988720</span><span class="token punctuation">,</span> <span class="token number">585429580</span><span class="token punctuation">,</span> <span class="token number">3158268550</span><span class="token punctuation">,</span> <span class="token number">1399100291</span><span class="token punctuation">,</span> <span class="token number">3688843295</span><span class="token punctuation">,</span> <span class="token number">2851190</span><span class="token punctuation">,</span> <span class="token number">2670576474</span><span class="token punctuation">,</span> <span class="token number">3177735154</span><span class="token punctuation">,</span> <span class="token number">3479499727</span><span class="token punctuation">,</span> <span class="token number">197376977</span><span class="token punctuation">,</span> <span class="token number">1790622954</span><span class="token punctuation">,</span> <span class="token number">2393956089</span><span class="token punctuation">]</span><span class="token punctuation">]</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> key<span class="token punctuation">:</span>    data <span class="token operator">+=</span> itt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token punctuation">(</span>rand3<span class="token operator">>></span><span class="token punctuation">(</span><span class="token number">32</span><span class="token operator">*</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xffffffff</span>    tt<span class="token punctuation">.</span>append<span class="token punctuation">(</span>a<span class="token punctuation">)</span>cipher <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token number">30083187577212262718109298947838809672</span><span class="token punctuation">)</span>level5_q <span class="token operator">=</span> <span class="token number">8969855733022131749661461631941829558599804649974054961356887065914210362150413862237851758018323719639766908084483692197684733902511290572485794820181091</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> p1<span class="token operator">-</span>rand1_start<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> q1<span class="token operator">-</span>rand2_start<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rand_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0xa603be43</span><span class="token operator">+</span>i<span class="token punctuation">,</span> <span class="token number">0x596ff11a</span><span class="token punctuation">,</span> <span class="token number">0x47b09412</span><span class="token punctuation">,</span> <span class="token number">0x6af83ebf</span><span class="token operator">+</span>j<span class="token punctuation">,</span> <span class="token number">0xff12cba2</span><span class="token punctuation">,</span><span class="token number">0xd00ee4fd</span><span class="token punctuation">]</span>        <span class="token comment">#rand_list</span>        rand_list <span class="token operator">+=</span> tt        rand_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span>rand4<span class="token punctuation">)</span>        rand_list <span class="token operator">+=</span> data        <span class="token comment">#print(len(rand_list))</span>        g <span class="token operator">=</span> clone_mt<span class="token punctuation">(</span>rand_list<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">624</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">624</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            g<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        aes_key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>g<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        a <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>aes_key<span class="token punctuation">,</span>AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>        msg <span class="token operator">=</span> a<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">b"_"</span> <span class="token keyword">in</span> msg <span class="token keyword">and</span> <span class="token string">b"."</span> <span class="token keyword">in</span> msg<span class="token punctuation">:</span>            <span class="token keyword">print</span> <span class="token punctuation">(</span>msg<span class="token punctuation">)</span>            g_val <span class="token operator">=</span> g<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>level5_q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            x_val <span class="token operator">=</span> g<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>level5_q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            y_val <span class="token operator">=</span> g<span class="token punctuation">.</span>randrange<span class="token punctuation">(</span>level5_q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>x_val<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>y_val<span class="token punctuation">)</span>            <span class="token comment">#print(g.randrange(level5_q-1))</span>            exit<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment">#print(rand_list)</span><span class="token comment"># No.777_hack_road</span></code></pre><h3 id="stage5"><a href="#stage5" class="headerlink" title="stage5"></a>stage5</h3><p>通过encrypt4的结果，可以预测出x和y，直接求逆元</p><pre class="language-python" data-language="python"><code class="language-python">q <span class="token operator">=</span> <span class="token number">10633907791737940618251181242781657501421066561498924963325211137527914761294120366839373944631586742065134364371088754330142268137893939163058957321576561</span>g <span class="token operator">=</span> <span class="token number">8720814254745089777252083344348851268520692318828030452122549926748859741402125799736178655620806485161358327515735405190921467358304697344848268434382637</span>h <span class="token operator">=</span> <span class="token number">216104228861939108659993238797563154032915211504674449037936765120276850117374086975724449214309729354051557008730636227236538575874972134049994788523813</span>c1 <span class="token operator">=</span> <span class="token number">7817920260306785410429732536522063841014966012571136751203203255948059437849813558135804344666976405241078856792098062469662771961521371324108084300684264</span>c2 <span class="token operator">=</span> <span class="token number">1481745904444589773553565664060921310797602864298274327867977946855979227560424911012281403108577341726903090365418372162573660146505537528621522795919444</span>x <span class="token operator">=</span> <span class="token number">9822319831145639889399192873724927105364592110824181727353156671381463280159058437888977193488677536845463844419172111367153742079974570210756921507694749</span>y <span class="token operator">=</span> <span class="token number">10544310008565707953300017333140586669346866310149394258835632607185373394755336326688614571016325718052311732879807687887700577256797156198372049034609748</span>s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>x<span class="token operator">*</span>y<span class="token punctuation">,</span>q<span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>s<span class="token punctuation">,</span> q<span class="token punctuation">)</span>school <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>c2<span class="token operator">*</span>d <span class="token operator">%</span> q<span class="token punctuation">)</span></code></pre><h2 id="signin"><a href="#signin" class="headerlink" title="signin"></a>signin</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flagp <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qe <span class="token operator">=</span> <span class="token number">0x10001</span>x <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">^</span> q<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">400</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"x = "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''c = 63488316931652165283768913693816254792896563414188573961010693330775143775030913217280890394659049814570506800869658798199766919279796699387348933980902437475407321186495972207055265266498997713893677789253948774459839170286422387924339017064620132596766605191433871936998603329570606903349148944177923042129e = 65537n = 96718802331928486399440471324839538140537235267473988763367174256395151407905179947160991624325793272001609865770400579479699246848732420404657206862379932460142346799183080432865152364837341193526953437531245191267443260742413602677075914430257485504145532873739572516607058139153045169040886155418058016911x = 463242922872367824870065968430782963359186990291269168445088582686817098312265100478236517597115371129636612590922320350'''</span></code></pre><p>从低位开始爆p和q，然后coppersmith恢复完整p</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">def</span> <span class="token function">partial_p</span><span class="token punctuation">(</span>p0<span class="token punctuation">,</span> kbits<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>  PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>  f <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x <span class="token operator">+</span> p0  f <span class="token operator">=</span> f<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>  roots <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.3</span><span class="token punctuation">)</span>  <span class="token keyword">if</span> roots<span class="token punctuation">:</span>    x0 <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> p <span class="token operator">=</span> gcd<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token operator">*</span>x0 <span class="token operator">+</span> p0<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">return</span> ZZ<span class="token punctuation">(</span>p<span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token number">10596436316702975331757245462986198885301724048262518406484407333732479367281391721838409014300075432774547867593888041793907018506284214898432640973347078422928998238442248280691301186797140197558662739254993848349695033133188448729071498559155478959476706983817882517886102203599090653816022071957312164735</span>e <span class="token operator">=</span> <span class="token number">65537</span>n<span class="token operator">=</span><span class="token number">8155990545235762305942964668342247736295216728266368540195169506979295314955050891505710001565324688518869552158352973775125495489356670253131336576193297430372996733167117860614537929385674351385426263721446579053403377365996744019246235251434285658196966440781084168142352073493973147145455064635516373317</span>x<span class="token operator">=</span><span class="token number">544528274874907263426386536858394514838784460789819080620775891616788086097329057778520781763108994646626718779325717092</span><span class="token keyword">class</span> <span class="token class-name">Solver</span><span class="token punctuation">:</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>x <span class="token operator">=</span> x    self<span class="token punctuation">.</span>n <span class="token operator">=</span> n    self<span class="token punctuation">.</span>pq <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment"># print(bin((p * q) &amp; (2*b-1)))</span><span class="token comment"># print(bin(n &amp; (2*b-1)))</span><span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token operator">*</span> q<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> n <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>b<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>pq<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">for</span> shift <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>b <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> shiftpq<span class="token punctuation">,</span> self<span class="token punctuation">.</span>pq <span class="token operator">=</span> self<span class="token punctuation">.</span>pq<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> p<span class="token punctuation">,</span> q <span class="token keyword">in</span> pq<span class="token punctuation">:</span><span class="token keyword">if</span> self<span class="token punctuation">.</span>x <span class="token operator">&amp;</span> b<span class="token punctuation">:</span>self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>b<span class="token punctuation">,</span> p <span class="token operator">|</span> b<span class="token punctuation">,</span> q<span class="token punctuation">)</span>self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q <span class="token operator">|</span> b<span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>b<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>self<span class="token punctuation">.</span>add<span class="token punctuation">(</span>b<span class="token punctuation">,</span> p <span class="token operator">|</span> b<span class="token punctuation">,</span> q <span class="token operator">|</span> b<span class="token punctuation">)</span><span class="token keyword">return</span> self<span class="token punctuation">.</span>pq<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>  solver <span class="token operator">=</span> Solver<span class="token punctuation">(</span>x<span class="token punctuation">,</span>n<span class="token punctuation">)</span>  pqs <span class="token operator">=</span> solver<span class="token punctuation">.</span>solve<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token keyword">for</span> pq <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>pqs<span class="token punctuation">)</span><span class="token punctuation">:</span>    p0 <span class="token operator">=</span> ZZ<span class="token punctuation">(</span>pq<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> partial_p<span class="token punctuation">(</span>p0<span class="token punctuation">,</span> <span class="token number">400</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">if</span> p <span class="token keyword">and</span> p <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> pp <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token keyword">not</span> p<span class="token punctuation">:</span>  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'WTF'</span><span class="token punctuation">)</span>  exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> q <span class="token operator">=</span> n<span class="token operator">//</span>pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> m <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h1 id="长城杯"><a href="#长城杯" class="headerlink" title="长城杯"></a>长城杯</h1><h2 id="baby-rsa"><a href="#baby-rsa" class="headerlink" title="baby_rsa"></a>baby_rsa</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token punctuation">,</span> v1<span class="token punctuation">,</span> v2<span class="token punctuation">,</span> m1<span class="token punctuation">,</span> m2<span class="token keyword">def</span> <span class="token function">enc_1</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>v1<span class="token punctuation">,</span> <span class="token punctuation">(</span>m1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>v2<span class="token punctuation">,</span> <span class="token punctuation">(</span>m2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m2<span class="token punctuation">)</span>    <span class="token keyword">assert</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span>        p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2048</span> <span class="token keyword">and</span> q <span class="token operator">&lt;</span> p <span class="token operator">&lt;</span> q <span class="token operator">&lt;&lt;</span> <span class="token number">3</span>    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> <span class="token number">0x10001</span><span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">enc_2</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> val<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">512</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        fac <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>fac<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>fac<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            n <span class="token operator">=</span> fac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>fac<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>fac<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>fac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>fac<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>fac<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>val<span class="token punctuation">,</span> <span class="token number">0x10001</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>fac<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>fac<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>fac<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">b'flag&#123;'</span>    plain1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    plain2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>enc_1<span class="token punctuation">(</span>plain1<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>enc_2<span class="token punctuation">(</span>plain2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''15808773921165746378224649554032774095198531782455904169552223303513940968292896814159288417499220739875833754573943607047855256739976161598599903932981169979509871591999964856806929597805904134099901826858367778386342376768508031554802249075072366710038889306268806744179086648684738023073458982906066972340414398928411147970593935244077925448732772473619783079328351522269170879807064111318871074291073581343039389561175391039766936376267875184581643335916049461784753341115227515163545709454746272514827000601853735356551495685229995637483506735448900656885365353434308639412035003119516693303377081576975540948311(40625981017250262945230548450738951725566520252163410124565622126754739693681271649127104109038164852787767296403697462475459670540845822150397639923013223102912674748402427501588018866490878394678482061561521253365550029075565507988232729032055298992792712574569704846075514624824654127691743944112075703814043622599530496100713378696761879982542679917631570451072107893348792817321652593471794974227183476732980623835483991067080345184978482191342430627490398516912714451984152960348899589532751919272583098764118161056078536781341750142553197082925070730178092561314400518151019955104989790911460357848366016263083, 43001726046955078981344016981790445980199072066019323382068244142888931539602812318023095256474939697257802646150348546779647545152288158607555239302887689137645748628421247685225463346118081238718049701320726295435376733215681415774255258419418661466010403928591242961434178730846537471236142683517399109466429776377360118355173431016107543977241358064093102741819626163467139833352454094472229349598479358367203452452606833796483111892076343745958394932132199442718048720633556310467019222434693785423996656306612262714609076119634814783438111843773649519101169326072793596027594057988365133037041133566146897868269, 39796272592331896400626784951713239526857273168732133046667572399622660330587881579319314094557011554851873068389016629085963086136116425352535902598378739)'''</span></code></pre><p>爆破v,m解flag1，最后⼀个因⼦不⼩于513位，⽽flag2⼩于512位，分解最后⼀个因⼦，按rsa解密得到flag2</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>c<span class="token operator">=</span><span class="token number">158087739211657463782246495540327740951985317824559041695522233035139409682928968141592884174</span><span class="token number">99220739875833754573943607047855256739976161598599903932981169979509871591999964856806929597805</span><span class="token number">90413409990182685836777838634237676850803155480224907507236671003888930626880674417908664868473</span><span class="token number">80230734589829060669723404143989284111479705939352440779254487327724736197830793283515222691708</span><span class="token number">79807064111318871074291073581343039389561175391039766936376267875184581643335916049461784753341</span><span class="token number">11522751516354570945474627251482700060185373535655149568522999563748350673544890065688536535343</span><span class="token number">4308639412035003119516693303377081576975540948311</span><span class="token keyword">for</span> m <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> v<span class="token operator">=</span><span class="token number">2</span> p<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token keyword">while</span> p<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">&lt;=</span><span class="token number">1024</span><span class="token punctuation">:</span> <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span> d<span class="token operator">=</span>inverse<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> text<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">21</span><span class="token punctuation">:</span> <span class="token keyword">print</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span>m<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> v<span class="token operator">+=</span><span class="token number">1</span> p<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>v<span class="token punctuation">,</span> <span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>c<span class="token punctuation">,</span>n<span class="token punctuation">,</span>d<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4062598101725026294523054845073895172556652025216341012456562212675473969368127164912710410903</span><span class="token number">81648527877672964036974624754596705408458221503976399230132231029126747484024275015880188664908</span><span class="token number">78394678482061561521253365550029075565507988232729032055298992792712574569704846075514624824654</span><span class="token number">12769174394411207570381404362259953049610071337869676187998254267991763157045107210789334879281</span><span class="token number">73216525934717949742271834767329806238354839910670803451849784821913424306274903985169127144519</span><span class="token number">84152960348899589532751919272583098764118161056078536781341750142553197082925070730178092561314</span><span class="token number">400518151019955104989790911460357848366016263083</span><span class="token punctuation">,</span><span class="token number">43001726046955078981344016981790445980199072066019323382068244142888931539602812318023095256474</span><span class="token number">93969725780264615034854677964754515228815860755523930288768913764574862842124768522546334611808</span><span class="token number">12387180497013207262954353767332156814157742552584194186614660104039285912429614341787308465374</span><span class="token number">71236142683517399109466429776377360118355173431016107543977241358064093102741819626163467139833</span><span class="token number">35245409447222934959847935836720345245260683379648311189207634374595839493213219944271804872063</span><span class="token number">35563104670192224346937854239966563066122627146090761196348147834381118437736495191011693260727</span><span class="token number">93596027594057988365133037041133566146897868269</span><span class="token punctuation">,</span><span class="token number">39796272592331896400626784951713239526857273168732133046667572399622660330587881579319314094557</span><span class="token number">011554851873068389016629085963086136116425352535902598378739</span><span class="token punctuation">)</span>p<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">191</span><span class="token punctuation">,</span><span class="token number">193</span><span class="token punctuation">,</span><span class="token number">627383</span><span class="token punctuation">,</span><span class="token number">1720754738477317127758682285465031939891059835873975157555031327070111123628789</span><span class="token number">833299433549669619325160679719355338187877758311485785197492710491</span><span class="token punctuation">]</span>phi<span class="token operator">=</span><span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> p<span class="token punctuation">:</span> phi<span class="token operator">*=</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token comment"># print(d)</span>dd<span class="token operator">=</span>inverse<span class="token punctuation">(</span><span class="token number">0x10001</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>dd<span class="token punctuation">,</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h1 id="DAS九月赛"><a href="#DAS九月赛" class="headerlink" title="DAS九月赛"></a>DAS九月赛</h1><h2 id="签到"><a href="#签到" class="headerlink" title="签到"></a>签到</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> randomflag<span class="token operator">=</span><span class="token string">b'flag&#123;******************&#125;'</span>n <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">256</span>flaglong<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>m <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token number">1</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> flaglong<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'m = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># m = 73964803637492582853353338913523546944627084372081477892312545091623069227301</span><span class="token comment"># c = 21572244511100216966799370397791432119463715616349800194229377843045443048821</span></code></pre><p>离散对数</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>m <span class="token operator">=</span> <span class="token number">73964803637492582853353338913523546944627084372081477892312545091623069227301</span>c <span class="token operator">=</span> <span class="token number">21572244511100216966799370397791432119463715616349800194229377843045443048821</span>n <span class="token operator">=</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">256</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>discrete_log<span class="token punctuation">(</span>n<span class="token punctuation">,</span> c<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;DASCTF_zjut&#125;'</span></code></pre><h2 id="RSA1"><a href="#RSA1" class="headerlink" title="RSA1"></a>RSA1</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#! /usr/bin/env python</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> get_flag<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha512<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>bytes_to_long<span class="token keyword">from</span> libnum <span class="token keyword">import</span> invmod<span class="token punctuation">,</span> gcd<span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">m_exit</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span> <span class="token string">"==============Game Over!================="</span>exit<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">cal_bit</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span> l<span class="token operator">-</span><span class="token number">2</span><span class="token keyword">def</span> <span class="token function">pi_b</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>bt <span class="token operator">=</span> 536380958350616057242691418634880594502192106332317228051967064327642091297687630174183636288378234177476435270519631690543765125295554448698898712393467267006465045949611180821007306678935181142803069337672948471202242891010188677287454504933695082327796243976863378333980923047411230913909715527759877351702062345876337256220760223926254773346698839492268265110546383782370744599490250832085044856878026833181982756791595730336514399767134613980006467147592898197961789187070786602534602178082726728869941829230655559180178594489856595304902790182697751195581218334712892008282605180395912026326384913562290014629187579128041030500771670510157597682826798117937852656884106597180126028398398087318119586692935386069677459788971114075941533740462978961436933215446347246886948166247617422293043364968298176007659058279518552847235689217185712791081965260495815179909242072310545078116020998113413517429654328367707069941427368374644442366092232916196726067387582032505389946398237261580350780769275427857010543262176468343294217258086275244086292475394366278211528621216522312552812343261375050388129743012932727654986046774759567950981007877856194574274373776538888953502272879816420369255752871177234736347325263320696917012616273L<span class="token keyword">return</span> invmod<span class="token punctuation">(</span>x<span class="token punctuation">,</span> bt<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_ed</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">:</span>k <span class="token operator">=</span> cal_bit<span class="token punctuation">(</span>q<span class="token operator">*</span>p<span class="token punctuation">)</span>phi_n <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>r <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">99</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>u <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>k<span class="token operator">/</span><span class="token number">4</span> <span class="token operator">-</span> r<span class="token punctuation">)</span><span class="token keyword">if</span> gcd<span class="token punctuation">(</span>u<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token keyword">continue</span>t <span class="token operator">=</span> invmod<span class="token punctuation">(</span>u<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span>e <span class="token operator">=</span> pi_b<span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span><span class="token keyword">break</span>d <span class="token operator">=</span> invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi_n<span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token punctuation">(</span>e<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>flag <span class="token operator">=</span> get_flag<span class="token punctuation">(</span><span class="token punctuation">)</span>p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>q<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qe<span class="token punctuation">,</span> d <span class="token operator">=</span> get_ed<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"n: "</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"e: "</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>flag <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>enc_flag <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">"Your flag is: "</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>enc_flag<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>原题：HCTF2016 Crypto So Interesting</p><p>github搜到脚本：<a href="https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py">https://github.com/Hcamael/ctf-library/blob/master/RSA1/rsa1_payload.py</a></p><p>先算出e模bt的逆元是t，然后用t和n做维纳攻击的e和n算出私钥也就是u，转化为已知e和d分解n的问题，分解n得到p和q就是常规rsa了</p><p>当时的脚本没保存，现在重新拿一组数据</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> random<span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> RSAwienerHacker <span class="token keyword">import</span> <span class="token operator">*</span>e <span class="token operator">=</span> <span class="token number">0x34fe99f3d5eb3459c170f76b650d3c0812e917c4f670dcbaf2c197ada22e637a28f76965508abf327d99bb835895efa868e0efe535f43db0918d94090acb6561bfd9528fe045c8c875477bf1ff4c1c219c6ea704eecce8d69d633bcc2afd7fccdf30e2494e92f522ffed7c07f840f8aa8ae830b615bcee7e5c160505c71bce2754fee3e15bf2c1e2d0038bddb6a0f14e5207a74b2a8537c9623df80a239fba1dd91251cbeb36e5a6d01ef0decfbbc225c3440ee133aeea40f5fd218de3629246b8631abcd2444eb0c8f40b0ec6278d53a9ecc871746d2282441ab04e5fb25b2823456114572bf7ad652c5c72454a76e483c07d77e20fbe20ebcb9cc09d03b1d771163f0219c8f0c9dc467411bd1101b554c4386745e850c1367f13026fc52bc1cbfabd90a70efdd249f88e3dec4d9fd637db6ba1f76b77a4e76d7390fe9e85ac4fdada7ff077d6cce138d74ee10e91806b8641b01da4e1350164a4e0e86faa73f5bfd2ee254944978aacb03df52ef69b4caa9efed840dfc419959d4da459bd6c8809af4aaaf5f64a2070a024e34874be0576899da2354a487d3ed0d55e02c0b6d481f3f79ad62ae0c6bda3bbc0d6bbb964d221a755a2a8a5915d8769eabc9dc9efd7d576d0a567021d4402e1af6f18cf01c487ff87cb4c4549d093894a0ef5e26a9e35306a985dd0b742dd31809af4e7fd25eca15c432b4dedc84355d48e0ff5</span>c <span class="token operator">=</span> <span class="token number">0xa9b3e83be02e4dd87c58f8b85266387e15ce551649451797bc4422adb6b90e3daaaea1aab41ca9900bc1b2a6fc3de35f5c1631ffd8252a5490ad0767647aa4cea802428e5efc0db76076e0cd30b695bef7e7cc4bc764fed1bcc678a78f6b6329211d47a462853eaca527685d9dea4c595bf25d0d4825a6f6a3940cea5658ed8f10e5582d65f1722a88b2affe144fe660fb6502c73283e249d96c4efbbf91fbf6a25d92cd9582a9d9ae85783ef382d12626125ffa10da386a551323826f5a81994d051a881065de70ec5c71ba325e83e151fc6e6fc51a8f24f572947d48346b9b3afa3837f4a9e95b0ebfeb5a93a0485c95260df4f79b910fcece6ec3af00efd7e530978b1f4a1d2ec819cec0b93ac6d2b0bc56f5a09caff5273f8a076bfd7e14fdad560eee0dd7827f25b63ac4bbe0081132f73910fc34d0cc8943341da614b318e0680a57a2247d0bb7822ba653acdf646e28286452f0dc2fd14a88b9172bb404c595910519958a49007399ff0e5f8e8ea9d0c0ad7daa9e17527466160f54b37f05209e539a28cde760208cc8a7ca792b491bc4ee0f44691c259bccf80aad702580a930c8adeddc7103d2890985b146f0b96da04cee3fcf2dc25035ae327f77144c172779fd154cf8c18da0e3bda2411d55e5565e0bd4884f742a3800edcd2498cbcdc7cccbedd9cd635139af76ea640d095c6042c9720e51d0d5803d306101</span>bt <span class="token operator">=</span> <span class="token number">536380958350616057242691418634880594502192106332317228051967064327642091297687630174183636288378234177476435270519631690543765125295554448698898712393467267006465045949611180821007306678935181142803069337672948471202242891010188677287454504933695082327796243976863378333980923047411230913909715527759877351702062345876337256220760223926254773346698839492268265110546383782370744599490250832085044856878026833181982756791595730336514399767134613980006467147592898197961789187070786602534602178082726728869941829230655559180178594489856595304902790182697751195581218334712892008282605180395912026326384913562290014629187579128041030500771670510157597682826798117937852656884106597180126028398398087318119586692935386069677459788971114075941533740462978961436933215446347246886948166247617422293043364968298176007659058279518552847235689217185712791081965260495815179909242072310545078116020998113413517429654328367707069941427368374644442366092232916196726067387582032505389946398237261580350780769275427857010543262176468343294217258086275244086292475394366278211528621216522312552812343261375050388129743012932727654986046774759567950981007877856194574274373776538888953502272879816420369255752871177234736347325263320696917012616273</span>n <span class="token operator">=</span> <span class="token number">0xae1e3e6c9b458b8b5c55b87d5ad27bad43965933b367033c8a03f0dec83952de01a0128f994a02e2c08472cd2ea078ffbbd80327865a2aa35f12bc5df786ddcf2cec5c77e0e8b54355421365be82c64e76068d6cb62f0c1a68065b62f36354bb921d46b632ed1a839e3ca4eb934db6d79b09f2312637674a068bfdd8af85a5edf785e8a51b9861342246a59e843d94e2358f599b5db4aaefc05aa36d21ca3dd661d4af642e5ec0327b864727ac00d564be7ca4d55264c6ed040a632839ca6c0c0794754e9ccb651b2931ba69636a7f601cb3bb2bfbabcb575bfb3adbe8e431f384fe5596fd6ed72db67c10f2bb44f3487ef5aac0ea4b20f03cc0d13011297aa22d2e7f77c659e23b99c95dc626ee5c5d065136b14a370ca7650ad520cd0a1afcdd413bbb88d859644369088e042e065cf66f87f30a22e816b8b6b22859a9758c558af29560521c113fcc23d8d0a3f7a1032e3d3bf2e089825e8e3974e8c18a82d3a0078639a007382889c8191a20ad63975b4a32e6facd9d2bd7e83ad62214c051959cc199e0b72b50984806e1e5f3c5977a2c4d470aec32a63a2b5d3d048a2925eae89da9517719dc4f1f8150ec08f945129a1e7da533fe7584afbb5d5ef7d3cab78ab07bd8727fd797dddaf5ae940817ef657ea8b3f8a18c64ce38ffab955d033b271cc1c5b80068c8107a7a60119980877910feea0d2209f936c81d3c3d69</span>t <span class="token operator">=</span> invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> bt<span class="token punctuation">)</span>u <span class="token operator">=</span> hack_RSA<span class="token punctuation">(</span>t<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">getp</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> e<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>k <span class="token operator">=</span> e <span class="token operator">*</span> d <span class="token operator">-</span> <span class="token number">1</span>g <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">while</span> k <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>k <span class="token operator">=</span> k <span class="token operator">//</span> <span class="token number">2</span>temp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> k<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token keyword">if</span> GCD<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span> <span class="token keyword">and</span> temp <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span><span class="token keyword">return</span> GCD<span class="token punctuation">(</span>temp<span class="token punctuation">,</span> n<span class="token punctuation">)</span>p <span class="token operator">=</span> getp<span class="token punctuation">(</span>n<span class="token punctuation">,</span> t<span class="token punctuation">,</span> u<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pd <span class="token operator">=</span> invmod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># Hacked!</span><span class="token comment"># b'flag&#123;5a05f9f4-87b3-474d-b2eb-fabb6a89228f&#125;'</span></code></pre><h2 id="easy-pow"><a href="#easy-pow" class="headerlink" title="easy_pow"></a>easy_pow</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> lcm<span class="token punctuation">,</span> invert <span class="token keyword">from</span> secret <span class="token keyword">import</span> flage <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">**</span><span class="token number">4</span><span class="token operator">*</span>qc <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>hint1 <span class="token operator">=</span> <span class="token punctuation">(</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>hint1<span class="token punctuation">)</span>b <span class="token operator">=</span> <span class="token number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span>a <span class="token operator">=</span> <span class="token number">2021</span><span class="token operator">*</span>p<span class="token operator">**</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">2022</span> <span class="token operator">+</span> <span class="token number">2023</span><span class="token operator">*</span>p<span class="token operator">**</span><span class="token number">4</span>hint2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>hint2<span class="token punctuation">)</span><span class="token comment"># c = 299017261835189498646801799047751320695668439348487790148528895116908291237131013926772081799359589818341682677111543442738252080655908837832980607220654285415406849188648588876074312051164587055277017087038387169198951679119726082130868577905495307509637437814639023859871022938423168215797501175602649102621121969715328259139345090638555904577654447171932081642373835789445132466483809296734563016796846181929739289611878336934959331072502575341363049247881265649823417307615491433072850482074652957723543487026059316519285366802688885941059639121330455152478436982943059233339674041805741182096012792918311275489444605460198614371459471817407804289704524901847153843161249387208624993194285848787852634062441217234375549379380562009770380599080279723135784896688900810431588688332192335709518547640569711433618297677079620698012458053569647547533141501523434448045634646828827172848593990693592901227377493322141118565281304196426176682214434838100064256923548036690051664051936039970959246550139917211615752871493362724592143267948814481824417708986007126979214014590455837766290295441889285916265364654809662082923890960381278762698116724490968196229881400330090923027715288555056444792729745833577501899130568724790858022446326695539071814537878834059655627706444192634195723979046739351624465832476575907100097011055108105860691993049169856798600475407542166158235082147463523443663009573254123280611097423735159597787799640249067078454450453894294270686260545979274</span><span class="token comment"># hint1 = 5721198034334676541837614694444858336798773246799126905170215130476545540224374062960340456885923620963383130312535476337226014394595162625328729352118817</span><span class="token comment"># hint2 = 70105679627771719775142746553136794250337998462106229956679264658530098746665466868944855488308669706231622476566195559705924155363353360283408488917464065710623926781621366649773018113928630700594350396854359790092271835687816435058239792764298042156558375596434224003013749584571959306678511753195214791439107077903813757339868710576521858061442786434257451730633431229846440096297272405246087428205202111469272496134202922842748813992627453559734564891714846769627501147879058486675487738815514505109515031476986129016953015076080656764571648130270143686579720157712521222948534007797015393032826637675765983480855079052044005355401993107282102074405371246891417816527026361635916312955134612786069557685941228464218624689513588345168398491708253400514386622804630997</span></code></pre><p>这题自我怀疑了一下午，前后矛盾，用离散对数求出的a远远大于四次方程的实际得数，最后才发现出题人把c和hint2的值搞反了。。。</p><p><img src="https://tva1.sinaimg.cn/large/008i3skNgy1gut4wrddwmj60u0108tbu02.jpg"></p><p>预期解：</p><p>根据hint2求离散对数然后解方程得到p</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>e <span class="token operator">=</span> <span class="token number">65537</span>b <span class="token operator">=</span> <span class="token number">449703347709287328982446812318870158230369688625894307953604074502413258045265502496365998383562119915565080518077360839705004058211784369656486678307007348691991136610142919372779782779111507129101110674559235388392082113417306002050124215904803026894400155194275424834577942500150410440057660679460918645357376095613079720172148302097893734034788458122333816759162605888879531594217661921547293164281934920669935417080156833072528358511807757748554348615957977663784762124746554638152693469580761002437793837094101338408017407251986116589240523625340964025531357446706263871843489143068620501020284421781243879675292060268876353250854369189182926055204229002568224846436918153245720514450234433170717311083868591477186061896282790880850797471658321324127334704438430354844770131980049668516350774939625369909869906362174015628078258039638111064842324979997867746404806457329528690722757322373158670827203350590809390932986616805533168714686834174965211242863201076482127152571774960580915318022303418111346406295217571564155573765371519749325922145875128395909112254242027512400564855444101325427710643212690768272048881411988830011985059218048684311349415764441760364762942692722834850287985399559042457470942580456516395188637916303814055777357738894264037988945951468416861647204658893837753361851667573185920779272635885127149348845064478121843462789367112698673780005436144393573832498203659056909233757206537514290993810628872250841862059672570704733990716282248839</span>c <span class="token operator">=</span> <span class="token number">299017261835189498646801799047751320695668439348487790148528895116908291237131013926772081799359589818341682677111543442738252080655908837832980607220654285415406849188648588876074312051164587055277017087038387169198951679119726082130868577905495307509637437814639023859871022938423168215797501175602649102621121969715328259139345090638555904577654447171932081642373835789445132466483809296734563016796846181929739289611878336934959331072502575341363049247881265649823417307615491433072850482074652957723543487026059316519285366802688885941059639121330455152478436982943059233339674041805741182096012792918311275489444605460198614371459471817407804289704524901847153843161249387208624993194285848787852634062441217234375549379380562009770380599080279723135784896688900810431588688332192335709518547640569711433618297677079620698012458053569647547533141501523434448045634646828827172848593990693592901227377493322141118565281304196426176682214434838100064256923548036690051664051936039970959246550139917211615752871493362724592143267948814481824417708986007126979214014590455837766290295441889285916265364654809662082923890960381278762698116724490968196229881400330090923027715288555056444792729745833577501899130568724790858022446326695539071814537878834059655627706444192634195723979046739351624465832476575907100097011055108105860691993049169856798600475407542166158235082147463523443663009573254123280611097423735159597787799640249067078454450453894294270686260545979274</span>hint1 <span class="token operator">=</span> <span class="token number">5721198034334676541837614694444858336798773246799126905170215130476545540224374062960340456885923620963383130312535476337226014394595162625328729352118817</span>hint2 <span class="token operator">=</span> <span class="token number">70105679627771719775142746553136794250337998462106229956679264658530098746665466868944855488308669706231622476566195559705924155363353360283408488917464065710623926781621366649773018113928630700594350396854359790092271835687816435058239792764298042156558375596434224003013749584571959306678511753195214791439107077903813757339868710576521858061442786434257451730633431229846440096297272405246087428205202111469272496134202922842748813992627453559734564891714846769627501147879058486675487738815514505109515031476986129016953015076080656764571648130270143686579720157712521222948534007797015393032826637675765983480855079052044005355401993107282102074405371246891417816527026361635916312955134612786069557685941228464218624689513588345168398491708253400514386622804630997</span><span class="token comment"># a = discrete_log(c, mod(2, b))</span><span class="token comment"># var('p')</span><span class="token comment"># print(solve([2021*p^3 + 2022 + 2023*p^4 == a],[p]))</span>p <span class="token operator">=</span> <span class="token number">9849483964909942642702841079905240118177503474715624145847966507461420748914700088374273209071471481219849748116334914172343735036739076730486732571971497</span>mp1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint2<span class="token punctuation">,</span> hint1<span class="token punctuation">,</span> p<span class="token punctuation">)</span>mp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint2<span class="token punctuation">,</span> hint1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>x <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint2 <span class="token operator">-</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>mp1<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> p <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>y <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>x <span class="token operator">*</span> mp <span class="token operator">*</span> <span class="token punctuation">(</span>inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> p <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>mp1 <span class="token operator">+=</span> y<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>mp1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;24uz5n82476b3315k6m8rk333b37pa22&#125;'</span></code></pre><p>非预期：不用管hint2，直接根据hint1给的dp爆破p</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span><span class="token punctuation">(</span>hint1 <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> i <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>p<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>hint1 <span class="token operator">*</span> e <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>mp1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint2<span class="token punctuation">,</span> hint1<span class="token punctuation">,</span> p<span class="token punctuation">)</span>mp <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint2<span class="token punctuation">,</span> hint1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>x <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>hint2 <span class="token operator">-</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>mp1<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> p<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">try</span><span class="token punctuation">:</span>y <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>x <span class="token operator">*</span> mp <span class="token operator">*</span> <span class="token punctuation">(</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> p<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">except</span><span class="token punctuation">:</span><span class="token keyword">pass</span>mp1 <span class="token operator">=</span> mp1 <span class="token operator">+</span> y<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>mp1<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h1 id="长安杯"><a href="#长安杯" class="headerlink" title="长安杯"></a>长安杯</h1><h2 id="easyRSA"><a href="#easyRSA" class="headerlink" title="easyRSA"></a>easyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    ans <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a0<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        ans <span class="token operator">=</span> ans<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>a0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">48</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        ans <span class="token operator">=</span> ans<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token punctuation">(</span>a0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>a0<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span>b0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>    <span class="token keyword">return</span> ans<span class="token keyword">def</span> <span class="token function">mul</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    ans <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        ans <span class="token operator">=</span> ans<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>a0<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>    <span class="token keyword">return</span> ansm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qc <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>add<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>mul<span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment"># 10399034381787849923326924881454040531711492204619924608227265350044149907274051734345037676383421545973249148286183660679683016947030357640361405556516408</span><span class="token comment"># 6004903250672248020273453078045186428048881010508070095760634049430058892705564009054400328070528434060550830050010084328522605000400260581038846465000861</span><span class="token comment"># 100457237809578238448997689590363740025639066957321554834356116114019566855447194466985968666777662995007348443263561295712530012665535942780881309520544097928921920784417859632308854225762469971326925931642031846400402355926637518199130760304347996335637140724757568332604740023000379088112644537238901495181</span><span class="token comment"># 49042009464540753864186870038605696433949255281829439530955555557471951265762643642510403828448619593655860548966001304965902133517879714352191832895783859451396658166132732818620715968231113019681486494621363269268257297512939412717227009564539512793374347236183475339558666141579267673676878540943373877937</span></code></pre><p>先获取所有p,q十进制的组合，然后爆破组合根据n的低位判断是否合法，还原p，q</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># from secret import flag</span><span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    ans <span class="token operator">=</span> <span class="token number">0</span>    <span class="token comment"># b0 &lt; a0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>a0<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        ans <span class="token operator">=</span> ans<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span>a0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">48</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        ans <span class="token operator">=</span> ans<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token punctuation">(</span>a0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>a0<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span>b0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>    <span class="token keyword">return</span> ans<span class="token keyword">def</span> <span class="token function">mul</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">&lt;</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        a0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>        b0 <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span>    ans <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        ans <span class="token operator">=</span> ans<span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a0<span class="token punctuation">[</span>i<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>a0<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>b0<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>b0<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>    <span class="token keyword">return</span> ans<span class="token keyword">def</span> <span class="token function">collect</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">while</span> m<span class="token punctuation">:</span>        res<span class="token punctuation">.</span>append<span class="token punctuation">(</span>m<span class="token operator">%</span><span class="token number">10</span><span class="token punctuation">)</span>        m <span class="token operator">//=</span> <span class="token number">10</span>    res <span class="token operator">=</span> res<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">solve</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    x_add_y <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>    x_mul_y <span class="token operator">=</span> <span class="token punctuation">(</span>b<span class="token operator">+</span><span class="token number">4</span><span class="token operator">-</span><span class="token number">2</span><span class="token operator">*</span>a<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span>    ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> y <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">58</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span> <span class="token operator">==</span> x_add_y <span class="token keyword">and</span> <span class="token punctuation">(</span>x<span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">10</span> <span class="token operator">==</span> x_mul_y<span class="token punctuation">:</span>                ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">,</span>y<span class="token operator">-</span><span class="token number">48</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> anse <span class="token operator">=</span> <span class="token number">65537</span>n <span class="token operator">=</span> <span class="token number">100457237809578238448997689590363740025639066957321554834356116114019566855447194466985968666777662995007348443263561295712530012665535942780881309520544097928921920784417859632308854225762469971326925931642031846400402355926637518199130760304347996335637140724757568332604740023000379088112644537238901495181</span>p_add_q <span class="token operator">=</span> <span class="token number">10399034381787849923326924881454040531711492204619924608227265350044149907274051734345037676383421545973249148286183660679683016947030357640361405556516408</span>p_mul_q <span class="token operator">=</span> <span class="token number">6004903250672248020273453078045186428048881010508070095760634049430058892705564009054400328070528434060550830050010084328522605000400260581038846465000861</span>info1 <span class="token operator">=</span> <span class="token punctuation">(</span>collect<span class="token punctuation">(</span>p_add_q<span class="token punctuation">)</span><span class="token punctuation">)</span>info2 <span class="token operator">=</span> <span class="token punctuation">(</span>collect<span class="token punctuation">(</span>p_mul_q<span class="token punctuation">)</span><span class="token punctuation">)</span>guess <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>info1 <span class="token operator">=</span> info1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>cnt <span class="token operator">=</span> <span class="token number">1</span>ans <span class="token operator">=</span> <span class="token number">0</span>ans_p <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>ans_q <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>info1<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> info1<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    b <span class="token operator">=</span> info2<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    poss <span class="token operator">=</span> solve<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>poss<span class="token punctuation">)</span>    pp_ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    qq_ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> index <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>ans_p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        pp <span class="token operator">=</span> ans_p<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        qq <span class="token operator">=</span> ans_q<span class="token punctuation">[</span>index<span class="token punctuation">]</span>        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> poss<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>            nans_p <span class="token operator">=</span> pp<span class="token operator">+</span>x<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span><span class="token punctuation">(</span>cnt<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            nans_q <span class="token operator">=</span> qq<span class="token operator">+</span>y<span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span><span class="token punctuation">(</span>cnt<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"cur"</span><span class="token punctuation">,</span>nans_p<span class="token punctuation">,</span>nans_q<span class="token punctuation">)</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>nans_p <span class="token operator">*</span> nans_q<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span>cnt<span class="token punctuation">)</span> <span class="token operator">==</span> n<span class="token operator">%</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">**</span>cnt<span class="token punctuation">)</span><span class="token punctuation">:</span>                pp_ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nans_p<span class="token punctuation">)</span>                qq_ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nans_q<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"yes!!!"</span><span class="token punctuation">,</span>pp_ans<span class="token punctuation">,</span>qq_ans<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"qq_ans"</span><span class="token punctuation">,</span>qq_ans<span class="token punctuation">)</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"pp_ans"</span><span class="token punctuation">,</span>pp_ans<span class="token punctuation">)</span>                <span class="token comment"># break</span>    <span class="token keyword">if</span> pp_ans<span class="token punctuation">:</span>        ans_p <span class="token operator">=</span> pp_ans        ans_q <span class="token operator">=</span> qq_ans    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ans"</span><span class="token punctuation">,</span>ans_p<span class="token punctuation">,</span>ans_q<span class="token punctuation">)</span>    cnt <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">for</span> p <span class="token keyword">in</span> ans_p<span class="token punctuation">:</span>    <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>p <span class="token operator">=</span> <span class="token number">8307103755174226983699771812499382664784661030503034013965679561410051699975573257899430944515587916063550418050690024796566861042630720583592848475010689</span>q <span class="token operator">=</span> n<span class="token operator">//</span>pphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span><span class="token number">65537</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token number">49042009464540753864186870038605696433949255281829439530955555557471951265762643642510403828448619593655860548966001304965902133517879714352191832895783859451396658166132732818620715968231113019681486494621363269268257297512939412717227009564539512793374347236183475339558666141579267673676878540943373877937</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p><a href="https://blog.csdn.net/a5555678744/article/details/120479157">https://blog.csdn.net/a5555678744/article/details/120479157</a></p><h1 id="绿城杯"><a href="#绿城杯" class="headerlink" title="绿城杯"></a>绿城杯</h1><h2 id="warmup-加密算法"><a href="#warmup-加密算法" class="headerlink" title="[warmup]加密算法"></a>[warmup]加密算法</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">assert</span> flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'flag&#123;'</span>str1 <span class="token operator">=</span> <span class="token string">'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</span><span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>plain_text<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>cipher_text <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> plain_text<span class="token punctuation">:</span><span class="token keyword">if</span> i <span class="token keyword">in</span> str1<span class="token punctuation">:</span>addr <span class="token operator">=</span> str1<span class="token punctuation">.</span>find<span class="token punctuation">(</span>i<span class="token punctuation">)</span>cipher_text <span class="token operator">+=</span> str1<span class="token punctuation">[</span><span class="token punctuation">(</span>a<span class="token operator">*</span>addr<span class="token operator">+</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> m<span class="token punctuation">]</span><span class="token keyword">else</span><span class="token punctuation">:</span>cipher_text <span class="token operator">+=</span> i<span class="token keyword">print</span><span class="token punctuation">(</span>cipher_text<span class="token punctuation">)</span>encode<span class="token punctuation">(</span>flag<span class="token punctuation">,</span><span class="token number">37</span><span class="token punctuation">,</span><span class="token number">23</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token comment"># cipher_text = 'aoxL&#123;XaaHKP_tHgwpc_hN_ToXnnht&#125;'</span></code></pre><p>52位的仿射密码解密，CSDN搜到了脚本一把梭。exp如下：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>k1<span class="token punctuation">,</span>k2<span class="token punctuation">,</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">52</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> k1<span class="token operator">*</span>i<span class="token operator">%</span><span class="token number">52</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            inv <span class="token operator">=</span> i            <span class="token keyword">break</span>    dic <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_letters    m <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> message<span class="token punctuation">:</span>        <span class="token keyword">if</span> i<span class="token punctuation">.</span>islower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>            m<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dic<span class="token punctuation">[</span>inv<span class="token operator">*</span><span class="token punctuation">(</span>num<span class="token operator">-</span>k2<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">elif</span> i<span class="token punctuation">.</span>isupper<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            num <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span><span class="token builtin">ord</span><span class="token punctuation">(</span><span class="token string">'A'</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">26</span>            m<span class="token punctuation">.</span>append<span class="token punctuation">(</span>dic<span class="token punctuation">[</span>inv<span class="token operator">*</span><span class="token punctuation">(</span>num<span class="token operator">-</span>k2<span class="token punctuation">)</span><span class="token operator">%</span><span class="token number">52</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            m<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>decrypt<span class="token punctuation">(</span><span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token string">'aoxL&#123;XaaHKP_tHgwpc_hN_ToXnnht&#125;'</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;AffInE_CIpheR_iS_clAssiC&#125;</span></code></pre><h2 id="RSA-1"><a href="#RSA-1" class="headerlink" title="RSA-1"></a>RSA-1</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">assert</span> flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">b'flag&#123;'</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n ='</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>M <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> m <span class="token operator">*</span> <span class="token number">1001</span> <span class="token operator">*</span> p c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>M<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c ='</span><span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token comment">#n = 17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span><span class="token comment">#c = 6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span></code></pre><p>c是p的倍数，所以对n和c求gcd即为p。exp如下：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">17365231154926348364478276872558492775911760603002394353723603461898405740234715001820111548600914907617003806652492391686710256274156677887101997175692277729648456087534987616743724646598234466094779540729413583826355145277980479040157075453694250572316638348121571218759769533738721506811175866990851972838466307594226293836934116659685215775643285465895317755892754473332034234495795936183610569571016400535362762699517686781602302045048532131426035260878979892169441059467623523060569285570577199236309888155833013721997933960457784653262076135561769838704166810384309655788983073376941843467117256002645962737847</span>c <span class="token operator">=</span> <span class="token number">6944967108815437735428941286784119403138319713455732155925055928646536962597672941805831312130689338014913452081296400272862710447207265099750401657828165836013122848656839100854719965188680097375491193249127725599660383746827031803066026497989298856420216250206035068180963797454792151191071433645946245914916732637007117085199442894495667455544517483404006536607121480678688000420422281380539368519807162175099763891988648117937777951069899975260190018995834904541447562718307433906592021226666885638877020304005614450763081337082838608414756162253825697420493509914578546951634127502393647068722995363753321912676</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>p <span class="token operator">=</span> gcd<span class="token punctuation">(</span>n<span class="token punctuation">,</span> c<span class="token punctuation">)</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pd <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span> <span class="token operator">//</span> p <span class="token operator">//</span> <span class="token number">2021</span> <span class="token operator">//</span> <span class="token number">1001</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;Math_1s_1nterest1ng_hah&#125;</span></code></pre><h2 id="RSA-2"><a href="#RSA-2" class="headerlink" title="RSA-2"></a>RSA-2</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">assert</span> flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">b'flag&#123;'</span>m1 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>p  <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>p1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>q  <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>q1 <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>q<span class="token punctuation">)</span>n1 <span class="token operator">=</span> p<span class="token operator">*</span>q<span class="token operator">*</span>p1<span class="token operator">*</span>q1<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n1 ='</span><span class="token punctuation">,</span>n1<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>c1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m1<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c1 ='</span><span class="token punctuation">,</span>c1<span class="token punctuation">)</span>m2 <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>p2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'p2+q2 ='</span><span class="token punctuation">,</span>p2<span class="token operator">+</span>q2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'q2*q2 ='</span><span class="token punctuation">,</span>p2<span class="token operator">*</span>q2<span class="token punctuation">)</span>n2 <span class="token operator">=</span> p2<span class="token operator">*</span>p2<span class="token operator">*</span>q2<span class="token operator">*</span>q2<span class="token operator">*</span>q2<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n2 ='</span><span class="token punctuation">,</span>n2<span class="token punctuation">)</span>c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m2<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c2 ='</span><span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token comment">#n1 = 6348779979606280884589422188738902470575876294643492831465947360363568026280963989291591157710389629216109615274754718329987990551836115660879103234129921943824061416396264358110216047994331119920503431491509529604742468032906950984256964560405062345280120526771439940278606226153077959057882262745273394986607004406770035459301695806378598890589432538916219821477777021460189140081521779103226953544426441823244765828342973086422949017937701261348963541035128661464068769033772390320426795044617751909787914185985911277628404632533530390761257251552073493697518547350246993679844132297414094727147161169548160586911</span><span class="token comment">#c1 = 6201882078995455673376327652982610102807874783073703018551044780440620679217833227711395689114659144506630609087600915116940111002026241056808189658969089532597757995423694966667948250438579639890580690392400661711864264184444018345499567505424672090632235109624193289954785503512742400960515331371813467034511130432319427185134018830006918682733848618201088649690422818940385123599468595766345668931882249779415788129316594083269412221804774856038796248038700275509397599351533280014908894068141056694660319816046357462684688942519849441237878018480036145051967731081582598773076490918572392784684372694103015244826</span><span class="token comment">#p2+q2 = 274773146761138462708137582309097386437793891793691383033856524303010811294101933454824485010521468914846151819876043508541879637544444256520741418495479393777132830985856522008561088410862815913292288683761657919121930016956916865849261153721097671315883469348972925757078089715102032241818526925988645578778</span><span class="token comment">#q2*q2 = 18514724270030962172566965941723224386374076294232652258701085781018776172843355920566035157331579524980108190739141959926523082142273672741849552475156278397131571360099018592018959785627785130126477982765210498547680367230723634424036009539347854344573537848628061468892166199866227984167843139793429682559241317072979374002912607549039431398267184818771503468116379618249319324788996321340764624593443106354104274472601170229835219638093242557547840060892527576940077162990069687019966946826210112318408269749294366586682732614372434218768720577917368726530200897558912687470088583774711767599580037663378929000217</span><span class="token comment">#n2 = 40588227045595304080360385041082238507044292731344465815296032905633525556943787610712651675460810768762763493579129831271018141591546207557410817432455139315527674932933085299277599173971912445226532235814580879585317211349524406424200622675880992390782025158621241499693400288031658194434641718026910652327933253877313106112861283314274635124734817398465059373562194694957841264834312640926278890386089611103714990646541470577351599526904458342660444968591197606820361364761648205241041444681145820799054413179462285509661124362074093583494932706249461954240408827087015525507173082129412234486228092002841868365895837463699200959915782767657258729794037776401995309244941171415842403617486719492483671490834562579225506831496881542530519595438932482796867853234159664409420977526102480385193101883785161080269573707156626838551506024455480650224305894501968583442346807126920740779780593650871645915149689424292912611578291912721896864772950410266629045542480009266574096080138709683466489568290569363478444349563498507530805502511051165160827192795520182720802422213364247355775222858214648603034743679187470844212529134374975737510982287957316878179964602394749601431823167982157434890459245394370728942790117156485268116758052636794417268680901420193002289035538753620555488506926366624641291881353268617130968991258983002165300186971963661666476600998389048880565199317280428349802824448329898502788492233381873026217202981921654673840142095839603360666049476100561268336225902504932800605464136192275593886736746497955270280541423593</span><span class="token comment">#c2 = 25591090168544821761746024178724660839590948190451329227481168576490717242294520739865602061082558759751196452117720647426598261568572440942370039702932821941366792140173428488344932203576334292648255551171274828821657097667106792872200082579319963310503721435500623146012954474613150848083425126987554594651797477741828655238243550266972216752593788734836373144363217639612492397228808215205862281278774096317615918854403992620720969173788151215489908812749179861803144937169587452008097008940710091361183942268245271154461872102813602754439939747566507116519362821255724179093051041994730856401493996771276172343313045755916751082693149885922105491818225012844519264933137622929024918619477538521533548551789739698933067212305578480416163609137189891797209277557411169643568540392303036719952140554435338851671440952865151077383220305295001632816442144022437763089133141886924265774247290306669825085862351732336395617276100374237159580759999593028756939354840677333467281632435767033150052439262501059299035212928041546259933118564251119588970009016873855478556588250138969938599988198494567241172399453741709840486953189764289118312870580993115636710724139809708256360212728127786394411676427828431569046279687481368215137561500777480380501551616577832499521295655237360184159889151837766353116185320317774645294201044772828099074917077896631909654671612557207653830344897644115936322128351494551004652981550758791285434809816872381900401440743578104582305215488888563166054568802145921399726673752722820646807494657299104190123945675647</span></code></pre><p>flag1是祥云杯的RSAssss，用费马因式分解n，网上搜到exp。flag2是用sympy解方程得到p和q。exp如下：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> sympy <span class="token keyword">import</span> Symbol<span class="token punctuation">,</span> solve<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">fermat_factorization</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    factor_list <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    get_context<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>precision <span class="token operator">=</span> <span class="token number">4096</span>    x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        x <span class="token operator">+=</span> <span class="token number">1</span>        y2 <span class="token operator">=</span> x <span class="token operator">**</span> <span class="token number">2</span> <span class="token operator">-</span> n        <span class="token keyword">if</span> is_square<span class="token punctuation">(</span>y2<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token comment">#print('x = ',x)</span>            y2 <span class="token operator">=</span> mpz<span class="token punctuation">(</span>y2<span class="token punctuation">)</span>            get_context<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>precision <span class="token operator">=</span> <span class="token number">4096</span>            y <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>sqrt<span class="token punctuation">(</span>y2<span class="token punctuation">)</span><span class="token punctuation">)</span>            factor_list<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token operator">+</span>y<span class="token punctuation">,</span> x<span class="token operator">-</span>y<span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>factor_list<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> factor_listn1 <span class="token operator">=</span> <span class="token number">6348779979606280884589422188738902470575876294643492831465947360363568026280963989291591157710389629216109615274754718329987990551836115660879103234129921943824061416396264358110216047994331119920503431491509529604742468032906950984256964560405062345280120526771439940278606226153077959057882262745273394986607004406770035459301695806378598890589432538916219821477777021460189140081521779103226953544426441823244765828342973086422949017937701261348963541035128661464068769033772390320426795044617751909787914185985911277628404632533530390761257251552073493697518547350246993679844132297414094727147161169548160586911</span>c1 <span class="token operator">=</span> <span class="token number">6201882078995455673376327652982610102807874783073703018551044780440620679217833227711395689114659144506630609087600915116940111002026241056808189658969089532597757995423694966667948250438579639890580690392400661711864264184444018345499567505424672090632235109624193289954785503512742400960515331371813467034511130432319427185134018830006918682733848618201088649690422818940385123599468595766345668931882249779415788129316594083269412221804774856038796248038700275509397599351533280014908894068141056694660319816046357462684688942519849441237878018480036145051967731081582598773076490918572392784684372694103015244826</span>s1 <span class="token operator">=</span> <span class="token number">274773146761138462708137582309097386437793891793691383033856524303010811294101933454824485010521468914846151819876043508541879637544444256520741418495479393777132830985856522008561088410862815913292288683761657919121930016956916865849261153721097671315883469348972925757078089715102032241818526925988645578778</span>s2 <span class="token operator">=</span> <span class="token number">18514724270030962172566965941723224386374076294232652258701085781018776172843355920566035157331579524980108190739141959926523082142273672741849552475156278397131571360099018592018959785627785130126477982765210498547680367230723634424036009539347854344573537848628061468892166199866227984167843139793429682559241317072979374002912607549039431398267184818771503468116379618249319324788996321340764624593443106354104274472601170229835219638093242557547840060892527576940077162990069687019966946826210112318408269749294366586682732614372434218768720577917368726530200897558912687470088583774711767599580037663378929000217</span>n2 <span class="token operator">=</span> <span class="token number">40588227045595304080360385041082238507044292731344465815296032905633525556943787610712651675460810768762763493579129831271018141591546207557410817432455139315527674932933085299277599173971912445226532235814580879585317211349524406424200622675880992390782025158621241499693400288031658194434641718026910652327933253877313106112861283314274635124734817398465059373562194694957841264834312640926278890386089611103714990646541470577351599526904458342660444968591197606820361364761648205241041444681145820799054413179462285509661124362074093583494932706249461954240408827087015525507173082129412234486228092002841868365895837463699200959915782767657258729794037776401995309244941171415842403617486719492483671490834562579225506831496881542530519595438932482796867853234159664409420977526102480385193101883785161080269573707156626838551506024455480650224305894501968583442346807126920740779780593650871645915149689424292912611578291912721896864772950410266629045542480009266574096080138709683466489568290569363478444349563498507530805502511051165160827192795520182720802422213364247355775222858214648603034743679187470844212529134374975737510982287957316878179964602394749601431823167982157434890459245394370728942790117156485268116758052636794417268680901420193002289035538753620555488506926366624641291881353268617130968991258983002165300186971963661666476600998389048880565199317280428349802824448329898502788492233381873026217202981921654673840142095839603360666049476100561268336225902504932800605464136192275593886736746497955270280541423593</span>c2 <span class="token operator">=</span> <span class="token number">25591090168544821761746024178724660839590948190451329227481168576490717242294520739865602061082558759751196452117720647426598261568572440942370039702932821941366792140173428488344932203576334292648255551171274828821657097667106792872200082579319963310503721435500623146012954474613150848083425126987554594651797477741828655238243550266972216752593788734836373144363217639612492397228808215205862281278774096317615918854403992620720969173788151215489908812749179861803144937169587452008097008940710091361183942268245271154461872102813602754439939747566507116519362821255724179093051041994730856401493996771276172343313045755916751082693149885922105491818225012844519264933137622929024918619477538521533548551789739698933067212305578480416163609137189891797209277557411169643568540392303036719952140554435338851671440952865151077383220305295001632816442144022437763089133141886924265774247290306669825085862351732336395617276100374237159580759999593028756939354840677333467281632435767033150052439262501059299035212928041546259933118564251119588970009016873855478556588250138969938599988198494567241172399453741709840486953189764289118312870580993115636710724139809708256360212728127786394411676427828431569046279687481368215137561500777480380501551616577832499521295655237360184159889151837766353116185320317774645294201044772828099074917077896631909654671612557207653830344897644115936322128351494551004652981550758791285434809816872381900401440743578104582305215488888563166054568802145921399726673752722820646807494657299104190123945675647</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>factor_list <span class="token operator">=</span> fermat_factorization<span class="token punctuation">(</span>n1<span class="token punctuation">)</span><span class="token punctuation">[</span>X1<span class="token punctuation">,</span> Y1<span class="token punctuation">]</span> <span class="token operator">=</span> factor_list<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span>X2<span class="token punctuation">,</span> Y2<span class="token punctuation">]</span> <span class="token operator">=</span> factor_list<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>p1 <span class="token operator">=</span> gcd<span class="token punctuation">(</span>X1<span class="token punctuation">,</span> X2<span class="token punctuation">)</span>q1 <span class="token operator">=</span> X1 <span class="token operator">//</span> p1p2 <span class="token operator">=</span> gcd<span class="token punctuation">(</span>Y1<span class="token punctuation">,</span> Y2<span class="token punctuation">)</span>q2 <span class="token operator">=</span> Y1 <span class="token operator">//</span> p2phi <span class="token operator">=</span> <span class="token punctuation">(</span>p1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q1 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>d1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>flag1 <span class="token operator">=</span> n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># p3 = Symbol('p3')</span><span class="token comment"># q3 = Symbol('q3')</span><span class="token comment"># p3, q3 = solve([p3+q3-s1, p3*q3-s2], [p3, q3])[0]</span><span class="token comment"># print(p3, q3)</span>p3 <span class="token operator">=</span> <span class="token number">118403784459455138582919377906131738592946190895354489225890530955489713357948723774385902598164582767355529878101682058998518634444589192617157682795489868846289962039288493883412519273541770945888153150197763095564026103787571812611196732248676365740482179339301570536662025044058993433932899960459852671737</span>q3 <span class="token operator">=</span> <span class="token number">156369362301683324125218204402965647844847700898336893807965993347521097936153209680438582412356886147490621941774361449543361003099855063903583735699989524930842868946568028125148569137321044967404135533563894823557903913169345053238064421472421305575401290009671355220416064671043038807885626965528792907041</span>d2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p3<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q3<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag2 <span class="token operator">=</span> n2s<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span> d2<span class="token punctuation">,</span> p3<span class="token operator">*</span>q3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag1 <span class="token operator">+</span> flag2<span class="token punctuation">)</span><span class="token comment"># flag&#123;Euler_funct1ons_1s_very_interst1ng&#125;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>4月总结笔记</title>
      <link href="2021/10/02/4-yue-zong-jie-bi-ji/"/>
      <url>2021/10/02/4-yue-zong-jie-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="羊城杯2020-Invitations"><a href="#羊城杯2020-Invitations" class="headerlink" title="[羊城杯2020]Invitations"></a>[羊城杯2020]Invitations</h2><blockquote><p>RSA Hastad Attack with non-linear padding and different public keys</p></blockquote><p>注意点：</p><ol><li><p>虽然题目给了14组数据，但是e=3的只有4组，只用那4组即可，因为Hastad攻击的条件是要选择相同值的e</p></li><li><p>bit_length为431，长度为54位的flag转成long之后的bit_length是430啊，不知为啥</p></li><li><p>epsilon设置问题，默认是1/8，这里要用1/20，不知怎么算的</p></li><li><p>Small_roots的解并不唯一，第二个正好是，所以不能return roots[0]</p></li></ol><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> bytes_to_long<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">import</span> gmpy2<span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">pad</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span>i<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> i <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span>s<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> s<span class="token operator">**</span><span class="token number">2</span><span class="token keyword">def</span> <span class="token function">gen_N</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span> <span class="token operator">*</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">54</span>invite <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>e_list <span class="token operator">=</span> <span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">]</span>N_list <span class="token operator">=</span> <span class="token punctuation">[</span>gen_N<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./invitations'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        invis <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>pad<span class="token punctuation">(</span>invite<span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>e_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>N_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Invitation%d: %d \n'</span><span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>invis<span class="token punctuation">)</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'Wait a minute! \n'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">'[e%d,N%d]: [%d,%d]\n'</span><span class="token operator">%</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>e_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>N_list<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">linearPaddingHastads</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> nArray<span class="token punctuation">,</span> aArray<span class="token punctuation">,</span> bArray<span class="token punctuation">,</span> eArray<span class="token punctuation">,</span> eps<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>aArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>eArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            nArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>nArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            eArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>eArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        TArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            arrayToCRT <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>            arrayToCRT<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>            TArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> crt<span class="token punctuation">(</span>arrayToCRT<span class="token punctuation">,</span> nArray<span class="token punctuation">)</span>        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>nArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        gArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            gArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> TArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> eArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">-</span> cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        g <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gArray<span class="token punctuation">)</span>        g <span class="token operator">=</span> g<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># Use Sage's inbuilt coppersmith method</span>        roots <span class="token operator">=</span> g<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>epsilon<span class="token operator">=</span>eps<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>roots<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No Solutions found"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        <span class="token keyword">return</span> roots    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CiphertextArray, ModulusArray, and the linear padding arrays need to be of the same length,"</span> <span class="token operator">+</span>              <span class="token string">"and the same size as the public exponent"</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">129274519334082165644106292383763271862424981496822335330342328217347928093592453953990448827969549377883054831490973006383371688359344675312001881631556371220779971357039899721241880304156884612458373310254854821837978876725801047977081900824202659636258168216028784656056334358157381820784576207338479493823</span>  <span class="token punctuation">,</span><span class="token number">8140023566779187828652447593867705813386781164538611122714708931585587727699213769519135028841126072130625547328311301696554048174772606261707345115571968105138543476580875347239912760797035694220505996377127309341770427102697008350472060971360460756799310951343070384766137332401117333917901167639276168214</span>  <span class="token punctuation">,</span><span class="token number">25434511525127530194830986592289179576070740435049947678930286998924519588985583799757299734846614343604661534391991096353170465467791358514448923161460366596251448937540153262731348684727026598527904328268639060306102090278287818149679940661579357649191023269947102746200467430583428889484549034314463114080</span> <span class="token punctuation">,</span><span class="token number">9435583236354598287661880148272717764447540972316605192855157484524753847806158586224733743434644389385148450722945845355791145016665856388503878165725148745517696840251674049929524448078129458846254866804153080766917319923905682824180976106679633180818527967145571143203594244851742143986040226240019541346</span> <span class="token punctuation">]</span>e <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>n <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">146694460234280339612721415368435987068740712812770728817136582256341063038147863645902264969297892447333024201649306207442798919845916187823646745721109151386096190207317810424580842120750075213595282979568495342617919336417068886973047979116994072272482630372638964064972815256237040541007947708358680368391</span><span class="token punctuation">,</span><span class="token number">65031485534704406281490718325237831433086480239135617407356760819741796565231283220528137697949585150709734732370203390254643835828984376427852793969716489016520923272675090536677771074867975287284694860155903327351119710765174437247599498342292671117884858621418276613385329637307269711179183430246951756029</span><span class="token punctuation">,</span><span class="token number">126172075578367446151297289668746433680600889845504078949758568698284471307000358407453139846282095477016675769468273204536898117467559575203458221600341760844973676129445394999861380625435418853474246813202182316736885441120197888145039130477114127079444939102267586634051045795627433724810346460217871661901</span><span class="token punctuation">,</span><span class="token number">75691424835079457343374072990750986689075078863640186724151061449621926239051140991748483370587430224317778303489124525034113533087612981452189061743589227565099659070008017454957304620495920813121234552401715857719372861565651204968408267740732475458128601061676264465241188491988485848198323410127587280471</span><span class="token punctuation">]</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>b <span class="token operator">=</span> <span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">**</span><span class="token number">431</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">]</span>m <span class="token operator">=</span> linearPaddingHastads<span class="token punctuation">(</span>c<span class="token punctuation">,</span> n<span class="token punctuation">,</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> e<span class="token punctuation">,</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> m<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'GWHT&#123;e959e3f8e7242954b43e1b91de9886e1&#125;Welc0metomyp4rty'</span></code></pre><h2 id="红明谷-RSA-attack"><a href="#红明谷-RSA-attack" class="headerlink" title="[红明谷]RSA attack"></a>[红明谷]RSA attack</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> sympy<span class="token keyword">import</span> random<span class="token keyword">from</span> secret <span class="token keyword">import</span> flagp1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token comment">#p1=172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649936031</span>p2 <span class="token operator">=</span> p1 <span class="token operator">-</span> random<span class="token punctuation">(</span><span class="token number">999</span><span class="token punctuation">,</span><span class="token number">99999</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token comment">#p2=172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649902034</span>p_1<span class="token operator">=</span><span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>p1<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p_1<span class="token operator">*=</span>ip3 <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextPrime<span class="token punctuation">(</span>p_1 <span class="token operator">%</span> p2 <span class="token punctuation">)</span>p4 <span class="token operator">=</span> p3 <span class="token operator">>></span> <span class="token number">50</span> <span class="token operator">&lt;&lt;</span> <span class="token number">50</span>p <span class="token operator">=</span> p4<span class="token keyword">while</span><span class="token punctuation">(</span>isPrime<span class="token punctuation">(</span>P<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P <span class="token operator">=</span> p <span class="token operator">+</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">50</span><span class="token punctuation">)</span>Q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span>N <span class="token operator">=</span> P <span class="token operator">*</span> Q<span class="token keyword">print</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token comment">#N=28592245028568852124815768977111125874262599260058745599820769758676575163359612268623240652811172009403854869932602124987089815595007954065785558682294503755479266935877152343298248656222514238984548734114192436817346633473367019138600818158715715935132231386478333980631609437639665255977026081124468935510279104246449817606049991764744352123119281766258347177186790624246492739368005511017524914036614317783472537220720739454744527197507751921840839876863945184171493740832516867733853656800209669179467244407710022070593053034488226101034106881990117738617496520445046561073310892360430531295027470929927226907793</span>flag<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span>e<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment">#c=15839981826831548396886036749682663273035548220969819480071392201237477433920362840542848967952612687163860026284987497137578272157113399130705412843449686711908583139117413</span></code></pre><p>求阶乘模，相差不多，用威尔逊定理和invert函数，将p2一步步推成p1，最后爆破一下p4加的随机数</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>p1<span class="token operator">=</span><span class="token number">172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649936031</span>p2<span class="token operator">=</span><span class="token number">172071201093945294154292240631809733545154559633386758234063824053438835958515543354911249971174172649606257936857627547311760174511316984409767738981247877005802155796623587461774104951797122995266217334158736848307655543970322950339988489801672160058805422153816950022590644650247595501280192205506649902034</span>n <span class="token operator">=</span> <span class="token number">28592245028568852124815768977111125874262599260058745599820769758676575163359612268623240652811172009403854869932602124987089815595007954065785558682294503755479266935877152343298248656222514238984548734114192436817346633473367019138600818158715715935132231386478333980631609437639665255977026081124468935510279104246449817606049991764744352123119281766258347177186790624246492739368005511017524914036614317783472537220720739454744527197507751921840839876863945184171493740832516867733853656800209669179467244407710022070593053034488226101034106881990117738617496520445046561073310892360430531295027470929927226907793</span>c<span class="token operator">=</span><span class="token number">15839981826831548396886036749682663273035548220969819480071392201237477433920362840542848967952612687163860026284987497137578272157113399130705412843449686711908583139117413</span><span class="token keyword">def</span> <span class="token function">wilson</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>B<span class="token punctuation">)</span><span class="token punctuation">:</span>t<span class="token operator">=</span>A<span class="token operator">-</span>B<span class="token operator">-</span><span class="token number">1</span>res<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>k<span class="token operator">=</span>A<span class="token operator">-</span><span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>res<span class="token operator">=</span><span class="token punctuation">(</span>res<span class="token operator">*</span>invert<span class="token punctuation">(</span>k<span class="token punctuation">,</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>Ak<span class="token operator">=</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> res<span class="token operator">+</span>A<span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">return</span> resp3 <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>wilson<span class="token punctuation">(</span>p2<span class="token punctuation">,</span> p1<span class="token punctuation">)</span><span class="token punctuation">)</span>p4 <span class="token operator">=</span> p3 <span class="token operator">>></span> <span class="token number">50</span> <span class="token operator">&lt;&lt;</span> <span class="token number">50</span>e <span class="token operator">=</span> <span class="token number">3</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>p <span class="token operator">=</span> p4 <span class="token operator">+</span> i<span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>m <span class="token operator">=</span> n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> m<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">'flag&#123;'</span><span class="token punctuation">:</span><span class="token keyword">print</span> m<span class="token keyword">break</span><span class="token comment"># flag&#123;w0_x1hu1n_y0u_b5st&#125;</span></code></pre><h2 id="红明谷-ezCRT"><a href="#红明谷-ezCRT" class="headerlink" title="[红明谷]ezCRT"></a>[红明谷]ezCRT</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> gmpy2<span class="token keyword">from</span> random <span class="token keyword">import</span> shuffleflag <span class="token operator">=</span> <span class="token string">b"flag is here"</span><span class="token keyword">def</span> <span class="token function">shuffle_flag</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    str_list <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>    shuffle<span class="token punctuation">(</span>str_list<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>str_list<span class="token punctuation">)</span>nl <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>el <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>count <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">while</span> count <span class="token operator">!=</span> <span class="token number">5</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    phi <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>    e <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>d<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>    nl<span class="token punctuation">.</span>append<span class="token punctuation">(</span>n<span class="token punctuation">)</span>    el<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">)</span>    count <span class="token operator">+=</span> <span class="token number">1</span><span class="token keyword">print</span><span class="token punctuation">(</span>nl<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span>cl <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> shuffle_flag<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>nl<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    cl<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> el<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> nl<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cl<span class="token punctuation">)</span></code></pre><p>d相同，用Common Private Exponent共私钥指数攻击</p><p>构造格子然后用LLL算法规约得到d</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>e0<span class="token operator">=</span><span class="token number">69312028009355287369151190914681978515224902099126626288106202481561083869512381976466800912049172557479956400189281179789850182367192324370292880508005951892909864237831856642160554901550928757105750738313195248541515727624216048436593804176317465366380022764459799506858495981817822670957526705611211712923</span>n0<span class="token operator">=</span><span class="token number">92568419674731290088321621356482160506897805615722568594108449347104924357404183476911642777855820991398881156764068184840768873749718093598712551142529474514837161712525386555067489900887826033760157015587905876891826276883359425048106383489316555600680137377034136599761900203863336332834524981581608546277</span>c0<span class="token operator">=</span><span class="token number">706565317398633346290694952311166623770389747503953970254889622211015097472765489676349936599997109100148837713409666075736711752497174928509516666210124850782396573268200919345005742905131769799719677758163730270857245509037860252700476102090438501579886321486095767737006847692632649652528793934802014895</span>e1<span class="token operator">=</span><span class="token number">75652848678989239962391202584125835503829570694373189157636155436633908234362973839251550542975725789188895010096917574118924190081886365041870173203566890015476761857546914959928731140619341634983144909962106759048918025248827973161384045263311189477657141886093632791593341193393085433749877270828641736687</span>n1<span class="token operator">=</span><span class="token number">156396473818563541024482014372866929605198443382524196879362284224099117401220679011156723462510565131555949471059964179767945960498473012008220045105490122503438703770112687917922899337041421537937431868908340506324082719417747902320117904166584374628828367801012533926776313544525573302674702867896838756349</span>c1<span class="token operator">=</span><span class="token number">39976293505792731417500342473259466413746324373570160856607039564687056797068114044891309890160001547746290678089875953230720229396293686037539133378586045964793387433679304899158546834837314101138069400994334720071006048815998660691472991971598192116289517127819703723844842002711298154106615035755646791235</span>e2<span class="token operator">=</span><span class="token number">33787880341418355427411601538315129862488529656310145182009801227014512555036822623215545927750632031483856865027938518144081751233475248361490189179988637342429805607352670543555743822390555949569061340741015073482051059972283793490798701339277926430357560613555427570475360496737455291914090967005368044847</span>n2<span class="token operator">=</span><span class="token number">158394833243620345170313957479796081390446308753163267294427471181012679879060921676287361174926310080500003540773261012005682050743188110335872216992843352902160171999286576526304619756655278142788064189969927027027650043645613441449926633380809295720977302961310978360575684689811662689798196832145977450067</span>c2<span class="token operator">=</span><span class="token number">82622936948791971063481195310587447614375265630407688161651173440160941964839173273115526802240672776681580169092371677673709037579318090622040018030730165371997331146171751228791524747622285256591779419274845659567001522182995468819720594650389854677582186770321424062935881407083956991646633760500152137305</span>e3<span class="token operator">=</span><span class="token number">45894271603047945281790624112313938740541711331584775481261776728213544262108835859642003140814571796838418889270625806159755478669858113687476417240730385707171289922064965084283027730393146219788228689778873266618663473231744646293406030907691363263939114550226424730102211751706087680590823466426973879111</span>n3<span class="token operator">=</span><span class="token number">160088237013152996062303719345275590040820298863729670660621544625451638541931139026114480452748397901155923890465415946150076272684251867169893163248736673419035618274961179288085209456220719404244194802327491684233804878013160262798831738441790443743813368173495029170393018727204042599457829167334217403039</span>c3<span class="token operator">=</span><span class="token number">47924672523033740219454774309397006543851002473271747603676349322670782245519637286314088457132590816165876451615235937683074852920250584155682791595116359054889940842281324709426616771765312825842634237678243213350551342690870568516232078792788925700389762945955053433276153136302757700081859531596237286407</span>e4<span class="token operator">=</span><span class="token number">39462780066564051085365889083337472288277223628014907704844994419242541623368920096395581667207909872944692627394665038729398405841875334128211337544205143876652949004817962123951132753801707134333132359039376283331685997619531570270269964807335633423631078057345827010794671894948828680193958561375351954627</span>n4<span class="token operator">=</span><span class="token number">176125361422384852665447804150030174008849487020728296169340093618559367127086381778331613043595010796295772394708222184703701230685609172767761426620379001062695169120599393984950488304290958534830276649464003949555105491117656796777657620812669612752464591728873199832200616338112460100967288829163217253937</span>c4<span class="token operator">=</span><span class="token number">157462720644970256050843434459828247139256140406409429896418317109064365936294939244159292550184482469972819258184119865598346921909220060266145241164734603316978286567811044606538176157224828857158099074286931716459626013079677895357212211176535500327064375073662684801175545519382470886239209020257096407424</span>M<span class="token operator">=</span>iroot<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>n4<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">6</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span>M<span class="token punctuation">,</span>e0<span class="token punctuation">,</span>e1<span class="token punctuation">,</span>e2<span class="token punctuation">,</span>e3<span class="token punctuation">,</span>e4<span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n0<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n2<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n3<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n4<span class="token punctuation">]</span>Mat <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>a<span class="token punctuation">)</span>Mat_LLL<span class="token operator">=</span>Mat<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>Mat_LLL<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">//</span>Md <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;9b73a84b-5e32-433a-bc8f-6f8a6d2793db&#125;paddip\x0f'</span></code></pre><h2 id="虎符2021-cubic"><a href="#虎符2021-cubic" class="headerlink" title="[虎符2021]cubic"></a>[虎符2021]cubic</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">from</span> math <span class="token keyword">import</span> gcd<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span><span class="token keyword">from</span> fractions <span class="token keyword">import</span> Fraction <span class="token keyword">as</span> FracN <span class="token operator">=</span> <span class="token number">6</span><span class="token keyword">def</span> <span class="token function">read_num</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        num <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span>prompt<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span>    <span class="token keyword">return</span> num <span class="token keyword">if</span> num <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Please give me </span><span class="token interpolation"><span class="token punctuation">&#123;</span>N<span class="token punctuation">&#125;</span></span><span class="token string"> pairs of positive integers (x,y,z) "</span></span>      <span class="token string-interpolation"><span class="token string">f"satisfying the equation `x/(y+z) + y/(z+x) + z/(x+y) = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>N<span class="token punctuation">&#125;</span></span><span class="token string">`\n"</span></span><span class="token punctuation">)</span>anss <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>mark <span class="token operator">=</span> <span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> read_num<span class="token punctuation">(</span><span class="token string">"[>] x: "</span><span class="token punctuation">)</span>    y <span class="token operator">=</span> read_num<span class="token punctuation">(</span><span class="token string">"[>] y: "</span><span class="token punctuation">)</span>    z <span class="token operator">=</span> read_num<span class="token punctuation">(</span><span class="token string">"[>] z: "</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> x <span class="token operator">*</span> y <span class="token operator">*</span> z <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span> <span class="token comment"># positive integer</span>        mark <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is not what i want!\n"</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token keyword">if</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span> <span class="token comment"># (kx, ky, kz)</span>        mark <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is not what i want!\n"</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token keyword">if</span> Frac<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token operator">+</span>z<span class="token punctuation">)</span> <span class="token operator">+</span> Frac<span class="token punctuation">(</span>y<span class="token punctuation">,</span> z<span class="token operator">+</span>x<span class="token punctuation">)</span> <span class="token operator">+</span> Frac<span class="token punctuation">(</span>z<span class="token punctuation">,</span> x<span class="token operator">+</span>y<span class="token punctuation">)</span> <span class="token operator">!=</span> N<span class="token punctuation">:</span>        mark <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is not what i want!\n"</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    ans <span class="token operator">=</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token builtin">sorted</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># (y, x, z)</span>    <span class="token keyword">if</span> ans <span class="token keyword">in</span> anss<span class="token punctuation">:</span>        mark <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"This is not what i want!\n"</span><span class="token punctuation">)</span>        <span class="token keyword">break</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"You are right!\n"</span><span class="token punctuation">)</span>        anss<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token keyword">if</span> mark <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"flag is: "</span> <span class="token operator">+</span> flag <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token keyword">else</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Something wrong!\n"</span><span class="token punctuation">)</span></code></pre><p>$$<br>\frac{x}{y+z}+\frac{y}{x+z}+\frac{z}{x+y}=6<br>$$</p><p>$$<br>a^{3}+b^{3}+c^{3}-5(a^{2}b+ab^{2}+a^{2}c+ac^{2}+b^{2}c+bc^{2})-9abc=0<br>$$</p><p>$$<br>x=\frac{-36(a+b+2c)}{8a+8b-c}<br>$$</p><p>$$<br>y=\frac{612(a-b)}{8a+8b-c}<br>$$</p><p>$$<br>(a,b,c)=(1,-1,0)<br>$$</p><p>$$<br>y^{2}=x^{3}+213x^{2}+288x<br>$$</p><p>$$<br>\frac{a}{a+b+c}=\frac{8(N+3)-x+y}{2(4-x)(N+3)}<br>$$</p><p>$$<br>\frac{b}{a+b+c}=\frac{8(N+3)-x-y}{2(4-x)(N+3)}<br>$$</p><p>$$<br>\frac{c}{a+b+c}=\frac{-4(N+3)-(N+2)x}{(4-x)(N+3)}<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#Sage</span>ee <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">12</span><span class="token operator">*</span><span class="token number">6</span><span class="token operator">-</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#print(ee)</span><span class="token comment">#print(ee.gens())</span><span class="token comment">#P = ee(-200,680) </span><span class="token comment">#print(P)</span><span class="token keyword">def</span> <span class="token function">orig</span><span class="token punctuation">(</span>P<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    x <span class="token operator">=</span> P<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    y <span class="token operator">=</span> P<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    a <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">8</span><span class="token operator">*</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span>x<span class="token operator">-</span>y<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token punctuation">)</span><span class="token operator">/</span><span class="token punctuation">(</span><span class="token punctuation">(</span>N<span class="token operator">+</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token operator">-</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>    da <span class="token operator">=</span> denominator<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    db <span class="token operator">=</span> denominator<span class="token punctuation">(</span>b<span class="token punctuation">)</span>    dc <span class="token operator">=</span> denominator<span class="token punctuation">(</span>c<span class="token punctuation">)</span>    l <span class="token operator">=</span> lcm<span class="token punctuation">(</span>da<span class="token punctuation">,</span>lcm<span class="token punctuation">(</span>db<span class="token punctuation">,</span>dc<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>a<span class="token operator">*</span>l<span class="token punctuation">,</span> b<span class="token operator">*</span>l<span class="token punctuation">,</span> c<span class="token operator">*</span>l<span class="token punctuation">]</span>ans <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    u <span class="token operator">=</span> orig<span class="token punctuation">(</span>k<span class="token operator">*</span>P<span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span>     <span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span>u<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>u<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>u<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> a<span class="token operator">></span><span class="token number">0</span> <span class="token keyword">and</span> b<span class="token operator">></span><span class="token number">0</span> <span class="token keyword">and</span> c<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'k:'</span><span class="token punctuation">,</span> k<span class="token punctuation">)</span>        <span class="token comment">#print(a)</span>        <span class="token comment">#print(b)</span>        <span class="token comment">#print(c)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'he:'</span><span class="token punctuation">,</span> a<span class="token operator">/</span><span class="token punctuation">(</span>b<span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token operator">+</span>b<span class="token operator">/</span><span class="token punctuation">(</span>a<span class="token operator">+</span>c<span class="token punctuation">)</span><span class="token operator">+</span>c<span class="token operator">/</span><span class="token punctuation">(</span>a<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token comment">#print()</span>        ans<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'len:'</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ans<span class="token punctuation">)</span><span class="token punctuation">)</span>s</code></pre><h2 id="VNCTF2021-factor"><a href="#VNCTF2021-factor" class="headerlink" title="[VNCTF2021]factor"></a>[VNCTF2021]factor</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">get_public_key</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>        N<span class="token punctuation">,</span> phi<span class="token punctuation">,</span> not_phi <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            e <span class="token operator">=</span> inverse<span class="token punctuation">(</span>d<span class="token punctuation">,</span> not_phi<span class="token punctuation">)</span>            <span class="token keyword">assert</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>            <span class="token keyword">break</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>N<span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>pubkey<span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>    N<span class="token punctuation">,</span> e <span class="token operator">=</span> pubkey    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> N<span class="token punctuation">)</span>    <span class="token keyword">return</span> cm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>d <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">)</span>pubkeys <span class="token operator">=</span> <span class="token punctuation">[</span>get_public_key<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">,</span> get_public_key<span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token punctuation">]</span>cs <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>pubkeys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">,</span> encrypt<span class="token punctuation">(</span>pubkeys<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>pubkeys<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cs<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''[(115483338707853323510117244601663937653032657454816581880428779391136584508645415322441921678179684904267659942318581245589538093236558206867210468172871004098796706517288570963560499418427771831765342801956281881820593084352360716457591198748797415842971188690055630073433785996545367137242661591939632740177, 57942961120648999071495995119939754708884253716257622598699627649519120883383654560602196191747110519111036450217116739928381611061803307053632035548944075112790103258912149703053932492832060534126356062378027983000713091223894604748395826345780826674822582205573649323340945351657354960324397873669889767611), (53622548101803784449246949981043962044702821559359430270342163843702543781580388956841660273746825211912789196955019345268896290156568895362182295889379787233440464948232717888315385094207004043907898658611926470834448875571292174245716821120409044389816082878077188546182422805778560826667364235348059795229, 37629174280947918845570975617525141920002123382327456934545962737176558640617579710289304146119507880547361939594011152968663070025066085778798378563965349218834887746411017240322083056673687330052590220772859205859051875687741541958997904176801239206348298021023694604932588913541173039972303193792987583003)](51861394323132582263685584977796608641129485967610029542263453128833142621927008505594685713111162217651119546991411861320042282788909858323941435593508384080858965324662410947546608051702238057613339996124961723578887443100478753831786550701578678090466528863014222331341645240511640398819027209200809466160, 53200507591144017820710284362261363695745231005527161900426580605551005076410241969689161754211964469126847594337121140420040532547631617290907291418063708630323838133357597795892690304405706577096504918510233628396424543417886828387510407109281423448827267022542075484645277275676556239547911837897827866040)'''</span></code></pre><p>$$<br>e_{0}d = k_{0}(n_{0}+p_{0}+q_{0}+1)+1<br>$$</p><p>$$<br>e_{1}d=k_{1}(n_{1}+p_{0}+q_{0}+1)+1<br>$$</p><p>设$ M=\sqrt{n_{0}}, s=p_{0}+q_{0} $</p><p>构造格子如下：<br>$$<br>X=\begin{pmatrix}d&amp;k_{0}&amp;k_{1}\end{pmatrix}<br>$$</p><p>$$<br>A=\begin{pmatrix}M&amp;e_{0}&amp;e_{1}\0&amp;-n_{0}&amp;0\0&amp;0&amp;-n_{1}\end{pmatrix}<br>$$</p><p>$$<br>XA=B<br>$$</p><p>$$<br>B=\begin{pmatrix}dM&amp;e_{0}d-k_{0}n_{0}&amp;e_{1}d-k_{1}n_{1}\end{pmatrix}<br>$$</p><p>对A用LLL算法进行格基规约得到B</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>e0 <span class="token operator">=</span> <span class="token number">57942961120648999071495995119939754708884253716257622598699627649519120883383654560602196191747110519111036450217116739928381611061803307053632035548944075112790103258912149703053932492832060534126356062378027983000713091223894604748395826345780826674822582205573649323340945351657354960324397873669889767611</span>n0 <span class="token operator">=</span> <span class="token number">115483338707853323510117244601663937653032657454816581880428779391136584508645415322441921678179684904267659942318581245589538093236558206867210468172871004098796706517288570963560499418427771831765342801956281881820593084352360716457591198748797415842971188690055630073433785996545367137242661591939632740177</span>c0 <span class="token operator">=</span> <span class="token number">51861394323132582263685584977796608641129485967610029542263453128833142621927008505594685713111162217651119546991411861320042282788909858323941435593508384080858965324662410947546608051702238057613339996124961723578887443100478753831786550701578678090466528863014222331341645240511640398819027209200809466160</span>e1 <span class="token operator">=</span> <span class="token number">37629174280947918845570975617525141920002123382327456934545962737176558640617579710289304146119507880547361939594011152968663070025066085778798378563965349218834887746411017240322083056673687330052590220772859205859051875687741541958997904176801239206348298021023694604932588913541173039972303193792987583003</span>n1 <span class="token operator">=</span> <span class="token number">53622548101803784449246949981043962044702821559359430270342163843702543781580388956841660273746825211912789196955019345268896290156568895362182295889379787233440464948232717888315385094207004043907898658611926470834448875571292174245716821120409044389816082878077188546182422805778560826667364235348059795229</span>c1 <span class="token operator">=</span> <span class="token number">53200507591144017820710284362261363695745231005527161900426580605551005076410241969689161754211964469126847594337121140420040532547631617290907291418063708630323838133357597795892690304405706577096504918510233628396424543417886828387510407109281423448827267022542075484645277275676556239547911837897827866040</span>M <span class="token operator">=</span> iroot<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>n1<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">3</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span>M<span class="token punctuation">,</span>e0<span class="token punctuation">,</span>e1<span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n0<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n1<span class="token punctuation">]</span>Mat <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>a<span class="token punctuation">)</span>res <span class="token operator">=</span> Mat<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>d <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">//</span>M<span class="token punctuation">)</span>k <span class="token operator">=</span> <span class="token punctuation">(</span>e0 <span class="token operator">*</span> d <span class="token operator">-</span> res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">//</span> n0s <span class="token operator">=</span> <span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> k <span class="token operator">-</span> <span class="token number">1</span><span class="token comment"># var("p,q")</span><span class="token comment"># eq1=p*q==n1</span><span class="token comment"># eq2=p+q==s</span><span class="token comment"># solve([eq1,eq2],p,q)</span>p <span class="token operator">=</span> <span class="token number">12142923211780390949278028555254354690367508997633592218490684570880648120995591724323182740048952281742212656089623106601110432188891734994648474592945523</span>q <span class="token operator">=</span> <span class="token number">9510340853989572312310219508407369314311536350226735639404605504254271288587514209474334748428705386324794069855863782259924949801740767334888452847705899</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d0 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e0<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c0<span class="token punctuation">,</span> d0<span class="token punctuation">,</span> n0<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'vnctf&#123;7d47956b-bc55-4897-a550-cda0b221ce67&#125;'</span></code></pre><h2 id="VNCTF2021-whitegive"><a href="#VNCTF2021-whitegive" class="headerlink" title="[VNCTF2021]whitegive"></a>[VNCTF2021]whitegive</h2><pre class="language-python" data-language="python"><code class="language-python">m <span class="token operator">=</span> ep <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> p <span class="token operator">*</span> qe <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span>lcm<span class="token punctuation">(</span>p<span class="token punctuation">,</span>lcm<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>hint <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>d<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>hint<span class="token punctuation">)</span></code></pre><p>$$<br>ed\equiv1\bmod(lcm(p,lcm(p-1,q-1)))<br>$$</p><p>$$<br>(ed)^{e}\equiv1\bmod(lcm(p,lcm(p-1,q-1)))<br>$$</p><p>$$<br>(ed)^{e}=kp(p-1)(q-1)/gcd(p-1, q-1)+1<br>$$</p><p>$$<br>gcd(p-1, q-1)((ed)^{e}-1)=kp(p-1)(q-1)<br>$$</p><p>$$<br>p=gcd(e^{e}d^{e}-1,n)<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>n<span class="token operator">=</span>c<span class="token operator">=</span>hint<span class="token operator">=</span>e<span class="token operator">=</span>p<span class="token operator">=</span>gcd<span class="token punctuation">(</span>hint<span class="token operator">*</span><span class="token punctuation">(</span>e<span class="token operator">**</span>e<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>q<span class="token operator">=</span>n<span class="token operator">//</span>p<span class="token operator">//</span>pphi<span class="token operator">=</span>p<span class="token operator">*</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="V-amp-N2020公开赛-Fast"><a href="#V-amp-N2020公开赛-Fast" class="headerlink" title="[V&amp;N2020公开赛]Fast"></a>[V&amp;N2020公开赛]Fast</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flagp <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>N <span class="token operator">=</span> p <span class="token operator">*</span> qg<span class="token punctuation">,</span> r1<span class="token punctuation">,</span> r2 <span class="token operator">=</span> <span class="token punctuation">[</span>getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>g1 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> r1 <span class="token operator">*</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>g2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span> r2 <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>    s1<span class="token punctuation">,</span> s2 <span class="token operator">=</span> <span class="token punctuation">[</span>getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    c1 <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> s1<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> N    c2 <span class="token operator">=</span> <span class="token punctuation">(</span>m <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span> s2<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> N    <span class="token keyword">return</span> <span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token punctuation">:</span>    xp <span class="token operator">=</span> c1 <span class="token operator">%</span> p    xq <span class="token operator">=</span> c2 <span class="token operator">%</span> q    <span class="token comment"># Chinese Remainder Theorem</span>    m <span class="token operator">=</span> <span class="token punctuation">(</span>xp<span class="token operator">*</span>inverse<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token operator">*</span>q <span class="token operator">+</span> xq<span class="token operator">*</span>inverse<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> N    <span class="token keyword">return</span> mc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># N = 18680643069610062851842282268594530254220611012409807422663284548187050713427682950720783343430650669361838067625768840896513125210105582070603021732086193955893838077699465426052925750736212977005683541174195320832791835197114668838654054444342903298662698415765898335350206380896849522280206304272801325820946987172164086644949521111058774180676742851681476123338557138770304164634321305204827406522957769478330124484710532963132900017800651579612646041955628867746525508376194147796920773364680264059390497210260540079810501777507814448518995581208169818764701641258963569599247156932381367802991222265241699715283</span><span class="token comment"># g1 = 9143176283300810019842153344177123108612540016879643936458724056602746667157014763960725115919119704406826965726023263657276550779443988565368344040505696950820899770544814163379169539926317676679421275092688200844094929042154854719312788471536324082041360841253720783220459009201882865091829118575721525038404689868986360373373122049951274015083845966946475469982961355934516388706446794517870569063777231434618411404965077775991870069073539415961610645268985004687402050059891500490949250730689691141954694508001895390336750734542724392709744200091587065816283592253967715080611459937165344139809223328071517060208</span><span class="token comment"># g2 = 14068322834597276347776814624877614869834816383564391664570268934537693322688875343215293618493363798985047779057952636529313879548457643220996398640913517182122425631198219387988691569709691279442005545716133131472147592456812502863851227108284027033557263611949365667779259585770738623603814004666845554284808166195201470503432803440754207350347128045893594280079379926676477680556845095378093693409219131090910168117334308781843178748431526974047817218228075136005979538773141427004682344298827618677773735288946271346252828348742296301538573408254015281232250841148556304927266143397565889649305095857756884049430</span><span class="token comment"># c1, c2 = (3976514029543484086411168675941075541422870678409709261442618832911574665848843566949154289825219682094719766762966082440586568781997199077781276145091509192208487682443007457513002005089654365915817414921574344557570444253187757317116858499013550050579856269915915792827620535138057468531410166908365364129001407147467636145589396570815405571923148902993581000542566387654639930651683044853608873583911638108204074537952317056718986683846742909366072461130053275195290631718363272923316002049685111871888148244026652658482359335651889139243735138819453744763293112267738369048641158946411500606588429007794613880534, 18524535479582837341745231233387403662294605513261199630593257391163433751052467785080620993007681605662927226603747560698627838567782891522546977611597418150309028806158429831471152782211111046118637630899456903846057977815397285171313888516791822545633820066408276065732715348834255021260666966934592884548856831383262013360819013814149529393178712576141627031723067564594282618223686778534522328204603249125537258294561872667849498796757523663858312311082034700705599706428944071848443463999351872482644584735305157234751806369172212650596041534643187402820399145288902719434158798638116870325144146218568810928344)</span></code></pre><p>$$<br>g1\equiv g^{r1(p-1)}\bmod N<br>$$</p><p>$$<br>g2\equiv g^{r2(q-1)}\bmod N<br>$$</p><p>费马小定理<br>$$<br>1\equiv g^{r1(p-1)}\bmod p<br>$$</p><p>$$<br>1\equiv g^{r2(q-1)}\bmod q<br>$$</p><p>$$<br>p=gcd(g1-1,N)<br>$$</p><p>$$<br>q=gcd(g2-1,N)<br>$$</p><pre class="language-python" data-language="python"><code class="language-python">N <span class="token operator">=</span> <span class="token number">18680643069610062851842282268594530254220611012409807422663284548187050713427682950720783343430650669361838067625768840896513125210105582070603021732086193955893838077699465426052925750736212977005683541174195320832791835197114668838654054444342903298662698415765898335350206380896849522280206304272801325820946987172164086644949521111058774180676742851681476123338557138770304164634321305204827406522957769478330124484710532963132900017800651579612646041955628867746525508376194147796920773364680264059390497210260540079810501777507814448518995581208169818764701641258963569599247156932381367802991222265241699715283</span>g1 <span class="token operator">=</span> <span class="token number">9143176283300810019842153344177123108612540016879643936458724056602746667157014763960725115919119704406826965726023263657276550779443988565368344040505696950820899770544814163379169539926317676679421275092688200844094929042154854719312788471536324082041360841253720783220459009201882865091829118575721525038404689868986360373373122049951274015083845966946475469982961355934516388706446794517870569063777231434618411404965077775991870069073539415961610645268985004687402050059891500490949250730689691141954694508001895390336750734542724392709744200091587065816283592253967715080611459937165344139809223328071517060208</span>g2 <span class="token operator">=</span> <span class="token number">14068322834597276347776814624877614869834816383564391664570268934537693322688875343215293618493363798985047779057952636529313879548457643220996398640913517182122425631198219387988691569709691279442005545716133131472147592456812502863851227108284027033557263611949365667779259585770738623603814004666845554284808166195201470503432803440754207350347128045893594280079379926676477680556845095378093693409219131090910168117334308781843178748431526974047817218228075136005979538773141427004682344298827618677773735288946271346252828348742296301538573408254015281232250841148556304927266143397565889649305095857756884049430</span>c1<span class="token punctuation">,</span> c2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3976514029543484086411168675941075541422870678409709261442618832911574665848843566949154289825219682094719766762966082440586568781997199077781276145091509192208487682443007457513002005089654365915817414921574344557570444253187757317116858499013550050579856269915915792827620535138057468531410166908365364129001407147467636145589396570815405571923148902993581000542566387654639930651683044853608873583911638108204074537952317056718986683846742909366072461130053275195290631718363272923316002049685111871888148244026652658482359335651889139243735138819453744763293112267738369048641158946411500606588429007794613880534</span><span class="token punctuation">,</span> <span class="token number">18524535479582837341745231233387403662294605513261199630593257391163433751052467785080620993007681605662927226603747560698627838567782891522546977611597418150309028806158429831471152782211111046118637630899456903846057977815397285171313888516791822545633820066408276065732715348834255021260666966934592884548856831383262013360819013814149529393178712576141627031723067564594282618223686778534522328204603249125537258294561872667849498796757523663858312311082034700705599706428944071848443463999351872482644584735305157234751806369172212650596041534643187402820399145288902719434158798638116870325144146218568810928344</span><span class="token punctuation">)</span>p <span class="token operator">=</span> gcd<span class="token punctuation">(</span>g1<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>q <span class="token operator">=</span> gcd<span class="token punctuation">(</span>g2<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span>m <span class="token operator">=</span> decrypt<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token keyword">print</span> n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span></code></pre><h2 id="NPUCTF2020-babyLCG"><a href="#NPUCTF2020-babyLCG" class="headerlink" title="[NPUCTF2020]babyLCG"></a>[NPUCTF2020]babyLCG</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> bit_length<span class="token punctuation">)</span><span class="token punctuation">:</span>        m <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bit_length<span class="token punctuation">)</span>        a <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>        b <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>        seed <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>_key <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'a'</span><span class="token punctuation">:</span>a<span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span>b<span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">:</span>m<span class="token punctuation">&#125;</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> seed            <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>_key<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>_state <span class="token operator">+</span> self<span class="token punctuation">.</span>_key<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>_key<span class="token punctuation">[</span><span class="token string">'m'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state        <span class="token keyword">def</span> <span class="token function">export_key</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_key<span class="token keyword">def</span> <span class="token function">gen_lcg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    rand_iter <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> rand_iter<span class="token punctuation">.</span>export_key<span class="token punctuation">(</span><span class="token punctuation">)</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"key"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> rand_iter<span class="token keyword">def</span> <span class="token function">leak_data</span><span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span><span class="token punctuation">:</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"old"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> rand_iter<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span><span class="token punctuation">:</span>    f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ct"</span><span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span>    key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">&lt;&lt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">b'\x00'</span><span class="token punctuation">)</span>    iv <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">b'\x00'</span><span class="token punctuation">)</span>    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>    pt <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span>    ct <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>pt<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>ct<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    rand_iter <span class="token operator">=</span> gen_lcg<span class="token punctuation">(</span><span class="token punctuation">)</span>    rand_iter <span class="token operator">=</span> leak_data<span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span>    encrypt<span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>就是要求seed，只有20组的高位，设高位为c，低位为d<br>$$<br>c_{2}+d_{2}\equiv a(c_{1}+d_{1})+b(\bmod m)<br>$$</p><p>$$<br>c_{2}+d_{2}=a(c_{1}+d_{1})+b+km<br>$$</p><p>$$<br>d_{2}=mk+ad_{1}+ac_{1}+b-c_{2}=f(k,d_{1})+C<br>$$</p><p>构造格子如下：<br>$$<br>\begin{pmatrix}k&amp;d_{1}&amp;0\end{pmatrix}\begin{pmatrix}m&amp;0&amp;0\a&amp;1&amp;0\ac_{1}+b-c_{2}&amp;0&amp;2^{64}\end{pmatrix}=\begin{pmatrix}d_{2}&amp;d_{1}&amp;…\end{pmatrix}<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>b <span class="token operator">=</span> <span class="token number">153582801876235638173762045261195852087</span>a <span class="token operator">=</span> <span class="token number">107763262682494809191803026213015101802</span>m <span class="token operator">=</span> <span class="token number">226649634126248141841388712969771891297</span>c1 <span class="token operator">=</span> <span class="token number">7800489346663478448</span><span class="token operator">&lt;&lt;</span><span class="token number">64</span>c2 <span class="token operator">=</span> <span class="token number">11267068470666042741</span><span class="token operator">&lt;&lt;</span><span class="token number">64</span>M <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>m<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>c1<span class="token operator">+</span>b<span class="token operator">-</span>c2<span class="token punctuation">)</span><span class="token operator">%</span>m<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">^</span><span class="token number">64</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> M<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span>    d2 <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    d1 <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>res<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    s2 <span class="token operator">=</span> c2<span class="token operator">+</span>d2    s1 <span class="token operator">=</span> c1<span class="token operator">+</span>d1    <span class="token keyword">if</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>s1<span class="token operator">+</span>b<span class="token punctuation">)</span><span class="token operator">%</span>m <span class="token operator">==</span> s2<span class="token punctuation">:</span>        seed <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s1 <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token operator">*</span>inverse_mod<span class="token punctuation">(</span>a<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>m        <span class="token keyword">print</span><span class="token punctuation">(</span>seed<span class="token punctuation">)</span><span class="token comment"># 73991202721494681711496408225724067994</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> bit_length<span class="token punctuation">)</span><span class="token punctuation">:</span>        b <span class="token operator">=</span> <span class="token number">153582801876235638173762045261195852087</span>        a <span class="token operator">=</span> <span class="token number">107763262682494809191803026213015101802</span>        m <span class="token operator">=</span> <span class="token number">226649634126248141841388712969771891297</span>        seed <span class="token operator">=</span> <span class="token number">73991202721494681711496408225724067994</span>        self<span class="token punctuation">.</span>_key <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'a'</span><span class="token punctuation">:</span>a<span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">:</span>b<span class="token punctuation">,</span> <span class="token string">'m'</span><span class="token punctuation">:</span>m<span class="token punctuation">&#125;</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> seed     <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>_state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>_key<span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>_state <span class="token operator">+</span> self<span class="token punctuation">.</span>_key<span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>_key<span class="token punctuation">[</span><span class="token string">'m'</span><span class="token punctuation">]</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_state    <span class="token keyword">def</span> <span class="token function">export_key</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_key<span class="token keyword">def</span> <span class="token function">gen_lcg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    rand_iter <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> rand_iter<span class="token punctuation">.</span>export_key<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> rand_iter<span class="token keyword">def</span> <span class="token function">leak_data</span><span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> rand_iter<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ct.txt"</span><span class="token punctuation">,</span> <span class="token string">"rb"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span>    key <span class="token operator">=</span> <span class="token punctuation">(</span>key <span class="token operator">&lt;&lt;</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">64</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">b'\x00'</span><span class="token punctuation">)</span>    iv <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>rand_iter<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ljust<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">,</span> <span class="token string">b'\x00'</span><span class="token punctuation">)</span>    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    rand_iter <span class="token operator">=</span> gen_lcg<span class="token punctuation">(</span><span class="token punctuation">)</span>    rand_iter <span class="token operator">=</span> leak_data<span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span>    decrypt<span class="token punctuation">(</span>rand_iter<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    main<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># b'npuctf&#123;7ruc4t3d-L(G-4nd-LLL-4r3-1nt3r3st1ng&#125;\x04\x04\x04\x04'</span></code></pre><h2 id="CISCN2018-sm"><a href="#CISCN2018-sm" class="headerlink" title="[CISCN2018]sm"></a>[CISCN2018]sm</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">,</span>bytes_to_long<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> hashlib<span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token keyword">def</span> <span class="token function">gen512num</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    order<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">while</span> <span class="token builtin">len</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">512</span><span class="token punctuation">:</span>        tmp<span class="token operator">=</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">512</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> tmp <span class="token keyword">not</span> <span class="token keyword">in</span> order<span class="token punctuation">:</span>            order<span class="token punctuation">.</span>append<span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>    ps<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span>order<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">10</span><span class="token punctuation">)</span>        pre<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span>order<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token string">"1"</span>        ps<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>pre<span class="token operator">+</span><span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>pre<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ps<span class="token keyword">def</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    choose<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>    ps<span class="token operator">=</span>gen512num<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">"gen over"</span>    bchoose<span class="token operator">=</span><span class="token builtin">bin</span><span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span>    r<span class="token operator">=</span><span class="token number">0</span>    bchoose <span class="token operator">=</span> <span class="token string">"0"</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token operator">-</span><span class="token builtin">len</span><span class="token punctuation">(</span>bchoose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span>bchoose    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> bchoose<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">'1'</span><span class="token punctuation">:</span>            r<span class="token operator">=</span>r<span class="token operator">^</span>ps<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    flag<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    key<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    aes_obj <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>    ef<span class="token operator">=</span>aes_obj<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">"base64"</span><span class="token punctuation">)</span>    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"r"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ef"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>ef<span class="token punctuation">)</span>    gg<span class="token operator">=</span><span class="token string">""</span>    <span class="token keyword">for</span> p <span class="token keyword">in</span> ps<span class="token punctuation">:</span>        gg<span class="token operator">+=</span><span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"\n"</span>    <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"ps"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>write<span class="token punctuation">(</span>gg<span class="token punctuation">)</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>$$<br>0\oplus ps[i]\oplus … = r<br>$$</p><p>设bchoose的矩阵是C，ps矩阵是A，r矩阵是B<br>$$<br>C*A=B<br>$$</p><p>$$<br>C=B*A^{-1}<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>ps <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/Users/lizihan/Downloads/attachment (1)/ps.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>readlines<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#print(ps)</span>p <span class="token operator">=</span> <span class="token punctuation">[</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> ps<span class="token punctuation">]</span>A <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> p<span class="token punctuation">:</span>    A<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#print(A)</span>r <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/Users/lizihan/Downloads/attachment (1)/r.txt'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>B <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">]</span>A <span class="token operator">=</span> matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> A<span class="token punctuation">)</span>B <span class="token operator">=</span> matrix<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> B<span class="token punctuation">)</span>key <span class="token operator">=</span> B<span class="token operator">*</span>A<span class="token punctuation">.</span>inverse<span class="token punctuation">(</span><span class="token punctuation">)</span>l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> key<span class="token punctuation">:</span>    l<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">,</span>bytes_to_long<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">import</span> hashlib<span class="token keyword">import</span> base64l <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>bchoose <span class="token operator">=</span> <span class="token string">'0b'</span><span class="token keyword">for</span> i <span class="token keyword">in</span> l<span class="token punctuation">:</span>    bchoose <span class="token operator">+=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>choose <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>bchoose<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>key<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>choose<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>aes_obj <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>ef <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span><span class="token string">b'5eFo3ANg2fu9LRrFktWCJmVvx6RgBFzd0R8GXQ8JD78='</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> aes_obj<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>ef<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b'flag&#123;shemir_alotof_in_wctf_fun!&#125;'</span></code></pre><h2 id="watevrCTF2019-ECC-RSA"><a href="#watevrCTF2019-ECC-RSA" class="headerlink" title="[watevrCTF2019]ECC-RSA"></a>[watevrCTF2019]ECC-RSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> fastecdsa<span class="token punctuation">.</span>curve <span class="token keyword">import</span> P521 <span class="token keyword">as</span> Curve<span class="token keyword">from</span> fastecdsa<span class="token punctuation">.</span>point <span class="token keyword">import</span> Point<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> isPrime<span class="token keyword">from</span> os <span class="token keyword">import</span> urandom<span class="token keyword">from</span> random <span class="token keyword">import</span> getrandbits<span class="token keyword">def</span> <span class="token function">gen_rsa_primes</span><span class="token punctuation">(</span>G<span class="token punctuation">)</span><span class="token punctuation">:</span>urand <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>urandom<span class="token punctuation">(</span><span class="token number">521</span><span class="token operator">//</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>s <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">521</span><span class="token punctuation">)</span> <span class="token operator">^</span> urandQ <span class="token operator">=</span> s<span class="token operator">*</span>G<span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>Q<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token keyword">and</span> isPrime<span class="token punctuation">(</span>Q<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"ECC Private key:"</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"RSA primes:"</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>Q<span class="token punctuation">.</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>Q<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Modulo:"</span><span class="token punctuation">,</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>Q<span class="token punctuation">.</span>x <span class="token operator">*</span> Q<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">return</span> <span class="token punctuation">(</span>Q<span class="token punctuation">.</span>x<span class="token punctuation">,</span> Q<span class="token punctuation">.</span>y<span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span><span class="token builtin">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> byteorder<span class="token operator">=</span><span class="token string">"big"</span><span class="token punctuation">)</span>ecc_p <span class="token operator">=</span> Curve<span class="token punctuation">.</span>pa <span class="token operator">=</span> Curve<span class="token punctuation">.</span>ab <span class="token operator">=</span> Curve<span class="token punctuation">.</span>bGx <span class="token operator">=</span> Curve<span class="token punctuation">.</span>gxGy <span class="token operator">=</span> Curve<span class="token punctuation">.</span>gyG <span class="token operator">=</span> Point<span class="token punctuation">(</span>Gx<span class="token punctuation">,</span> Gy<span class="token punctuation">,</span> curve<span class="token operator">=</span>Curve<span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> gen_rsa_primes<span class="token punctuation">(</span>G<span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qfile_out <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"downloads/ecc-rsa.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"ECC Curve Prime: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>ecc_p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Curve a: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Curve b: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Gx: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>Gx<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Gy: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>Gy<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"e: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"p * q: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"ciphertext: "</span> <span class="token operator">+</span> <span class="token builtin">hex</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span></code></pre><p>$$<br>q^{2} = p^{3} + ap + b<br>$$</p><p>$$<br>p^{5}+ap^{3}+bp^{2}-n^{2}\equiv0(\bmod eccp)<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>eccp <span class="token operator">=</span> <span class="token number">0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff</span>a <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">0x3</span>b <span class="token operator">=</span> <span class="token number">0x51953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>n <span class="token operator">=</span> <span class="token number">0x118aaa1add80bdd0a1788b375e6b04426c50bb3f9cae0b173b382e3723fc858ce7932fb499cd92f5f675d4a2b05d2c575fc685f6cf08a490d6c6a8a6741e8be4572adfcba233da791ccc0aee033677b72788d57004a776909f6d699a0164af514728431b5aed704b289719f09d591f5c1f9d2ed36a58448a9d57567bd232702e9b28f</span>c <span class="token operator">=</span> <span class="token number">0x3862c872480bdd067c0c68cfee4527a063166620c97cca4c99baff6eb0cf5d42421b8f8d8300df5f8c7663adb5d21b47c8cb4ca5aab892006d7d44a1c5b5f5242d88c6e325064adf9b969c7dfc52a034495fe67b5424e1678ca4332d59225855b7a9cb42db2b1db95a90ab6834395397e305078c5baff78c4b7252d7966365afed9e</span>P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>eccp<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>f <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> a<span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> b<span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">-</span> n<span class="token operator">^</span><span class="token number">2</span><span class="token comment"># print(f.roots())</span>p <span class="token operator">=</span> <span class="token number">4573744216059593260686660411936793507327994800883645562370166075007970317346237399760397301505506131100113886281839847419425482918932436139080837246914736557</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pd <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'watevr&#123;factoring_polynomials_over_finite_fields_is_too_ez&#125;'</span></code></pre><h2 id="watevrCTF2019-Swedish-RSA"><a href="#watevrCTF2019-Swedish-RSA" class="headerlink" title="[watevrCTF2019]Swedish RSA"></a>[watevrCTF2019]Swedish RSA</h2><pre class="language-python" data-language="python"><code class="language-python">flag <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>bits <span class="token operator">=</span> <span class="token number">16</span><span class="token comment">## Prime for Finite Field.</span>p <span class="token operator">=</span> random_prime<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>bits<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>bits<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>file_out <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"downloads/polynomial_rsa.txt"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Prime: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token comment">## Univariate Polynomial Ring in y over Finite Field of size p</span>R<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>GF<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">## Analogous to the primes in Z</span><span class="token keyword">def</span> <span class="token function">gen_irreducable_poly</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        out <span class="token operator">=</span> R<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span>degree<span class="token operator">=</span>deg<span class="token punctuation">)</span>        <span class="token keyword">if</span> out<span class="token punctuation">.</span>is_irreducible<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> out<span class="token comment">## Polynomial "primes"</span>P <span class="token operator">=</span> gen_irreducable_poly<span class="token punctuation">(</span>ZZ<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span>Q <span class="token operator">=</span> gen_irreducable_poly<span class="token punctuation">(</span>ZZ<span class="token punctuation">.</span>random_element<span class="token punctuation">(</span>length<span class="token punctuation">,</span> <span class="token number">2</span><span class="token operator">*</span>length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">## Public exponent key</span>e <span class="token operator">=</span> <span class="token number">65537</span><span class="token comment">## Modulus</span>N <span class="token operator">=</span> P<span class="token operator">*</span>Qfile_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Modulus: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token comment">## Univariate Quotient Polynomial Ring in x over Finite Field of size 659 with modulus N(x)</span>S<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> R<span class="token punctuation">.</span>quotient<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token comment">## Encrypt</span>m <span class="token operator">=</span> S<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>c <span class="token operator">=</span> m<span class="token operator">^</span>efile_out<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Ciphertext: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>file_out<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>R<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>GF<span class="token punctuation">(</span><span class="token number">43753</span><span class="token punctuation">)</span><span class="token punctuation">)</span>N <span class="token operator">=</span> R<span class="token punctuation">(</span><span class="token number">34036</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">177</span> <span class="token operator">+</span> <span class="token number">23068</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">176</span> <span class="token operator">+</span> <span class="token number">13147</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">175</span> <span class="token operator">+</span> <span class="token number">36344</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">174</span> <span class="token operator">+</span> <span class="token number">10045</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">173</span> <span class="token operator">+</span> <span class="token number">41049</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">172</span> <span class="token operator">+</span> <span class="token number">17786</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">171</span> <span class="token operator">+</span> <span class="token number">16601</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">170</span> <span class="token operator">+</span> <span class="token number">7929</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">169</span> <span class="token operator">+</span> <span class="token number">37570</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">168</span> <span class="token operator">+</span> <span class="token number">990</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">167</span> <span class="token operator">+</span> <span class="token number">9622</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">166</span> <span class="token operator">+</span> <span class="token number">39273</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">165</span> <span class="token operator">+</span> <span class="token number">35284</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">164</span> <span class="token operator">+</span> <span class="token number">15632</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">163</span> <span class="token operator">+</span> <span class="token number">18850</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">162</span> <span class="token operator">+</span> <span class="token number">8800</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">161</span> <span class="token operator">+</span> <span class="token number">33148</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">160</span> <span class="token operator">+</span> <span class="token number">12147</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">159</span> <span class="token operator">+</span> <span class="token number">40487</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">158</span> <span class="token operator">+</span> <span class="token number">6407</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">157</span> <span class="token operator">+</span> <span class="token number">34111</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">156</span> <span class="token operator">+</span> <span class="token number">8446</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">155</span> <span class="token operator">+</span> <span class="token number">21908</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">154</span> <span class="token operator">+</span> <span class="token number">16812</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">153</span> <span class="token operator">+</span> <span class="token number">40624</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">152</span> <span class="token operator">+</span> <span class="token number">43506</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">151</span> <span class="token operator">+</span> <span class="token number">39116</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">150</span> <span class="token operator">+</span> <span class="token number">33011</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">149</span> <span class="token operator">+</span> <span class="token number">23914</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">148</span> <span class="token operator">+</span> <span class="token number">2210</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">147</span> <span class="token operator">+</span> <span class="token number">23196</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">146</span> <span class="token operator">+</span> <span class="token number">43359</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">145</span> <span class="token operator">+</span> <span class="token number">34455</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">144</span> <span class="token operator">+</span> <span class="token number">17684</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">143</span> <span class="token operator">+</span> <span class="token number">25262</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">142</span> <span class="token operator">+</span> <span class="token number">982</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">141</span> <span class="token operator">+</span> <span class="token number">24015</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">140</span> <span class="token operator">+</span> <span class="token number">27968</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">139</span> <span class="token operator">+</span> <span class="token number">37463</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">138</span> <span class="token operator">+</span> <span class="token number">10667</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">137</span> <span class="token operator">+</span> <span class="token number">39519</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">136</span> <span class="token operator">+</span> <span class="token number">31176</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">135</span> <span class="token operator">+</span> <span class="token number">27520</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">134</span> <span class="token operator">+</span> <span class="token number">32118</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">133</span> <span class="token operator">+</span> <span class="token number">8333</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">132</span> <span class="token operator">+</span> <span class="token number">38945</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">131</span> <span class="token operator">+</span> <span class="token number">34713</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">130</span> <span class="token operator">+</span> <span class="token number">1107</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">129</span> <span class="token operator">+</span> <span class="token number">43604</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">128</span> <span class="token operator">+</span> <span class="token number">4433</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">127</span> <span class="token operator">+</span> <span class="token number">18110</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">126</span> <span class="token operator">+</span> <span class="token number">17658</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">125</span> <span class="token operator">+</span> <span class="token number">32354</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">124</span> <span class="token operator">+</span> <span class="token number">3219</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">123</span> <span class="token operator">+</span> <span class="token number">40238</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">122</span> <span class="token operator">+</span> <span class="token number">10439</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">121</span> <span class="token operator">+</span> <span class="token number">3669</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">120</span> <span class="token operator">+</span> <span class="token number">8713</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">119</span> <span class="token operator">+</span> <span class="token number">21027</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">118</span> <span class="token operator">+</span> <span class="token number">29480</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">117</span> <span class="token operator">+</span> <span class="token number">5477</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">116</span> <span class="token operator">+</span> <span class="token number">24332</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">115</span> <span class="token operator">+</span> <span class="token number">43480</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">114</span> <span class="token operator">+</span> <span class="token number">33406</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">113</span> <span class="token operator">+</span> <span class="token number">43121</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">112</span> <span class="token operator">+</span> <span class="token number">1114</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">111</span> <span class="token operator">+</span> <span class="token number">17198</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">110</span> <span class="token operator">+</span> <span class="token number">22829</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">109</span> <span class="token operator">+</span> <span class="token number">24424</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">108</span> <span class="token operator">+</span> <span class="token number">16523</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">107</span> <span class="token operator">+</span> <span class="token number">20424</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">106</span> <span class="token operator">+</span> <span class="token number">36206</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">105</span> <span class="token operator">+</span> <span class="token number">41849</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">104</span> <span class="token operator">+</span> <span class="token number">3584</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">103</span> <span class="token operator">+</span> <span class="token number">26500</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">102</span> <span class="token operator">+</span> <span class="token number">31897</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">101</span> <span class="token operator">+</span> <span class="token number">34640</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">27449</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">99</span> <span class="token operator">+</span> <span class="token number">30962</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">98</span> <span class="token operator">+</span> <span class="token number">41434</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">97</span> <span class="token operator">+</span> <span class="token number">22125</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token number">24314</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">95</span> <span class="token operator">+</span> <span class="token number">3944</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">94</span> <span class="token operator">+</span> <span class="token number">18400</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">93</span> <span class="token operator">+</span> <span class="token number">38476</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">92</span> <span class="token operator">+</span> <span class="token number">28904</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">91</span> <span class="token operator">+</span> <span class="token number">27936</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">90</span> <span class="token operator">+</span> <span class="token number">41867</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">89</span> <span class="token operator">+</span> <span class="token number">25573</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">88</span> <span class="token operator">+</span> <span class="token number">25659</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">87</span> <span class="token operator">+</span> <span class="token number">33443</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">86</span> <span class="token operator">+</span> <span class="token number">18435</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">85</span> <span class="token operator">+</span> <span class="token number">5934</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">84</span> <span class="token operator">+</span> <span class="token number">38030</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">83</span> <span class="token operator">+</span> <span class="token number">17563</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">82</span> <span class="token operator">+</span> <span class="token number">24086</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">81</span> <span class="token operator">+</span> <span class="token number">36782</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">20922</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">79</span> <span class="token operator">+</span> <span class="token number">38933</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">78</span> <span class="token operator">+</span> <span class="token number">23448</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">77</span> <span class="token operator">+</span> <span class="token number">10599</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">76</span> <span class="token operator">+</span> <span class="token number">7156</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">75</span> <span class="token operator">+</span> <span class="token number">29044</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">74</span> <span class="token operator">+</span> <span class="token number">23605</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">73</span> <span class="token operator">+</span> <span class="token number">7657</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">72</span> <span class="token operator">+</span> <span class="token number">28200</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">71</span> <span class="token operator">+</span> <span class="token number">2431</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">70</span> <span class="token operator">+</span> <span class="token number">3860</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">69</span> <span class="token operator">+</span> <span class="token number">23259</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">68</span> <span class="token operator">+</span> <span class="token number">14590</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">67</span> <span class="token operator">+</span> <span class="token number">33631</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">66</span> <span class="token operator">+</span> <span class="token number">15673</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">65</span> <span class="token operator">+</span> <span class="token number">36049</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">64</span> <span class="token operator">+</span> <span class="token number">29728</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">63</span> <span class="token operator">+</span> <span class="token number">22413</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">62</span> <span class="token operator">+</span> <span class="token number">18602</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">61</span> <span class="token operator">+</span> <span class="token number">18557</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">60</span> <span class="token operator">+</span> <span class="token number">23505</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">59</span> <span class="token operator">+</span> <span class="token number">17642</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">12595</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">57</span> <span class="token operator">+</span> <span class="token number">17255</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">56</span> <span class="token operator">+</span> <span class="token number">15316</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">55</span> <span class="token operator">+</span> <span class="token number">8948</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">54</span> <span class="token operator">+</span> <span class="token number">38</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token number">40329</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">9823</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">5798</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">6379</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">8662</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">34640</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">38321</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">18760</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">13135</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">15926</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">34952</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">28940</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">13558</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">42579</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">38015</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">33788</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">12381</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">195</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">13709</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">31500</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">32994</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">30486</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">40414</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">2578</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">30525</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">43067</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">6195</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">36288</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">23236</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">21493</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">15808</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">34500</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">6390</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">42994</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">42151</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">19248</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">19291</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">8124</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">40161</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">24726</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">31874</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">30272</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">30761</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">2296</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">11017</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">16559</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">28949</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">40499</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">22377</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">33628</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">30598</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">4386</span><span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">23814</span><span class="token punctuation">)</span>c <span class="token operator">=</span> R<span class="token punctuation">(</span><span class="token number">5209</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">176</span> <span class="token operator">+</span> <span class="token number">10881</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">175</span> <span class="token operator">+</span> <span class="token number">31096</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">174</span> <span class="token operator">+</span> <span class="token number">23354</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">173</span> <span class="token operator">+</span> <span class="token number">28337</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">172</span> <span class="token operator">+</span> <span class="token number">15982</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">171</span> <span class="token operator">+</span> <span class="token number">13515</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">170</span> <span class="token operator">+</span> <span class="token number">21641</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">169</span> <span class="token operator">+</span> <span class="token number">10254</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">168</span> <span class="token operator">+</span> <span class="token number">34588</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">167</span> <span class="token operator">+</span> <span class="token number">27434</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">166</span> <span class="token operator">+</span> <span class="token number">29552</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">165</span> <span class="token operator">+</span> <span class="token number">7105</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">164</span> <span class="token operator">+</span> <span class="token number">22604</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">163</span> <span class="token operator">+</span> <span class="token number">41253</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">162</span> <span class="token operator">+</span> <span class="token number">42675</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">161</span> <span class="token operator">+</span> <span class="token number">21153</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">160</span> <span class="token operator">+</span> <span class="token number">32838</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">159</span> <span class="token operator">+</span> <span class="token number">34391</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">158</span> <span class="token operator">+</span> <span class="token number">832</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">157</span> <span class="token operator">+</span> <span class="token number">720</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">156</span> <span class="token operator">+</span> <span class="token number">22883</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">155</span> <span class="token operator">+</span> <span class="token number">19236</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">154</span> <span class="token operator">+</span> <span class="token number">33772</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">153</span> <span class="token operator">+</span> <span class="token number">5020</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">152</span> <span class="token operator">+</span> <span class="token number">17943</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">151</span> <span class="token operator">+</span> <span class="token number">26967</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">150</span> <span class="token operator">+</span> <span class="token number">30847</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">149</span> <span class="token operator">+</span> <span class="token number">10306</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">148</span> <span class="token operator">+</span> <span class="token number">33966</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">147</span> <span class="token operator">+</span> <span class="token number">43255</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">146</span> <span class="token operator">+</span> <span class="token number">20342</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">145</span> <span class="token operator">+</span> <span class="token number">4474</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">144</span> <span class="token operator">+</span> <span class="token number">3490</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">143</span> <span class="token operator">+</span> <span class="token number">38033</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">142</span> <span class="token operator">+</span> <span class="token number">11224</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">141</span> <span class="token operator">+</span> <span class="token number">30565</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">140</span> <span class="token operator">+</span> <span class="token number">31967</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">139</span> <span class="token operator">+</span> <span class="token number">32382</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">138</span> <span class="token operator">+</span> <span class="token number">9759</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">137</span> <span class="token operator">+</span> <span class="token number">1030</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">136</span> <span class="token operator">+</span> <span class="token number">32122</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">135</span> <span class="token operator">+</span> <span class="token number">42614</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">134</span> <span class="token operator">+</span> <span class="token number">14280</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">133</span> <span class="token operator">+</span> <span class="token number">16533</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">132</span> <span class="token operator">+</span> <span class="token number">32676</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">131</span> <span class="token operator">+</span> <span class="token number">43070</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">130</span> <span class="token operator">+</span> <span class="token number">36009</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">129</span> <span class="token operator">+</span> <span class="token number">28497</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">128</span> <span class="token operator">+</span> <span class="token number">2940</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">127</span> <span class="token operator">+</span> <span class="token number">9747</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">126</span> <span class="token operator">+</span> <span class="token number">22758</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">125</span> <span class="token operator">+</span> <span class="token number">16615</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">124</span> <span class="token operator">+</span> <span class="token number">14086</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">123</span> <span class="token operator">+</span> <span class="token number">13038</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">122</span> <span class="token operator">+</span> <span class="token number">39603</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">121</span> <span class="token operator">+</span> <span class="token number">36260</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">120</span> <span class="token operator">+</span> <span class="token number">32502</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">119</span> <span class="token operator">+</span> <span class="token number">17619</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">118</span> <span class="token operator">+</span> <span class="token number">17700</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">117</span> <span class="token operator">+</span> <span class="token number">15083</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">116</span> <span class="token operator">+</span> <span class="token number">11311</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">115</span> <span class="token operator">+</span> <span class="token number">36496</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">114</span> <span class="token operator">+</span> <span class="token number">1300</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">113</span> <span class="token operator">+</span> <span class="token number">13601</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">112</span> <span class="token operator">+</span> <span class="token number">43425</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">111</span> <span class="token operator">+</span> <span class="token number">10376</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">110</span> <span class="token operator">+</span> <span class="token number">11551</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">109</span> <span class="token operator">+</span> <span class="token number">13684</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">108</span> <span class="token operator">+</span> <span class="token number">14955</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">107</span> <span class="token operator">+</span> <span class="token number">6661</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">106</span> <span class="token operator">+</span> <span class="token number">12674</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">105</span> <span class="token operator">+</span> <span class="token number">21534</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">104</span> <span class="token operator">+</span> <span class="token number">32132</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">103</span> <span class="token operator">+</span> <span class="token number">34135</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">102</span> <span class="token operator">+</span> <span class="token number">43684</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">101</span> <span class="token operator">+</span> <span class="token number">837</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">100</span> <span class="token operator">+</span> <span class="token number">29311</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">99</span> <span class="token operator">+</span> <span class="token number">4849</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">98</span> <span class="token operator">+</span> <span class="token number">26632</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">97</span> <span class="token operator">+</span> <span class="token number">26662</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">96</span> <span class="token operator">+</span> <span class="token number">10159</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">95</span> <span class="token operator">+</span> <span class="token number">32657</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">94</span> <span class="token operator">+</span> <span class="token number">12149</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">93</span> <span class="token operator">+</span> <span class="token number">17858</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">92</span> <span class="token operator">+</span> <span class="token number">35805</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">91</span> <span class="token operator">+</span> <span class="token number">19391</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">90</span> <span class="token operator">+</span> <span class="token number">30884</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">89</span> <span class="token operator">+</span> <span class="token number">42039</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">88</span> <span class="token operator">+</span> <span class="token number">17292</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">87</span> <span class="token operator">+</span> <span class="token number">4694</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">86</span> <span class="token operator">+</span> <span class="token number">1497</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">85</span> <span class="token operator">+</span> <span class="token number">1744</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">84</span> <span class="token operator">+</span> <span class="token number">31071</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">83</span> <span class="token operator">+</span> <span class="token number">26246</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">82</span> <span class="token operator">+</span> <span class="token number">24402</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">81</span> <span class="token operator">+</span> <span class="token number">22068</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">80</span> <span class="token operator">+</span> <span class="token number">39263</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">79</span> <span class="token operator">+</span> <span class="token number">23703</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">78</span> <span class="token operator">+</span> <span class="token number">21484</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">77</span> <span class="token operator">+</span> <span class="token number">12241</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">76</span> <span class="token operator">+</span> <span class="token number">28821</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">75</span> <span class="token operator">+</span> <span class="token number">32886</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">74</span> <span class="token operator">+</span> <span class="token number">43075</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">73</span> <span class="token operator">+</span> <span class="token number">35741</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">72</span> <span class="token operator">+</span> <span class="token number">19936</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">71</span> <span class="token operator">+</span> <span class="token number">37219</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">70</span> <span class="token operator">+</span> <span class="token number">33411</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">69</span> <span class="token operator">+</span> <span class="token number">8301</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">68</span> <span class="token operator">+</span> <span class="token number">12949</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">67</span> <span class="token operator">+</span> <span class="token number">28611</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">66</span> <span class="token operator">+</span> <span class="token number">42654</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">65</span> <span class="token operator">+</span> <span class="token number">6910</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">64</span> <span class="token operator">+</span> <span class="token number">18523</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">63</span> <span class="token operator">+</span> <span class="token number">31144</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">62</span> <span class="token operator">+</span> <span class="token number">21398</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">61</span> <span class="token operator">+</span> <span class="token number">36298</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">60</span> <span class="token operator">+</span> <span class="token number">27158</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">59</span> <span class="token operator">+</span> <span class="token number">918</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">38601</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">57</span> <span class="token operator">+</span> <span class="token number">4269</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">56</span> <span class="token operator">+</span> <span class="token number">5699</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">55</span> <span class="token operator">+</span> <span class="token number">36444</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">54</span> <span class="token operator">+</span> <span class="token number">34791</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token number">37978</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">32481</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">8039</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">11012</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">11454</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">30450</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">1381</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">32403</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">8202</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">8404</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">37648</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">43696</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">34237</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">36490</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">41423</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">35792</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">36950</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">31086</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">38970</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">12439</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">7963</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">16150</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">11382</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">3038</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">20157</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">23531</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">32866</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">5428</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">21132</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">13443</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">28909</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">42716</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">6567</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">24744</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">8727</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">14895</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">28172</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">30903</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">26608</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">27314</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">42224</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">42551</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">37726</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">11203</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">36816</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">5537</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">20301</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">17591</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">41279</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">7999</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">33753</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">34551</span><span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">9659</span><span class="token punctuation">)</span><span class="token comment"># print(factor(N))</span>e <span class="token operator">=</span> <span class="token number">65537</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">43753</span><span class="token operator">^</span><span class="token number">65</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">43753</span><span class="token operator">^</span><span class="token number">112</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>ans <span class="token operator">=</span> R<span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span>temp<span class="token operator">=</span> c<span class="token comment"># while(True):</span><span class="token comment"># if(d % 2 == 1):</span><span class="token comment"># ans = (ans * temp) % N</span><span class="token comment"># d = d - 1</span><span class="token comment"># d = d / 2</span><span class="token comment"># temp = (temp * temp) % N</span><span class="token comment"># if(d == 0):</span><span class="token comment"># break</span><span class="token comment"># #快速幂</span><span class="token comment"># print (ans)</span>flag <span class="token operator">=</span> <span class="token number">125</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">62</span> <span class="token operator">+</span> <span class="token number">111</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">61</span> <span class="token operator">+</span> <span class="token number">114</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">60</span> <span class="token operator">+</span> <span class="token number">117</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">59</span> <span class="token operator">+</span> <span class="token number">53</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">58</span> <span class="token operator">+</span> <span class="token number">51</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">57</span> <span class="token operator">+</span> <span class="token number">51</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">56</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">55</span> <span class="token operator">+</span> <span class="token number">106</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">54</span> <span class="token operator">+</span> <span class="token number">110</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token number">102</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">106</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">100</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">104</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">101</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">117</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">52</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">52</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">57</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">48</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">50</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">107</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">35</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">101</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">114</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">117</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">99</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">101</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">115</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">110</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">105</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">95</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">116</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">117</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">98</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">95</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">110</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">117</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">102</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">95</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">115</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">105</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">95</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">101</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">107</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">105</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">95</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">109</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">111</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">114</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">102</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">95</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">65</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">83</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">82</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">123</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">114</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">118</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">101</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">116</span><span class="token operator">*</span>y<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">97</span><span class="token operator">*</span>y <span class="token operator">+</span> <span class="token number">119</span>res <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    res <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token comment"># watevr&#123;RSA_from_ikea_is_fun_but_insecure#k20944uehdjfnjd335uro&#125;</span></code></pre><h2 id="GUET-CTF2019-Uncle-Sam"><a href="#GUET-CTF2019-Uncle-Sam" class="headerlink" title="[GUET-CTF2019]Uncle Sam"></a>[GUET-CTF2019]Uncle Sam</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">generkey</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span>k<span class="token punctuation">)</span>pubkey <span class="token operator">=</span> p<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">*</span> qn <span class="token operator">=</span> pubkeyl <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> gcd<span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>privkey <span class="token operator">=</span> inverse<span class="token punctuation">(</span>n<span class="token punctuation">,</span> l<span class="token punctuation">)</span><span class="token keyword">return</span> pubkey<span class="token punctuation">,</span> privkey<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> pubkey<span class="token punctuation">,</span> pubkey<span class="token punctuation">)</span><span class="token comment"># pubkey =  2188967977749378274223515689363599801320698247938997135947965550196681836543275429767581633044354412195352229175764784503562989045268075431206876726265968368605210824232207290410773979606662689866265612797103853982014198455433380266671856355564273196151136025319624636805659505233975208570409914054916955097594873702395812044506205943671404203774360656553350987491558491176962018842708476009578127303566834534914605109859995649555122751891647040448980718882755855420324482466559223748065037520788159654436293431470164057490350841209872489538460060216015196875136927502162027562546316560342464968237957692873588796640619530455268367136243313422579857823529592167101260779382665832380054690727358197646512896661216090677033395209196007249594394515130315041760988292009930675192749010228592156047159029095406021812884258810889225617544404799863903982758961208187042972047819358256866346758337277473016068375206319837317222523597</span><span class="token comment"># privkey = 1430375790065574721602196196929651174572674429040725535698217207301881161695296519567051246290199551982286327831985649037584885137134580625982555634409225551121712376849579015320947279716204424716566222721338735256648873164510429206991141648646869378141312253135997851908862030990576004173514556541317395106924370019574216894560447817319669690140544728277302043783163888037836675290468320723215759693903569878293475447370766682477726453262771004872749335257953507469109966448126634101604029506006038527612917418016783711729800719387298398848370079742790126047329182349899824258355003200173612567191747851669220766603</span><span class="token comment"># enc = 1491421391364871767357931639710394622399451019824572362288458431186299231664459957755422474433520889084351841298056066100216440853409346006657723086501921816381226292526490195810903459483318275931326433052468863850690793659405367902593999395060606972100169925074005992478583035226026829214443008941631771292291305226470216430735050944285543542354459162474346521327649934512511202470099020668235115245819634762067338432916012664452035696422865651002305445711778476072004708256200872226475346448360491248823843688268126341094612981308791499434770936360676087490303951728563482686307164877000300082742316368597958297217061375140696272398140310043942637287763946305961019518639745426370821124559939597559475362769382796386720030343305889701616194279058139516811941262747298761646317383112470923295543635754747288259324745583689440061956478083777663996487389553238481759103908588004219390662578446313004404784835263543083088327198</span></code></pre><p>$$<br>\because n=p^{2}q<br>$$</p><p>$$<br>\therefore\phi(n)=p(p-1)(q-1)<br>$$</p><p>费马小定理：<br>$$<br>a^{p(p-1)(q-1)}\equiv1(\bmod n)<br>$$<br>由题目：<br>$$<br>nd\equiv1(\bmod (p-1)(q-1))<br>$$</p><p>$$<br>a^{nd}\equiv a^{nd\bmod((p-1)(q-1))}\equiv a\bmod(pq)<br>$$</p><p>$$<br>a^{nd}-a\equiv0(\bmod pq)<br>$$</p><p>$$<br>pq=gcd(a^{nd}-a, n)<br>$$</p><p>这里取a=2</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">2188967977749378274223515689363599801320698247938997135947965550196681836543275429767581633044354412195352229175764784503562989045268075431206876726265968368605210824232207290410773979606662689866265612797103853982014198455433380266671856355564273196151136025319624636805659505233975208570409914054916955097594873702395812044506205943671404203774360656553350987491558491176962018842708476009578127303566834534914605109859995649555122751891647040448980718882755855420324482466559223748065037520788159654436293431470164057490350841209872489538460060216015196875136927502162027562546316560342464968237957692873588796640619530455268367136243313422579857823529592167101260779382665832380054690727358197646512896661216090677033395209196007249594394515130315041760988292009930675192749010228592156047159029095406021812884258810889225617544404799863903982758961208187042972047819358256866346758337277473016068375206319837317222523597</span>d <span class="token operator">=</span> <span class="token number">1430375790065574721602196196929651174572674429040725535698217207301881161695296519567051246290199551982286327831985649037584885137134580625982555634409225551121712376849579015320947279716204424716566222721338735256648873164510429206991141648646869378141312253135997851908862030990576004173514556541317395106924370019574216894560447817319669690140544728277302043783163888037836675290468320723215759693903569878293475447370766682477726453262771004872749335257953507469109966448126634101604029506006038527612917418016783711729800719387298398848370079742790126047329182349899824258355003200173612567191747851669220766603</span>c <span class="token operator">=</span> <span class="token number">1491421391364871767357931639710394622399451019824572362288458431186299231664459957755422474433520889084351841298056066100216440853409346006657723086501921816381226292526490195810903459483318275931326433052468863850690793659405367902593999395060606972100169925074005992478583035226026829214443008941631771292291305226470216430735050944285543542354459162474346521327649934512511202470099020668235115245819634762067338432916012664452035696422865651002305445711778476072004708256200872226475346448360491248823843688268126341094612981308791499434770936360676087490303951728563482686307164877000300082742316368597958297217061375140696272398140310043942637287763946305961019518639745426370821124559939597559475362769382796386720030343305889701616194279058139516811941262747298761646317383112470923295543635754747288259324745583689440061956478083777663996487389553238481759103908588004219390662578446313004404784835263543083088327198</span>x <span class="token operator">=</span> gcd<span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> n<span class="token operator">*</span>d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token keyword">print</span> n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;61e19444-7afb-11e9-b704-4ccc6adfc6f0&#125;s</span></code></pre><h2 id="b01lers2020-safety-in-numbers"><a href="#b01lers2020-safety-in-numbers" class="headerlink" title="[b01lers2020]safety_in_numbers"></a>[b01lers2020]safety_in_numbers</h2><p>n很大，直接对c开e次方得到m，因为小端序存储，所以最后[::-1]反序</p><h2 id="cryptoku"><a href="#cryptoku" class="headerlink" title="cryptoku"></a>cryptoku</h2><h3 id="11littlersa"><a href="#11littlersa" class="headerlink" title="11littlersa"></a>11littlersa</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> bytes_to_long<span class="token punctuation">,</span> getPrime<span class="token keyword">from</span> secret <span class="token keyword">import</span> flagp<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qe <span class="token operator">=</span> <span class="token number">0x10001</span>s <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">1314</span><span class="token operator">*</span>p <span class="token operator">-</span> <span class="token number">520</span><span class="token operator">*</span>q<span class="token punctuation">,</span> n <span class="token operator">-</span> p <span class="token operator">-</span> q<span class="token punctuation">,</span> n<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'n = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>n<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f's = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>s<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'c = </span><span class="token interpolation"><span class="token punctuation">&#123;</span>c<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">)</span></code></pre><p>$$<br>\phi(n)=(p-1)(q-1)=pq-p-q+1<br>$$</p><p>$$<br>(1314p-520q)^{\phi(n)}\equiv 1(\bmod n)<br>$$</p><p>$$<br>s\equiv(1314p-520q)^{n-p-q}(\bmod n)\equiv(1314p-520q)^{-1}(\bmod n)<br>$$</p><p>$$<br>1314p-520q\equiv s^{-1}(\bmod n)<br>$$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">21527992586049890742463208685084056886310965008510150149662539465508522110836141118201993905501496573947758250830179174167767904598851246246883313258119194517451136464061754012857201163557130509549702608281712944282522512395405915342449680305392687437622431284142745065375302709310557854831484673680407778594714529585782056415778141766213407370997672554723753202013563817286448850181916119501687341489042612085905005774185877110170473521083991709238570129700236355021759838698301009539406493513673267448754800055385494881665134028236347565559420582088784168876596273511904770078853805492034067652075997160067097096389</span>s <span class="token operator">=</span> <span class="token number">689371464378603954186279564342194575991521192704684277207288178599489794962450715850049002302487534260512846768904192932944096786449367699010863982182323679968386484011474068581844681990765999053322562552934116860156681394692018958475994862295885631931726039769250893352710917976460230207966276224955917433141021398552482066127690546179606369096409983860114624081300199440661763939814014217903483843133317053237884070077730674376541753789775676614501869056220897164107160298416764019915900754814865340973490933257727198707945012160497462607376733744883748828632202067199804149859997895800374289404967684151848041078</span>c <span class="token operator">=</span> <span class="token number">16018690856580134963499619732983511637301063037736211987652823346056397737077114122360038377367134402506313854843001130337277242449318875422253234028539504328893925016557601740495977176944226657312832415247368764132804576588715682110651105761722000223962198274728394855418102910814601509869869023753969580176908357542029260491093770925557678492025234534301611764843254092935308547079513469696933137356279998386197451965233193792656124337741310279640692073770305956685952966109064967232736373641126701147376387370878674943061250794501317147835670604279925388762127236579127880834986244206920182304311470798055226190212</span><span class="token comment"># from sympy import *</span><span class="token comment"># s = invert(s, n)</span><span class="token comment"># p = Symbol('p')</span><span class="token comment"># q = Symbol('q')</span><span class="token comment"># p, q = solve([p*q-n, 1314*p-520*q-s], [p, q])</span><span class="token comment"># print(p, q)</span>p <span class="token operator">=</span> <span class="token number">154284076004209590955001376421515345266804896344881716639416022056900642771581349207838844600803873059250955811948664771306587899601011067929479621101844021172358446324898774632702069255293306160485960431628918978692153936045835115287574063945828069016255778095497627064585169033677372120904914719277876790361</span>q <span class="token operator">=</span> <span class="token number">139534766928652484198642301870530258382621694742867470419339097644217217548670323347872788454147801929413925661162297845232088692598434720859485702680791518176068930632495796027974231708386994067530792729112431398309511627474634552488231112040611112002376565831994653508566728340240409080110236842144836956749</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="12eeeeezrsa"><a href="#12eeeeezrsa" class="headerlink" title="12eeeeezrsa"></a>12eeeeezrsa</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span>bytes_to_long<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> powmod<span class="token punctuation">,</span>is_prime<span class="token punctuation">,</span>invert<span class="token punctuation">,</span>bit_length<span class="token keyword">from</span> FLAG <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">RSA_genParameter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> p <span class="token operator">+</span> <span class="token number">1</span>    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        q <span class="token operator">+=</span> <span class="token number">2</span> <span class="token keyword">if</span> q <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">1</span>        <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>q<span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">assert</span> p <span class="token operator">&lt;</span> q    n <span class="token operator">=</span> p<span class="token operator">*</span>q    e <span class="token operator">=</span> <span class="token number">0x10001</span>    d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    cipherParameter <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span>    <span class="token keyword">return</span> cipherParameter<span class="token keyword">def</span> <span class="token function">leak_info</span><span class="token punctuation">(</span>cipherParameter<span class="token punctuation">,</span>c<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipherParameter<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span>    <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">=</span> cipherParameter    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Here's sthg you may want to know."</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"n ="</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"e ="</span><span class="token punctuation">,</span>e<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c_mod_p ="</span><span class="token punctuation">,</span>c <span class="token operator">%</span> p<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c_mod_q ="</span><span class="token punctuation">,</span>c <span class="token operator">%</span> q<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">RSA_encryption</span><span class="token punctuation">(</span>message<span class="token punctuation">,</span>cipherParameter<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>cipherParameter<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">5</span>    <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">,</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span> <span class="token operator">=</span> cipherParameter    m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>message<span class="token punctuation">)</span>    <span class="token keyword">assert</span> bit_length<span class="token punctuation">(</span>q<span class="token punctuation">)</span> <span class="token operator">&lt;</span> bit_length<span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">&lt;</span> bit_length<span class="token punctuation">(</span>n<span class="token punctuation">)</span>    c <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token keyword">return</span> c<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    cipherParameter <span class="token operator">=</span> RSA_genParameter<span class="token punctuation">(</span><span class="token punctuation">)</span>    c <span class="token operator">=</span> RSA_encryption<span class="token punctuation">(</span>flag<span class="token punctuation">,</span>cipherParameter<span class="token punctuation">)</span>    leak_info<span class="token punctuation">(</span>cipherParameter<span class="token punctuation">,</span>c<span class="token punctuation">)</span></code></pre><p>pq相差不大，对n开方爆破，最后中国剩余定理</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdmn <span class="token operator">=</span> <span class="token number">1868334156775298896231812470739357521959374975890291444695640351814139728754262335708297349257391991779446164262218985159</span>e <span class="token operator">=</span> <span class="token number">65537</span>c_mod_p <span class="token operator">=</span> <span class="token number">1062384575136942194457401502734355664153040886120004084031121</span>c_mod_q <span class="token operator">=</span> <span class="token number">255520115722444172168148366934668388396463537147929322939703</span><span class="token comment"># p = iroot(n, 2)[0]</span><span class="token comment"># for i in tqdm(range(1000)):</span><span class="token comment">#     p -= 1</span><span class="token comment">#     if is_prime(p):</span><span class="token comment">#         q = next_prime(p)</span><span class="token comment">#         if p*q == n:</span><span class="token comment">#             print(p)</span><span class="token comment">#             print(q)</span><span class="token comment">#             exit()</span>p <span class="token operator">=</span> <span class="token number">1366870204801940547527182701310518853392777286350885464974949</span>q <span class="token operator">=</span> <span class="token number">1366870204801940547527182701310518853392777286350885464975291</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token punctuation">(</span>c_mod_p<span class="token operator">*</span>invert<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token operator">*</span>q <span class="token operator">+</span> c_mod_q<span class="token operator">*</span>invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token operator">*</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="1ezDLP1"><a href="#1ezDLP1" class="headerlink" title="1ezDLP1"></a>1ezDLP1</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> FLAGx<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>g<span class="token operator">=</span><span class="token number">19</span>p<span class="token operator">=</span><span class="token number">335215034881592512312398694238485179340610060759881511231472142277527176340784432381542726029524727833039074808456839870641607412102746854257629226877248337002993023452385472058106944014653401647033456174126976474875859099023703472904735779212010820524934972736276889281087909166017427905825553503050645575935980580803899122224368875197728677516907272452047278523846912786938173456942568602502013001099009776563388736434564541041529106817380347284002060811645842312648498340150736573246893588079033524476111268686138924892091575797329915240849862827621736832883215569687974368499436632617425922744658912248644475097139485785819369867604176912652851123185884810544172785948158330991257118563772736929105360124222843930130347670027236797458715653361366862282591170630650344062377644570729478796795124594909835004189813214758026703689710017334501371279295621820181402191463184275851324378938021156631501330660825566054528793444353</span>h<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>x<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span></code></pre><p>用discrete_log函数求解离散对数，第一个参数是模数，第二个参数是余数，第三个参数是底数</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>discrete_log<span class="token punctuation">(</span>p<span class="token punctuation">,</span> h<span class="token punctuation">,</span> g<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="3friends8470"><a href="#3friends8470" class="headerlink" title="3friends8470"></a>3friends8470</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> long_to_bytes<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> inverse<span class="token keyword">import</span> math<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> next_primeFLAG <span class="token operator">=</span> <span class="token string">b"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>N <span class="token operator">=</span> p<span class="token operator">*</span>qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>my_key <span class="token operator">=</span> <span class="token punctuation">(</span>N<span class="token punctuation">,</span> d<span class="token punctuation">)</span>friends <span class="token operator">=</span> <span class="token number">8470</span>friend_keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>friends<span class="token punctuation">)</span><span class="token punctuation">]</span>cipher <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span><span class="token keyword">for</span> key <span class="token keyword">in</span> friend_keys<span class="token punctuation">:</span>    cipher <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">r'C:\Users\dell\Desktop\新建文件夹\output.txt'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"My private key: &#123;&#125;\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>my_key<span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"My Friend's public keys: &#123;&#125;\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>friend_keys<span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"Encrypted flag: &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>先用d分解n得到pq，再用8470组随机的e来循环解密</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> random <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">9297128283983941432045234147703287250798904268213511485649937145473424112522632091170463801330377126937076682880003270817044620519588692217610024692461756476752594502866379940325928306678497619609001865840258345351699434491103889835804179223493975567452456409725769747131345103948177587204595896812289690514961222948520456725050008127602344945524085088187909363361785959139547611544443308370415769438618596524731053548712520584571294810550954901279297527175272717793850043803267593549272731006423249152834079138241719534660665593188796158286929076617604721784539091610652167054547455662364998461130576136393569033813</span><span class="token comment"># e = 0x10001</span><span class="token comment"># d = 6770020798885601064459690086986648419516854729266725798093778329698158580983529476279476387245213965070389406550229581659243182096469645523917835854530302033051010382841635257826483918696582722745935823176139417660545220443702808102813416010540656362139456753304895091968646450031568106476722004113293267931645917258893154445063272866515222067643284609528131590504180360042380847074388715109170360380897549117453522559309939506123630622924554811758586737785047436321787103828109958069019456723464178418058164853262404820775941088122590290160976865610244219489885823711823941542135342825622883363168882921952842121633</span><span class="token comment"># def getpq(n, e, d):</span><span class="token comment"># while True:</span><span class="token comment"># k = e * d - 1</span><span class="token comment"># g = randint(0, n)</span><span class="token comment"># while k % 2 == 0:</span><span class="token comment"># k = k // 2</span><span class="token comment"># temp = pow(g, k, n) - 1</span><span class="token comment"># if gcd(temp, n) > 1 and temp != 0:</span><span class="token comment"># return gcd(temp, n)</span><span class="token comment"># p = getpq(n, e, d)</span><span class="token comment"># q = n // p</span><span class="token comment"># print(p, q)</span>p <span class="token operator">=</span> <span class="token number">101665011582651453374639803565481302049981406968172618891916121842144444187702507883777930908263676281802852505341671701004463488880202765828561612794953216299967043485152863592862914928641800350504709331953141076969087534525669455464181441497270220049964519511886797924686414128228303396106049236567397802253</span>q <span class="token operator">=</span> <span class="token number">91448652188718607674536149764330302168277487253616424144817592968724886973818242765838687004195988983146722344012143324133761729763148910627851790703713801218943004433890303118840339404360417832267178619895052804669076307048806566907571706501040337228809066397074242066455053587803754827151822332719673020521</span>c <span class="token operator">=</span> <span class="token number">2140180080934141827450126364391018115860389226884426757770714360018926009963088161257799535546140166149364676631283332158950547864614389850798718187432074087541976429222957826470201323917675604895134829043587019669199783408789746196365136682199920323822099947472839409935007795402592449380881687184818261811177333059582900044459905652841833575554703149217878353476815356254727032482879912733566474034636632524362926394011231323451701169715998263415893218582682966676188175274811817023283479089335113330942129729688827121339968304170401548272904535035612550021543429243345521989994397488226013103294945141772283585871</span>e <span class="token operator">=</span> e <span class="token operator">=</span> e<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="15FwRSA1"><a href="#15FwRSA1" class="headerlink" title="15FwRSA1"></a>15FwRSA1</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> os <span class="token keyword">import</span> urandom<span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token keyword">from</span> secret <span class="token keyword">import</span> flagm<span class="token operator">=</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>q<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">2048</span><span class="token punctuation">)</span>e<span class="token operator">=</span><span class="token number">10007</span>n<span class="token operator">=</span>p<span class="token operator">*</span>qf<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span>r<span class="token operator">=</span><span class="token number">348839131610151502497259090343608859521638225585948539355235805416998922506252838526137107642248922957945029984864898040083389762927448651701934862548862243576769546778107847452918384857322265982526840217472192128124528285918345330110723123433656768664899422877893087552183627675058904910388326441867525988276987265395780819178852504141769404291727430703468489502342212147446099165213452396270310114148938660411646174364616328990161600167229258203782409553365813379255237357273330004080769083627285528263323766522062801308515349668978595752320407544952912547157680347320670156733011984612736871189579240255899393186551853745958340396834063474144474999600546323965307387862449136280226873741996433230472616299022027512571576609288751470982626619954105037930619399475215320588316683586987187571797605468130139607830931194115605143664746831017839122419503652878578762022011266540177318575415788308050665106331551844524585012870487813810607617422536650365491146285696876926188995154449860004922949730904320705772054601052781208968873449657164701848998563087238767195491607087750944267163721274679321454451772574982106455686603260593968904504261107423334079578666110521816206168880831013715650059006028362724318932856902542115065802613405089419492547393548641346438052909352742641202034829737046695805732331925243748516214791227685903754750563838997575837898379170873992023639274795144036895836861639527076861155907115597701350403372007773865437618084954365027859717120052135447470120382123882602757439306701374395747663873</span>h<span class="token operator">=</span>p<span class="token operator">*</span>inverse<span class="token punctuation">(</span>f<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token operator">%</span>rooo<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"given.py"</span><span class="token punctuation">,</span><span class="token string">"w"</span><span class="token punctuation">)</span>ooo<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"e="</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>ooo<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"n="</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>ooo<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"r="</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>r<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>ooo<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"h="</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>ooo<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">"c="</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'\n'</span><span class="token punctuation">)</span>ooo<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>格</p><pre class="language-python" data-language="python"><code class="language-python">h <span class="token operator">=</span> p <span class="token operator">=</span> c <span class="token operator">=</span> v1 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">)</span>v2 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> p<span class="token punctuation">]</span><span class="token punctuation">)</span>m <span class="token operator">=</span> matrix<span class="token punctuation">(</span><span class="token punctuation">[</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>shortest_vector <span class="token operator">=</span> m<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>f<span class="token punctuation">,</span> g <span class="token operator">=</span> shortest_vector<span class="token keyword">print</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span>f <span class="token operator">=</span>  g <span class="token operator">=</span> a <span class="token operator">=</span> f<span class="token operator">*</span>c <span class="token operator">%</span> p <span class="token operator">%</span> gm <span class="token operator">=</span> a <span class="token operator">*</span> inverse_mod<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">%</span> g<span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>p <span class="token operator">=</span> n <span class="token operator">=</span> c <span class="token operator">=</span> q <span class="token operator">=</span> n <span class="token operator">//</span> pd <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h3 id="14boom"><a href="#14boom" class="headerlink" title="14boom"></a>14boom</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">assert</span> flag<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string">"aflag"</span><span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>a <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token operator">*</span>self<span class="token punctuation">.</span>seed<span class="token operator">+</span>self<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>m        <span class="token keyword">return</span> self<span class="token punctuation">.</span>seed <span class="token operator">>></span> <span class="token number">16</span>    <span class="token keyword">def</span> <span class="token function">output</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> self<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"state1 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"state2 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token punctuation">)</span>lcg<span class="token punctuation">.</span>output<span class="token punctuation">(</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>flag<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>              <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''a = 2901797069b = 3983697489m = 3156268457state1 = 46432state2 = 37133555944023803039445280183217695573804405851318132'''</span><span class="token comment">#hint :题目名字</span></code></pre><p>不需要求出种子，只需要还原移位爆破满足条件的</p><pre class="language-python" data-language="python"><code class="language-python">a <span class="token operator">=</span> <span class="token number">2901797069</span>b <span class="token operator">=</span> <span class="token number">3983697489</span>m <span class="token operator">=</span> <span class="token number">3156268457</span>se<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">65536</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">46432</span><span class="token operator">&lt;&lt;</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">+</span>i    s <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token operator">*</span>s<span class="token operator">+</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> m    <span class="token keyword">if</span> <span class="token punctuation">(</span>s<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">37133</span><span class="token punctuation">:</span>        se<span class="token punctuation">.</span>append<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">2901797069</span>        self<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">3983697489</span>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> <span class="token number">3156268457</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span><span class="token number">0</span>    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token operator">*</span>self<span class="token punctuation">.</span>seed<span class="token operator">+</span>self<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>m        <span class="token keyword">return</span> self<span class="token punctuation">.</span>seed <span class="token operator">>></span> <span class="token number">16</span>lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token punctuation">)</span>c<span class="token operator">=</span><span class="token number">555944023803039445280183217695573804405851318132</span>c<span class="token operator">=</span>long_to_bytes<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token keyword">for</span> _ <span class="token keyword">in</span> se<span class="token punctuation">:</span>    lcg<span class="token punctuation">.</span>seed<span class="token operator">=</span>_    t<span class="token operator">=</span><span class="token string">b''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>long_to_bytes<span class="token punctuation">(</span><span class="token punctuation">(</span>c<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> t<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string">b'aflag'</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span></code></pre><h2 id="INSHack2019-Yet-Another-RSA-Challenge-Part-1"><a href="#INSHack2019-Yet-Another-RSA-Challenge-Part-1" class="headerlink" title="[INSHack2019]Yet Another RSA Challenge - Part 1"></a>[INSHack2019]Yet Another RSA Challenge - Part 1</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> subprocessp <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">'openssl prime -generate -bits 2048 -hex'</span><span class="token punctuation">)</span>q <span class="token operator">=</span> subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">(</span><span class="token string">'openssl prime -generate -bits 2048 -hex'</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token string">'INSA&#123;REDACTED&#125;'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'hex'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span>N <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">int</span><span class="token punctuation">(</span>q<span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">print</span> N<span class="token keyword">print</span> <span class="token string">'0x'</span><span class="token operator">+</span>p<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'9F'</span><span class="token punctuation">,</span><span class="token string">'FC'</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span><span class="token number">65537</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span></code></pre><p>p的所有9f被替换成fc，切片再爆破插入即可</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">719579745653303119025873098043848913976880838286635817351790189702008424828505522253331968992725441130409959387942238566082746772468987336980704680915524591881919460709921709513741059003955050088052599067720107149755856317364317707629467090624585752920523062378696431510814381603360130752588995217840721808871896469275562085215852034302374902524921137398710508865248881286824902780186249148613287250056380811479959269915786545911048030947364841177976623684660771594747297272818410589981294227084173316280447729440036251406684111603371364957690353449585185893322538541593242187738587675489180722498945337715511212885934126635221601469699184812336984707723198731876940991485904637481371763302337637617744175461566445514603405016576604569057507997291470369704260553992902776099599438704680775883984720946337235834374667842758010444010254965664863296455406931885650448386682827401907759661117637294838753325610213809162253020362015045242003388829769019579522792182295457962911430276020610658073659629786668639126004851910536565721128484604554703970965744790413684836096724064390486888113608024265771815004188203124405817878645103282802994701531113849607969243815078720289912255827700390198089699808626116357304202660642601149742427766381</span>p <span class="token operator">=</span> <span class="token string">'DCC5A0BD3A1FC0BEB0DA1C2E8CF6B474481B7C12849B76E03C4C946724DB577D2825D6AA193DB559BC9DBABE1DDE8B5E7805E48749EF002F622F7CDBD7853B200E2A027E87E331AFCFD066ED9900F1E5F5E5196A451A6F9E329EB889D773F08E5FBF45AACB818FD186DD74626180294DCC31805A88D1B71DE5BFEF3ED01F12678D906A833A78EDCE9BDAF22BBE45C0BFB7A82AFE42C1C3B8581C83BF43DFE31BFD81527E507686956458905CC9A660604552A060109DC81D01F229A264AB67C6D7168721AB36DE769CEAFB97F238050193EC942078DDF5329A387F46253A4411A9C8BB71F9AEB11AC9623E41C14FCD2739D76E69283E57DDB11FC531B4611EE3'</span>c <span class="token operator">=</span> <span class="token number">596380963583874022971492302071822444225514552231574984926542429117396590795270181084030717066220888052607057994262255729890598322976783889090993129161030148064314476199052180347747135088933481343974996843632511300255010825580875930722684714290535684951679115573751200980708359500292172387447570080875531002842462002727646367063816531958020271149645805755077133231395881833164790825731218786554806777097126212126561056170733032553159740167058242065879953688453169613384659653035659118823444582576657499974059388261153064772228570460351169216103620379299362366574826080703907036316546232196313193923841110510170689800892941998845140534954264505413254429240789223724066502818922164419890197058252325607667959185100118251170368909192832882776642565026481260424714348087206462283972676596101498123547647078981435969530082351104111747783346230914935599764345176602456069568419879060577771404946743580809330315332836749661503035076868102720709045692483171306425207758972682717326821412843569770615848397477633761506670219845039890098105484693890695897858251238713238301401843678654564558196040100908796513657968507381392735855990706254646471937809011610992016368630851454275478216664521360246605400986428230407975530880206404171034278692756</span>e <span class="token operator">=</span> <span class="token number">65537</span>p1 <span class="token operator">=</span> p<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'FC'</span><span class="token punctuation">)</span><span class="token comment"># print(p1)</span><span class="token comment"># print(len(p1))</span><span class="token comment"># print(int(p, 16))</span><span class="token comment"># s = ['9F', 'FC']</span><span class="token comment"># salt = []</span><span class="token comment"># for a in range(2):</span><span class="token comment"># for b in range(2):</span><span class="token comment"># for c in range(2):</span><span class="token comment"># for d in range(2):</span><span class="token comment"># salt.append(s[a]+s[b]+s[c]+s[d])</span><span class="token comment"># print(salt)</span><span class="token comment"># print(len(salt))</span>salt <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'9F9F9F9F'</span><span class="token punctuation">,</span> <span class="token string">'9F9F9FFC'</span><span class="token punctuation">,</span> <span class="token string">'9F9FFC9F'</span><span class="token punctuation">,</span> <span class="token string">'9F9FFCFC'</span><span class="token punctuation">,</span> <span class="token string">'9FFC9F9F'</span><span class="token punctuation">,</span> <span class="token string">'9FFC9FFC'</span><span class="token punctuation">,</span> <span class="token string">'9FFCFC9F'</span><span class="token punctuation">,</span> <span class="token string">'9FFCFCFC'</span><span class="token punctuation">,</span> <span class="token string">'FC9F9F9F'</span><span class="token punctuation">,</span> <span class="token string">'FC9F9FFC'</span><span class="token punctuation">,</span> <span class="token string">'FC9FFC9F'</span><span class="token punctuation">,</span> <span class="token string">'FC9FFCFC'</span><span class="token punctuation">,</span> <span class="token string">'FCFC9F9F'</span><span class="token punctuation">,</span> <span class="token string">'FCFC9FFC'</span><span class="token punctuation">,</span> <span class="token string">'FCFCFC9F'</span><span class="token punctuation">,</span> <span class="token string">'FCFCFCFC'</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>p <span class="token operator">=</span> p1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> salt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> p1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> salt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">4</span><span class="token punctuation">]</span> <span class="token operator">+</span> p1<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">+</span> salt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span> <span class="token operator">+</span> p1<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">+</span> salt<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">:</span><span class="token number">8</span><span class="token punctuation">]</span> <span class="token operator">+</span> p1<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>q <span class="token operator">=</span> n <span class="token operator">//</span> pd <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token comment"># INSA&#123;I_w1ll_us3_OTp_n3xT_T1M3&#125;</span></code></pre><h2 id="MRCTF2020-Easy-RSA"><a href="#MRCTF2020-Easy-RSA" class="headerlink" title="[MRCTF2020]Easy_RSA"></a>[MRCTF2020]Easy_RSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> isPrime<span class="token punctuation">,</span> getRandomNBitInteger<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes<span class="token keyword">import</span> base64<span class="token keyword">from</span> zlib <span class="token keyword">import</span> <span class="token operator">*</span>flag <span class="token operator">=</span> <span class="token string">b"MRCTF&#123;XXXX&#125;"</span>base <span class="token operator">=</span> <span class="token number">65537</span><span class="token keyword">def</span> <span class="token function">gen_prime</span><span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    A <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        A <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>N<span class="token punctuation">)</span>        <span class="token keyword">if</span> A <span class="token operator">%</span> <span class="token number">8</span> <span class="token operator">==</span> <span class="token number">5</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> A<span class="token keyword">def</span> <span class="token function">gen_p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> q<span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_n = "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    F_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_F_n = "</span><span class="token punctuation">,</span> F_n<span class="token punctuation">)</span>    factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">+</span> <span class="token number">2020</span> <span class="token operator">*</span> q    <span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gen_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>p <span class="token operator">&lt;</span> q<span class="token punctuation">)</span>    n <span class="token operator">=</span> p <span class="token operator">*</span> q    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_n = "</span><span class="token punctuation">,</span> n<span class="token punctuation">)</span>    e <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span>    F_n <span class="token operator">=</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>e<span class="token punctuation">,</span> F_n<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>        e <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span>    d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> F_n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_E_D = "</span><span class="token punctuation">,</span> e <span class="token operator">*</span> d<span class="token punctuation">)</span>    factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p <span class="token operator">-</span> <span class="token number">2020</span> <span class="token operator">*</span> q    <span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>        factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    _E <span class="token operator">=</span> base    _P <span class="token operator">=</span> gen_p<span class="token punctuation">(</span><span class="token punctuation">)</span>    _Q <span class="token operator">=</span> gen_q<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>gcd<span class="token punctuation">(</span>_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>_P <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_Q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>    _M <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    _C <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>_M<span class="token punctuation">,</span> _E<span class="token punctuation">,</span> _P <span class="token operator">*</span> _Q<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ciphertext = "</span><span class="token punctuation">,</span> _C<span class="token punctuation">)</span></code></pre><p>p和q由两种方式生成，p由n和phi解方程组得到，求q转化为已知ed和n的问题</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#from sympy import *</span><span class="token comment"># p_q = P_n - P_F_n + 1</span><span class="token comment"># p = Symbol('p')</span><span class="token comment"># q = Symbol('q')</span><span class="token comment"># p1, q1 = solve([p*q - P_n, p+q - p_q], [p ,q])</span><span class="token comment"># print(p1, q1)</span>p1 <span class="token operator">=</span> <span class="token number">118153578345562250550767057731385782963063734586321112579869747650001448473633860305142281504862521928246520876300707405515141444727550839066835195905927281903880307860942630322499106164191736174201506457157272220802515607939618476716593888428832962374494147723577980992661629254713116923690067827155668889571</span> q1 <span class="token operator">=</span> <span class="token number">118975085954858660642562584152139261422493348532593400307960127317249511761542030451912561362687361053191375307180413931721355251895350936376781657674896801388806379750757264377396608174235075021854614328009897408824235800167369204203680938298803752964983358298299699273425596382268869237139724754214443556383</span>P <span class="token operator">=</span> next_prime<span class="token punctuation">(</span><span class="token number">2021</span><span class="token operator">*</span>p1<span class="token operator">+</span><span class="token number">2020</span><span class="token operator">*</span>q1<span class="token punctuation">)</span>K<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Q_E_D<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>Q_n<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span>phi<span class="token operator">=</span><span class="token punctuation">(</span>Q_E_D<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>K<span class="token comment"># p_q = Q_n - phi + 1</span><span class="token comment"># p2 = Symbol('p2')</span><span class="token comment"># q2 = Symbol('q2')</span><span class="token comment"># p2, q2 = solve([p2*q2 - Q_n, p2+q2 - p_q], [p2 ,q2])</span><span class="token comment"># print(p2, q2)</span>p2 <span class="token operator">=</span> <span class="token number">120538849514661970159855851547577637711900368732462953774738483480759950867244867240401273864984981385806453735655967797329769252143125966966236767391995563418243748302685348336642872306042286401427581501609713577329945760930395130411743322595026287853073310150103535873078436896035943385067893062698858976291</span>q2 <span class="token operator">=</span> <span class="token number">171847486694659608706336923173786708071603689972942289760669690002615525263534483261477699540482615520223300780778172120221008417518590133753701145591943840552802072474293556608389677806415392384924913911677288126066245025731416399656855625839288752326267741979436855441260177305707529456715625062080892327017</span>factor2 <span class="token operator">=</span> <span class="token number">2021</span> <span class="token operator">*</span> p2 <span class="token operator">-</span> <span class="token number">2020</span> <span class="token operator">*</span> q2<span class="token keyword">if</span> factor2 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>    factor2 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> factor2Q <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>factor2<span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span><span class="token number">65537</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>P<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>Q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>Ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> P<span class="token operator">*</span>Q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># MRCTF&#123;Ju3t_@_31mp13_que3t10n&#125;</span></code></pre><h2 id="NPUCTF2020-EzRSA"><a href="#NPUCTF2020-EzRSA" class="headerlink" title="[NPUCTF2020]EzRSA"></a>[NPUCTF2020]EzRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> lcm <span class="token punctuation">,</span> powmod <span class="token punctuation">,</span> invert <span class="token punctuation">,</span> gcd <span class="token punctuation">,</span> mpz<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token keyword">from</span> sympy <span class="token keyword">import</span> nextprime<span class="token keyword">from</span> random <span class="token keyword">import</span> randintp <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qgift <span class="token operator">=</span> lcm<span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span> <span class="token punctuation">,</span> q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>e <span class="token operator">=</span> <span class="token number">54722</span>flag <span class="token operator">=</span> <span class="token string">b'NPUCTF&#123;******************&#125;'</span>m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag <span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span>c <span class="token operator">=</span> powmod<span class="token punctuation">(</span>m <span class="token punctuation">,</span> e <span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'n: '</span> <span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'gift: '</span> <span class="token punctuation">,</span> gift<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'c: '</span> <span class="token punctuation">,</span> c<span class="token punctuation">)</span></code></pre><p>phi是gift的倍数，爆破求解，还要注意e和phi不互素，转化成这个问题：</p><p>$$<br>(m^{gcd(e,\phi(n))})^{\frac{e}{gcd(e,\phi(n))}}\equiv c(\bmod n)<br>$$</p><p>即先用e//gcd(e, phi)求得的d求m，再开gcd(e, phi)次方即可</p><pre class="language-python" data-language="python"><code class="language-python">n <span class="token operator">=</span> <span class="token number">17083941230213489700426636484487738282426471494607098847295335339638177583685457921198569105417734668692072727759139358207667248703952436680183153327606147421932365889983347282046439156176685765143620637107347870401946946501620531665573668068349080410807996582297505889946205052879002028936125315312256470583622913646319779125559691270916064588684997382451412747432722966919513413709987353038375477178385125453567111965259721484997156799355617642131569095810304077131053588483057244340742751804935494087687363416921314041547093118565767609667033859583125275322077617576783247853718516166743858265291135353895239981121</span>gift <span class="token operator">=</span> <span class="token number">2135492653776686212553329560560967285303308936825887355911916917454772197960682240149821138177216833586509090969892419775958406087994054585022894165950768427741545736247918410255804894522085720642952579638418483800243368312702566458196708508543635051350999572787188236243275631609875253617015664414032058822919469443284453403064076232765024248435543326597418851751586308514540124571309152787559712950209357825576896132278045112177910266019741013995106579484868768251084453338417115483515132869594712162052362083414163954681306259137057581036657441897428432575924018950961141822554251369262248368899977337886190114104</span>c <span class="token operator">=</span> <span class="token number">3738960639194737957667684143565005503596276451617922474669745529299929395507971435311181578387223323429323286927370576955078618335757508161263585164126047545413028829873269342924092339298957635079736446851837414357757312525158356579607212496060244403765822636515347192211817658170822313646743520831977673861869637519843133863288550058359429455052676323196728280408508614527953057214779165450356577820378810467527006377296194102671360302059901897977339728292345132827184227155061326328585640019916328847372295754472832318258636054663091475801235050657401857262960415898483713074139212596685365780269667500271108538319</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sympy <span class="token keyword">import</span> Symbol<span class="token punctuation">,</span> solve<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdme1 <span class="token operator">=</span> e <span class="token operator">//</span> <span class="token number">2</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">try</span><span class="token punctuation">:</span>phi <span class="token operator">=</span> gift <span class="token operator">*</span> i<span class="token keyword">if</span> gcd<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> phi<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span> p <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">)</span>q <span class="token operator">=</span> Symbol<span class="token punctuation">(</span><span class="token string">'q'</span><span class="token punctuation">)</span>p_q <span class="token operator">=</span> n <span class="token operator">-</span> phi <span class="token operator">+</span> <span class="token number">1</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span>p<span class="token operator">*</span>q<span class="token operator">-</span>n<span class="token punctuation">,</span> p<span class="token operator">+</span>q<span class="token operator">-</span>p_q<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>iroot<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>exit<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">except</span> Exception <span class="token keyword">as</span> ee<span class="token punctuation">:</span><span class="token keyword">pass</span><span class="token comment"># NPUCTF&#123;diff1cult_rsa_1s_e@sy&#125;</span></code></pre><h2 id="MRCTF2020-babyRSA"><a href="#MRCTF2020-babyRSA" class="headerlink" title="[MRCTF2020]babyRSA"></a>[MRCTF2020]babyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">import</span> random<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> gcd<span class="token punctuation">,</span> invert<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> getPrime<span class="token punctuation">,</span> isPrime<span class="token punctuation">,</span> getRandomNBitInteger<span class="token punctuation">,</span> bytes_to_long<span class="token punctuation">,</span> long_to_bytes<span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>flag <span class="token operator">=</span> <span class="token string">b"MRCTF&#123;xxxx&#125;"</span>base <span class="token operator">=</span> <span class="token number">65537</span><span class="token keyword">def</span> <span class="token function">GCD</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">:</span>    B <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        B <span class="token operator">=</span> gcd<span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> B<span class="token keyword">def</span> <span class="token function">gen_p</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    P<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        P<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_p :"</span><span class="token punctuation">,</span> P<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    n <span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        n <span class="token operator">*=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    factor <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span> base<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"P_factor :"</span><span class="token punctuation">,</span> factor<span class="token punctuation">)</span>    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">gen_q</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    sub_Q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    Q_1 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    Q_2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    Q <span class="token operator">=</span> sub_Q <span class="token operator">**</span> Q_2 <span class="token operator">%</span> Q_1    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_1: "</span><span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Q_2: "</span><span class="token punctuation">,</span> Q_2<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"sub_Q: "</span><span class="token punctuation">,</span> sub_Q<span class="token punctuation">)</span>    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>Q<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    _E <span class="token operator">=</span> base    _P <span class="token operator">=</span> gen_p<span class="token punctuation">(</span><span class="token punctuation">)</span>    _Q <span class="token operator">=</span> gen_q<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token punctuation">(</span>gcd<span class="token punctuation">(</span>_E<span class="token punctuation">,</span> <span class="token punctuation">(</span>_P <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>_Q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>    _M <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>    _C <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>_M<span class="token punctuation">,</span> _E<span class="token punctuation">,</span> _P <span class="token operator">*</span> _Q<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Ciphertext = "</span><span class="token punctuation">,</span> _C<span class="token punctuation">)</span></code></pre><p>for循环prevprime和nextprime即可</p><pre class="language-python" data-language="python"><code class="language-python">P_p <span class="token operator">=</span> <span class="token number">206027926847308612719677572554991143421</span>P_factor <span class="token operator">=</span> <span class="token number">213671742765908980787116579976289600595864704574134469173111790965233629909513884704158446946409910475727584342641848597858942209151114627306286393390259700239698869487469080881267182803062488043469138252786381822646126962323295676431679988602406971858136496624861228526070581338082202663895710929460596143281673761666804565161435963957655012011051936180536581488499059517946308650135300428672486819645279969693519039407892941672784362868653243632727928279698588177694171797254644864554162848696210763681197279758130811723700154618280764123396312330032986093579531909363210692564988076206283296967165522152288770019720928264542910922693728918198338839</span>Q_1 <span class="token operator">=</span> <span class="token number">103766439849465588084625049495793857634556517064563488433148224524638105971161051763127718438062862548184814747601299494052813662851459740127499557785398714481909461631996020048315790167967699932967974484481209879664173009585231469785141628982021847883945871201430155071257803163523612863113967495969578605521</span>Q_2 <span class="token operator">=</span> <span class="token number">151010734276916939790591461278981486442548035032350797306496105136358723586953123484087860176438629843688462671681777513652947555325607414858514566053513243083627810686084890261120641161987614435114887565491866120507844566210561620503961205851409386041194326728437073995372322433035153519757017396063066469743</span>sub_Q <span class="token operator">=</span> <span class="token number">168992529793593315757895995101430241994953638330919314800130536809801824971112039572562389449584350643924391984800978193707795909956472992631004290479273525116959461856227262232600089176950810729475058260332177626961286009876630340945093629959302803189668904123890991069113826241497783666995751391361028949651</span>Ciphertext <span class="token operator">=</span> <span class="token number">1709187240516367141460862187749451047644094885791761673574674330840842792189795049968394122216854491757922647656430908587059997070488674220330847871811836724541907666983042376216411561826640060734307013458794925025684062804589439843027290282034999617915124231838524593607080377300985152179828199569474241678651559771763395596697140206072537688129790126472053987391538280007082203006348029125729650207661362371936196789562658458778312533505938858959644541233578654340925901963957980047639114170033936570060250438906130591377904182111622236567507022711176457301476543461600524993045300728432815672077399879668276471832</span>e <span class="token operator">=</span> <span class="token number">65537</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sympy <span class="token keyword">import</span> prevprime<span class="token punctuation">,</span> nextprime<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdmP <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P_p <span class="token operator">=</span> prevprime<span class="token punctuation">(</span>P_p<span class="token punctuation">)</span>P<span class="token punctuation">.</span>append<span class="token punctuation">(</span>P_p<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    P<span class="token punctuation">.</span>append<span class="token punctuation">(</span>nextprime<span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>n <span class="token operator">=</span> <span class="token number">1</span>phi <span class="token operator">=</span> <span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">*=</span> P<span class="token punctuation">[</span>i<span class="token punctuation">]</span>    phi <span class="token operator">*=</span> <span class="token punctuation">(</span>P<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span>p <span class="token operator">=</span> nextprime<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>P_factor<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span>q <span class="token operator">=</span> nextprime<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>sub_Q<span class="token punctuation">,</span> Q_2<span class="token punctuation">,</span> Q_1<span class="token punctuation">)</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>Ciphertext<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># MRCTF&#123;sti11_@_b@by_qu3st10n&#125;</span></code></pre><h2 id="困惑的总结"><a href="#困惑的总结" class="headerlink" title="困惑的总结"></a>困惑的总结</h2><p>重难点主要集中在LFSR，ECC，Lattice</p><p>有关原理方面的困惑在于coppersmith，Polynomial Ring，Lattice的LLL算法</p>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>2月和3月总结笔记</title>
      <link href="2021/03/31/2-yue-he-3-yue-zong-jie-bi-ji/"/>
      <url>2021/03/31/2-yue-he-3-yue-zong-jie-bi-ji/</url>
      
        <content type="html"><![CDATA[<h1 id="Some-wp"><a href="#Some-wp" class="headerlink" title="Some wp"></a>Some wp</h1><h2 id="hgame2021week2-signin"><a href="#hgame2021week2-signin" class="headerlink" title="[hgame2021week2]signin"></a>[hgame2021week2]signin</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util <span class="token keyword">import</span> number<span class="token keyword">from</span> secret <span class="token keyword">import</span> FLAGm <span class="token operator">=</span> s2n<span class="token punctuation">(</span>FLAG<span class="token punctuation">)</span>a <span class="token operator">=</span> number<span class="token punctuation">.</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>p <span class="token operator">=</span> number<span class="token punctuation">.</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>c <span class="token operator">=</span> a <span class="token operator">**</span> p <span class="token operator">*</span> m <span class="token operator">%</span> p<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># a = 114860703441277641159010520457158779743406545528920568790985108964161284695646120202566466577905632104388633713510921541107712064183498148484917830523711193223293589592121551112550440675243616576203905342750212598333519257633313008795211410775228583376590610854565937051450960491199274401879127456639254354787</span><span class="token comment"># p = 128337372863548733982628567035170003526593417952180525194192159178242702197521429086326104838106948416844886788242477807248072299082097134981718011660755395525206183882787666600218259021191537486566977688094471407299627161423853728124784268632944908474596463076060977522841693595025422665925345726268832156411</span><span class="token comment"># c = 89307609447045247940453313245387079059195320809034029001135691327604934287433876029928261397471393214500935563825104638091048695922698852839685381899565313007469197828666213834055492744237102478143542837196793018354189910673128014928309895806759030851721114111420175990080693470002656332421701173726269842336</span></code></pre><blockquote><p>费马小定理:</p><p>$ a ^ {p} \equiv a\left(\bmod p\right) $</p></blockquote><p>$$<br>\therefore c = \left(a * m\right) \bmod p<br>$$</p><p>设 ni 为 a mod p的逆元</p><p>两边同时乘ni，得<br>$$<br>m = (c * ni)\bmod p<br>$$<br>已知c,ni,p，可以求得m</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token number">114860703441277641159010520457158779743406545528920568790985108964161284695646120202566466577905632104388633713510921541107712064183498148484917830523711193223293589592121551112550440675243616576203905342750212598333519257633313008795211410775228583376590610854565937051450960491199274401879127456639254354787</span>p <span class="token operator">=</span> <span class="token number">128337372863548733982628567035170003526593417952180525194192159178242702197521429086326104838106948416844886788242477807248072299082097134981718011660755395525206183882787666600218259021191537486566977688094471407299627161423853728124784268632944908474596463076060977522841693595025422665925345726268832156411</span>c <span class="token operator">=</span> <span class="token number">89307609447045247940453313245387079059195320809034029001135691327604934287433876029928261397471393214500935563825104638091048695922698852839685381899565313007469197828666213834055492744237102478143542837196793018354189910673128014928309895806759030851721114111420175990080693470002656332421701173726269842336</span>ni <span class="token operator">=</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span>m <span class="token operator">=</span> c <span class="token operator">*</span> ni <span class="token operator">%</span> p <span class="token keyword">print</span> n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment"># hgame&#123;M0du1@r_m4th+1s^th3~ba5is-Of=cRypt0!!&#125;</span></code></pre><h2 id="Common-Private-Exponent（共私钥指数攻击，d相同）"><a href="#Common-Private-Exponent（共私钥指数攻击，d相同）" class="headerlink" title="Common Private Exponent（共私钥指数攻击，d相同）"></a>Common Private Exponent（共私钥指数攻击，d相同）</h2><p><img src="https://img-blog.csdnimg.cn/20210102164535469.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FvNTI0MjYwNTU=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>e0<span class="token operator">=</span>n0<span class="token operator">=</span>c0<span class="token operator">=</span>e1<span class="token operator">=</span>n1<span class="token operator">=</span>c1<span class="token operator">=</span>e2<span class="token operator">=</span>n2<span class="token operator">=</span>c2<span class="token operator">=</span>M<span class="token operator">=</span>iroot<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>n2<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">4</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span>M<span class="token punctuation">,</span>e0<span class="token punctuation">,</span>e1<span class="token punctuation">,</span>e2<span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n0<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n1<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">]</span>a<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token operator">-</span>n2<span class="token punctuation">]</span>Mat <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>a<span class="token punctuation">)</span>Mat_LLL<span class="token operator">=</span>Mat<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>Mat_LLL<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">/</span>M<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="NCTF2019-babyRSA"><a href="#NCTF2019-babyRSA" class="headerlink" title="[NCTF2019]babyRSA"></a>[NCTF2019]babyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">nextPrime</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    n <span class="token operator">+=</span> <span class="token number">2</span> <span class="token keyword">if</span> n <span class="token operator">&amp;</span> <span class="token number">1</span> <span class="token keyword">else</span> <span class="token number">1</span>    <span class="token keyword">while</span> <span class="token keyword">not</span> isPrime<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>        n <span class="token operator">+=</span> <span class="token number">2</span>    <span class="token keyword">return</span> np <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>q <span class="token operator">=</span> nextPrime<span class="token punctuation">(</span>p<span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qe <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token comment"># d = 19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span><span class="token comment"># c = 5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span></code></pre><p>已知<br>$$<br>e，d，c，q = nextprime(p)<br>$$</p><p>$$<br>(e*d-1)=k * (q-1)*(p-1)<br>$$</p><p><code>p,q接近，p*q为2048位</code></p><p><code> (e*d-1)是2064位的，所以k的取值范围为（pow(2,15),pow(2,16)）</code></p><p><code>通过爆破k的值，可以得到(p-1)*(q-1) 的值，对phi 开平方，进而求得p,q。</code></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> sympy <span class="token keyword">import</span><span class="token operator">*</span> <span class="token keyword">from</span> libnum <span class="token keyword">import</span><span class="token operator">*</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> <span class="token number">19275778946037899718035455438175509175723911466127462154506916564101519923603308900331427601983476886255849200332374081996442976307058597390881168155862238533018621944733299208108185814179466844504468163200369996564265921022888670062554504758512453217434777820468049494313818291727050400752551716550403647148197148884408264686846693842118387217753516963449753809860354047619256787869400297858568139700396567519469825398575103885487624463424429913017729585620877168171603444111464692841379661112075123399343270610272287865200880398193573260848268633461983435015031227070217852728240847398084414687146397303110709214913</span>c <span class="token operator">=</span> <span class="token number">5382723168073828110696168558294206681757991149022777821127563301413483223874527233300721180839298617076705685041174247415826157096583055069337393987892262764211225227035880754417457056723909135525244957935906902665679777101130111392780237502928656225705262431431953003520093932924375902111280077255205118217436744112064069429678632923259898627997145803892753989255615273140300021040654505901442787810653626524305706316663169341797205752938755590056568986738227803487467274114398257187962140796551136220532809687606867385639367743705527511680719955380746377631156468689844150878381460560990755652899449340045313521804</span><span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">%</span>k <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        phi <span class="token operator">=</span> <span class="token punctuation">(</span>e<span class="token operator">*</span>d<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">//</span>k        P1 <span class="token operator">=</span> iroot<span class="token punctuation">(</span>phi<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token comment">#  对(q-1)*(p-1)开平方        </span>        p <span class="token operator">=</span> nextprime<span class="token punctuation">(</span>P1<span class="token punctuation">)</span>     <span class="token comment"># 获取素数P        </span>        q_1 <span class="token operator">=</span> phi<span class="token operator">//</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>      <span class="token comment"># 得到(q-1)        </span>        q <span class="token operator">=</span> q_1<span class="token operator">+</span><span class="token number">1</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>isprime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>       <span class="token comment"># 对q进行素性检测</span>                   <span class="token keyword">break</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>p<span class="token operator">=</span><span class="token number">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225076497</span>q<span class="token operator">=</span><span class="token number">143193611591752210918770476402384783351740028841763223236102885221839966637073188462808195974548579833368313904083095786906479416347681923731100260359652426441593107755892485944809419189348311956308456459523437459969713060653432909873986596042482699670451716296743727525586437248462432327423361080811225075839</span>n<span class="token operator">=</span>p<span class="token operator">*</span>qm <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="DiceCTF2021-newcrypt-v2"><a href="#DiceCTF2021-newcrypt-v2" class="headerlink" title="[DiceCTF2021]newcrypt v2"></a>[DiceCTF2021]newcrypt v2</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/env python3</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>flag <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.txt'</span><span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">Generator</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>bits<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span>bits<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>N <span class="token operator">=</span> self<span class="token punctuation">.</span>p<span class="token operator">*</span>self<span class="token punctuation">.</span>q        <span class="token keyword">print</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">gen</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> <span class="token builtin">round</span> <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            x <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">10</span><span class="token punctuation">)</span>            <span class="token keyword">while</span> x<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token keyword">or</span> GCD<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>                x <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">10</span><span class="token punctuation">)</span>            y <span class="token operator">=</span> inverse<span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            numbers<span class="token punctuation">.</span>append<span class="token punctuation">(</span>y<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>numbers<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span>m<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span><span class="token number">0x1337</span><span class="token punctuation">,</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span>g <span class="token operator">=</span> Generator<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>g<span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>只有一解，大佬的exp也没太看懂，之后有空再研究（好像又用到coppersmith了</p><p>已知n，e，c，和几组由随机的D生成的E，这几组E只给phin有关系，所以要通过这几组E求出p和q，就能求得d了。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">import</span> itertools<span class="token keyword">from</span> sympy<span class="token punctuation">.</span>solvers<span class="token punctuation">.</span>diophantine<span class="token punctuation">.</span>diophantine <span class="token keyword">import</span> diop_linear<span class="token keyword">from</span> sympy <span class="token keyword">import</span> symbols<span class="token keyword">def</span> <span class="token function">getPolyInfo</span><span class="token punctuation">(</span>poly<span class="token punctuation">)</span><span class="token punctuation">:</span>    HM <span class="token operator">=</span> poly<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment"># HM: head monomial</span>    HC <span class="token operator">=</span> poly<span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>HM<span class="token punctuation">)</span>  <span class="token comment"># HC: head coefficient</span>    HT <span class="token operator">=</span> HC<span class="token operator">*</span>HM                          <span class="token comment"># HT: head term</span>    HI <span class="token operator">=</span> poly<span class="token punctuation">.</span>exponents<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token comment"># HI: head index</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'HT'</span><span class="token punctuation">:</span>HT<span class="token punctuation">,</span><span class="token string">'HC'</span><span class="token punctuation">:</span>HC<span class="token punctuation">,</span><span class="token string">'HM'</span><span class="token punctuation">:</span>HM<span class="token punctuation">,</span><span class="token string">'HI'</span><span class="token punctuation">:</span>HI<span class="token punctuation">&#125;</span><span class="token comment"># https://eprint.iacr.org/2012/675.pdf</span><span class="token keyword">def</span> <span class="token function">multivariate</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>E<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>m<span class="token punctuation">,</span>improve<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># Setup multivariate simultaneous equations</span>    l <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>E<span class="token punctuation">)</span>    P<span class="token punctuation">,</span>x <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>objgens<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># y = x[-1]</span>    F <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>        F<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token operator">+</span>x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    X <span class="token operator">=</span> <span class="token punctuation">[</span>floor<span class="token punctuation">(</span>N<span class="token operator">^</span>beta<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span>floor<span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>N<span class="token operator">^</span><span class="token number">.5</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token comment"># upper bounds</span>    <span class="token comment"># Construct polynomials: G</span>    G <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    I <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>        g <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>        i_k <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>m<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                g<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>i<span class="token operator">-</span>j<span class="token punctuation">)</span> <span class="token operator">*</span> F<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>j <span class="token operator">*</span> E<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span><span class="token punctuation">(</span>m<span class="token operator">-</span>j<span class="token punctuation">)</span>                <span class="token comment"># check HM,HI</span>                polyinfo <span class="token operator">=</span> getPolyInfo<span class="token punctuation">(</span>g<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>                <span class="token keyword">assert</span> polyinfo<span class="token punctuation">[</span><span class="token string">'HM'</span><span class="token punctuation">]</span> <span class="token operator">==</span> x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>i <span class="token operator">*</span> x<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">^</span>j                <span class="token keyword">assert</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span>polyinfo<span class="token punctuation">[</span><span class="token string">'HI'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token punctuation">[</span>i <span class="token keyword">if</span> <span class="token punctuation">(</span>_ <span class="token operator">==</span> k<span class="token punctuation">)</span> <span class="token keyword">else</span> j <span class="token keyword">if</span><span class="token punctuation">(</span>_ <span class="token operator">==</span> l<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                i_k<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">tuple</span><span class="token punctuation">(</span>polyinfo<span class="token punctuation">[</span><span class="token string">'HI'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        G<span class="token punctuation">.</span>append<span class="token punctuation">(</span>g<span class="token punctuation">)</span>        I<span class="token punctuation">.</span>append<span class="token punctuation">(</span>i_k<span class="token punctuation">)</span>    <span class="token comment"># Get index set I+</span>    I_plus <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token operator">*</span>I<span class="token punctuation">)</span><span class="token punctuation">:</span>        I_plus<span class="token punctuation">.</span>add<span class="token punctuation">(</span><span class="token builtin">tuple</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">sum</span><span class="token punctuation">(</span>i<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    I_plus <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>I_plus<span class="token punctuation">)</span>    <span class="token keyword">if</span> improve<span class="token punctuation">:</span>        <span class="token comment"># Get index set I++</span>        I_pp <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">for</span> idx <span class="token keyword">in</span> I_plus<span class="token punctuation">:</span>            <span class="token keyword">if</span> idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">&lt;=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">or</span> <span class="token number">.5</span><span class="token operator">*</span>idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span><span class="token punctuation">:</span>l<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">*</span>beta <span class="token operator">-</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">min</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>                I_pp<span class="token punctuation">.</span>add<span class="token punctuation">(</span>idx<span class="token punctuation">)</span>        I_pp <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>I_pp<span class="token punctuation">)</span>        I_plus <span class="token operator">=</span> I_pp    <span class="token comment"># Construct polynomials: G+</span>    G_plus <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> idx <span class="token keyword">in</span> I_plus<span class="token punctuation">:</span>        J <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> j_tuples <span class="token keyword">in</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span>idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>repeat<span class="token operator">=</span>l<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>j_tuples<span class="token punctuation">)</span> <span class="token operator">==</span> idx<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">and</span> <span class="token keyword">not</span> <span class="token builtin">any</span><span class="token punctuation">(</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">&lt;</span> j_tuples<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                J<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j_tuples<span class="token punctuation">)</span>        <span class="token comment"># Find GCD(HC)</span>        gcdn <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> J<span class="token punctuation">:</span>            polyinfo <span class="token operator">=</span> getPolyInfo<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>j<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            gcdn <span class="token operator">=</span> polyinfo<span class="token punctuation">[</span><span class="token string">'HC'</span><span class="token punctuation">]</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>gcdn <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">else</span> gcd<span class="token punctuation">(</span>gcdn<span class="token punctuation">,</span>polyinfo<span class="token punctuation">[</span><span class="token string">'HC'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">:</span>            arr <span class="token operator">=</span> <span class="token punctuation">[</span>getPolyInfo<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>J<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'HC'</span><span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>            sols <span class="token operator">=</span> diop_linear<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">*</span>x0 <span class="token keyword">for</span> t<span class="token punctuation">,</span>x0 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>symbols<span class="token punctuation">(</span><span class="token string">"x0:%d"</span><span class="token operator">%</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">,</span>integer<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span>gcdn<span class="token punctuation">)</span>            a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>expr<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>t<span class="token punctuation">:</span><span class="token number">0</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> sols<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>free_symbols<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> expr <span class="token keyword">in</span> sols<span class="token punctuation">]</span>            <span class="token keyword">assert</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span>t<span class="token punctuation">]</span><span class="token operator">*</span>a<span class="token punctuation">[</span>t<span class="token punctuation">]</span> <span class="token keyword">for</span> t <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> gcdn            poly <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>a<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">*</span> prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>J<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>J<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            poly <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>j<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> J<span class="token punctuation">)</span>        <span class="token comment"># check HM</span>        <span class="token keyword">for</span> j <span class="token keyword">in</span> J<span class="token punctuation">:</span>            polyinfo <span class="token operator">=</span> getPolyInfo<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>G<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">[</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">,</span>j<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">assert</span> polyinfo<span class="token punctuation">[</span><span class="token string">'HM'</span><span class="token punctuation">]</span> <span class="token operator">==</span> prod<span class="token punctuation">(</span>x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token operator">^</span>idx<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        g_poly <span class="token operator">=</span> poly<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">:</span>x<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>X<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        G_plus<span class="token punctuation">.</span>append<span class="token punctuation">(</span>g_poly<span class="token punctuation">)</span>    <span class="token comment"># Get monomials</span>    monomials <span class="token operator">=</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> poly <span class="token keyword">in</span> G_plus<span class="token punctuation">:</span>        <span class="token keyword">for</span> m1 <span class="token keyword">in</span> poly<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            monomials<span class="token punctuation">.</span>add<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>    monomials <span class="token operator">=</span> <span class="token builtin">sorted</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span> <span class="token comment"># sort monomials</span>    <span class="token comment"># Setup matrix for LLL</span>    <span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Matrix dimensions: &#123;&#125;x&#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    L <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i<span class="token punctuation">,</span>poly <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>G_plus<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j<span class="token punctuation">,</span>m1 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">:</span>            L<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> poly<span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>m1<span class="token punctuation">)</span>    L <span class="token operator">=</span> L<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># Get system of polynomials</span>    H <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> j<span class="token punctuation">,</span>m1 <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">:</span>            H<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+=</span> P<span class="token punctuation">(</span>m1 <span class="token operator">*</span> L<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">/</span> m1<span class="token punctuation">.</span>subs<span class="token punctuation">(</span><span class="token punctuation">&#123;</span>x<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">:</span>X<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># Find roots using Groebner basis</span>    H <span class="token operator">=</span> <span class="token punctuation">[</span>eq<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>QQ<span class="token punctuation">)</span> <span class="token keyword">for</span> eq <span class="token keyword">in</span> H<span class="token punctuation">]</span>    I <span class="token operator">=</span> Ideal<span class="token punctuation">(</span><span class="token operator">*</span>H<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span>l<span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    g <span class="token operator">=</span> I<span class="token punctuation">.</span>groebner_basis<span class="token punctuation">(</span><span class="token string">'giac'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> g <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>    x0 <span class="token operator">=</span> var<span class="token punctuation">(</span><span class="token string">'x'</span><span class="token punctuation">,</span>n<span class="token operator">=</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>    sols <span class="token operator">=</span> solve<span class="token punctuation">(</span><span class="token punctuation">[</span>eq<span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token keyword">for</span> eq <span class="token keyword">in</span> g<span class="token punctuation">]</span><span class="token punctuation">,</span>x0<span class="token punctuation">,</span>solution_dict<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> s <span class="token keyword">in</span> sols<span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token punctuation">[</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>is_integer<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> x0<span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token boolean">True</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span>l<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            p_plus_q <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">-</span>s<span class="token punctuation">[</span>x0<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span>            x1 <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token string">'x'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>            f <span class="token operator">=</span> x1<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">-</span> p_plus_q<span class="token operator">*</span>x1 <span class="token operator">+</span> N            roots <span class="token operator">=</span> f<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span>            p<span class="token punctuation">,</span>q <span class="token operator">=</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>roots<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>            <span class="token keyword">return</span> <span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">test</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>n<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>m<span class="token punctuation">,</span>improve<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token triple-quoted-string string">'''    l: number of RSA keys    n: RSA bit length    beta: ratio of secret keys to n    '''</span>    p <span class="token operator">=</span> random_prime<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>lbound<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    q <span class="token operator">=</span> random_prime<span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">^</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>lbound<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token punctuation">(</span>floor<span class="token punctuation">(</span>n<span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    N <span class="token operator">=</span> p<span class="token operator">*</span>q    d_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    e_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        d <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span>floor<span class="token punctuation">(</span>beta<span class="token operator">*</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> d<span class="token operator">%</span><span class="token number">2</span> <span class="token operator">!=</span> <span class="token number">1</span> <span class="token keyword">or</span> gcd<span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        d_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>d<span class="token punctuation">)</span>        e <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>d<span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        e_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>e<span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>d_arr<span class="token punctuation">)</span> <span class="token operator">==</span> l<span class="token punctuation">:</span>            <span class="token keyword">break</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"N=pxq: &#123;&#125; = &#123;&#125; x &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"E:"</span><span class="token punctuation">,</span>e_arr<span class="token punctuation">)</span>    <span class="token keyword">assert</span> <span class="token builtin">set</span><span class="token punctuation">(</span>multivariate<span class="token punctuation">(</span>N<span class="token punctuation">,</span>e_arr<span class="token punctuation">,</span>beta<span class="token punctuation">,</span>m<span class="token punctuation">,</span>improve<span class="token operator">=</span>improve<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">set</span><span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Recovered successfully!"</span><span class="token punctuation">)</span><span class="token comment"># Tests</span><span class="token comment"># test(2,2048,.4,3)</span><span class="token comment"># test(3,1024,.46,2)</span><span class="token comment"># test(4,2048,.465,1,True)</span><span class="token comment"># test(5,2048,.5,1,True)</span>N <span class="token operator">=</span> <span class="token number">14337596625981852268356733199577363454740211423306675087406912203612106754740920535831186446286722686623181504391319837160175722628785779086065934404508907495375575604993274597567269696998989342554512169936041805398614285019559611603192791406141673196062487187176974406170426326985080300401992871878272750861304966084697316255932229517848590059063403143320068885919541934394285204068719613486701354616465507009243987608727662705537132041395688365562715140968368814327462123434153164039701357637150078015089287814859891259359522535418157646847992980552057214329745061692026530855072281235664669710276172313808317219377</span>E <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">12976676506376070110040406570149996101394527411415881605860843983349363069127746407886818103004002117366801754683449911816105354951654828869006253634088640931647307722477393307231188093852730642851927610384508472618758673499740002362888463449907850898256709493427721244039346744775543365490896192997672156351539772375297375865701816236826858372370828737647663910668758559951734259138880399000934641709724370982987684871113999721232035923836779554293705654708805788634929466224221204317582909006400475748926200070330888314906329563110519417492641071166678480550894995905707586159556311266401315984011972916692724662007</span><span class="token punctuation">,</span> <span class="token number">1863763332200533355187495032998617435554266559806936864499583761336209979224578994667995146126874905256288657356393344293005098598793270446199080399410824354463753330703855276639236442323809498935079594864731622806981650099779625802394492866772783164556122039084479891630004937148495825596230840040565205548593767270423848984375003632523408070963142589587241988428801951874519861970126281101472254516564569333579422627371073253518765484477877683153600580032505599620122184765699186189626337136723831818155748441783703710300026814764444157324740641952652611754903513683898296023658398333790727757433569553518827781081</span><span class="token punctuation">,</span> <span class="token number">2266107108355028257265149613659513002904527665415922083354756255551387373798380715368636460529830761909106090742940804896135018713646665813103359939678904950388594536893820576541648929534374197197699236090310478668004566290689920782095321065479404918697144906086349325096417620451929567373057958837794405051832027393710209669487434964110954150175622748681581358286557194922971711892121496052503670245966738246893335673371911853174980221559458430193451035071192245185753464656500832472716390638460484671724823329824542466725661315185971990283547100285181536347175215757494437839674240264046716971285767053511953014531</span><span class="token punctuation">,</span> <span class="token number">3012665180743215926044185696769375844027893756273454464899436474243670235496407935713055380725328632598984826511997157495169513834153639995899362029217480834870286205900296318828132585598137285805346657507373383217564586845718076975940327895945639149538433468219499891765910172868182009270172797753293191815210844128651385425158004075468732463275400326825588500413826705324683883847629057842100412354271506810539904381290499384122685388561018876503682490390411350939677572500607680288271353610724980926630513275655559323486108263101876350397264023226898671971480444539423455934221932088753929657082051926857943772249</span><span class="token punctuation">,</span> <span class="token number">11654698355361642253478315394509778991884549939645189298025844618346681492919905598771246194066168408610846920719586231628616008528010499420499104967297209036853716237681916872940149475834811605883772954478356917401690932414133714754145102545282932055458620466374791600444965981474694964466374906501557735419193196210081985354200587280684723865152043847523132554069361865253297610018545961901224789197822102327845824463263202308386229169765022168048658546459296356873527223601643713792899944747399360948976054350376734975776305888045491739605171010206699460442078038128020076159311221789613452312845058576145149846029</span><span class="token punctuation">]</span>c <span class="token operator">=</span> <span class="token number">3956820731464413675248976184330090386023400385276540416612412624089512558297526443036270899672623474843471114663110309683900437072074275592048007465581536399064139915757208597226420873829762312175028263779702542540471556091196109301321307501425411404463271934422940357892918540470499135323435236378549758184835624591770086862646876844851191370941059743180644939927085439332975325190261804739679687807083505313731296227816013191899297272702691347829966232657275540293776915188791505265719622572712788357792237668230216117983278509746622406227163590935715374994406994094600128249001135177407180401006889949317057904629</span>p<span class="token punctuation">,</span>q <span class="token operator">=</span> multivariate<span class="token punctuation">(</span>N<span class="token punctuation">,</span>E<span class="token punctuation">,</span><span class="token number">.5</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token keyword">assert</span> p<span class="token operator">*</span>q <span class="token operator">==</span> Nphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token number">0x1337</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><h2 id="VNCTF2021-strange-function"><a href="#VNCTF2021-strange-function" class="headerlink" title="[VNCTF2021]strange_function"></a>[VNCTF2021]strange_function</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> sha256<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">import</span> socketserver<span class="token keyword">import</span> signal<span class="token keyword">import</span> string<span class="token keyword">import</span> random<span class="token keyword">import</span> osMENU <span class="token operator">=</span> <span class="token triple-quoted-string string">br'''[+] 1.function[+] 2.check_answer[+] 3.exit'''</span><span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>BaseRequestHandler<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">_recvall</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        BUFF_SIZE <span class="token operator">=</span> <span class="token number">2048</span>        data <span class="token operator">=</span> <span class="token string">b''</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            part <span class="token operator">=</span> self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>BUFF_SIZE<span class="token punctuation">)</span>            data <span class="token operator">+=</span> part            <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>part<span class="token punctuation">)</span> <span class="token operator">&lt;</span> BUFF_SIZE<span class="token punctuation">:</span>                <span class="token keyword">break</span>        <span class="token keyword">return</span> data<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">send</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> msg<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> newline<span class="token punctuation">:</span>                msg <span class="token operator">+=</span> <span class="token string">b'\n'</span>            self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>msg<span class="token punctuation">)</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>    <span class="token keyword">def</span> <span class="token function">recv</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> prompt<span class="token operator">=</span><span class="token string">b'[-] '</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>prompt<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>_recvall<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">proof_of_work</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span>os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        proof <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters<span class="token operator">+</span>string<span class="token punctuation">.</span>digits<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        _hexdigest <span class="token operator">=</span> sha256<span class="token punctuation">(</span>proof<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[+] sha256(XXXX+</span><span class="token interpolation"><span class="token punctuation">&#123;</span>proof<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token format-spec">]</span><span class="token punctuation">&#125;</span></span><span class="token string">) == </span><span class="token interpolation"><span class="token punctuation">&#123;</span>_hexdigest<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        x <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span>prompt<span class="token operator">=</span><span class="token string">b'[+] Plz tell me XXXX: '</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">4</span> <span class="token keyword">or</span> sha256<span class="token punctuation">(</span>x<span class="token operator">+</span>proof<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> _hexdigest<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">def</span> <span class="token function">function</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span>        res <span class="token operator">=</span> <span class="token number">0</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">:</span>            numerator <span class="token operator">=</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            denominator <span class="token operator">=</span> x <span class="token operator">-</span> self<span class="token punctuation">.</span>data<span class="token punctuation">[</span>i<span class="token punctuation">]</span>            <span class="token keyword">try</span><span class="token punctuation">:</span>                tmp <span class="token operator">=</span> numerator <span class="token operator">/</span> denominator            <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] Error!'</span><span class="token punctuation">)</span>                <span class="token keyword">return</span>            res <span class="token operator">+=</span> tmp        <span class="token keyword">return</span> res    <span class="token keyword">def</span> <span class="token function">handle</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        signal<span class="token punctuation">.</span>alarm<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>proof_of_work<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] Welcome!'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] Can you find the flag through the calculating?'</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">0</span>        self<span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span>string<span class="token punctuation">.</span>ascii_letters <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lenth <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>getRandomInteger<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>MENU<span class="token punctuation">,</span> newline<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>            choice <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>choice <span class="token operator">==</span> <span class="token string">b'1'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"[+] Plz give me your x: "</span><span class="token punctuation">)</span>                now <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                now <span class="token operator">=</span> self<span class="token punctuation">.</span>function<span class="token punctuation">(</span>now<span class="token punctuation">)</span>                self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"[+] let me show you the answer: "</span><span class="token operator">+</span><span class="token builtin">str</span><span class="token punctuation">(</span>now<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">elif</span><span class="token punctuation">(</span>choice <span class="token operator">==</span> <span class="token string">b'2'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                guess <span class="token operator">=</span> self<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>guess <span class="token operator">==</span> self<span class="token punctuation">.</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>score <span class="token operator">+=</span> <span class="token number">1</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b"[+] You win!"</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">"[!] Now your score: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>token <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>string<span class="token punctuation">.</span>digits <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_letters<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>lenth <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>token<span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>                    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>lenth<span class="token punctuation">)</span><span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>data<span class="token punctuation">.</span>append<span class="token punctuation">(</span>getRandomInteger<span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                                        <span class="token keyword">if</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score <span class="token operator">>=</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">:</span>                        self<span class="token punctuation">.</span>send<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                <span class="token keyword">else</span><span class="token punctuation">:</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[+] What do you want to say???'</span><span class="token punctuation">)</span>                    self<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">b'[!] Go away!'</span><span class="token punctuation">)</span>                    <span class="token keyword">break</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>        self<span class="token punctuation">.</span>request<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">ThreadedServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>ThreadingMixIn<span class="token punctuation">,</span> socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">class</span> <span class="token class-name">ForkedServer</span><span class="token punctuation">(</span>socketserver<span class="token punctuation">.</span>ForkingMixIn<span class="token punctuation">,</span> socketserver<span class="token punctuation">.</span>TCPServer<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">pass</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    HOST<span class="token punctuation">,</span> PORT <span class="token operator">=</span> <span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">10002</span>    server <span class="token operator">=</span> ForkedServer<span class="token punctuation">(</span><span class="token punctuation">(</span>HOST<span class="token punctuation">,</span> PORT<span class="token punctuation">)</span><span class="token punctuation">,</span> Task<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>allow_reuse_address <span class="token operator">=</span> <span class="token boolean">True</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>主要逻辑如下：</p><p><img src="imgs/image-20210321162145223.png" alt="image-20210321162145223"></p><p>即每次反馈给我们的res等于token[i]/(x-data[i])的和</p><p>x是我们输入的数，每次输入data[i]+1，后面的每项分母很大，极限约等于0，所以每次的res都约等于token[i]</p><h2 id="NepCTF2021-Real-Base"><a href="#NepCTF2021-Real-Base" class="headerlink" title="[NepCTF2021]Real_Base"></a>[NepCTF2021]Real_Base</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#py2</span><span class="token keyword">import</span> string<span class="token keyword">import</span> random<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token punctuation">,</span>b_char<span class="token keyword">def</span> <span class="token function">encode</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    res<span class="token operator">=</span><span class="token string">''</span>    binstr<span class="token operator">=</span><span class="token punctuation">[</span> <span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'0b'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    p1<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>binstr<span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">3</span>    p2<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>binstr<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">3</span>    part1 <span class="token operator">=</span> binstr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token operator">*</span>p1<span class="token punctuation">]</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>p1<span class="token punctuation">)</span><span class="token punctuation">:</span>        str_p1<span class="token operator">=</span>binstr<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>binstr<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>binstr<span class="token punctuation">[</span>i<span class="token operator">*</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">2</span><span class="token punctuation">]</span>        tmp_str <span class="token operator">=</span> <span class="token punctuation">[</span>str_p1<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">]</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>b_char<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> tmp_str<span class="token punctuation">]</span>        res<span class="token operator">+=</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>    <span class="token keyword">if</span> p2<span class="token punctuation">:</span>        part2 <span class="token operator">=</span> binstr<span class="token punctuation">[</span><span class="token number">3</span><span class="token operator">*</span>p1<span class="token punctuation">:</span><span class="token punctuation">]</span>        str_p2 <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>part2<span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>p2<span class="token punctuation">)</span><span class="token operator">*</span><span class="token string">'0'</span><span class="token operator">*</span><span class="token number">8</span>        tmp_str <span class="token operator">=</span> <span class="token punctuation">[</span>str_p2<span class="token punctuation">[</span>x<span class="token punctuation">:</span> x <span class="token operator">+</span> <span class="token number">6</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span>p2<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">]</span>        tmp_res <span class="token operator">=</span> <span class="token punctuation">[</span>b_char<span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> tmp_str<span class="token punctuation">]</span>        res<span class="token operator">+=</span><span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>tmp_res<span class="token punctuation">)</span>        res <span class="token operator">+=</span><span class="token string">'='</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">-</span>p2<span class="token punctuation">)</span>    <span class="token keyword">return</span> res m1<span class="token operator">=</span>random<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>b_char<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token keyword">print</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token keyword">print</span> encode<span class="token punctuation">(</span>m1<span class="token punctuation">)</span><span class="token keyword">print</span> encode<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># rTcb1BR8YVW2EOUjweXpIiLt5QCNg7ZAsD9muq3ylMhvofnx/P</span><span class="token comment"># 2Br9y9fcu97zvB2OruZv0D3Bwhbj0uNQnvfdtC2TwAfPrdBJ3xeP4wNn0hzLzCVUlRa=</span><span class="token comment"># tCvM4R3TzvZ7nhjBxSiNyxmP28e7qCjVxQn91SRM3gBKzxQ=</span></code></pre><blockquote><p>b_char = ‘abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ+/‘</p></blockquote><p>base64变种，编码过程是每个转成八位二进制数之后，每六位切片，二进制转十进制对应到表上的位置，最后补位。所以我们解码就可以先把每个字符根据表上的位置全部转成六位二进制数，然后八个一组切片，转成十进制，ASCII码转字符。</p><pre class="language-python" data-language="python"><code class="language-python">s <span class="token operator">=</span> <span class="token string">'tCvM4R3TzvZ7nhjBxSiNyxmP28e7qCjVxQn91SRM3gBKzxQ='</span><span class="token comment"># b = ''</span><span class="token comment"># for i in s:</span><span class="token comment">#     for j in range(len(b_char)):</span><span class="token comment">#         if i == b_char[j]:</span><span class="token comment">#             b += str(bin(j)).replace('0b', '').zfill(6)</span>            <span class="token comment"># print b</span><span class="token comment"># print b</span>b <span class="token operator">=</span> <span class="token string">'0100111001100101011100000111101101010111011101110110010101011111011000010011010001110010011001010101111101100010001100010110000101110011001100110111001000100001001000010100001001100010011110010101111101000011011000110110111101101101011100000111010001101001011011100110010101111101'</span> <span class="token comment">#去掉末尾两个0</span>flag <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>b<span class="token punctuation">[</span>i<span class="token punctuation">:</span> i<span class="token operator">+</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> flag</code></pre><h2 id="NepCTF2021-easyEncryption"><a href="#NepCTF2021-easyEncryption" class="headerlink" title="[NepCTF2021]easyEncryption"></a>[NepCTF2021]easyEncryption</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> random <span class="token keyword">import</span> randrange<span class="token keyword">from</span> random <span class="token keyword">import</span> shuffle<span class="token keyword">from</span> secret <span class="token keyword">import</span> flag1<span class="token punctuation">,</span> flag2<span class="token keyword">import</span> string<span class="token keyword">from</span> hashlib <span class="token keyword">import</span> md5ALPHABET <span class="token operator">=</span> string<span class="token punctuation">.</span>hexdigits<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">]</span>ALPHABET_ALL <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> \    string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digits<span class="token keyword">def</span> <span class="token function">plus</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num1 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num2 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>        tmp <span class="token operator">=</span> tmp <span class="token operator">&lt;&lt;</span> i        res <span class="token operator">+=</span> tmp        num1 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>        num2 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">return</span> res<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>msg<span class="token punctuation">,</span> key<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">:</span>    c <span class="token operator">=</span> <span class="token string">''</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> msg<span class="token punctuation">:</span>        c_i <span class="token operator">=</span> key<span class="token punctuation">[</span>plus<span class="token punctuation">(</span>key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">]</span>        c <span class="token operator">+=</span> c_i        s <span class="token operator">=</span> key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    <span class="token keyword">return</span> ck <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>ALPHABET<span class="token punctuation">)</span>shuffle<span class="token punctuation">(</span>k<span class="token punctuation">)</span>k <span class="token operator">=</span> <span class="token string">'ca038b6194df72e5'</span>m <span class="token operator">=</span> <span class="token string">b'Welcome to NepCTF. I have a message for you '</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> flag1<span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span>cipher <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>m<span class="token punctuation">,</span> k<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token comment"># 93d4466bb2277405eb5265f1943efd76c5f335fab5800afdc4058ad587743555baadd4058cc21ac5e8e2130580043af40ac5e5e8e2133ac58cc66aad5880758cc66aadc46a85dcbbcee8a555dccbccc47cbf</span><span class="token comment"># kk = []</span><span class="token comment"># kk.append(k)</span><span class="token comment"># while len(kk) &lt; 500:</span><span class="token comment">#     tmp_k = list(ALPHABET)</span><span class="token comment">#     shuffle(tmp_k)</span><span class="token comment">#     if encrypt(m, tmp_k, 7) == cipher:</span><span class="token comment">#         kk.append(tmp_k)</span>kk <span class="token operator">=</span> <span class="token builtin">eval</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'22'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'out.txt'</span><span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token keyword">for</span> k <span class="token keyword">in</span> kk<span class="token punctuation">:</span>    iv <span class="token operator">=</span> <span class="token string">b'i\xfd\xd1\xb9\x81U\x87\xde\xdbB\x9b\x1b\x14|\x97\x14'</span>    secret2 <span class="token operator">=</span> flag2 <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> <span class="token string">b"Hope you enjoy NepCtf"</span>    m <span class="token operator">=</span> m <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    AES_keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        prefix <span class="token operator">=</span> ALPHABET_ALL<span class="token punctuation">[</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET_ALL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">+</span> \            ALPHABET_ALL<span class="token punctuation">[</span>randrange<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>ALPHABET_ALL<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        AES_keys<span class="token punctuation">.</span>append<span class="token punctuation">(</span>prefix<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> subkey <span class="token keyword">in</span> AES_keys<span class="token punctuation">:</span>        cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>subkey<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>        secret2 <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>secret2<span class="token punctuation">)</span>    <span class="token keyword">for</span> subkey <span class="token keyword">in</span> AES_keys<span class="token punctuation">:</span>        cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>subkey<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>        m <span class="token operator">=</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>m<span class="token punctuation">)</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span>secret2<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> md5<span class="token punctuation">(</span>        <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'\n'</span><span class="token punctuation">)</span></code></pre><p>求解第一部分的flag1很简单，通过找规律发现plus函数的逆运算还是plus</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plus</span><span class="token punctuation">(</span>num1<span class="token punctuation">,</span> num2<span class="token punctuation">)</span><span class="token punctuation">:</span>    res <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        tmp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>num1 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token punctuation">(</span>num2 <span class="token operator">&amp;</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span><span class="token punctuation">)</span>        tmp <span class="token operator">=</span> tmp <span class="token operator">&lt;&lt;</span> i        res <span class="token operator">+=</span> tmp        num1 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>        num2 <span class="token operator">>></span><span class="token operator">=</span> <span class="token number">1</span>    <span class="token keyword">return</span> reskey <span class="token operator">=</span> <span class="token string">'ca038b6194df72e5'</span>s <span class="token operator">=</span> <span class="token number">7</span>flag <span class="token operator">=</span> <span class="token string">'93d4466bb2277405eb5265f1943efd76c5f335fab5800afdc4058ad587743555baadd4058cc21ac5e8e2130580043af40ac5e5e8e2133ac58cc66aad5880758cc66aadc46a85dcbbcee8a555dccbccc47cbf'</span>flag1 <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    c_i <span class="token operator">=</span> key<span class="token punctuation">[</span>plus<span class="token punctuation">(</span>key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">]</span>    flag1 <span class="token operator">+=</span> c_i    s <span class="token operator">=</span> key<span class="token punctuation">.</span>index<span class="token punctuation">(</span>c_i<span class="token punctuation">)</span> <span class="token comment"># 这里特别要注意一下，不是i而是c_i</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b"Welcome to NepCTF. I have a message for you here's your flag1: flag&#123;0d3c21dd36fe3b"</span></code></pre><p>第二部分的flag2，遍历所有的AESKEY以及用这些key生成明文加密两次和密文解密两次的两个list，用set和&amp;来找交集，并且找到这个交集使用了哪四个key，最后用这四个key解密即可。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">import</span> string<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">def</span> <span class="token function">jiami</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>k<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">jiemi</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> k<span class="token punctuation">)</span><span class="token punctuation">:</span>    cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>k<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_CBC<span class="token punctuation">,</span> IV<span class="token operator">=</span>iv<span class="token punctuation">)</span>    <span class="token keyword">return</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>s<span class="token punctuation">)</span>ALPHABET_ALL <span class="token operator">=</span> string<span class="token punctuation">.</span>ascii_lowercase <span class="token operator">+</span> string<span class="token punctuation">.</span>ascii_uppercase <span class="token operator">+</span> string<span class="token punctuation">.</span>digitscipher <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'26bd5910dfb1a236a7ca20650eb9ea3d846d1baacde9591cfdf28c852e16ddf6'</span><span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token string">b"Hope you enjoy NepCtf"</span>m <span class="token operator">=</span> m <span class="token operator">+</span> <span class="token string">b"\x00"</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">16</span> <span class="token operator">-</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">)</span>iv <span class="token operator">=</span> <span class="token string">b'i\xfd\xd1\xb9\x81U\x87\xde\xdbB\x9b\x1b\x14|\x97\x14'</span>k <span class="token operator">=</span> <span class="token string">'ca038b6194df72e5'</span>list1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>list2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>list3 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>list4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token comment"># for a in tqdm(ALPHABET_ALL):#加密</span><span class="token comment">#     for b in ALPHABET_ALL:</span><span class="token comment">#         str1 = a+b</span><span class="token comment">#         key1 = str1.encode() + ''.join(k).encode() + b'\x00' * 6</span><span class="token comment">#         jiami1 = jiami(m, key1)</span><span class="token comment">#         for c in ALPHABET_ALL:</span><span class="token comment">#             for d in ALPHABET_ALL:</span><span class="token comment">#                 str2 = c+d</span><span class="token comment">#                 key2 = str2.encode() + ''.join(k).encode() + b'\x00' * 6</span><span class="token comment">#                 jiami2 = jiami(jiami1, key2)</span><span class="token comment">#                 list1.append(jiami2)</span><span class="token comment">#                 list2.append(str(a+b+c+d))</span><span class="token comment"># print('ok1')</span><span class="token comment"># for a in tqdm(ALPHABET_ALL):</span><span class="token comment">#     for b in ALPHABET_ALL:</span><span class="token comment">#         str1 = a+b</span><span class="token comment">#         key3 = str1.encode() + ''.join(k).encode() + b'\x00' * 6</span><span class="token comment">#         jiemi1 = jiemi(cipher, key3)</span><span class="token comment">#         for c in ALPHABET_ALL:</span><span class="token comment">#             for d in ALPHABET_ALL:</span><span class="token comment">#                 str2 = c+d</span><span class="token comment">#                 key4 = str2.encode() + ''.join(k).encode() + b'\x00' * 6</span><span class="token comment">#                 jiemi2 = jiemi(jiemi1, key4)</span><span class="token comment">#                 list3.append(jiemi2)</span><span class="token comment">#                 list4.append(str(a+b+c+d)) </span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ok2'</span><span class="token punctuation">)</span><span class="token comment"># jiaoji = set(list1) &amp; set(list3)</span><span class="token comment"># print(jiaoji)</span>jiaoji <span class="token operator">=</span> <span class="token string">b'\x87\xf3b\xfe\xc8\xe3\x96q5\xdax\x01\xe1U\xfd\x88_:7\xb8\t\x82\x83\xdd5\x1atO\xe9\xdfn\xea'</span><span class="token comment"># for i in tqdm(range(len(list1))):</span>    <span class="token comment"># if list1[i] == jiaoji:</span>    <span class="token comment">#     print(list2[i])</span>    <span class="token comment">#     exit()</span>    <span class="token comment"># if list3[i] == jiaoji:</span>    <span class="token comment">#     print(list4[i])</span>    <span class="token comment">#     exit()</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ok3'</span><span class="token punctuation">)</span>key1 <span class="token operator">=</span> <span class="token string">'8U'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>key2 <span class="token operator">=</span> <span class="token string">'9e'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>key3 <span class="token operator">=</span> <span class="token string">'aT'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>key4 <span class="token operator">=</span> <span class="token string">'lt'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b'\x00'</span> <span class="token operator">*</span> <span class="token number">6</span>flag <span class="token operator">=</span> <span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token string">'9da1f3806954ebe7f76b829f799901617ffae4eee96c5bb925f6fd58feecdef2c74505c02262e9d5480c2375300f2f3d404a6eee31f03e172c30b246c6490479d2d6d759611dc5cdc410d631b9709936'</span><span class="token punctuation">)</span>flag2 <span class="token operator">=</span> jiemi<span class="token punctuation">(</span>jiemi<span class="token punctuation">(</span>jiemi<span class="token punctuation">(</span>jiemi<span class="token punctuation">(</span>flag<span class="token punctuation">,</span> key3<span class="token punctuation">)</span><span class="token punctuation">,</span> key4<span class="token punctuation">)</span><span class="token punctuation">,</span> key2<span class="token punctuation">)</span><span class="token punctuation">,</span> key1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token comment"># b'wow! you are wonderful, this is your flag2 : aaf2e86a3fe4af5156&#125;\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00'</span></code></pre><h2 id="GKCTF2020-Backdoor"><a href="#GKCTF2020-Backdoor" class="headerlink" title="[GKCTF2020]Backdoor"></a>[GKCTF2020]Backdoor</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSA<span class="token keyword">import</span> gmpy2<span class="token punctuation">,</span> binascii<span class="token keyword">import</span> base64<span class="token keyword">from</span> FLAG <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">rsa_encrypt</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./pub.pem'</span> <span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        key <span class="token operator">=</span> RSA<span class="token punctuation">.</span>import_key<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    e <span class="token operator">=</span> key<span class="token punctuation">.</span>e    n <span class="token operator">=</span> key<span class="token punctuation">.</span>n    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>     ciphertext <span class="token operator">=</span> binascii<span class="token punctuation">.</span>hexlify<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> ciphertext<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    text <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>rsa_encrypt<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'flag.enc'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>text<span class="token punctuation">)</span></code></pre><p>某CVE</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># f = '02142af7ce70fe0ddae116bb7e96260274ee9252a8cb528e7fdd29809c2a6032727c05526133ae4610ed944572ff1abfcd0b17aa22ef44a2'</span><span class="token comment"># c = bytes_to_long(bytes.fromhex(f))</span><span class="token comment"># print(c)</span><span class="token comment"># with open('./pub.pem' ,'r') as f:</span><span class="token comment">#     key = RSA.import_key(f.read())</span><span class="token comment"># e = key.e</span><span class="token comment"># n = key.n</span><span class="token comment"># print(e, n)</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util <span class="token keyword">import</span> number<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token number">5902102609936183530036413041949205016072856184947596155784933422689438216690059498706287388882989673839294236821030261398121787376802</span>e <span class="token operator">=</span> <span class="token number">65537</span> n <span class="token operator">=</span> <span class="token number">15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739</span>vals<span class="token operator">=</span><span class="token number">39</span>M<span class="token operator">=</span><span class="token number">1</span>n <span class="token operator">=</span> mpz<span class="token punctuation">(</span><span class="token number">15518961041625074876182404585394098781487141059285455927024321276783831122168745076359780343078011216480587575072479784829258678691739</span><span class="token punctuation">)</span>primes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">,</span> <span class="token number">13</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">,</span> <span class="token number">19</span><span class="token punctuation">,</span> <span class="token number">23</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">,</span> <span class="token number">37</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">,</span> <span class="token number">43</span><span class="token punctuation">,</span> <span class="token number">47</span><span class="token punctuation">,</span> <span class="token number">53</span><span class="token punctuation">,</span> <span class="token number">59</span><span class="token punctuation">,</span> <span class="token number">61</span><span class="token punctuation">,</span> <span class="token number">67</span><span class="token punctuation">,</span> <span class="token number">71</span><span class="token punctuation">,</span> <span class="token number">73</span><span class="token punctuation">,</span> <span class="token number">79</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">89</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">,</span> <span class="token number">101</span><span class="token punctuation">,</span> <span class="token number">103</span><span class="token punctuation">,</span> <span class="token number">107</span><span class="token punctuation">,</span> <span class="token number">109</span><span class="token punctuation">,</span> <span class="token number">113</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">,</span> <span class="token number">131</span><span class="token punctuation">,</span> <span class="token number">137</span><span class="token punctuation">,</span> <span class="token number">139</span><span class="token punctuation">,</span> <span class="token number">149</span><span class="token punctuation">,</span> <span class="token number">151</span><span class="token punctuation">,</span> <span class="token number">157</span><span class="token punctuation">,</span> <span class="token number">163</span><span class="token punctuation">,</span> <span class="token number">167</span><span class="token punctuation">,</span> <span class="token number">173</span><span class="token punctuation">,</span> <span class="token number">179</span><span class="token punctuation">,</span> <span class="token number">181</span><span class="token punctuation">,</span> <span class="token number">191</span><span class="token punctuation">,</span> <span class="token number">193</span><span class="token punctuation">,</span> <span class="token number">197</span><span class="token punctuation">,</span> <span class="token number">199</span><span class="token punctuation">,</span> <span class="token number">211</span><span class="token punctuation">,</span> <span class="token number">223</span><span class="token punctuation">,</span> <span class="token number">227</span><span class="token punctuation">,</span> <span class="token number">229</span><span class="token punctuation">,</span> <span class="token number">233</span><span class="token punctuation">,</span> <span class="token number">239</span><span class="token punctuation">,</span> <span class="token number">241</span><span class="token punctuation">,</span> <span class="token number">251</span><span class="token punctuation">,</span> <span class="token number">257</span><span class="token punctuation">,</span> <span class="token number">263</span><span class="token punctuation">,</span> <span class="token number">269</span><span class="token punctuation">,</span> <span class="token number">271</span><span class="token punctuation">,</span> <span class="token number">277</span><span class="token punctuation">,</span> <span class="token number">281</span><span class="token punctuation">,</span> <span class="token number">283</span><span class="token punctuation">,</span> <span class="token number">293</span><span class="token punctuation">,</span> <span class="token number">307</span><span class="token punctuation">,</span> <span class="token number">311</span><span class="token punctuation">,</span> <span class="token number">313</span><span class="token punctuation">,</span> <span class="token number">317</span><span class="token punctuation">,</span> <span class="token number">331</span><span class="token punctuation">,</span> <span class="token number">337</span><span class="token punctuation">,</span> <span class="token number">347</span><span class="token punctuation">,</span> <span class="token number">349</span><span class="token punctuation">,</span> <span class="token number">353</span><span class="token punctuation">,</span> <span class="token number">359</span><span class="token punctuation">,</span> <span class="token number">367</span><span class="token punctuation">,</span> <span class="token number">373</span><span class="token punctuation">,</span> <span class="token number">379</span><span class="token punctuation">,</span> <span class="token number">383</span><span class="token punctuation">,</span> <span class="token number">389</span><span class="token punctuation">,</span> <span class="token number">397</span><span class="token punctuation">,</span> <span class="token number">401</span><span class="token punctuation">,</span> <span class="token number">409</span><span class="token punctuation">,</span> <span class="token number">419</span><span class="token punctuation">,</span> <span class="token number">421</span><span class="token punctuation">,</span> <span class="token number">431</span><span class="token punctuation">,</span> <span class="token number">433</span><span class="token punctuation">,</span> <span class="token number">439</span><span class="token punctuation">,</span> <span class="token number">443</span><span class="token punctuation">,</span> <span class="token number">449</span><span class="token punctuation">,</span> <span class="token number">457</span><span class="token punctuation">,</span> <span class="token number">461</span><span class="token punctuation">,</span> <span class="token number">463</span><span class="token punctuation">,</span> <span class="token number">467</span><span class="token punctuation">,</span> <span class="token number">479</span><span class="token punctuation">,</span> <span class="token number">487</span><span class="token punctuation">,</span> <span class="token number">491</span><span class="token punctuation">,</span> <span class="token number">499</span><span class="token punctuation">,</span> <span class="token number">503</span><span class="token punctuation">,</span> <span class="token number">509</span><span class="token punctuation">,</span> <span class="token number">521</span><span class="token punctuation">,</span> <span class="token number">523</span><span class="token punctuation">,</span> <span class="token number">541</span><span class="token punctuation">,</span> <span class="token number">547</span><span class="token punctuation">,</span> <span class="token number">557</span><span class="token punctuation">,</span> <span class="token number">563</span><span class="token punctuation">,</span> <span class="token number">569</span><span class="token punctuation">,</span> <span class="token number">571</span><span class="token punctuation">,</span> <span class="token number">577</span><span class="token punctuation">,</span> <span class="token number">587</span><span class="token punctuation">,</span> <span class="token number">593</span><span class="token punctuation">,</span> <span class="token number">599</span><span class="token punctuation">,</span> <span class="token number">601</span><span class="token punctuation">,</span> <span class="token number">607</span><span class="token punctuation">,</span> <span class="token number">613</span><span class="token punctuation">,</span> <span class="token number">617</span><span class="token punctuation">,</span> <span class="token number">619</span><span class="token punctuation">,</span> <span class="token number">631</span><span class="token punctuation">,</span> <span class="token number">641</span><span class="token punctuation">,</span> <span class="token number">643</span><span class="token punctuation">,</span> <span class="token number">647</span><span class="token punctuation">,</span> <span class="token number">653</span><span class="token punctuation">,</span> <span class="token number">659</span><span class="token punctuation">,</span> <span class="token number">661</span><span class="token punctuation">,</span> <span class="token number">673</span><span class="token punctuation">,</span> <span class="token number">677</span><span class="token punctuation">,</span> <span class="token number">683</span><span class="token punctuation">,</span> <span class="token number">691</span><span class="token punctuation">,</span> <span class="token number">701</span><span class="token punctuation">,</span> <span class="token number">709</span><span class="token punctuation">,</span> <span class="token number">719</span><span class="token punctuation">,</span> <span class="token number">727</span><span class="token punctuation">,</span> <span class="token number">733</span><span class="token punctuation">,</span> <span class="token number">739</span><span class="token punctuation">,</span> <span class="token number">743</span><span class="token punctuation">,</span> <span class="token number">751</span><span class="token punctuation">,</span> <span class="token number">757</span><span class="token punctuation">,</span> <span class="token number">761</span><span class="token punctuation">,</span> <span class="token number">769</span><span class="token punctuation">,</span> <span class="token number">773</span><span class="token punctuation">,</span> <span class="token number">787</span><span class="token punctuation">,</span> <span class="token number">797</span><span class="token punctuation">,</span> <span class="token number">809</span><span class="token punctuation">,</span> <span class="token number">811</span><span class="token punctuation">,</span> <span class="token number">821</span><span class="token punctuation">,</span> <span class="token number">823</span><span class="token punctuation">,</span> <span class="token number">827</span><span class="token punctuation">,</span> <span class="token number">829</span><span class="token punctuation">,</span> <span class="token number">839</span><span class="token punctuation">,</span> <span class="token number">853</span><span class="token punctuation">,</span> <span class="token number">857</span><span class="token punctuation">,</span> <span class="token number">859</span><span class="token punctuation">,</span> <span class="token number">863</span><span class="token punctuation">,</span> <span class="token number">877</span><span class="token punctuation">,</span> <span class="token number">881</span><span class="token punctuation">,</span> <span class="token number">883</span><span class="token punctuation">,</span> <span class="token number">887</span><span class="token punctuation">,</span> <span class="token number">907</span><span class="token punctuation">,</span> <span class="token number">911</span><span class="token punctuation">,</span> <span class="token number">919</span><span class="token punctuation">,</span> <span class="token number">929</span><span class="token punctuation">,</span> <span class="token number">937</span><span class="token punctuation">,</span> <span class="token number">941</span><span class="token punctuation">,</span> <span class="token number">947</span><span class="token punctuation">,</span> <span class="token number">953</span><span class="token punctuation">,</span> <span class="token number">967</span><span class="token punctuation">,</span> <span class="token number">971</span><span class="token punctuation">,</span> <span class="token number">977</span><span class="token punctuation">,</span> <span class="token number">983</span><span class="token punctuation">,</span> <span class="token number">991</span><span class="token punctuation">,</span> <span class="token number">997</span><span class="token punctuation">,</span> <span class="token number">1009</span><span class="token punctuation">,</span> <span class="token number">1013</span><span class="token punctuation">,</span> <span class="token number">1019</span><span class="token punctuation">,</span> <span class="token number">1021</span><span class="token punctuation">,</span> <span class="token number">1031</span><span class="token punctuation">,</span> <span class="token number">1033</span><span class="token punctuation">,</span> <span class="token number">1039</span><span class="token punctuation">,</span> <span class="token number">1049</span><span class="token punctuation">,</span> <span class="token number">1051</span><span class="token punctuation">,</span> <span class="token number">1061</span><span class="token punctuation">,</span> <span class="token number">1063</span><span class="token punctuation">,</span> <span class="token number">1069</span><span class="token punctuation">,</span> <span class="token number">1087</span><span class="token punctuation">,</span> <span class="token number">1091</span><span class="token punctuation">,</span> <span class="token number">1093</span><span class="token punctuation">,</span> <span class="token number">1097</span><span class="token punctuation">,</span> <span class="token number">1103</span><span class="token punctuation">,</span> <span class="token number">1109</span><span class="token punctuation">,</span> <span class="token number">1117</span><span class="token punctuation">,</span> <span class="token number">1123</span><span class="token punctuation">,</span> <span class="token number">1129</span><span class="token punctuation">,</span> <span class="token number">1151</span><span class="token punctuation">,</span> <span class="token number">1153</span><span class="token punctuation">,</span> <span class="token number">1163</span><span class="token punctuation">,</span> <span class="token number">1171</span><span class="token punctuation">,</span> <span class="token number">1181</span><span class="token punctuation">,</span> <span class="token number">1187</span><span class="token punctuation">,</span> <span class="token number">1193</span><span class="token punctuation">,</span> <span class="token number">1201</span><span class="token punctuation">,</span> <span class="token number">1213</span><span class="token punctuation">,</span> <span class="token number">1217</span><span class="token punctuation">,</span> <span class="token number">1223</span><span class="token punctuation">,</span> <span class="token number">1229</span><span class="token punctuation">,</span> <span class="token number">1231</span><span class="token punctuation">,</span> <span class="token number">1237</span><span class="token punctuation">,</span> <span class="token number">1249</span><span class="token punctuation">,</span> <span class="token number">1259</span><span class="token punctuation">,</span> <span class="token number">1277</span><span class="token punctuation">,</span> <span class="token number">1279</span><span class="token punctuation">,</span> <span class="token number">1283</span><span class="token punctuation">,</span> <span class="token number">1289</span><span class="token punctuation">,</span> <span class="token number">1291</span><span class="token punctuation">,</span> <span class="token number">1297</span><span class="token punctuation">,</span> <span class="token number">1301</span><span class="token punctuation">,</span> <span class="token number">1303</span><span class="token punctuation">,</span> <span class="token number">1307</span><span class="token punctuation">,</span> <span class="token number">1319</span><span class="token punctuation">,</span> <span class="token number">1321</span><span class="token punctuation">,</span> <span class="token number">1327</span><span class="token punctuation">,</span> <span class="token number">1361</span><span class="token punctuation">,</span> <span class="token number">1367</span><span class="token punctuation">,</span> <span class="token number">1373</span><span class="token punctuation">,</span> <span class="token number">1381</span><span class="token punctuation">,</span> <span class="token number">1399</span><span class="token punctuation">,</span> <span class="token number">1409</span><span class="token punctuation">,</span> <span class="token number">1423</span><span class="token punctuation">,</span> <span class="token number">1427</span><span class="token punctuation">,</span> <span class="token number">1429</span><span class="token punctuation">,</span> <span class="token number">1433</span><span class="token punctuation">,</span> <span class="token number">1439</span><span class="token punctuation">,</span> <span class="token number">1447</span><span class="token punctuation">,</span> <span class="token number">1451</span><span class="token punctuation">,</span> <span class="token number">1453</span><span class="token punctuation">,</span> <span class="token number">1459</span><span class="token punctuation">,</span> <span class="token number">1471</span><span class="token punctuation">,</span> <span class="token number">1481</span><span class="token punctuation">,</span> <span class="token number">1483</span><span class="token punctuation">,</span> <span class="token number">1487</span><span class="token punctuation">,</span> <span class="token number">1489</span><span class="token punctuation">,</span> <span class="token number">1493</span><span class="token punctuation">,</span> <span class="token number">1499</span><span class="token punctuation">,</span> <span class="token number">1511</span><span class="token punctuation">,</span> <span class="token number">1523</span><span class="token punctuation">,</span> <span class="token number">1531</span><span class="token punctuation">,</span> <span class="token number">1543</span><span class="token punctuation">,</span> <span class="token number">1549</span><span class="token punctuation">,</span> <span class="token number">1553</span><span class="token punctuation">,</span> <span class="token number">1559</span><span class="token punctuation">,</span> <span class="token number">1567</span><span class="token punctuation">,</span> <span class="token number">1571</span><span class="token punctuation">,</span> <span class="token number">1579</span><span class="token punctuation">,</span> <span class="token number">1583</span><span class="token punctuation">,</span> <span class="token number">1597</span><span class="token punctuation">,</span> <span class="token number">1601</span><span class="token punctuation">,</span> <span class="token number">1607</span><span class="token punctuation">,</span> <span class="token number">1609</span><span class="token punctuation">,</span> <span class="token number">1613</span><span class="token punctuation">,</span> <span class="token number">1619</span><span class="token punctuation">,</span> <span class="token number">1621</span><span class="token punctuation">,</span> <span class="token number">1627</span><span class="token punctuation">,</span> <span class="token number">1637</span><span class="token punctuation">,</span> <span class="token number">1657</span><span class="token punctuation">,</span> <span class="token number">1663</span><span class="token punctuation">,</span> <span class="token number">1667</span><span class="token punctuation">,</span> <span class="token number">1669</span><span class="token punctuation">,</span> <span class="token number">1693</span><span class="token punctuation">,</span> <span class="token number">1697</span><span class="token punctuation">,</span> <span class="token number">1699</span><span class="token punctuation">,</span> <span class="token number">1709</span><span class="token punctuation">,</span> <span class="token number">1721</span><span class="token punctuation">,</span> <span class="token number">1723</span><span class="token punctuation">,</span> <span class="token number">1733</span><span class="token punctuation">,</span> <span class="token number">1741</span><span class="token punctuation">,</span> <span class="token number">1747</span><span class="token punctuation">,</span> <span class="token number">1753</span><span class="token punctuation">,</span> <span class="token number">1759</span><span class="token punctuation">,</span> <span class="token number">1777</span><span class="token punctuation">,</span> <span class="token number">1783</span><span class="token punctuation">,</span> <span class="token number">1787</span><span class="token punctuation">,</span> <span class="token number">1789</span><span class="token punctuation">,</span> <span class="token number">1801</span><span class="token punctuation">,</span> <span class="token number">1811</span><span class="token punctuation">,</span> <span class="token number">1823</span><span class="token punctuation">,</span> <span class="token number">1831</span><span class="token punctuation">,</span> <span class="token number">1847</span><span class="token punctuation">,</span> <span class="token number">1861</span><span class="token punctuation">,</span> <span class="token number">1867</span><span class="token punctuation">,</span> <span class="token number">1871</span><span class="token punctuation">,</span> <span class="token number">1873</span><span class="token punctuation">,</span> <span class="token number">1877</span><span class="token punctuation">,</span> <span class="token number">1879</span><span class="token punctuation">,</span> <span class="token number">1889</span><span class="token punctuation">,</span> <span class="token number">1901</span><span class="token punctuation">,</span> <span class="token number">1907</span><span class="token punctuation">,</span> <span class="token number">1913</span><span class="token punctuation">,</span> <span class="token number">1931</span><span class="token punctuation">,</span> <span class="token number">1933</span><span class="token punctuation">,</span> <span class="token number">1949</span><span class="token punctuation">,</span> <span class="token number">1951</span><span class="token punctuation">,</span> <span class="token number">1973</span><span class="token punctuation">,</span> <span class="token number">1979</span><span class="token punctuation">,</span> <span class="token number">1987</span><span class="token punctuation">,</span> <span class="token number">1993</span><span class="token punctuation">,</span> <span class="token number">1997</span><span class="token punctuation">,</span> <span class="token number">1999</span><span class="token punctuation">,</span> <span class="token number">2003</span><span class="token punctuation">,</span> <span class="token number">2011</span><span class="token punctuation">,</span> <span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">2027</span><span class="token punctuation">,</span> <span class="token number">2029</span><span class="token punctuation">,</span> <span class="token number">2039</span><span class="token punctuation">,</span> <span class="token number">2053</span><span class="token punctuation">,</span> <span class="token number">2063</span><span class="token punctuation">,</span> <span class="token number">2069</span><span class="token punctuation">,</span> <span class="token number">2081</span><span class="token punctuation">,</span> <span class="token number">2083</span><span class="token punctuation">,</span> <span class="token number">2087</span><span class="token punctuation">,</span> <span class="token number">2089</span><span class="token punctuation">,</span> <span class="token number">2099</span><span class="token punctuation">,</span> <span class="token number">2111</span><span class="token punctuation">,</span> <span class="token number">2113</span><span class="token punctuation">,</span> <span class="token number">2129</span><span class="token punctuation">,</span> <span class="token number">2131</span><span class="token punctuation">,</span> <span class="token number">2137</span><span class="token punctuation">,</span> <span class="token number">2141</span><span class="token punctuation">,</span> <span class="token number">2143</span><span class="token punctuation">,</span> <span class="token number">2153</span><span class="token punctuation">,</span> <span class="token number">2161</span><span class="token punctuation">,</span> <span class="token number">2179</span><span class="token punctuation">,</span> <span class="token number">2203</span><span class="token punctuation">,</span> <span class="token number">2207</span><span class="token punctuation">,</span> <span class="token number">2213</span><span class="token punctuation">,</span> <span class="token number">2221</span><span class="token punctuation">,</span> <span class="token number">2237</span><span class="token punctuation">,</span> <span class="token number">2239</span><span class="token punctuation">,</span> <span class="token number">2243</span><span class="token punctuation">,</span> <span class="token number">2251</span><span class="token punctuation">,</span> <span class="token number">2267</span><span class="token punctuation">,</span> <span class="token number">2269</span><span class="token punctuation">,</span> <span class="token number">2273</span><span class="token punctuation">,</span> <span class="token number">2281</span><span class="token punctuation">,</span> <span class="token number">2287</span><span class="token punctuation">,</span> <span class="token number">2293</span><span class="token punctuation">,</span> <span class="token number">2297</span><span class="token punctuation">,</span> <span class="token number">2309</span><span class="token punctuation">,</span> <span class="token number">2311</span><span class="token punctuation">,</span> <span class="token number">2333</span><span class="token punctuation">,</span> <span class="token number">2339</span><span class="token punctuation">,</span> <span class="token number">2341</span><span class="token punctuation">,</span> <span class="token number">2347</span><span class="token punctuation">,</span> <span class="token number">2351</span><span class="token punctuation">,</span> <span class="token number">2357</span><span class="token punctuation">,</span> <span class="token number">2371</span><span class="token punctuation">,</span> <span class="token number">2377</span><span class="token punctuation">,</span> <span class="token number">2381</span><span class="token punctuation">,</span> <span class="token number">2383</span><span class="token punctuation">,</span> <span class="token number">2389</span><span class="token punctuation">,</span> <span class="token number">2393</span><span class="token punctuation">,</span> <span class="token number">2399</span><span class="token punctuation">,</span> <span class="token number">2411</span><span class="token punctuation">,</span> <span class="token number">2417</span><span class="token punctuation">,</span> <span class="token number">2423</span><span class="token punctuation">,</span> <span class="token number">2437</span><span class="token punctuation">,</span> <span class="token number">2441</span><span class="token punctuation">,</span> <span class="token number">2447</span><span class="token punctuation">,</span> <span class="token number">2459</span><span class="token punctuation">,</span> <span class="token number">2467</span><span class="token punctuation">,</span> <span class="token number">2473</span><span class="token punctuation">,</span> <span class="token number">2477</span><span class="token punctuation">,</span> <span class="token number">2503</span><span class="token punctuation">,</span> <span class="token number">2521</span><span class="token punctuation">,</span> <span class="token number">2531</span><span class="token punctuation">,</span> <span class="token number">2539</span><span class="token punctuation">,</span> <span class="token number">2543</span><span class="token punctuation">,</span> <span class="token number">2549</span><span class="token punctuation">,</span> <span class="token number">2551</span><span class="token punctuation">,</span> <span class="token number">2557</span><span class="token punctuation">,</span> <span class="token number">2579</span><span class="token punctuation">,</span> <span class="token number">2591</span><span class="token punctuation">,</span> <span class="token number">2593</span><span class="token punctuation">,</span> <span class="token number">2609</span><span class="token punctuation">,</span> <span class="token number">2617</span><span class="token punctuation">,</span> <span class="token number">2621</span><span class="token punctuation">,</span> <span class="token number">2633</span><span class="token punctuation">,</span> <span class="token number">2647</span><span class="token punctuation">,</span> <span class="token number">2657</span><span class="token punctuation">,</span> <span class="token number">2659</span><span class="token punctuation">,</span> <span class="token number">2663</span><span class="token punctuation">,</span> <span class="token number">2671</span><span class="token punctuation">,</span> <span class="token number">2677</span><span class="token punctuation">,</span> <span class="token number">2683</span><span class="token punctuation">,</span> <span class="token number">2687</span><span class="token punctuation">,</span> <span class="token number">2689</span><span class="token punctuation">,</span> <span class="token number">2693</span><span class="token punctuation">,</span> <span class="token number">2699</span><span class="token punctuation">,</span> <span class="token number">2707</span><span class="token punctuation">,</span> <span class="token number">2711</span><span class="token punctuation">,</span> <span class="token number">2713</span><span class="token punctuation">,</span> <span class="token number">2719</span><span class="token punctuation">,</span> <span class="token number">2729</span><span class="token punctuation">,</span> <span class="token number">2731</span><span class="token punctuation">,</span> <span class="token number">2741</span><span class="token punctuation">,</span> <span class="token number">2749</span><span class="token punctuation">,</span> <span class="token number">2753</span><span class="token punctuation">,</span> <span class="token number">2767</span><span class="token punctuation">,</span> <span class="token number">2777</span><span class="token punctuation">,</span> <span class="token number">2789</span><span class="token punctuation">,</span> <span class="token number">2791</span><span class="token punctuation">,</span> <span class="token number">2797</span><span class="token punctuation">,</span> <span class="token number">2801</span><span class="token punctuation">,</span> <span class="token number">2803</span><span class="token punctuation">,</span> <span class="token number">2819</span><span class="token punctuation">,</span> <span class="token number">2833</span><span class="token punctuation">,</span> <span class="token number">2837</span><span class="token punctuation">,</span> <span class="token number">2843</span><span class="token punctuation">,</span> <span class="token number">2851</span><span class="token punctuation">,</span> <span class="token number">2857</span><span class="token punctuation">,</span> <span class="token number">2861</span><span class="token punctuation">,</span> <span class="token number">2879</span><span class="token punctuation">,</span> <span class="token number">2887</span><span class="token punctuation">,</span> <span class="token number">2897</span><span class="token punctuation">,</span> <span class="token number">2903</span><span class="token punctuation">,</span> <span class="token number">2909</span><span class="token punctuation">,</span> <span class="token number">2917</span><span class="token punctuation">,</span> <span class="token number">2927</span><span class="token punctuation">,</span> <span class="token number">2939</span><span class="token punctuation">,</span> <span class="token number">2953</span><span class="token punctuation">,</span> <span class="token number">2957</span><span class="token punctuation">,</span> <span class="token number">2963</span><span class="token punctuation">,</span> <span class="token number">2969</span><span class="token punctuation">,</span> <span class="token number">2971</span><span class="token punctuation">,</span> <span class="token number">2999</span><span class="token punctuation">]</span><span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> vals<span class="token punctuation">)</span><span class="token punctuation">:</span>    M<span class="token operator">=</span>M<span class="token operator">*</span>primes<span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token keyword">for</span> a <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> k <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        p<span class="token operator">=</span>mpz<span class="token punctuation">(</span>k<span class="token operator">*</span>M<span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">65537</span><span class="token operator">**</span>a <span class="token operator">%</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>            q <span class="token operator">=</span> mpz<span class="token punctuation">(</span>n<span class="token operator">//</span>p<span class="token punctuation">)</span>            <span class="token keyword">if</span> is_prime<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'p=%d\nq=%d'</span><span class="token operator">%</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>p<span class="token operator">=</span><span class="token number">4582433561127855310805294456657993281782662645116543024537051682479</span>q<span class="token operator">=</span><span class="token number">3386619977051114637303328519173627165817832179845212640767197001941</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;760958c9-cca9-458b-9cbe-ea07aa1668e4&#125;</span></code></pre><h2 id="V-amp-N2020-公开赛-easy-RSA"><a href="#V-amp-N2020-公开赛-easy-RSA" class="headerlink" title="[V&amp;N2020 公开赛]easy_RSA"></a>[V&amp;N2020 公开赛]easy_RSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randint<span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">getprime</span><span class="token punctuation">(</span>bits<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> <span class="token number">1</span><span class="token punctuation">:</span>        n <span class="token operator">=</span> <span class="token number">1</span>        <span class="token keyword">while</span> n<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> bits<span class="token punctuation">:</span>            n <span class="token operator">*=</span> next_prime<span class="token punctuation">(</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> n <span class="token operator">-</span> <span class="token number">1</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span><span class="token string">b'flag&#123;************************************&#125;'</span><span class="token punctuation">)</span>p <span class="token operator">=</span> getprime<span class="token punctuation">(</span><span class="token number">505</span><span class="token punctuation">)</span>q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span>r <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">512</span><span class="token punctuation">)</span><span class="token keyword">assert</span> m <span class="token operator">&lt;</span> qn <span class="token operator">=</span> p <span class="token operator">*</span> q <span class="token operator">*</span> re <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>q <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">,</span> p <span class="token operator">**</span> <span class="token number">2</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> r<span class="token punctuation">)</span>cipher <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>d<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''794137173995657728016066441938374096751691893878130661081714974498837928056135903901650867936580610872219815719905880789270383755828067871142041124291405965805536634812310647333518650561741895663078064989494523334598527947110688863517725601146897908332060510325617844699323032044379024028515826023692651904241337820429851471489072532583176928150553078773992200736702688395954423956888634907055727286904227552896148341254449558981193385613155722167353417010540975159878427941709494445172021580670211184545583601450303994534876036935226957467325472241008455701193759776290707023089912213887219522589697523059043787244020025459471825298596045844000489830918615947202997917438875212284927141354495840030543864577519330959029838412460489521550976682453226643185188614401618155233923718966393124032999431934705026408748451436388483012584983753140040289666712916510617403356206112730613485227084128314043665913357106301736817062412927135716281544348612150328867226515184078966397180771624148797528036548243343316501503364783092550480439749404301122277056732857399413805293899249313045684662146333448668209567898831091274930053147799756622844119463942087160062353526056879436998061803187343431081504474584816590199768034450005448200'''</span></code></pre><blockquote><ol><li><p><a href="https://en.wikipedia.org/wiki/Williams'_p_%2B_1_algorithm">Williams’p+1 algorithm</a></p><p><a href="https://0xdktb.top/2020/02/28/Summary-of-Crypto-in-CTF-RSA/#RSA-William%E2%80%99s-p-1-and-Pollard%E2%80%99s-p-1">https://0xdktb.top/2020/02/28/Summary-of-Crypto-in-CTF-RSA/#RSA-William%E2%80%99s-p-1-and-Pollard%E2%80%99s-p-1</a></p></li><li><p>p &lt; q  ，分解q^2的时候要加上p^2的倍数</p></li><li><p>模数是素数，e = 2，求解二次平方根：Tonelli–Shanks算法</p></li></ol></blockquote><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> primefac <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdmn <span class="token operator">=</span> <span class="token number">7941371739956577280160664419383740967516918938781306610817149744988379280561359039016508679365806108722198157199058807892703837558280678711420411242914059658055366348123106473335186505617418956630780649894945233345985279471106888635177256011468979083320605103256178446993230320443790240285158260236926519042413378204298514714890725325831769281505530787739922007367026883959544239568886349070557272869042275528961483412544495589811933856131557221673534170105409</span><span class="token comment"># p = williams_pp1(n)</span><span class="token comment"># print p</span>p <span class="token operator">=</span> <span class="token number">102634610559478918970860957918259981057327949366949344137104804864768237961662136189827166317524151288799657758536256924609797810164397005081733039415393</span>e <span class="token operator">=</span> <span class="token number">0x10001</span>d <span class="token operator">=</span> <span class="token number">7515987842794170949444517202158067021118454558360145030399453487603693522695746732547224100845570119375977629070702308991221388721952258969752305904378724402002545947182529859604584400048983091861594720299791743887521228492714135449584003054386457751933095902983841246048952155097668245322664318518861440</span>cipher <span class="token operator">=</span> <span class="token number">1618155233923718966393124032999431934705026408748451436388483012584983753140040289666712916510617403356206112730613485227084128314043665913357106301736817062412927135716281544348612150328867226515184078966397180771624148797528036548243343316501503364783092550480439749404301122277056732857399413805293899249313045684662146333448668209567898831091274930053147799756622844119463942087160062353526056879436998061803187343431081504474584816590199768034450005448200</span>q2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>d<span class="token punctuation">,</span> p<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token comment"># for i in tqdm(range(10000)):</span><span class="token comment"># q = iroot(q2+i*p**2, 2)</span><span class="token comment"># if q[1]:</span><span class="token comment"># print q[0]</span><span class="token comment"># exit()</span>q <span class="token operator">=</span> <span class="token number">7534810196420932552168708937019691994681052660068275906973480617604535381306041583841106383688654426129050931519275383386503174076258645141589911492908993</span>r <span class="token operator">=</span> n <span class="token operator">//</span> p <span class="token operator">//</span> qd1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>cipher<span class="token punctuation">,</span> d1<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">legendre</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">tonelli</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> legendre<span class="token punctuation">(</span>n<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span>    q <span class="token operator">=</span> p <span class="token operator">-</span> <span class="token number">1</span>    s <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> q <span class="token operator">%</span> <span class="token number">2</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        q <span class="token operator">//=</span> <span class="token number">2</span>        s <span class="token operator">+=</span> <span class="token number">1</span>    <span class="token keyword">if</span> s <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token punctuation">(</span>p <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">4</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>    <span class="token keyword">for</span> z <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10000</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#    for z in range(2, p):</span>        <span class="token keyword">if</span> p <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">==</span> legendre<span class="token punctuation">(</span>z<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>z<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>    r <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> <span class="token punctuation">(</span>q <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>    t <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>n<span class="token punctuation">,</span> q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>    m <span class="token operator">=</span> s    t2 <span class="token operator">=</span> <span class="token number">0</span>    <span class="token keyword">while</span> <span class="token punctuation">(</span>t <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>        t2 <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> t<span class="token punctuation">)</span> <span class="token operator">%</span> p        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>t2 <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> p <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                <span class="token keyword">break</span>            t2 <span class="token operator">=</span> <span class="token punctuation">(</span>t2 <span class="token operator">*</span> t2<span class="token punctuation">)</span> <span class="token operator">%</span> p        b <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token punctuation">(</span>m <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>        r <span class="token operator">=</span> <span class="token punctuation">(</span>r <span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> p        c <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> p        t <span class="token operator">=</span> <span class="token punctuation">(</span>t <span class="token operator">*</span> c<span class="token punctuation">)</span> <span class="token operator">%</span> p        m <span class="token operator">=</span> i    <span class="token keyword">return</span> rm <span class="token operator">=</span> tonelli<span class="token punctuation">(</span>c<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token keyword">print</span> n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment"># flag&#123;fd462593-25e4-4631-a96a-0cd5c72b2d1b&#125;</span></code></pre><h2 id="DASCTF三月赛-son-of-NTRU"><a href="#DASCTF三月赛-son-of-NTRU" class="headerlink" title="[DASCTF三月赛]son_of_NTRU"></a>[DASCTF三月赛]son_of_NTRU</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> random <span class="token keyword">import</span> randrange<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> invert<span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">while</span> b<span class="token punctuation">:</span>        a<span class="token punctuation">,</span>b <span class="token operator">=</span> b<span class="token punctuation">,</span>a<span class="token operator">%</span>b    <span class="token keyword">return</span> a<span class="token keyword">def</span> <span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        g <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> gcd<span class="token punctuation">(</span>f<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span> <span class="token keyword">and</span> gcd<span class="token punctuation">(</span>f<span class="token punctuation">,</span>g<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">:</span>            <span class="token keyword">break</span>    h <span class="token operator">=</span> <span class="token punctuation">(</span>invert<span class="token punctuation">(</span>f<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token operator">*</span>g<span class="token punctuation">)</span><span class="token operator">%</span>p    <span class="token keyword">return</span> h<span class="token punctuation">,</span>p<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g<span class="token keyword">def</span> <span class="token function">encrypt</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>h<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">assert</span> m<span class="token operator">&lt;</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> randrange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">(</span>p<span class="token operator">//</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">**</span><span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span>r<span class="token operator">*</span>h<span class="token operator">+</span>m<span class="token punctuation">)</span><span class="token operator">%</span>p    <span class="token keyword">return</span> ch<span class="token punctuation">,</span>p<span class="token punctuation">,</span>f<span class="token punctuation">,</span>g <span class="token operator">=</span> generate<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">from</span> flag <span class="token keyword">import</span> flagc <span class="token operator">=</span> encrypt<span class="token punctuation">(</span>bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span>h<span class="token punctuation">,</span>p<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"h = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>h<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"p = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"c = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># h = 70851272226599856513658616506718804769182611213413854493145253337330709939355936692154199813179587933065165812259913249917314725765898812249062834111179900151466610356207921771928832591335738750053453046857602342378475278876652263044722419918958361163645152112020971804267503129035439011008349349624213734004</span><span class="token comment"># p = 125796773654949906956757901514929172896506715196511121353157781851652093811702246079116208920427110231653664239838444378725001877052652056537732732266407477191221775698956008368755461680533430353707546171814962217736494341129233572423073286387554056407408816555382448824610216634458550949715062229816683685469</span><span class="token comment"># c = 4691517945653877981376957637565364382959972087952249273292897076221178958350355396910942555879426136128610896883898318646711419768716904972164508407035668258209226498292327845169861395205212789741065517685193351416871631112431257858097798333893494180621728198734264288028849543413123321402664789239712408700</span></code></pre><p><a href="https://xz.aliyun.com/t/7163">https://xz.aliyun.com/t/7163</a></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>h <span class="token operator">=</span> <span class="token number">70851272226599856513658616506718804769182611213413854493145253337330709939355936692154199813179587933065165812259913249917314725765898812249062834111179900151466610356207921771928832591335738750053453046857602342378475278876652263044722419918958361163645152112020971804267503129035439011008349349624213734004</span>p <span class="token operator">=</span> <span class="token number">125796773654949906956757901514929172896506715196511121353157781851652093811702246079116208920427110231653664239838444378725001877052652056537732732266407477191221775698956008368755461680533430353707546171814962217736494341129233572423073286387554056407408816555382448824610216634458550949715062229816683685469</span>c <span class="token operator">=</span> <span class="token number">4691517945653877981376957637565364382959972087952249273292897076221178958350355396910942555879426136128610896883898318646711419768716904972164508407035668258209226498292327845169861395205212789741065517685193351416871631112431257858097798333893494180621728198734264288028849543413123321402664789239712408700</span><span class="token comment"># Construct lattice.</span>v1 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> h<span class="token punctuation">]</span><span class="token punctuation">)</span>v2 <span class="token operator">=</span> vector<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">,</span> p<span class="token punctuation">]</span><span class="token punctuation">)</span>m <span class="token operator">=</span> matrix<span class="token punctuation">(</span><span class="token punctuation">[</span>v1<span class="token punctuation">,</span>v2<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment"># Solve SVP.</span>shortest_vector <span class="token operator">=</span> m<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>f<span class="token punctuation">,</span> g <span class="token operator">=</span> shortest_vector<span class="token comment"># print(f, g)</span><span class="token comment"># Decrypt</span>f <span class="token operator">=</span> <span class="token number">3052745506321037491577220926923466609715612813029263120922605939187287981215931840968854538555321338710902665095952768815345285556873715325200121768087377</span> g <span class="token operator">=</span> <span class="token number">6390108444026998457573135563944030351069358995011779835195686570376684843461358071141777920310356437442825541867565659114422145012850808683785653621804110</span>a <span class="token operator">=</span> f<span class="token operator">*</span>c <span class="token operator">%</span> p <span class="token operator">%</span> gm <span class="token operator">=</span> a <span class="token operator">*</span> inverse_mod<span class="token punctuation">(</span>f<span class="token punctuation">,</span> g<span class="token punctuation">)</span> <span class="token operator">%</span> g<span class="token comment"># print(m)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">bytes</span><span class="token punctuation">.</span>fromhex<span class="token punctuation">(</span><span class="token builtin">hex</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># b'flag&#123;93d02e3bf2c7458a47aac58387140dd5&#125;'</span></code></pre><h2 id="DASCTF三月赛-FeedBack"><a href="#DASCTF三月赛-FeedBack" class="headerlink" title="[DASCTF三月赛]FeedBack"></a>[DASCTF三月赛]FeedBack</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">from</span> string <span class="token keyword">import</span> hexdigits<span class="token keyword">import</span> random<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span><span class="token keyword">def</span> <span class="token function">cycle</span><span class="token punctuation">(</span>c<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">,</span>a<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token builtin">int</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> x<span class="token operator">+</span>y<span class="token punctuation">,</span><span class="token builtin">map</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token builtin">zip</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">enc</span><span class="token punctuation">(</span>m<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">,</span>k<span class="token punctuation">:</span><span class="token builtin">list</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">></span><span class="token builtin">list</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        m<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cycle<span class="token punctuation">(</span>m<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token builtin">len</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>hexdigits<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    key<span class="token operator">=</span><span class="token punctuation">[</span><span class="token builtin">ord</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>hexdigits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    c<span class="token operator">=</span>enc<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">,</span>key<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment"># flag = [180320, 12795604, 913707946, 65244867544, 4658921499366, 332678259897680, 23755460291939729, 1696299282824525162, 121127152307279309992, 8649291534003765460181, 617617459134250473857819, 44102031285199767595231826, 3149180993372727865351695610, 224872656429052251931507068163, 16057416742916791898621189838002, 1146607313446549338631740275859490, 81875456824588820793005728503088789, 5846457066530480582594997088868317921, 417476268914312098171907310476576578536, 29810607197367740257089118506396936455267, 2128677406710643996313598469435818995764283, 152001851952900202233154866795341968398324618, 10853952282423997785255606215412380976089774602, 775045031593704366379150517314704054142878227755, 55343416422679709865626814221707233611767499083451, 3951891330799176591085237005754672086216649002044116, 282191561344334793283891774610663595748300192924237652, 20150371209182455377207293308509352961052348504530516058, 1438871729308714548579613052036192683042976990785336035213, 102745097443187470470063857372230471012050786200205019335560, 7336689458539737357933680339939811164938123954552946412371136, 523888862345101730958585832445722009143686030486587614405269619, 37409180481229224476184683624742923927721083153229315469794323846, 2671266531631899605156440693785360699681088880751785277451781995127, 190746356675660819059021289711194688989007498945709965975632125093772, 13620569925986012345710256811290898483914841356894501064938828451682289, 972600097542764210429602165761543702875470220807440912087468994318947199, 69450173882625967125859360885466807837084362724230554403206714010957033564, 4959208480970674965771932762141990438694621159829420665293248503741956497339, 354120765763611360372631234091033326236527919343510113669886900852817067794937, 25286599106731127999761204195099137001826484641202640190432847596126102129290177, 1805632869356683189091740036886552559813413339716342384679179468460652986832630119, 128934304100758873373068786008043012614625306314330902439450614878647840309940810799, 9206774564238985792239909901043542380389506567225353556524468058541750913201465442258, 657425488646345934124836595103998888905043390553798696290609052666406363868364633227987, 46944591735815161454850764823066332748372328488810515939042504343121621896260739496814215, 3352158885381868382186614128492698209211597671157972107257901283108688995314288195559935895, 239366640061152248661380413770610731951278310979044705869198442025229868870474962029566786828, 17092384440374810990148000504438682199862673994374786921479630475896214666270304948184067943963, 1220510952499186818225235173267171189892653750839095345581049972346091269304188809141591821528945, 87152672604981875905661244747737456527193455119785950165560211136820203006355054095176767065463607, 6223285687554056604834063330772248822879874758146969128122776216276580479221618865554693862254391145, 444384361274324240336894080988769378714126300500080707977898823502774400070423897702729938853457320554, 31732025566514505285832183071784730973330427403124198140983516899800427456134314554661472009492580417251]</span></code></pre><p>主要的运算逻辑就是边移位边和key相乘再求和</p><p>先把key作为未知数，利用前27位c和key运算生成后27位c的逻辑求得key</p><p>再把27位flag作为未知数，利用27位flag和key运算生成前27位c的逻辑求得flag</p><p>z3解方程组</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> z3 <span class="token keyword">import</span> <span class="token operator">*</span>c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">180320</span><span class="token punctuation">,</span> <span class="token number">12795604</span><span class="token punctuation">,</span> <span class="token number">913707946</span><span class="token punctuation">,</span> <span class="token number">65244867544</span><span class="token punctuation">,</span> <span class="token number">4658921499366</span><span class="token punctuation">,</span> <span class="token number">332678259897680</span><span class="token punctuation">,</span> <span class="token number">23755460291939729</span><span class="token punctuation">,</span> <span class="token number">1696299282824525162</span><span class="token punctuation">,</span> <span class="token number">121127152307279309992</span><span class="token punctuation">,</span> <span class="token number">8649291534003765460181</span><span class="token punctuation">,</span> <span class="token number">617617459134250473857819</span><span class="token punctuation">,</span> <span class="token number">44102031285199767595231826</span><span class="token punctuation">,</span> <span class="token number">3149180993372727865351695610</span><span class="token punctuation">,</span> <span class="token number">224872656429052251931507068163</span><span class="token punctuation">,</span> <span class="token number">16057416742916791898621189838002</span><span class="token punctuation">,</span> <span class="token number">1146607313446549338631740275859490</span><span class="token punctuation">,</span> <span class="token number">81875456824588820793005728503088789</span><span class="token punctuation">,</span> <span class="token number">5846457066530480582594997088868317921</span><span class="token punctuation">,</span> <span class="token number">417476268914312098171907310476576578536</span><span class="token punctuation">,</span> <span class="token number">29810607197367740257089118506396936455267</span><span class="token punctuation">,</span> <span class="token number">2128677406710643996313598469435818995764283</span><span class="token punctuation">,</span> <span class="token number">152001851952900202233154866795341968398324618</span><span class="token punctuation">,</span> <span class="token number">10853952282423997785255606215412380976089774602</span><span class="token punctuation">,</span> <span class="token number">775045031593704366379150517314704054142878227755</span><span class="token punctuation">,</span> <span class="token number">55343416422679709865626814221707233611767499083451</span><span class="token punctuation">,</span> <span class="token number">3951891330799176591085237005754672086216649002044116</span><span class="token punctuation">,</span> <span class="token number">282191561344334793283891774610663595748300192924237652</span><span class="token punctuation">,</span> <span class="token number">20150371209182455377207293308509352961052348504530516058</span><span class="token punctuation">,</span> <span class="token number">1438871729308714548579613052036192683042976990785336035213</span><span class="token punctuation">,</span> <span class="token number">102745097443187470470063857372230471012050786200205019335560</span><span class="token punctuation">,</span> <span class="token number">7336689458539737357933680339939811164938123954552946412371136</span><span class="token punctuation">,</span> <span class="token number">523888862345101730958585832445722009143686030486587614405269619</span><span class="token punctuation">,</span> <span class="token number">37409180481229224476184683624742923927721083153229315469794323846</span><span class="token punctuation">,</span> <span class="token number">2671266531631899605156440693785360699681088880751785277451781995127</span><span class="token punctuation">,</span> <span class="token number">190746356675660819059021289711194688989007498945709965975632125093772</span><span class="token punctuation">,</span> <span class="token number">13620569925986012345710256811290898483914841356894501064938828451682289</span><span class="token punctuation">,</span> <span class="token number">972600097542764210429602165761543702875470220807440912087468994318947199</span><span class="token punctuation">,</span> <span class="token number">69450173882625967125859360885466807837084362724230554403206714010957033564</span><span class="token punctuation">,</span> <span class="token number">4959208480970674965771932762141990438694621159829420665293248503741956497339</span><span class="token punctuation">,</span> <span class="token number">354120765763611360372631234091033326236527919343510113669886900852817067794937</span><span class="token punctuation">,</span> <span class="token number">25286599106731127999761204195099137001826484641202640190432847596126102129290177</span><span class="token punctuation">,</span> <span class="token number">1805632869356683189091740036886552559813413339716342384679179468460652986832630119</span><span class="token punctuation">,</span> <span class="token number">128934304100758873373068786008043012614625306314330902439450614878647840309940810799</span><span class="token punctuation">,</span> <span class="token number">9206774564238985792239909901043542380389506567225353556524468058541750913201465442258</span><span class="token punctuation">,</span> <span class="token number">657425488646345934124836595103998888905043390553798696290609052666406363868364633227987</span><span class="token punctuation">,</span> <span class="token number">46944591735815161454850764823066332748372328488810515939042504343121621896260739496814215</span><span class="token punctuation">,</span> <span class="token number">3352158885381868382186614128492698209211597671157972107257901283108688995314288195559935895</span><span class="token punctuation">,</span> <span class="token number">239366640061152248661380413770610731951278310979044705869198442025229868870474962029566786828</span><span class="token punctuation">,</span> <span class="token number">17092384440374810990148000504438682199862673994374786921479630475896214666270304948184067943963</span><span class="token punctuation">,</span> <span class="token number">1220510952499186818225235173267171189892653750839095345581049972346091269304188809141591821528945</span><span class="token punctuation">,</span> <span class="token number">87152672604981875905661244747737456527193455119785950165560211136820203006355054095176767065463607</span><span class="token punctuation">,</span> <span class="token number">6223285687554056604834063330772248822879874758146969128122776216276580479221618865554693862254391145</span><span class="token punctuation">,</span> <span class="token number">444384361274324240336894080988769378714126300500080707977898823502774400070423897702729938853457320554</span><span class="token punctuation">,</span> <span class="token number">31732025566514505285832183071784730973330427403124198140983516899800427456134314554661472009492580417251</span><span class="token punctuation">]</span><span class="token comment"># k=[Int('k%d'%i) for i in range(27)]</span>f<span class="token operator">=</span><span class="token punctuation">[</span>Int<span class="token punctuation">(</span><span class="token string">'f%d'</span><span class="token operator">%</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token comment"># for i in range(27):</span><span class="token comment">#     print('s.add(')</span><span class="token comment">#     for j in range(27):</span><span class="token comment">#         if j !=26:</span><span class="token comment">#             print('c[&#123;&#125;]*k[&#123;&#125;]+'.format(i+j,j),end='')</span><span class="token comment">#         else: </span><span class="token comment">#         print('c[&#123;&#125;]*k[&#123;&#125;]'.format(i+j,j),end='')</span><span class="token comment">#     print('==c[&#123;&#125;])'.format(i+j+1))</span>s<span class="token operator">=</span>Solver<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># s.add(</span><span class="token comment"># c[0]*k[0]+c[1]*k[1]+c[2]*k[2]+c[3]*k[3]+c[4]*k[4]+c[5]*k[5]+c[6]*k[6]+c[7]*k[7]+c[8]*k[8]+c[9]*k[9]+c[10]*k[10]+c[11]*k[11]+c[12]*k[12]+c[13]*k[13]+c[14]*k[14]+c[15]*k[15]+c[16]*k[16]+c[17]*k[17]+c[18]*k[18]+c[19]*k[19]+c[20]*k[20]+c[21]*k[21]+c[22]*k[22]+c[23]*k[23]+c[24]*k[24]+c[25]*k[25]+c[26]*k[26]==c[27])</span><span class="token comment"># s.add(</span><span class="token comment"># c[1]*k[0]+c[2]*k[1]+c[3]*k[2]+c[4]*k[3]+c[5]*k[4]+c[6]*k[5]+c[7]*k[6]+c[8]*k[7]+c[9]*k[8]+c[10]*k[9]+c[11]*k[10]+c[12]*k[11]+c[13]*k[12]+c[14]*k[13]+c[15]*k[14]+c[16]*k[15]+c[17]*k[16]+c[18]*k[17]+c[19]*k[18]+c[20]*k[19]+c[21]*k[20]+c[22]*k[21]+c[23]*k[22]+c[24]*k[23]+c[25]*k[24]+c[26]*k[25]+c[27]*k[26]==c[28])</span><span class="token comment"># s.add(</span><span class="token comment"># c[2]*k[0]+c[3]*k[1]+c[4]*k[2]+c[5]*k[3]+c[6]*k[4]+c[7]*k[5]+c[8]*k[6]+c[9]*k[7]+c[10]*k[8]+c[11]*k[9]+c[12]*k[10]+c[13]*k[11]+c[14]*k[12]+c[15]*k[13]+c[16]*k[14]+c[17]*k[15]+c[18]*k[16]+c[19]*k[17]+c[20]*k[18]+c[21]*k[19]+c[22]*k[20]+c[23]*k[21]+c[24]*k[22]+c[25]*k[23]+c[26]*k[24]+c[27]*k[25]+c[28]*k[26]==c[29])</span><span class="token comment"># s.add(</span><span class="token comment"># c[3]*k[0]+c[4]*k[1]+c[5]*k[2]+c[6]*k[3]+c[7]*k[4]+c[8]*k[5]+c[9]*k[6]+c[10]*k[7]+c[11]*k[8]+c[12]*k[9]+c[13]*k[10]+c[14]*k[11]+c[15]*k[12]+c[16]*k[13]+c[17]*k[14]+c[18]*k[15]+c[19]*k[16]+c[20]*k[17]+c[21]*k[18]+c[22]*k[19]+c[23]*k[20]+c[24]*k[21]+c[25]*k[22]+c[26]*k[23]+c[27]*k[24]+c[28]*k[25]+c[29]*k[26]==c[30])</span><span class="token comment"># s.add(</span><span class="token comment"># c[4]*k[0]+c[5]*k[1]+c[6]*k[2]+c[7]*k[3]+c[8]*k[4]+c[9]*k[5]+c[10]*k[6]+c[11]*k[7]+c[12]*k[8]+c[13]*k[9]+c[14]*k[10]+c[15]*k[11]+c[16]*k[12]+c[17]*k[13]+c[18]*k[14]+c[19]*k[15]+c[20]*k[16]+c[21]*k[17]+c[22]*k[18]+c[23]*k[19]+c[24]*k[20]+c[25]*k[21]+c[26]*k[22]+c[27]*k[23]+c[28]*k[24]+c[29]*k[25]+c[30]*k[26]==c[31])</span><span class="token comment"># s.add(</span><span class="token comment"># c[5]*k[0]+c[6]*k[1]+c[7]*k[2]+c[8]*k[3]+c[9]*k[4]+c[10]*k[5]+c[11]*k[6]+c[12]*k[7]+c[13]*k[8]+c[14]*k[9]+c[15]*k[10]+c[16]*k[11]+c[17]*k[12]+c[18]*k[13]+c[19]*k[14]+c[20]*k[15]+c[21]*k[16]+c[22]*k[17]+c[23]*k[18]+c[24]*k[19]+c[25]*k[20]+c[26]*k[21]+c[27]*k[22]+c[28]*k[23]+c[29]*k[24]+c[30]*k[25]+c[31]*k[26]==c[32])</span><span class="token comment"># s.add(</span><span class="token comment"># c[6]*k[0]+c[7]*k[1]+c[8]*k[2]+c[9]*k[3]+c[10]*k[4]+c[11]*k[5]+c[12]*k[6]+c[13]*k[7]+c[14]*k[8]+c[15]*k[9]+c[16]*k[10]+c[17]*k[11]+c[18]*k[12]+c[19]*k[13]+c[20]*k[14]+c[21]*k[15]+c[22]*k[16]+c[23]*k[17]+c[24]*k[18]+c[25]*k[19]+c[26]*k[20]+c[27]*k[21]+c[28]*k[22]+c[29]*k[23]+c[30]*k[24]+c[31]*k[25]+c[32]*k[26]==c[33])</span><span class="token comment"># s.add(</span><span class="token comment"># c[7]*k[0]+c[8]*k[1]+c[9]*k[2]+c[10]*k[3]+c[11]*k[4]+c[12]*k[5]+c[13]*k[6]+c[14]*k[7]+c[15]*k[8]+c[16]*k[9]+c[17]*k[10]+c[18]*k[11]+c[19]*k[12]+c[20]*k[13]+c[21]*k[14]+c[22]*k[15]+c[23]*k[16]+c[24]*k[17]+c[25]*k[18]+c[26]*k[19]+c[27]*k[20]+c[28]*k[21]+c[29]*k[22]+c[30]*k[23]+c[31]*k[24]+c[32]*k[25]+c[33]*k[26]==c[34])</span><span class="token comment"># s.add(</span><span class="token comment"># c[8]*k[0]+c[9]*k[1]+c[10]*k[2]+c[11]*k[3]+c[12]*k[4]+c[13]*k[5]+c[14]*k[6]+c[15]*k[7]+c[16]*k[8]+c[17]*k[9]+c[18]*k[10]+c[19]*k[11]+c[20]*k[12]+c[21]*k[13]+c[22]*k[14]+c[23]*k[15]+c[24]*k[16]+c[25]*k[17]+c[26]*k[18]+c[27]*k[19]+c[28]*k[20]+c[29]*k[21]+c[30]*k[22]+c[31]*k[23]+c[32]*k[24]+c[33]*k[25]+c[34]*k[26]==c[35])</span><span class="token comment"># s.add(</span><span class="token comment"># c[9]*k[0]+c[10]*k[1]+c[11]*k[2]+c[12]*k[3]+c[13]*k[4]+c[14]*k[5]+c[15]*k[6]+c[16]*k[7]+c[17]*k[8]+c[18]*k[9]+c[19]*k[10]+c[20]*k[11]+c[21]*k[12]+c[22]*k[13]+c[23]*k[14]+c[24]*k[15]+c[25]*k[16]+c[26]*k[17]+c[27]*k[18]+c[28]*k[19]+c[29]*k[20]+c[30]*k[21]+c[31]*k[22]+c[32]*k[23]+c[33]*k[24]+c[34]*k[25]+c[35]*k[26]==c[36])</span><span class="token comment"># s.add(</span><span class="token comment"># c[10]*k[0]+c[11]*k[1]+c[12]*k[2]+c[13]*k[3]+c[14]*k[4]+c[15]*k[5]+c[16]*k[6]+c[17]*k[7]+c[18]*k[8]+c[19]*k[9]+c[20]*k[10]+c[21]*k[11]+c[22]*k[12]+c[23]*k[13]+c[24]*k[14]+c[25]*k[15]+c[26]*k[16]+c[27]*k[17]+c[28]*k[18]+c[29]*k[19]+c[30]*k[20]+c[31]*k[21]+c[32]*k[22]+c[33]*k[23]+c[34]*k[24]+c[35]*k[25]+c[36]*k[26]==c[37])</span><span class="token comment"># s.add(</span><span class="token comment"># c[11]*k[0]+c[12]*k[1]+c[13]*k[2]+c[14]*k[3]+c[15]*k[4]+c[16]*k[5]+c[17]*k[6]+c[18]*k[7]+c[19]*k[8]+c[20]*k[9]+c[21]*k[10]+c[22]*k[11]+c[23]*k[12]+c[24]*k[13]+c[25]*k[14]+c[26]*k[15]+c[27]*k[16]+c[28]*k[17]+c[29]*k[18]+c[30]*k[19]+c[31]*k[20]+c[32]*k[21]+c[33]*k[22]+c[34]*k[23]+c[35]*k[24]+c[36]*k[25]+c[37]*k[26]==c[38])</span><span class="token comment"># s.add(</span><span class="token comment"># c[12]*k[0]+c[13]*k[1]+c[14]*k[2]+c[15]*k[3]+c[16]*k[4]+c[17]*k[5]+c[18]*k[6]+c[19]*k[7]+c[20]*k[8]+c[21]*k[9]+c[22]*k[10]+c[23]*k[11]+c[24]*k[12]+c[25]*k[13]+c[26]*k[14]+c[27]*k[15]+c[28]*k[16]+c[29]*k[17]+c[30]*k[18]+c[31]*k[19]+c[32]*k[20]+c[33]*k[21]+c[34]*k[22]+c[35]*k[23]+c[36]*k[24]+c[37]*k[25]+c[38]*k[26]==c[39])</span><span class="token comment"># s.add(</span><span class="token comment"># c[13]*k[0]+c[14]*k[1]+c[15]*k[2]+c[16]*k[3]+c[17]*k[4]+c[18]*k[5]+c[19]*k[6]+c[20]*k[7]+c[21]*k[8]+c[22]*k[9]+c[23]*k[10]+c[24]*k[11]+c[25]*k[12]+c[26]*k[13]+c[27]*k[14]+c[28]*k[15]+c[29]*k[16]+c[30]*k[17]+c[31]*k[18]+c[32]*k[19]+c[33]*k[20]+c[34]*k[21]+c[35]*k[22]+c[36]*k[23]+c[37]*k[24]+c[38]*k[25]+c[39]*k[26]==c[40])</span><span class="token comment"># s.add(</span><span class="token comment"># c[14]*k[0]+c[15]*k[1]+c[16]*k[2]+c[17]*k[3]+c[18]*k[4]+c[19]*k[5]+c[20]*k[6]+c[21]*k[7]+c[22]*k[8]+c[23]*k[9]+c[24]*k[10]+c[25]*k[11]+c[26]*k[12]+c[27]*k[13]+c[28]*k[14]+c[29]*k[15]+c[30]*k[16]+c[31]*k[17]+c[32]*k[18]+c[33]*k[19]+c[34]*k[20]+c[35]*k[21]+c[36]*k[22]+c[37]*k[23]+c[38]*k[24]+c[39]*k[25]+c[40]*k[26]==c[41])</span><span class="token comment"># s.add(</span><span class="token comment"># c[15]*k[0]+c[16]*k[1]+c[17]*k[2]+c[18]*k[3]+c[19]*k[4]+c[20]*k[5]+c[21]*k[6]+c[22]*k[7]+c[23]*k[8]+c[24]*k[9]+c[25]*k[10]+c[26]*k[11]+c[27]*k[12]+c[28]*k[13]+c[29]*k[14]+c[30]*k[15]+c[31]*k[16]+c[32]*k[17]+c[33]*k[18]+c[34]*k[19]+c[35]*k[20]+c[36]*k[21]+c[37]*k[22]+c[38]*k[23]+c[39]*k[24]+c[40]*k[25]+c[41]*k[26]==c[42])</span><span class="token comment"># s.add(</span><span class="token comment"># c[16]*k[0]+c[17]*k[1]+c[18]*k[2]+c[19]*k[3]+c[20]*k[4]+c[21]*k[5]+c[22]*k[6]+c[23]*k[7]+c[24]*k[8]+c[25]*k[9]+c[26]*k[10]+c[27]*k[11]+c[28]*k[12]+c[29]*k[13]+c[30]*k[14]+c[31]*k[15]+c[32]*k[16]+c[33]*k[17]+c[34]*k[18]+c[35]*k[19]+c[36]*k[20]+c[37]*k[21]+c[38]*k[22]+c[39]*k[23]+c[40]*k[24]+c[41]*k[25]+c[42]*k[26]==c[43])</span><span class="token comment"># s.add(</span><span class="token comment"># c[17]*k[0]+c[18]*k[1]+c[19]*k[2]+c[20]*k[3]+c[21]*k[4]+c[22]*k[5]+c[23]*k[6]+c[24]*k[7]+c[25]*k[8]+c[26]*k[9]+c[27]*k[10]+c[28]*k[11]+c[29]*k[12]+c[30]*k[13]+c[31]*k[14]+c[32]*k[15]+c[33]*k[16]+c[34]*k[17]+c[35]*k[18]+c[36]*k[19]+c[37]*k[20]+c[38]*k[21]+c[39]*k[22]+c[40]*k[23]+c[41]*k[24]+c[42]*k[25]+c[43]*k[26]==c[44])</span><span class="token comment"># s.add(</span><span class="token comment"># c[18]*k[0]+c[19]*k[1]+c[20]*k[2]+c[21]*k[3]+c[22]*k[4]+c[23]*k[5]+c[24]*k[6]+c[25]*k[7]+c[26]*k[8]+c[27]*k[9]+c[28]*k[10]+c[29]*k[11]+c[30]*k[12]+c[31]*k[13]+c[32]*k[14]+c[33]*k[15]+c[34]*k[16]+c[35]*k[17]+c[36]*k[18]+c[37]*k[19]+c[38]*k[20]+c[39]*k[21]+c[40]*k[22]+c[41]*k[23]+c[42]*k[24]+c[43]*k[25]+c[44]*k[26]==c[45])</span><span class="token comment"># s.add(</span><span class="token comment"># c[19]*k[0]+c[20]*k[1]+c[21]*k[2]+c[22]*k[3]+c[23]*k[4]+c[24]*k[5]+c[25]*k[6]+c[26]*k[7]+c[27]*k[8]+c[28]*k[9]+c[29]*k[10]+c[30]*k[11]+c[31]*k[12]+c[32]*k[13]+c[33]*k[14]+c[34]*k[15]+c[35]*k[16]+c[36]*k[17]+c[37]*k[18]+c[38]*k[19]+c[39]*k[20]+c[40]*k[21]+c[41]*k[22]+c[42]*k[23]+c[43]*k[24]+c[44]*k[25]+c[45]*k[26]==c[46])</span><span class="token comment"># s.add(</span><span class="token comment"># c[20]*k[0]+c[21]*k[1]+c[22]*k[2]+c[23]*k[3]+c[24]*k[4]+c[25]*k[5]+c[26]*k[6]+c[27]*k[7]+c[28]*k[8]+c[29]*k[9]+c[30]*k[10]+c[31]*k[11]+c[32]*k[12]+c[33]*k[13]+c[34]*k[14]+c[35]*k[15]+c[36]*k[16]+c[37]*k[17]+c[38]*k[18]+c[39]*k[19]+c[40]*k[20]+c[41]*k[21]+c[42]*k[22]+c[43]*k[23]+c[44]*k[24]+c[45]*k[25]+c[46]*k[26]==c[47])</span><span class="token comment"># s.add(</span><span class="token comment"># c[21]*k[0]+c[22]*k[1]+c[23]*k[2]+c[24]*k[3]+c[25]*k[4]+c[26]*k[5]+c[27]*k[6]+c[28]*k[7]+c[29]*k[8]+c[30]*k[9]+c[31]*k[10]+c[32]*k[11]+c[33]*k[12]+c[34]*k[13]+c[35]*k[14]+c[36]*k[15]+c[37]*k[16]+c[38]*k[17]+c[39]*k[18]+c[40]*k[19]+c[41]*k[20]+c[42]*k[21]+c[43]*k[22]+c[44]*k[23]+c[45]*k[24]+c[46]*k[25]+c[47]*k[26]==c[48])</span><span class="token comment"># s.add(</span><span class="token comment"># c[22]*k[0]+c[23]*k[1]+c[24]*k[2]+c[25]*k[3]+c[26]*k[4]+c[27]*k[5]+c[28]*k[6]+c[29]*k[7]+c[30]*k[8]+c[31]*k[9]+c[32]*k[10]+c[33]*k[11]+c[34]*k[12]+c[35]*k[13]+c[36]*k[14]+c[37]*k[15]+c[38]*k[16]+c[39]*k[17]+c[40]*k[18]+c[41]*k[19]+c[42]*k[20]+c[43]*k[21]+c[44]*k[22]+c[45]*k[23]+c[46]*k[24]+c[47]*k[25]+c[48]*k[26]==c[49])</span><span class="token comment"># s.add(</span><span class="token comment"># c[23]*k[0]+c[24]*k[1]+c[25]*k[2]+c[26]*k[3]+c[27]*k[4]+c[28]*k[5]+c[29]*k[6]+c[30]*k[7]+c[31]*k[8]+c[32]*k[9]+c[33]*k[10]+c[34]*k[11]+c[35]*k[12]+c[36]*k[13]+c[37]*k[14]+c[38]*k[15]+c[39]*k[16]+c[40]*k[17]+c[41]*k[18]+c[42]*k[19]+c[43]*k[20]+c[44]*k[21]+c[45]*k[22]+c[46]*k[23]+c[47]*k[24]+c[48]*k[25]+c[49]*k[26]==c[50])</span><span class="token comment"># s.add(</span><span class="token comment"># c[24]*k[0]+c[25]*k[1]+c[26]*k[2]+c[27]*k[3]+c[28]*k[4]+c[29]*k[5]+c[30]*k[6]+c[31]*k[7]+c[32]*k[8]+c[33]*k[9]+c[34]*k[10]+c[35]*k[11]+c[36]*k[12]+c[37]*k[13]+c[38]*k[14]+c[39]*k[15]+c[40]*k[16]+c[41]*k[17]+c[42]*k[18]+c[43]*k[19]+c[44]*k[20]+c[45]*k[21]+c[46]*k[22]+c[47]*k[23]+c[48]*k[24]+c[49]*k[25]+c[50]*k[26]==c[51])</span><span class="token comment"># s.add(</span><span class="token comment"># c[25]*k[0]+c[26]*k[1]+c[27]*k[2]+c[28]*k[3]+c[29]*k[4]+c[30]*k[5]+c[31]*k[6]+c[32]*k[7]+c[33]*k[8]+c[34]*k[9]+c[35]*k[10]+c[36]*k[11]+c[37]*k[12]+c[38]*k[13]+c[39]*k[14]+c[40]*k[15]+c[41]*k[16]+c[42]*k[17]+c[43]*k[18]+c[44]*k[19]+c[45]*k[20]+c[46]*k[21]+c[47]*k[22]+c[48]*k[23]+c[49]*k[24]+c[50]*k[25]+c[51]*k[26]==c[52])</span><span class="token comment"># s.add(</span><span class="token comment"># c[26]*k[0]+c[27]*k[1]+c[28]*k[2]+c[29]*k[3]+c[30]*k[4]+c[31]*k[5]+c[32]*k[6]+c[33]*k[7]+c[34]*k[8]+c[35]*k[9]+c[36]*k[10]+c[37]*k[11]+c[38]*k[12]+c[39]*k[13]+c[40]*k[14]+c[41]*k[15]+c[42]*k[16]+c[43]*k[17]+c[44]*k[18]+c[45]*k[19]+c[46]*k[20]+c[47]*k[21]+c[48]*k[22]+c[49]*k[23]+c[50]*k[24]+c[51]*k[25]+c[52]*k[26]==c[53])</span><span class="token comment"># if s.check()==sat:</span><span class="token comment">#     m=s.model()</span><span class="token comment">#     for i in range(27):</span><span class="token comment">#         print(m[k[i]],end=',')</span>k<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">51</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">,</span><span class="token number">57</span><span class="token punctuation">,</span><span class="token number">68</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">,</span><span class="token number">54</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">55</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">97</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">65</span><span class="token punctuation">,</span><span class="token number">48</span><span class="token punctuation">,</span><span class="token number">50</span><span class="token punctuation">,</span><span class="token number">52</span><span class="token punctuation">,</span><span class="token number">66</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">49</span><span class="token punctuation">,</span><span class="token number">98</span><span class="token punctuation">,</span><span class="token number">53</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">102</span><span class="token punctuation">,</span><span class="token number">99</span><span class="token punctuation">,</span><span class="token number">70</span><span class="token punctuation">]</span><span class="token comment"># for i in range(27):</span><span class="token comment">#     print('s.add(')</span><span class="token comment">#     for j in range(27):</span><span class="token comment">#         if i+j&lt;=26:</span><span class="token comment">#             if j !=26:</span><span class="token comment">#                 print('f[&#123;&#125;]*k[&#123;&#125;]+'.format(i+j,j),end='')</span><span class="token comment">#             else: print('f[&#123;&#125;]*k[&#123;&#125;]'.format(i+j,j),end='')</span><span class="token comment">#         else:</span><span class="token comment">#             if j !=26:</span><span class="token comment">#                 print('c[&#123;&#125;]*k[&#123;&#125;]+'.format(i+j-27,j),end='')</span><span class="token comment">#             else: print('c[&#123;&#125;]*k[&#123;&#125;]'.format(i+j-27,j),end='')</span><span class="token comment">#     print('==c[&#123;&#125;])'.format(i))</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token punctuation">)</span>s<span class="token punctuation">.</span>add<span class="token punctuation">(</span>f<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">12</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">13</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">14</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">16</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">17</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">18</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">19</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">21</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">22</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">23</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">24</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">+</span>c<span class="token punctuation">[</span><span class="token number">25</span><span class="token punctuation">]</span><span class="token operator">*</span>k<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token operator">==</span>c<span class="token punctuation">[</span><span class="token number">26</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">if</span> s<span class="token punctuation">.</span>check<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">==</span>sat<span class="token punctuation">:</span>    m<span class="token operator">=</span>s<span class="token punctuation">.</span>model<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>m<span class="token punctuation">[</span>f<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>end<span class="token operator">=</span><span class="token string">''</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;_FeedBack_is_so_e@sy_&#125;</span></code></pre><h2 id="DASCTF三月赛-threshold"><a href="#DASCTF三月赛-threshold" class="headerlink" title="[DASCTF三月赛]threshold"></a>[DASCTF三月赛]threshold</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#make.sage</span><span class="token keyword">import</span> randomflag <span class="token operator">=</span> <span class="token builtin">bytearray</span><span class="token punctuation">(</span><span class="token string">"DASCTF&#123;********************************&#125;"</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>length <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>N<span class="token operator">=</span><span class="token number">53</span>p<span class="token operator">=</span><span class="token number">257</span>q<span class="token operator">=</span><span class="token number">28019</span>d<span class="token operator">=</span><span class="token number">18</span>f<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">19</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">16</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>f<span class="token punctuation">)</span>g<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">18</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">17</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>g<span class="token punctuation">)</span>Q<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>P<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>fx<span class="token operator">=</span>Q<span class="token punctuation">(</span>f<span class="token punctuation">)</span>fy<span class="token operator">=</span>P<span class="token punctuation">(</span>f<span class="token punctuation">)</span>gx<span class="token operator">=</span>Q<span class="token punctuation">(</span>g<span class="token punctuation">)</span>Fqx<span class="token operator">=</span>fx<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>Fpy<span class="token operator">=</span>fy<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>y<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>hx<span class="token operator">=</span><span class="token punctuation">(</span>Fqx<span class="token operator">*</span>gx<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>r<span class="token operator">=</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">10</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">22</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">21</span>random<span class="token punctuation">.</span>shuffle<span class="token punctuation">(</span>r<span class="token punctuation">)</span>rx<span class="token operator">=</span>Q<span class="token punctuation">(</span>r<span class="token punctuation">)</span>mx<span class="token operator">=</span>Q<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>ex<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">*</span>rx<span class="token operator">*</span>hx<span class="token operator">+</span>mx<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x<span class="token operator">^</span>N<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>hx<span class="token punctuation">)</span><span class="token comment">#7367*x^52 + 24215*x^51 + 5438*x^50 + 7552*x^49 + 22666*x^48 + 21907*x^47 + 10572*x^46 + 19756*x^45 + 4083*x^44 + 22080*x^43 + 1757*x^42 + 5708*x^41 + 22838*x^40 + 4022*x^39 + 9239*x^38 + 1949*x^37 + 27073*x^36 + 8192*x^35 + 955*x^34 + 4373*x^33 + 17877*x^32 + 25592*x^31 + 13535*x^30 + 185*x^29 + 9471*x^28 + 9793*x^27 + 22637*x^26 + 3293*x^25 + 27047*x^24 + 21985*x^23 + 13584*x^22 + 6809*x^21 + 24770*x^20 + 16964*x^19 + 8866*x^18 + 22102*x^17 + 18006*x^16 + 3198*x^15 + 19024*x^14 + 2777*x^13 + 9252*x^12 + 9684*x^11 + 3604*x^10 + 7840*x^9 + 17573*x^8 + 11382*x^7 + 12726*x^6 + 6811*x^5 + 10104*x^4 + 7485*x^3 + 858*x^2 + 15100*x + 15860</span><span class="token comment">#14443*x^52 + 10616*x^51 + 11177*x^50 + 24769*x^49 + 23510*x^48 + 23059*x^47 + 21848*x^46 + 24145*x^45 + 12420*x^44 + 1976*x^43 + 16947*x^42 + 7373*x^41 + 16708*x^40 + 18435*x^39 + 18561*x^38 + 21557*x^37 + 16115*x^36 + 7873*x^35 + 20005*x^34 + 11543*x^33 + 9488*x^32 + 2865*x^31 + 11797*x^30 + 2961*x^29 + 14944*x^28 + 22631*x^27 + 24061*x^26 + 9792*x^25 + 6791*x^24 + 10423*x^23 + 3534*x^22 + 26233*x^21 + 14223*x^20 + 15555*x^19 + 3381*x^18 + 23641*x^17 + 2697*x^16 + 11303*x^15 + 6030*x^14 + 7355*x^13 + 20693*x^12 + 1768*x^11 + 10059*x^10 + 27822*x^9 + 8150*x^8 + 5458*x^7 + 21270*x^6 + 22651*x^5 + 8381*x^4 + 2819*x^3 + 3987*x^2 + 8610*x + 6022</span></code></pre><p>多项式的格基规约，只需关注每项的系数即可</p><p><img src="https://coinc1dens.github.io/pics/lattice/NTRU_LLL1.png" alt="p"></p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span>p <span class="token operator">=</span> <span class="token number">257</span>q <span class="token operator">=</span> <span class="token number">28019</span>P<span class="token punctuation">.</span><span class="token operator">&lt;</span>y<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>Q<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>hx <span class="token operator">=</span> <span class="token number">14443</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">10616</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">11177</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">24769</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">23510</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">23059</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">21848</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">24145</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">12420</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">1976</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">16947</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">7373</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">16708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">18435</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">18561</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">21557</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">16115</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">7873</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">20005</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">11543</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">9488</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">2865</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">11797</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">2961</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">14944</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">22631</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">24061</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">9792</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">6791</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">10423</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">3534</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">26233</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">14223</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">15555</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">3381</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">23641</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">2697</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">11303</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">6030</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">7355</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">20693</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">1768</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">10059</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">27822</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">8150</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">5458</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">21270</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">22651</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">8381</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">2819</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">3987</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">8610</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">6022</span>ex <span class="token operator">=</span> <span class="token number">7367</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">52</span> <span class="token operator">+</span> <span class="token number">24215</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">51</span> <span class="token operator">+</span> <span class="token number">5438</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">50</span> <span class="token operator">+</span> <span class="token number">7552</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">49</span> <span class="token operator">+</span> <span class="token number">22666</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">48</span> <span class="token operator">+</span> <span class="token number">21907</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">47</span> <span class="token operator">+</span> <span class="token number">10572</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">46</span> <span class="token operator">+</span> <span class="token number">19756</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">45</span> <span class="token operator">+</span> <span class="token number">4083</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">44</span> <span class="token operator">+</span> <span class="token number">22080</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">43</span> <span class="token operator">+</span> <span class="token number">1757</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">42</span> <span class="token operator">+</span> <span class="token number">5708</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">41</span> <span class="token operator">+</span> <span class="token number">22838</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">40</span> <span class="token operator">+</span> <span class="token number">4022</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">39</span> <span class="token operator">+</span> <span class="token number">9239</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">38</span> <span class="token operator">+</span> <span class="token number">1949</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">37</span> <span class="token operator">+</span> <span class="token number">27073</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">36</span> <span class="token operator">+</span> <span class="token number">8192</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">35</span> <span class="token operator">+</span> <span class="token number">955</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">34</span> <span class="token operator">+</span> <span class="token number">4373</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">33</span> <span class="token operator">+</span> <span class="token number">17877</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">32</span> <span class="token operator">+</span> <span class="token number">25592</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">31</span> <span class="token operator">+</span> <span class="token number">13535</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">30</span> <span class="token operator">+</span> <span class="token number">185</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">29</span> <span class="token operator">+</span> <span class="token number">9471</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">28</span> <span class="token operator">+</span> <span class="token number">9793</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">27</span> <span class="token operator">+</span> <span class="token number">22637</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">26</span> <span class="token operator">+</span> <span class="token number">3293</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">25</span> <span class="token operator">+</span> <span class="token number">27047</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">24</span> <span class="token operator">+</span> <span class="token number">21985</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">23</span> <span class="token operator">+</span> <span class="token number">13584</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">22</span> <span class="token operator">+</span> <span class="token number">6809</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">21</span> <span class="token operator">+</span> <span class="token number">24770</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">20</span> <span class="token operator">+</span> <span class="token number">16964</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">19</span> <span class="token operator">+</span> <span class="token number">8866</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">18</span> <span class="token operator">+</span> <span class="token number">22102</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">17</span> <span class="token operator">+</span> <span class="token number">18006</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">16</span> <span class="token operator">+</span> <span class="token number">3198</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">15</span> <span class="token operator">+</span> <span class="token number">19024</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">14</span> <span class="token operator">+</span> <span class="token number">2777</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">13</span> <span class="token operator">+</span> <span class="token number">9252</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">12</span> <span class="token operator">+</span> <span class="token number">9684</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">11</span> <span class="token operator">+</span> <span class="token number">3604</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">10</span> <span class="token operator">+</span> <span class="token number">7840</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span> <span class="token operator">+</span> <span class="token number">17573</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span> <span class="token operator">+</span> <span class="token number">11382</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span> <span class="token operator">+</span> <span class="token number">12726</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span> <span class="token operator">+</span> <span class="token number">6811</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span> <span class="token operator">+</span> <span class="token number">10104</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span> <span class="token operator">+</span> <span class="token number">7485</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> <span class="token number">858</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span> <span class="token number">15100</span><span class="token operator">*</span>x <span class="token operator">+</span> <span class="token number">15860</span>temp <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    this <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">53</span> <span class="token operator">-</span> i <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        this<span class="token punctuation">.</span>append<span class="token punctuation">(</span>hx<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token operator">-</span>i <span class="token operator">+</span> j<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">53</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>this<span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">53</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    this <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token number">53</span> <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> i <span class="token operator">+</span> <span class="token punctuation">[</span><span class="token number">28019</span><span class="token punctuation">]</span> <span class="token operator">+</span>  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token number">52</span> <span class="token operator">-</span> i<span class="token punctuation">)</span>    temp<span class="token punctuation">.</span>append<span class="token punctuation">(</span>this<span class="token punctuation">)</span>M <span class="token operator">=</span> Matrix<span class="token punctuation">(</span>ZZ <span class="token punctuation">,</span>temp<span class="token punctuation">)</span>B <span class="token operator">=</span> M<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>_f <span class="token operator">=</span> B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">53</span><span class="token punctuation">]</span>_g <span class="token operator">=</span> B<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">53</span><span class="token punctuation">:</span><span class="token punctuation">]</span>fqx <span class="token operator">=</span> Q<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>_f<span class="token punctuation">)</span><span class="token punctuation">)</span>gqx <span class="token operator">=</span> Q<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>_g<span class="token punctuation">)</span><span class="token punctuation">)</span>fpy <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token builtin">list</span><span class="token punctuation">(</span>_f<span class="token punctuation">)</span><span class="token punctuation">)</span>Fpy<span class="token operator">=</span>fpy<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>y<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>Fqx<span class="token operator">=</span>fqx<span class="token punctuation">.</span>inverse_mod<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>ax <span class="token operator">=</span> <span class="token punctuation">(</span>fqx <span class="token operator">*</span> ex<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>x<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> ax<span class="token punctuation">:</span>    a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>Mod<span class="token punctuation">(</span>i<span class="token punctuation">,</span> q<span class="token punctuation">)</span><span class="token punctuation">.</span>lift_centered<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>ay <span class="token operator">=</span> P<span class="token punctuation">(</span>a<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Fpy <span class="token operator">*</span> ay<span class="token punctuation">)</span><span class="token punctuation">.</span>mod<span class="token punctuation">(</span>y<span class="token operator">^</span><span class="token number">53</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment"># DASCTF&#123;9bba98e8024da44a3250acbc06bebc7b&#125;</span></code></pre><h2 id="V-amp-N2020公开赛-CRT"><a href="#V-amp-N2020公开赛-CRT" class="headerlink" title="[V&amp;N2020公开赛]CRT"></a>[V&amp;N2020公开赛]CRT</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib<span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>ms <span class="token operator">=</span> <span class="token punctuation">[</span>getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">]</span>p <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span>y<span class="token punctuation">:</span> x<span class="token operator">*</span>y<span class="token punctuation">,</span> ms<span class="token punctuation">)</span>x <span class="token operator">=</span> getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span>cs <span class="token operator">=</span> <span class="token punctuation">[</span>x <span class="token operator">%</span> m  <span class="token keyword">for</span> m <span class="token keyword">in</span> ms<span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">"flag&#123;"</span> <span class="token operator">+</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">"&#125;"</span><span class="token comment"># assert("4b93deeb" in flag)</span><span class="token comment"># ms = [284461942441737992421992210219060544764, 218436209063777179204189567410606431578, 288673438109933649911276214358963643204, 239232622368515797881077917549177081575, 206264514127207567149705234795160750411, 338915547568169045185589241329271490503, 246545359356590592172327146579550739141, 219686182542160835171493232381209438048]</span><span class="token comment"># cs = [273520784183505348818648859874365852523, 128223029008039086716133583343107528289, 5111091025406771271167772696866083419, 33462335595116820423587878784664448439, 145377705960376589843356778052388633917, 128158421725856807614557926615949143594, 230664008267846531848877293149791626711, 94549019966480959688919233343793910003]</span></code></pre><p>中国剩余定理模不互素，需要合并不互素的两个方程。通过不断合并方程最终达到一个满足方程组的最小解。求一个满足条件的解,所以需要爆破。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#coding=utf-8</span><span class="token keyword">from</span> hashlib <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">merge</span><span class="token punctuation">(</span>a1<span class="token punctuation">,</span>n1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">:</span>    d <span class="token operator">=</span> gcd<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span>    c <span class="token operator">=</span> a2<span class="token operator">-</span>a1    <span class="token keyword">if</span> c<span class="token operator">%</span>d<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token number">0</span>    c <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token operator">%</span>n2<span class="token operator">+</span>n2<span class="token punctuation">)</span><span class="token operator">%</span>n2    c <span class="token operator">=</span> c<span class="token operator">//</span>d    n1 <span class="token operator">=</span> n1<span class="token operator">//</span>d    n2 <span class="token operator">=</span> n2<span class="token operator">//</span>d    c <span class="token operator">*=</span> invert<span class="token punctuation">(</span>n1<span class="token punctuation">,</span>n2<span class="token punctuation">)</span>    c <span class="token operator">%=</span> n2    c <span class="token operator">*=</span> n1<span class="token operator">*</span>d    c <span class="token operator">+=</span> a1    <span class="token keyword">global</span> n3    <span class="token keyword">global</span> a3    n3 <span class="token operator">=</span> n1<span class="token operator">*</span>n2<span class="token operator">*</span>d    a3 <span class="token operator">=</span> <span class="token punctuation">(</span>c<span class="token operator">%</span>n3<span class="token operator">+</span>n3<span class="token punctuation">)</span><span class="token operator">%</span>n3    <span class="token keyword">return</span> <span class="token number">1</span><span class="token keyword">def</span> <span class="token function">exCRT</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    a1<span class="token operator">=</span>a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    n1<span class="token operator">=</span>n<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    le<span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>le<span class="token punctuation">)</span><span class="token punctuation">:</span>        a2 <span class="token operator">=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        n2<span class="token operator">=</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> merge<span class="token punctuation">(</span>a1<span class="token punctuation">,</span>n1<span class="token punctuation">,</span>a2<span class="token punctuation">,</span>n2<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        a1 <span class="token operator">=</span> a3        n1 <span class="token operator">=</span> n3    <span class="token keyword">global</span> mod    mod<span class="token operator">=</span>n1    <span class="token keyword">return</span> <span class="token punctuation">(</span>a1<span class="token operator">%</span>n1<span class="token operator">+</span>n1<span class="token punctuation">)</span><span class="token operator">%</span>n1ms <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">284461942441737992421992210219060544764</span><span class="token punctuation">,</span> <span class="token number">218436209063777179204189567410606431578</span><span class="token punctuation">,</span> <span class="token number">288673438109933649911276214358963643204</span><span class="token punctuation">,</span> <span class="token number">239232622368515797881077917549177081575</span><span class="token punctuation">,</span> <span class="token number">206264514127207567149705234795160750411</span><span class="token punctuation">,</span> <span class="token number">338915547568169045185589241329271490503</span><span class="token punctuation">,</span> <span class="token number">246545359356590592172327146579550739141</span><span class="token punctuation">,</span> <span class="token number">219686182542160835171493232381209438048</span><span class="token punctuation">]</span>cs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">273520784183505348818648859874365852523</span><span class="token punctuation">,</span> <span class="token number">128223029008039086716133583343107528289</span><span class="token punctuation">,</span> <span class="token number">5111091025406771271167772696866083419</span><span class="token punctuation">,</span> <span class="token number">33462335595116820423587878784664448439</span><span class="token punctuation">,</span> <span class="token number">145377705960376589843356778052388633917</span><span class="token punctuation">,</span> <span class="token number">128158421725856807614557926615949143594</span><span class="token punctuation">,</span> <span class="token number">230664008267846531848877293149791626711</span><span class="token punctuation">,</span> <span class="token number">94549019966480959688919233343793910003</span><span class="token punctuation">]</span>x<span class="token operator">=</span>exCRT<span class="token punctuation">(</span>cs<span class="token punctuation">,</span>ms<span class="token punctuation">)</span>flag<span class="token operator">=</span>sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token string">"4b93deeb"</span> <span class="token keyword">not</span> <span class="token keyword">in</span> flag<span class="token punctuation">:</span>    x<span class="token operator">=</span>x<span class="token operator">+</span>mod    flag <span class="token operator">=</span> sha256<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span></code></pre><h2 id="AFCTF2018-MyOwnCBC"><a href="#AFCTF2018-MyOwnCBC" class="headerlink" title="[AFCTF2018]MyOwnCBC"></a>[AFCTF2018]MyOwnCBC</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#!/usr/bin/python2.7</span><span class="token comment"># -*- coding: utf-8 -*-</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Cipher <span class="token keyword">import</span> AES<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Random <span class="token keyword">import</span> random<span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> long_to_bytes<span class="token keyword">def</span> <span class="token function">MyOwnCBC</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> plain<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">32</span><span class="token punctuation">:</span><span class="token keyword">return</span> <span class="token string">"error!"</span>cipher_txt <span class="token operator">=</span> <span class="token string">b""</span>cipher_arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>plain <span class="token operator">=</span> <span class="token punctuation">[</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">print</span> plaincipher_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plain<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cipher_txt <span class="token operator">+=</span> cipher_arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>cipher_arr<span class="token punctuation">[</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>cipher_arr<span class="token punctuation">.</span>append<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>cipher_txt <span class="token operator">+=</span> cipher_arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token keyword">return</span> cipher_txtkey <span class="token operator">=</span> random<span class="token punctuation">.</span>getrandbits<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>key <span class="token operator">=</span> long_to_bytes<span class="token punctuation">(</span>key<span class="token punctuation">)</span>s <span class="token operator">=</span> <span class="token string">""</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>s <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag_cipher"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>MyOwnCBC<span class="token punctuation">(</span>key<span class="token punctuation">,</span> s<span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>上一组的密文作为下一组的key</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"flag_cipher"</span><span class="token punctuation">,</span><span class="token string">"rb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>plain <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>key <span class="token operator">=</span> plain<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">32</span><span class="token punctuation">]</span>plain <span class="token operator">=</span> <span class="token punctuation">[</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">:</span>i<span class="token operator">+</span><span class="token number">32</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">]</span>flag <span class="token operator">=</span> <span class="token string">b''</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>plain<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>cipher <span class="token operator">=</span> AES<span class="token punctuation">.</span>new<span class="token punctuation">(</span>key<span class="token punctuation">,</span> AES<span class="token punctuation">.</span>MODE_ECB<span class="token punctuation">)</span>flag <span class="token operator">+=</span> cipher<span class="token punctuation">.</span>decrypt<span class="token punctuation">(</span>plain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>key <span class="token operator">=</span> plain<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># b"mode of operation is an algorithm that uses a block cipher to provide an information service such as confidentiality or authenticity. A block cipher by itself is only suitable for the secure cryptographic transformation (encryption or decryption) of one fixed-length group of bits called a block. A mode of operation describes how to repeatedly apply a cipher's single-block operation to securely transform amounts of data larger than a block.\n\nMost modes require a unique binary sequence, often called an initialization vector (IV), for each encryption operation. The IV has to be non-repeating and, for some modes, random as well. The initialization vector is used to ensure distinct ciphertexts are produced even when the same plaintext is encrypted multiple times independently with the same key. Block ciphers have one or more block size(s), but during transformation the block size is always fixed. Block cipher modes operate on whole blocks and require that the last part of the data be padded to a full block if it is smaller than the current block size. There are, however, modes that do not require padding because they effectively use a block cipher as a stream cipher.\n\nHistorically, encryption modes have been studied extensively in regard to their error propagation properties under various scenarios of data modification. Later development regarded integrity protection as an entirely separate cryptographic goal. Some modern modes of operation combine confidentiality and authenticity in an efficient way, and are known as authenticated encryption modes.\n\nAh you found it~ afctf&#123;Don't_be_fooled_by_yourself&#125;~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n"</span></code></pre><h2 id="Polynomial-Ring"><a href="#Polynomial-Ring" class="headerlink" title="Polynomial Ring"></a>Polynomial Ring</h2><h3 id="多项式中的欧拉函数"><a href="#多项式中的欧拉函数" class="headerlink" title="多项式中的欧拉函数"></a>多项式中的欧拉函数</h3><blockquote><p>对于多项式P(y)来讲，欧拉函数phi(P(y))表示所有不高于P(y)幂级的环内所有多项式中，与P(y)无除1以外的公因式的其他多项式的个数。</p><p>$ \phi = (p^{P(x).degree()} - 1)*(p^{Q(x).degree()} - 1) $</p></blockquote><h3 id="some-api-in-sagemath"><a href="#some-api-in-sagemath" class="headerlink" title="some api in sagemath"></a>some api in sagemath</h3><ol><li><p>R.<x> = PolynomialRing(GF(p))  系数都小于p的多项式环</p></li><li><p>out = R.random_element(degree=30)   随机，幂级为30</p></li><li><p>out.is_irreducible()  不可约的</p></li><li><p>R.quotient(N)  多项式除法</p></li></ol><h2 id="Pollard’s-p-1-Factorization-Algorithm"><a href="#Pollard’s-p-1-Factorization-Algorithm" class="headerlink" title="Pollard’s p-1 Factorization Algorithm"></a>Pollard’s p-1 Factorization Algorithm</h2><h3 id="principle"><a href="#principle" class="headerlink" title="principle"></a>principle</h3><p>$ L = i(p-1) = j(q-1)+k $</p><p>$ a^{L} = a^{i(p-1)} = (a^{p-1})^{i} \equiv 1^{i} \equiv 1 (\bmod p) $</p><p>$ a^{L} = a^{j(q-1)+k} = a^{k}(a^{q-1})^{j} \equiv a^{k} \cdot 1^{j} \equiv a^{k}(\bmod q) $</p><p>$ p = gcd(a^{L}-1, N) $</p><p>Pollard发现如果p-1由一些小素数相乘得到，那么</p><p>$ p = gcd(a^{n!}-1, N) $</p><p>其中n的值不太大，可以通过爆破</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token number">2</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token builtin">sum</span> <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">,</span>i<span class="token punctuation">,</span>n<span class="token punctuation">)</span>    <span class="token comment"># print(sum)</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>gcd<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token operator">!=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>gcd<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">break</span></code></pre><h3 id="Smooth-Number"><a href="#Smooth-Number" class="headerlink" title="Smooth Number"></a>Smooth Number</h3><p>一个数的所有素因子都小于等于B，叫作B-smooth number</p><h2 id="Short-Pad-Attack-amp-Related-Message-Attack"><a href="#Short-Pad-Attack-amp-Related-Message-Attack" class="headerlink" title="Short Pad Attack &amp; Related Message Attack"></a>Short Pad Attack &amp; Related Message Attack</h2><p>padding长度小于等于$ \frac{n.nbits()}{e^{2}} $</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">def</span> <span class="token function">short_pad_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span>    PRxy<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>xn<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    PRZZ<span class="token punctuation">.</span><span class="token operator">&lt;</span>xz<span class="token punctuation">,</span>yz<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>y<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    q1 <span class="token operator">=</span> g1<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    q2 <span class="token operator">=</span> g2<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRZZ<span class="token punctuation">)</span>    h <span class="token operator">=</span> q2<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>q1<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>PRx<span class="token punctuation">)</span><span class="token punctuation">.</span>subs<span class="token punctuation">(</span>y<span class="token operator">=</span>xn<span class="token punctuation">)</span>    h <span class="token operator">=</span> h<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    kbits <span class="token operator">=</span> n<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>e<span class="token operator">*</span>e<span class="token punctuation">)</span>    diff <span class="token operator">=</span> h<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span>kbits<span class="token punctuation">,</span> beta<span class="token operator">=</span><span class="token number">0.4</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># find root &lt; 2^kbits with factor >= n^0.4</span>    <span class="token keyword">return</span> diff<span class="token keyword">def</span> <span class="token function">related_message_attack</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment">#small e</span>    PRx<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>    g1 <span class="token operator">=</span> x<span class="token operator">^</span>e <span class="token operator">-</span> c1    g2 <span class="token operator">=</span> <span class="token punctuation">(</span>x<span class="token operator">+</span>diff<span class="token punctuation">)</span><span class="token operator">^</span>e <span class="token operator">-</span> c2    <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> g2<span class="token punctuation">:</span>            g1<span class="token punctuation">,</span> g2 <span class="token operator">=</span> g2<span class="token punctuation">,</span> g1 <span class="token operator">%</span> g2        <span class="token keyword">return</span> g1<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token operator">-</span>gcd<span class="token punctuation">(</span>g1<span class="token punctuation">,</span> g2<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    n <span class="token operator">=</span>     e <span class="token operator">=</span>     c1 <span class="token operator">=</span>    c2 <span class="token operator">=</span>     diff <span class="token operator">=</span> short_pad_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"difference of two messages is %d"</span> <span class="token operator">%</span> diff<span class="token punctuation">)</span>    m1 <span class="token operator">=</span> related_message_attack<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> diff<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m1:"</span><span class="token punctuation">,</span> m1<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"m2:"</span><span class="token punctuation">,</span> m1 <span class="token operator">+</span> diff<span class="token punctuation">)</span></code></pre><h2 id="AES-CBC"><a href="#AES-CBC" class="headerlink" title="AES.CBC"></a>AES.CBC</h2><h3 id="bit翻转"><a href="#bit翻转" class="headerlink" title="bit翻转"></a>bit翻转</h3><p>admin=0 -&gt; admin=1</p><h3 id="选择明文攻击"><a href="#选择明文攻击" class="headerlink" title="选择明文攻击"></a>选择明文攻击</h3><p>$ iv = M_{1} \oplus M_{2} \oplus C $</p><h3 id="padding-oracle"><a href="#padding-oracle" class="headerlink" title="padding oracle"></a>padding oracle</h3><p>PKCS5填充、有交互、key和iv都未知、利用服务器对padding检查有不同回显、末位逐位爆破</p><h2 id="NepCTF2021-ChildRSA"><a href="#NepCTF2021-ChildRSA" class="headerlink" title="[NepCTF2021]ChildRSA"></a>[NepCTF2021]ChildRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment">#childrsa</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> iroot<span class="token keyword">from</span> os <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag1<span class="token punctuation">,</span>flag2<span class="token punctuation">,</span>padding1<span class="token punctuation">,</span>padding2<span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token operator">=</span><span class="token number">20</span><span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token operator">></span><span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token keyword">assert</span> <span class="token builtin">len</span><span class="token punctuation">(</span>flag2<span class="token punctuation">)</span><span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>padding2<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">init1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m<span class="token operator">=</span><span class="token punctuation">(</span>padding1<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span><span class="token operator">+</span>bytes_to_long<span class="token punctuation">(</span>flag1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span>    r1<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">)</span>    r2<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">170</span><span class="token punctuation">)</span>    p<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    q<span class="token operator">=</span>getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    N<span class="token operator">=</span>p<span class="token operator">*</span>q    <span class="token keyword">return</span> m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N    <span class="token keyword">def</span> <span class="token function">enc1</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span>    c1<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token operator">+</span>r1<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span>    c2<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token operator">+</span>r2<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span>N<span class="token punctuation">)</span>    <span class="token keyword">return</span> c1<span class="token punctuation">,</span>c2<span class="token keyword">def</span> <span class="token function">init2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    prefix <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">1000</span>    r3 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>prefix<span class="token operator">+</span>flag2<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span>    r4 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>prefix<span class="token operator">+</span>padding2<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span>    <span class="token keyword">return</span> r3<span class="token punctuation">,</span>r4<span class="token keyword">def</span> <span class="token function">enc2</span><span class="token punctuation">(</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span><span class="token punctuation">:</span>    c3 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>r3<span class="token operator">*</span>r4<span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> c3<span class="token punctuation">(</span>m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N<span class="token punctuation">)</span> <span class="token operator">=</span> init1<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token operator">=</span>enc1<span class="token punctuation">(</span>m<span class="token punctuation">,</span>r1<span class="token punctuation">,</span>r2<span class="token punctuation">,</span>N<span class="token punctuation">)</span><span class="token punctuation">(</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span> <span class="token operator">=</span> init2<span class="token punctuation">(</span><span class="token punctuation">)</span>c3 <span class="token operator">=</span> enc2<span class="token punctuation">(</span>r3<span class="token punctuation">,</span>r4<span class="token punctuation">)</span><span class="token keyword">print</span> N<span class="token keyword">print</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span></code></pre><h2 id="Coppersmith’s-Random-Padding-Attack"><a href="#Coppersmith’s-Random-Padding-Attack" class="headerlink" title="Coppersmith’s Random Padding Attack"></a>Coppersmith’s Random Padding Attack</h2><p>$   c_1 \equiv (m+r_1)^{3}\mod{N}$</p><p>$  c_2\equiv(m+r_2)^{3}\mod{N} $</p><p>可以看成是<br>$$<br>c_1 \equiv M^{3}\mod{N}\<br>$$</p><p>$$<br>c_2\equiv(M+r)^{3}\mod{N}<br>$$</p><p>然后化简两个公式，将M抵消掉，得到只有r的⼀元⽅程<br>$$<br>r^9+(3c_1-3c_2)r^6+(3c_1^2+21c_1c_2+3c_2^2)r^3+(c_1-c_2)^3=0\mod{N}<br>$$<br>因为r1、r2最多170位，所以r也是最多170位。此时利⽤coppersmith可以得到r的值<br>$$<br>170bits \approx N^{\frac{1}{12}}<br>$$</p><p>$$<br>epsilon =\frac{1}{9} - \frac{1}{12} = \frac{1}{36}<br>$$</p><p>求得r之后⽤Franklin-Reiter Related Message Attack 得到M。由于M=padding 1|| flag1 || r1 ,因此直接转 </p><p>化成字节可以得到flag1。 </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#from gmpy2 import iroot </span>N<span class="token operator">=</span>28158376030783126462160089589823483713527137233213875572448002306591587078780130580064960928000260046723470757493523772992812185236491055072491361217940285809743091958889318723862394925161624189393204199333582056921761101170728126732633570787046368451452592297474997001720894985956809324776433753817913573764903118962295218320504483249302086522864189503976194142497460351928118211969015560337732569710308337625261805046420223294551248496856153012197979278463862836023897894535718512636307578414641240750045867326554984308461337470720249462693325847418638485693227856545631806676082705971847561028566848739943309350523L<span class="token punctuation">(</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">,</span>c3<span class="token punctuation">)</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">24224099638194324112593871012681573152728137743988130174034194747749499893806613392393262358304278286207848016575593184397104060179978140321847376670647434030870270659753891424180300938412183930402939964298221231907700551385713992208907288670440128651459855106370601996167821568454498946189809679805856760077602954185656580735443254919133313869021875507715983005654259694427753140006431537962760663821770319611657591446033183695065991242937214964884018439712856483970516075937859659014842147053482562615064262033128353761384111673580976781273192034059752430319614321781718852031021334707002690826600780316128823557078</span><span class="token punctuation">,</span> <span class="token number">9346750271098236574311526832166143274981900619073634627239673835573015044474781208925371397721856252589055337535370071073022935304585017378639576719997933317896392172224331035651304165371533650982779424261861522620182573561472976299952543222698749313342053690793739259992577314602927389157124886863152775368006245054707996451092743563826965858367896714784027494674462238582099575028052030487857739015972028019673964986909534784865442448462755269733906210352597618064622408012998910837512387765999752231309660534222112023575816948992389787796776523706795068869288928522584197893586912900864981983132389327089147168146</span><span class="token punctuation">,</span><span class="token number">12107764658433896580107280538635135643387858852976620070691115333175114455948516277086646541412419646593297889201461016204186139568117475108121483620886979081055400119823555863287145558918960315604392538385365775518531415962595383790406519796107060397002742243430892069572422621367817969753308155681207288179722229190134116638193477979912363191546805420859415583321036973918671704414861068461071208456971522273733442192940846444300605718874968169235475237419035100359757819694303844991958162933063957514071374815976765116772095057060790532835820921941088145846413070125370893266694322242100018189171839236880288990785924731992240524566660760922463600094468267262479875177563252492042982465535450638009272498423063736302466479967160885598220013264243699170187377424360056887609494799576319202957855035769847474106037568257493594313444725436907261296589305657506580644724070073124760436092785070723978602029411520504130916009400359604526646351156436915392008166680858644751752849852559564642823536994015310787265345702214921009048446529410934651620740678596168179297695317825626377519087362620254075060283392495964100088104432955208048486368967069833933648053224437409662903374041626724752539021740964387214123704727358129789524527156031473687977024441000979679744414175754810038626527843431424394300602082336759566303619981176757419266691542040519548871088083534246850686949005736818866455421187638056233493672106359797782169712261131423897346468178309589638059793798304934967642857700497827862408132279349488890162419922934863936257606996005393045700768753829407234139813940831919160314036065245565171960402080772504580960750282631405024166104777299328579173845225098623353952827436661379857324363184646746357839176347923656698542515335105484998791972994614628816209171376677660216724863205662719962318372864</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">cop_solve</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span>     PR<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">>=</span>PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">)</span>     f <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">9</span><span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token operator">*</span>c1<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">21</span><span class="token operator">*</span>c1<span class="token operator">*</span>c2<span class="token operator">+</span><span class="token number">3</span><span class="token operator">*</span>c2<span class="token operator">^</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span><span class="token punctuation">(</span>c1<span class="token operator">-</span>c2<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span>     x0<span class="token operator">=</span>f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">170</span><span class="token punctuation">,</span>beta<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">,</span>epsilon <span class="token operator">=</span> <span class="token number">1</span><span class="token operator">/</span><span class="token number">36</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>x0<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">:</span>         <span class="token keyword">print</span><span class="token punctuation">(</span>x0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>     <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"error"</span><span class="token punctuation">)</span>     <span class="token keyword">return</span> x0<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">def</span> <span class="token function">gcd</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">return</span> a<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">if</span> b <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">else</span> gcd<span class="token punctuation">(</span>b<span class="token punctuation">,</span> a <span class="token operator">%</span> b<span class="token punctuation">)</span> <span class="token keyword">def</span> <span class="token function">franklin_solve</span><span class="token punctuation">(</span>N<span class="token punctuation">,</span>r<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span><span class="token punctuation">:</span>     R<span class="token punctuation">.</span><span class="token operator">&lt;</span>X<span class="token operator">></span> <span class="token operator">=</span> Zmod<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">]</span>     f1 <span class="token operator">=</span> X<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">-</span> c1     f2 <span class="token operator">=</span> <span class="token punctuation">(</span>X <span class="token operator">+</span> r<span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span> <span class="token operator">-</span> c2     <span class="token keyword">return</span> long_to_bytes<span class="token punctuation">(</span><span class="token operator">-</span>gcd<span class="token punctuation">(</span>f1<span class="token punctuation">,</span> f2<span class="token punctuation">)</span><span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> R <span class="token operator">=</span> cop_solve<span class="token punctuation">(</span>N<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span> M <span class="token operator">=</span> franklin_solve<span class="token punctuation">(</span>N<span class="token punctuation">,</span>R<span class="token punctuation">,</span>c1<span class="token punctuation">,</span>c2<span class="token punctuation">)</span> <span class="token keyword">print</span><span class="token punctuation">(</span>M<span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#flag1 </span><span class="token comment">#28158376030783126462160089589823483713527137233213875572448002306591587078780130580064960928000260046723470757493523772992812185236491055072491361217940285809743091958889318723862394925161624189393204199333582056921761101170728126732633570787046368451452592297474997001720894985956809324776433753817913573764903118962295218320504483249302086522864189503976194142497460351928118211969015560337732569710308337625261805046420223294551248496856153012197979278463862836023897894535718512636307578414641240750045867326554984308461337470720249462693325847418638485693227856340154690304590078577734025351629922056279918570359</span><span class="token comment">#b'\x00\x00\x00\x00\x00Nep&#123;Nep_n3p_ba4_bad_\x00\x00\x00\x03\t'</span></code></pre><p>flag2直接解⽅程</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> <span class="token comment">#from gmpy2 import iroot </span>c3 <span class="token operator">=</span> <span class="token number">12107764658433896580107280538635135643387858852976620070691115333175114455948516277086646541412419646593297889201461016204186139568117475108121483620886979081055400119823555863287145558918960315604392538385365775518531415962595383790406519796107060397002742243430892069572422621367817969753308155681207288179722229190134116638193477979912363191546805420859415583321036973918671704414861068461071208456971522273733442192940846444300605718874968169235475237419035100359757819694303844991958162933063957514071374815976765116772095057060790532835820921941088145846413070125370893266694322242100018189171839236880288990785924731992240524566660760922463600094468267262479875177563252492042982465535450638009272498423063736302466479967160885598220013264243699170187377424360056887609494799576319202957855035769847474106037568257493594313444725436907261296589305657506580644724070073124760436092785070723978602029411520504130916009400359604526646351156436915392008166680858644751752849852559564642823536994015310787265345702214921009048446529410934651620740678596168179297695317825626377519087362620254075060283392495964100088104432955208048486368967069833933648053224437409662903374041626724752539021740964387214123704727358129789524527156031473687977024441000979679744414175754810038626527843431424394300602082336759566303619981176757419266691542040519548871088083534246850686949005736818866455421187638056233493672106359797782169712261131423897346468178309589638059793798304934967642857700497827862408132279349488890162419922934863936257606996005393045700768753829407234139813940831919160314036065245565171960402080772504580960750282631405024166104777299328579173845225098623353952827436661379857324363184646746357839176347923656698542515335105484998791972994614628816209171376677660216724863205662719962318372864</span><span class="token keyword">def</span> <span class="token function">coron</span><span class="token punctuation">(</span>pol<span class="token punctuation">,</span> X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">if</span> pol<span class="token punctuation">.</span>nvariables<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">2</span><span class="token punctuation">:</span>         <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"pol is not bivariate"</span><span class="token punctuation">)</span>     P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>     pol <span class="token operator">=</span> pol<span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span>     xoffset <span class="token operator">=</span> <span class="token number">0</span>     <span class="token keyword">while</span> pol<span class="token punctuation">(</span>xoffset<span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>         xoffset <span class="token operator">+=</span> <span class="token number">1</span>     pol <span class="token operator">=</span> pol<span class="token punctuation">(</span>x<span class="token operator">+</span>xoffset<span class="token punctuation">,</span>y<span class="token punctuation">)</span>     <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>pol<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> X<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>         X <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>X<span class="token punctuation">,</span> proof<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>     <span class="token keyword">while</span> gcd<span class="token punctuation">(</span>pol<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">1</span><span class="token punctuation">:</span>         Y <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>Y<span class="token punctuation">,</span> proof<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>     pol <span class="token operator">=</span> P<span class="token punctuation">(</span>pol<span class="token operator">/</span>gcd<span class="token punctuation">(</span>pol<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># seems to be helpful </span>    p00 <span class="token operator">=</span> pol<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span>     delta <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span>pol<span class="token punctuation">.</span>degree<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">,</span>pol<span class="token punctuation">.</span>degree<span class="token punctuation">(</span>y<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment"># maximum degree of any variable </span>    W <span class="token operator">=</span> <span class="token builtin">max</span><span class="token punctuation">(</span><span class="token builtin">abs</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> pol<span class="token punctuation">(</span>x<span class="token operator">*</span>X<span class="token punctuation">,</span>y<span class="token operator">*</span>Y<span class="token punctuation">)</span><span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     u <span class="token operator">=</span> W <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>W<span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token builtin">abs</span><span class="token punctuation">(</span>p00<span class="token punctuation">)</span><span class="token punctuation">)</span>     N <span class="token operator">=</span> u<span class="token operator">*</span><span class="token punctuation">(</span>X<span class="token operator">*</span>Y<span class="token punctuation">)</span><span class="token operator">^</span>k <span class="token comment"># modulus for polynomials </span>    p00inv <span class="token operator">=</span> inverse_mod<span class="token punctuation">(</span>p00<span class="token punctuation">,</span>N<span class="token punctuation">)</span>     polq <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">(</span>i<span class="token operator">*</span>p00inv <span class="token operator">%</span> N<span class="token punctuation">)</span><span class="token operator">*</span>j <span class="token keyword">for</span> i<span class="token punctuation">,</span>j <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>pol<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> pol<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     polynomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>delta<span class="token operator">+</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>delta<span class="token operator">+</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> i <span class="token operator">&lt;=</span> k <span class="token keyword">and</span> <span class="token number">0</span> <span class="token operator">&lt;=</span> j <span class="token operator">&lt;=</span> k<span class="token punctuation">:</span>                 polynomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>polq <span class="token operator">*</span> x<span class="token operator">^</span>i <span class="token operator">*</span> y<span class="token operator">^</span>j <span class="token operator">*</span> X<span class="token operator">^</span><span class="token punctuation">(</span>k<span class="token operator">-</span>i<span class="token punctuation">)</span> <span class="token operator">*</span> Y<span class="token operator">^</span><span class="token punctuation">(</span>k<span class="token operator">-</span>j<span class="token punctuation">)</span><span class="token punctuation">)</span>             <span class="token keyword">else</span><span class="token punctuation">:</span>                polynomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>x<span class="token operator">^</span>i <span class="token operator">*</span> y<span class="token operator">^</span>j <span class="token operator">*</span> N<span class="token punctuation">)</span>     monomials <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token keyword">for</span> i <span class="token keyword">in</span> polynomials<span class="token punctuation">:</span>         <span class="token keyword">for</span> j <span class="token keyword">in</span> i<span class="token punctuation">.</span>monomials<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> j <span class="token keyword">not</span> <span class="token keyword">in</span> monomials<span class="token punctuation">:</span>                 monomials<span class="token punctuation">.</span>append<span class="token punctuation">(</span>j<span class="token punctuation">)</span>     monomials<span class="token punctuation">.</span>sort<span class="token punctuation">(</span><span class="token punctuation">)</span>     L <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>             L<span class="token punctuation">[</span>i<span class="token punctuation">,</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> polynomials<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">(</span>X<span class="token operator">*</span>x<span class="token punctuation">,</span>Y<span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>monomial_coefficient<span class="token punctuation">(</span>monomials<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span>     L <span class="token operator">=</span> matrix<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span><span class="token builtin">sorted</span><span class="token punctuation">(</span>L<span class="token punctuation">,</span>reverse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> debug<span class="token punctuation">:</span>         <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bitlengths of matrix elements (before reduction):"</span><span class="token punctuation">)</span>         <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>apply_map<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     L <span class="token operator">=</span> L<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>     <span class="token keyword">if</span> debug<span class="token punctuation">:</span>         <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Bitlengths of matrix elements (after reduction):"</span><span class="token punctuation">)</span>         <span class="token keyword">print</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>apply_map<span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">:</span> x<span class="token punctuation">.</span>nbits<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     roots <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>     <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>L<span class="token punctuation">.</span>nrows<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token keyword">if</span> debug<span class="token punctuation">:</span>             <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Trying row &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>         pol2 <span class="token operator">=</span> P<span class="token punctuation">(</span><span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token builtin">map</span><span class="token punctuation">(</span>mul<span class="token punctuation">,</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>L<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span>monomials<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span>x<span class="token operator">/</span>X<span class="token punctuation">,</span>y<span class="token operator">/</span>Y<span class="token punctuation">)</span><span class="token punctuation">)</span>         r <span class="token operator">=</span> pol<span class="token punctuation">.</span>resultant<span class="token punctuation">(</span>pol2<span class="token punctuation">,</span> y<span class="token punctuation">)</span>         <span class="token keyword">if</span> r<span class="token punctuation">.</span>is_constant<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># not independent </span>            <span class="token keyword">continue</span>     <span class="token keyword">for</span> x0<span class="token punctuation">,</span> _ <span class="token keyword">in</span> r<span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>         <span class="token keyword">if</span> x0<span class="token operator">-</span>xoffset <span class="token keyword">in</span> <span class="token punctuation">[</span>i<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> roots<span class="token punctuation">]</span><span class="token punctuation">:</span>             <span class="token keyword">continue</span>        <span class="token keyword">if</span> debug<span class="token punctuation">:</span>             <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Potential x0:"</span><span class="token punctuation">,</span>x0<span class="token punctuation">)</span>         <span class="token keyword">for</span> y0<span class="token punctuation">,</span> _ <span class="token keyword">in</span> pol<span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token punctuation">.</span>univariate_polynomial<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>             <span class="token keyword">if</span> debug<span class="token punctuation">:</span>                 <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Potential y0:"</span><span class="token punctuation">,</span>y0<span class="token punctuation">)</span>             <span class="token keyword">if</span> <span class="token punctuation">(</span>x0<span class="token operator">-</span>xoffset<span class="token punctuation">,</span>y0<span class="token punctuation">)</span> <span class="token keyword">not</span> <span class="token keyword">in</span> roots <span class="token keyword">and</span> pol<span class="token punctuation">(</span>x0<span class="token punctuation">,</span>y0<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>                 roots<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>x0<span class="token operator">-</span>xoffset<span class="token punctuation">,</span>y0<span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token keyword">return</span> roots prefix <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">**</span><span class="token number">1000</span> P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token punctuation">,</span>y<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span> f <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>prefix<span class="token operator">+</span>x<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">*</span>prefix<span class="token operator">+</span>y<span class="token operator">*</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token number">3</span><span class="token operator">-</span>c3 x0<span class="token punctuation">,</span> y0 <span class="token operator">=</span> coron<span class="token punctuation">(</span>f<span class="token punctuation">,</span> X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">160</span><span class="token punctuation">,</span> Y<span class="token operator">=</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">160</span><span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>x0<span class="token punctuation">)</span><span class="token punctuation">,</span>long_to_bytes<span class="token punctuation">(</span>y0<span class="token punctuation">)</span><span class="token punctuation">)</span> </code></pre><p>flag2求解报错，尚未解决。。</p><h2 id="NepCTF2021-lowExponent"><a href="#NepCTF2021-lowExponent" class="headerlink" title="[NepCTF2021]lowExponent"></a>[NepCTF2021]<strong>lowExponent</strong></h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">Encrypt</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> nbits<span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">:</span>    p<span class="token punctuation">,</span> q <span class="token operator">=</span> <span class="token punctuation">[</span>getPrime<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">(</span>nbits<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    N <span class="token operator">=</span> p<span class="token operator">*</span>q    x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>        a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token punctuation">[</span>getRandomRange<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yp<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>        fp <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span> Yp<span class="token operator">^</span><span class="token number">2</span>        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yq<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>        fq <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span> Yq<span class="token operator">^</span><span class="token number">2</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            yp<span class="token punctuation">,</span> yq <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fp<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>fq<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>            y <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token punctuation">[</span>yp<span class="token punctuation">,</span> yq<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>            E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>            msg_point <span class="token operator">=</span> E<span class="token punctuation">.</span>point<span class="token punctuation">(</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">)</span>            Ep <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>            Eq <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>            N1 <span class="token operator">=</span> Ep<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span>            N2 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>p<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span>N1            N3 <span class="token operator">=</span> Eq<span class="token punctuation">.</span>order<span class="token punctuation">(</span><span class="token punctuation">)</span>            N4 <span class="token operator">=</span> <span class="token number">2</span><span class="token operator">*</span>q<span class="token operator">+</span><span class="token number">2</span><span class="token operator">-</span>N3            d <span class="token operator">=</span> <span class="token punctuation">&#123;</span>                <span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N1<span class="token punctuation">,</span> N3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token punctuation">(</span> <span class="token number">1</span><span class="token punctuation">,</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N1<span class="token punctuation">,</span> N4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N2<span class="token punctuation">,</span> N3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>                <span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> inverse_mod<span class="token punctuation">(</span>e<span class="token punctuation">,</span> lcm<span class="token punctuation">(</span>N2<span class="token punctuation">,</span> N4<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">break</span>        <span class="token keyword">except</span><span class="token punctuation">:</span>            <span class="token keyword">pass</span>    cip_point <span class="token operator">=</span> e<span class="token operator">*</span>msg_point    ciphertext <span class="token operator">=</span> cip_point<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    privKey <span class="token operator">=</span> <span class="token punctuation">(</span>d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>    pubKey <span class="token operator">=</span> <span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> N<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> pubKey<span class="token punctuation">,</span> privKey<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">Decrypt</span><span class="token punctuation">(</span>ciphertext<span class="token punctuation">,</span> pubKey<span class="token punctuation">,</span> privKey<span class="token punctuation">)</span><span class="token punctuation">:</span>    d<span class="token punctuation">,</span> p<span class="token punctuation">,</span> q <span class="token operator">=</span> privKey    a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> N <span class="token operator">=</span> pubKey    x <span class="token operator">=</span> ciphertext    w <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">%</span> N    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yp<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span>    fp <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span>Yp<span class="token operator">^</span><span class="token number">2</span>    yp <span class="token operator">=</span> fp<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    P<span class="token punctuation">.</span><span class="token operator">&lt;</span>Yq<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span>    fq <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">3</span> <span class="token operator">+</span> a<span class="token operator">*</span>x <span class="token operator">+</span> b <span class="token operator">-</span>Yq<span class="token operator">^</span><span class="token number">2</span>    yq <span class="token operator">=</span> fq<span class="token punctuation">.</span>roots<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    y <span class="token operator">=</span> crt<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>yp<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>yq<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>p<span class="token punctuation">,</span> q<span class="token punctuation">]</span><span class="token punctuation">)</span>    E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">)</span>    cip_point <span class="token operator">=</span> E<span class="token punctuation">.</span>point<span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span><span class="token punctuation">)</span>    legendre_symbol_p <span class="token operator">=</span> legendre_symbol<span class="token punctuation">(</span>w<span class="token punctuation">,</span> p<span class="token punctuation">)</span>    legendre_symbol_q <span class="token operator">=</span> legendre_symbol<span class="token punctuation">(</span>w<span class="token punctuation">,</span> q<span class="token punctuation">)</span>    msg_point <span class="token operator">=</span> d<span class="token punctuation">[</span><span class="token punctuation">(</span>legendre_symbol_p<span class="token punctuation">,</span> legendre_symbol_q<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">*</span>cip_point    <span class="token keyword">return</span> msg_point<span class="token punctuation">.</span>xy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>msg <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"w"</span><span class="token punctuation">)</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    current_st <span class="token operator">=</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span>    cipher <span class="token operator">=</span> Encrypt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span>    f<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span><span class="token string">"&#123;&#125;, &#123;&#125;, &#123;&#125;, &#123;&#125;\n"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>cipher<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token operator">*</span>cipher<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>f<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><p>加密后的结果是椭圆曲线上的点， Division Polynomials使我们可以⽤仅含⼀个未知数的多项式来表⽰这个点 </p><p>的x坐标： </p><p>$$<br>\begin{aligned} </p><p>\psi_{-1} &amp;=-1 \ </p><p>\psi_{0} &amp;=0 \ </p><p>\psi_{1} &amp;=1 \ </p><p>\psi_{2} &amp;=2 y \ </p><p>\psi_{3} &amp;=3 x^{4}+6 a x^{2}+12 b x-a^{2} \ </p><p>\psi_{4} &amp;=4 y\left(x^{6}+5 a x^{4}+20 b x^{3}-5 a^{2} x^{2}-4 a b x-8 b^{2}-a^{3}\right) \ </p><p>\psi_{2 i+1} &amp;=\psi_{i}\left(\psi_{i+2} \psi_{i-1}^{2}-\psi_{i-2} \psi_{i+1}^{2}\right) / 2 y, i \geq 2 \ </p><p>\psi_{2 i} &amp;=\psi_{i+2} \psi_{i}^{3}-\psi_{i+1}^{3} \psi_{i-1}, i \geq 3 </p><p>\end{aligned}<br>$$</p><p>此外，还可以定义多项式 $\phi_{m}$ 和 $\omega_{m}$： </p><p>$$<br>\begin{aligned} </p><p>\phi_{m} &amp;=x \psi_{m}^{2}-\psi_{m+1} \psi_{m-1} \ </p><p>\omega_{m} &amp;=\left(\psi_{m+2} \psi_{m-1}^{2}-\psi_{m-2} \psi_{m+1}^{2}\right) / 4 y </p><p>\end{aligned}<br>$$</p><p>那么椭圆曲线上的数乘，就可以⽤Division Polynomials来表⽰了：<br>$$<br>m P=\left(\frac{\phi_{m}(P)}{\psi_{m}(P)^{2}}, \frac{\omega_{m}(P)}{\psi_{m}(P)^{3}}\right)<br>$$</p><p>$$<br>ciphertext=\frac{\phi_{m}(P)}{\psi_{m}(P)^{2}}<br>$$</p><p>$$<br>f=ciphertext\cdot \psi_{m}(P)^{2}-\phi_{m}(P)=0\ (mod\ n)<br>$$</p><p>由于密⽂给了70组，所以 $f_i$ 多项式⼀共有70个，由于指数 $e=3$，所以 $f_i$ 为九次同余⽅程，可以通 </p><p>过中国剩余定理将70个同余⽅程合并成⼀个，这时得到的是⼀个系数很⼤，模数N也很⼤的九次同余⽅程，这 </p><p>时可以通过格基规约算法得到模这个很⼤的N的意义下的、较⼩的系数，当真实系数⼩于N时，同余⽅程便可 </p><p>以直接看作等号连接的⽅程，即可很⽅便的求解⼀个较⼩的根（明⽂）。 </p><p>⾮预期：在使⽤CRT合并成⼀个同余式之后，由于明⽂m相对n过于⼩，可以⽤ </p><p>coppersmith求解出根。 </p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> functools <span class="token keyword">import</span> <span class="token builtin">reduce</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span> f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">)</span> ciphertext <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> n <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span> ci<span class="token punctuation">,</span> ai<span class="token punctuation">,</span> bi<span class="token punctuation">,</span> ni <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span> <span class="token keyword">for</span> num <span class="token keyword">in</span> f<span class="token punctuation">.</span>readline<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">", "</span><span class="token punctuation">)</span><span class="token punctuation">]</span> ciphertext<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ci<span class="token punctuation">)</span> a<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ai<span class="token punctuation">)</span> b<span class="token punctuation">.</span>append<span class="token punctuation">(</span>bi<span class="token punctuation">)</span> n<span class="token punctuation">.</span>append<span class="token punctuation">(</span>ni<span class="token punctuation">)</span> e <span class="token operator">=</span> <span class="token number">3</span> deg <span class="token operator">=</span> <span class="token number">9</span> coeffi <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">:</span> E <span class="token operator">=</span> EllipticCurve<span class="token punctuation">(</span>IntegerModRing<span class="token punctuation">(</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> b<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> P<span class="token punctuation">.</span><span class="token operator">&lt;</span>m<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> f <span class="token operator">=</span> ciphertext<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>E<span class="token punctuation">.</span>_multiple_x_denominator<span class="token punctuation">(</span>e<span class="token punctuation">,</span> m<span class="token punctuation">)</span> <span class="token operator">-</span> E<span class="token punctuation">.</span>_multiple_x_numerator<span class="token punctuation">(</span>e<span class="token punctuation">,</span> m<span class="token punctuation">)</span> coeffi<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">.</span>coefficients<span class="token punctuation">(</span>sparse<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">)</span> large_coeffi <span class="token operator">=</span> <span class="token punctuation">[</span>crt<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>coeffi<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>n<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> N_bitlength <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span><span class="token punctuation">[</span>n<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">70</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> min_n <span class="token operator">=</span> <span class="token builtin">min</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span> N <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x<span class="token operator">*</span>y<span class="token punctuation">,</span> n<span class="token punctuation">)</span> Sc <span class="token operator">=</span> large_coeffivar<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span> assume<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">'integer'</span><span class="token punctuation">)</span> f <span class="token operator">=</span> Sc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> lat <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> lat<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span>large_coeffi<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>min_n<span class="token operator">**</span>i <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">/</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span> lat<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>min_n<span class="token operator">**</span>j<span class="token punctuation">)</span><span class="token operator">*</span>N <span class="token keyword">if</span> <span class="token punctuation">(</span>i<span class="token operator">==</span>j<span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">+</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> Mat <span class="token operator">=</span> matrix<span class="token punctuation">(</span>lat<span class="token punctuation">)</span> Mat_LLL <span class="token operator">=</span> Mat<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">for</span> lin <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token punctuation">)</span><span class="token punctuation">:</span> Sc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> Mat_LLL<span class="token punctuation">[</span>lin<span class="token punctuation">]</span><span class="token punctuation">]</span> Sc <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>Sc<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">//</span><span class="token punctuation">(</span>min_n<span class="token operator">**</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>deg<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> var<span class="token punctuation">(</span><span class="token string">"x"</span><span class="token punctuation">)</span> assume<span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token string">'integer'</span><span class="token punctuation">)</span> f <span class="token operator">=</span> Sc<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">9</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">8</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">7</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">7</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">6</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">5</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">4</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">3</span><span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>x<span class="token operator">+</span>Sc<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">print</span><span class="token punctuation">(</span>factor<span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">break</span> <span class="token triple-quoted-string string">''' m = 3088969433059681806521206959873975785377227976800172674306727155831805513908352148702210247662586117242206183337522557 print(long_to_bytes(m)) '''</span></code></pre><p>运行报错，待解决</p><h3 id="Hasted广播攻击"><a href="#Hasted广播攻击" class="headerlink" title="Hasted广播攻击"></a>Hasted广播攻击</h3><blockquote><p>使用不同但互质的模数n，相同的指数e、加密e个明文得到e个密文</p><p>$ c_{i} = (a_{i}x + b{i})^{e} \bmod n_{i} , i = 1,2,\cdots,e $</p><p>e个式子：$ (a_{i}x + b{i})^{e} - c_{i} \equiv 0 \bmod n_{i} , i = 1, 2, \cdots , e $</p><p>$ \because  n_{i}互素 和 中国剩余定理 $</p><p>$ \therefore P(x) \equiv 0 \bmod M , M = \prod_{i=1}^{e} n_{i} $</p><p>$ \because P(x)有唯一解，且满足LLL算法的约束条件 $</p><p>$ \therefore 可以用coppersmith的smallroots求解 $</p></blockquote><pre class="language-python" data-language="python"><code class="language-python"><span class="token comment"># sage</span><span class="token keyword">def</span> <span class="token function">linearPaddingHastads1</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> nArray<span class="token punctuation">,</span> aArray<span class="token punctuation">,</span> bArray<span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>cArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>nArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>aArray<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token builtin">len</span><span class="token punctuation">(</span>bArray<span class="token punctuation">)</span> <span class="token operator">==</span> e<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>            cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            nArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>nArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>            bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> Integer<span class="token punctuation">(</span>bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        TArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>e        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>            arrayToCRT <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>e            arrayToCRT<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>            TArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> crt<span class="token punctuation">(</span>arrayToCRT<span class="token punctuation">,</span> nArray<span class="token punctuation">)</span>        P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>prod<span class="token punctuation">(</span>nArray<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        gArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">*</span>e        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">:</span>            gArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> TArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>aArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x <span class="token operator">+</span> bArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span> <span class="token operator">-</span> cArray<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        g <span class="token operator">=</span> <span class="token builtin">sum</span><span class="token punctuation">(</span>gArray<span class="token punctuation">)</span>        g <span class="token operator">=</span> g<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token comment"># Use Sage's inbuilt coppersmith method</span>        roots <span class="token operator">=</span> g<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>epsilon<span class="token operator">=</span>eps<span class="token punctuation">)</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>roots<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"No Solutions found"</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span>        <span class="token keyword">return</span> roots<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"CiphertextArray, ModulusArray, and the linear padding arrays need to be of the same length,"</span> <span class="token operator">+</span>              <span class="token string">"and the same size as the public exponent"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">linearPaddingHastads2</span><span class="token punctuation">(</span>cArray<span class="token punctuation">,</span> nArray<span class="token punctuation">,</span> aArray<span class="token punctuation">,</span> bArray<span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span> eps<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    cnt <span class="token operator">=</span> e    PR <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>ZZ<span class="token punctuation">,</span> <span class="token string">'x'</span><span class="token punctuation">)</span>    x <span class="token operator">=</span> PR<span class="token punctuation">.</span>gen<span class="token punctuation">(</span><span class="token punctuation">)</span>    Fs <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>cnt<span class="token punctuation">)</span><span class="token punctuation">:</span>        f <span class="token operator">=</span> PR<span class="token punctuation">(</span><span class="token punctuation">(</span>A<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>x <span class="token operator">+</span> B<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">**</span>e <span class="token operator">-</span> Cs<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>        ff <span class="token operator">=</span> f<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>Ns<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        ff <span class="token operator">=</span> ff<span class="token punctuation">.</span>monic<span class="token punctuation">(</span><span class="token punctuation">)</span>        f <span class="token operator">=</span> ff<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>ZZ<span class="token punctuation">)</span>        Fs<span class="token punctuation">.</span>append<span class="token punctuation">(</span>f<span class="token punctuation">)</span>    F <span class="token operator">=</span> crt<span class="token punctuation">(</span>Fs<span class="token punctuation">,</span> Ns<span class="token punctuation">)</span>    M <span class="token operator">=</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span><span class="token keyword">lambda</span> x<span class="token punctuation">,</span> y<span class="token punctuation">:</span> x <span class="token operator">*</span> y<span class="token punctuation">,</span> Ns<span class="token punctuation">)</span>    FF <span class="token operator">=</span> F<span class="token punctuation">.</span>change_ring<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>M<span class="token punctuation">)</span><span class="token punctuation">)</span>    m <span class="token operator">=</span> FF<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>epsilon<span class="token operator">=</span><span class="token number">1</span><span class="token operator">/</span><span class="token number">16</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> m<span class="token punctuation">:</span>        <span class="token keyword">return</span> m<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">None</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>LCG-线性同余生成器</title>
      <link href="2021/03/31/lcg-xian-xing-tong-yu-sheng-cheng-qi/"/>
      <url>2021/03/31/lcg-xian-xing-tong-yu-sheng-cheng-qi/</url>
      
        <content type="html"><![CDATA[<h1 id="LCG-线性同余生成器"><a href="#LCG-线性同余生成器" class="headerlink" title="LCG(线性同余生成器)"></a>LCG(线性同余生成器)</h1><blockquote><p><strong>伪随机数生成器</strong>（pseudo random number generator，<strong>PRNG</strong>）</p><p>流密码（stream cipher)</p></blockquote><p>LCG属于PRNG和stream cipher的一种。</p><h2 id="Principle"><a href="#Principle" class="headerlink" title="Principle"></a>Principle</h2><p>递归公式：$$ S_{n+1} \equiv aS_{n} + b \left(\bmod m\right) $$</p><p>若 $$ gcd\left(a, m\right) = 1 $$ , 则周期 $$ T = ordm\left(a\right) $$</p><p>所以选取系数时应尽量使得a为模m的原根，以此尽量延长LCG周期。</p><blockquote><p>整数的阶： a 与 n 互素，使得$$ a^{x} \equiv 1\left(\bmod n\right) $$成立的最小正整数 x 称为<strong>a模n的阶</strong>，记为$$ ordn\left(a\right) $$</p><p>原根：当 $$ ordn\left(a\right) = \phi\left(n\right) $$时，称a为模n的原根</p></blockquote><p>python代码实现：</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>  a <span class="token operator">=</span> <span class="token number">672257317069504227</span>  <span class="token comment"># "乘数"</span>  b <span class="token operator">=</span> <span class="token number">7382843889490547368</span>  <span class="token comment"># "增量"</span>  m <span class="token operator">=</span> <span class="token number">9223372036854775783</span>  <span class="token comment"># "模数"</span>  <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> seed<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>state <span class="token operator">=</span> seed  <span class="token comment"># "种子"</span>  <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>    self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>state <span class="token operator">*</span> self<span class="token punctuation">.</span>a <span class="token operator">+</span> self<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>m    <span class="token keyword">return</span> self<span class="token punctuation">.</span>stategen <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>  <span class="token comment"># seed = 123</span><span class="token keyword">print</span> gen<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 第一个生成值</span><span class="token keyword">print</span> gen<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 第二个生成值</span><span class="token keyword">print</span> gen<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 第三个生成值</span><span class="token comment"># 7060145557346585242</span><span class="token comment"># 3490819368718893392</span><span class="token comment"># 6200546448603839134</span></code></pre><h2 id="Crack-methods"><a href="#Crack-methods" class="headerlink" title="Crack methods"></a>Crack methods</h2><h3 id="unknown-b"><a href="#unknown-b" class="headerlink" title="unknown b"></a>unknown b</h3><p>已知：a,m,s0,s1</p><p>因为$$ s_{1} = a * s_{0} + b \left(\bmod m\right) $$</p><p>所以$$ b = s_{1} - a * s_{0} \left(\bmod m\right) $$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">crack_unknown_increment</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> multiplier<span class="token punctuation">)</span><span class="token punctuation">:</span>    increment <span class="token operator">=</span> <span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">*</span>multiplier<span class="token punctuation">)</span> <span class="token operator">%</span> modulus    <span class="token keyword">return</span> modulus<span class="token punctuation">,</span> multiplier<span class="token punctuation">,</span> increment</code></pre><h3 id="unknown-a-b"><a href="#unknown-a-b" class="headerlink" title="unknown (a, b)"></a>unknown (a, b)</h3><p>已知：m,s0,s1,s2</p><p>因为</p><p> $$ s_{1} = a * s_{0} + b \left(\bmod m\right) $$</p><p>$$ s_{2} = a * s_{1} + b \left(\bmod m\right) $$</p><p>所以</p><p>$$ s_{2} - s_{1} = a * \left(s_{1} - s_{0}\right) \left(\bmod m\right) $$</p><p>$$ a = \left(s_{2} - s_{1}\right) / \left(s_{1} - s_{0}\right) \left(\bmod m\right) $$</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">crack_unknown_multiplier</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span><span class="token punctuation">:</span>    multiplier <span class="token operator">=</span> <span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> invert<span class="token punctuation">(</span>states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> states<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> modulus<span class="token punctuation">)</span> <span class="token operator">%</span> modulus <span class="token comment"># 注意这里求逆元</span>    <span class="token keyword">return</span> crack_unknown_increment<span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">,</span> multiplier<span class="token punctuation">)</span></code></pre><p>这里贴一下一个大师傅的另一种解法（现在没研究明白，等以后研究格密码再补）</p><blockquote><p>求模等式方程组的通法</p><p>基于LLL，对构造的格基进行约化</p><p><img src="https://img-blog.csdnimg.cn/img_convert/2f79006c06d46a37db7c34b3214f7d44.png" alt="img"></p><p>[外链图片转存失败,源站可能有防盗链机制,建议将图片保存下来直接上传(img-AeLJXI9P-1616997030766)(imgs/image-20210203152457151.png)]</p><pre class="language-python" data-language="python"><code class="language-python">A <span class="token operator">=</span> Matrix<span class="token punctuation">(</span><span class="token punctuation">[</span>    <span class="token punctuation">[</span>s0  <span class="token punctuation">,</span>s1  <span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">[</span><span class="token number">1</span>   <span class="token punctuation">,</span><span class="token number">1</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">1</span><span class="token operator">/</span>m <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">[</span><span class="token operator">-</span>s1 <span class="token punctuation">,</span><span class="token operator">-</span>s2 <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">1</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">[</span>m   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">]</span><span class="token punctuation">,</span>    <span class="token punctuation">[</span><span class="token number">0</span>   <span class="token punctuation">,</span>m   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">,</span><span class="token number">0</span>   <span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>A <span class="token operator">=</span> A<span class="token punctuation">.</span>LLL<span class="token punctuation">(</span><span class="token punctuation">)</span>a <span class="token operator">=</span> <span class="token boolean">None</span>b <span class="token operator">=</span> <span class="token boolean">None</span><span class="token keyword">for</span> l <span class="token keyword">in</span> A<span class="token punctuation">:</span>    <span class="token keyword">if</span> l<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword">and</span> l<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> l<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span>            a<span class="token punctuation">,</span> b <span class="token operator">=</span> l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> m<span class="token punctuation">,</span> l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> m        <span class="token keyword">elif</span> l<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>            a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token operator">-</span>l<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">*</span> m<span class="token punctuation">,</span> <span class="token operator">-</span>l<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span> <span class="token operator">*</span> m        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span><span class="token keyword">if</span> <span class="token keyword">not</span> a <span class="token keyword">or</span> <span class="token keyword">not</span> b<span class="token punctuation">:</span>    <span class="token keyword">raise</span> ValueError<span class="token punctuation">(</span><span class="token string">"[*] No solves"</span><span class="token punctuation">)</span>a <span class="token operator">%=</span> mb <span class="token operator">%=</span> m</code></pre><p>构造矩阵进行LLL约化是在解决模等式和CVP等问题时很实用的方法</p></blockquote><h3 id="unknown-a-b-m"><a href="#unknown-a-b-m" class="headerlink" title="unknown (a, b, m)"></a>unknown (a, b, m)</h3><p>已知：s0-s6</p><blockquote><p>假设我们有一组数据data = {𝑘𝑖𝑁}(N为大素数，𝑘𝑖为𝐹𝑁下的随机数)，则reduce(gcd, data)很大概率即为N或N乘上一些很小的因子.（∵ 假设len(data)=n，则在𝑘𝑖视作完全随机的情况下，reduce(gcd, data)有除N外的素因子p的概率约为$$ \frac{1}{p^{n}} $$，∴ 在p或n足够大的时候该方法能有效求解N）</p></blockquote><p>即：如果有几个随机数分别乘以n，那么这几个数的gcd就很可能等于n。</p><pre class="language-python" data-language="python"><code class="language-python">n <span class="token operator">=</span> <span class="token number">123456789</span><span class="token keyword">print</span> <span class="token builtin">reduce</span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span> <span class="token punctuation">[</span>randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token operator">*</span>n<span class="token punctuation">,</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token operator">*</span>n<span class="token punctuation">,</span> randint<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1000000</span><span class="token punctuation">)</span><span class="token operator">*</span>n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment"># 123456789</span></code></pre><p>引入序列$$ T_{n} = S_{n+1} - S_{n} $$</p><p>$$ T_{n+1} = S_{n+2} - S_{n+1} = a\left(S_{n+1} - S_{n}\right) = aT_{n}\left(\bmod m\right) $$</p><p>$$ T_{n+2} = S_{n+3} - S_{n+2} = a\left(S_{n+2} - S_{n+1}\right) = aT_{n+1} = a^{2}T_{n}\left(\bmod m\right) $$</p><p>$$ \therefore T_{n}T_{n+2} - \left(T_{n+1}\right)^{2} = 0\left(\bmod m\right) $$</p><p>因此只要我们能拿到连续𝑛(𝑛≥6)组数据，即可对module进行有效攻击. 后续即转为上一个情形的LCG攻击.</p><p>也就是说我们可以利用n组s，生成几个mod m为0(m的倍数)的一组data(通过$$ T_{n}T_{n+2} - \left(T_{n+1}\right)^{2} $$求得)，就可以求得它们的最大公因数(<code>reduce(gcd, data)</code>)，也就是模数m，得到了m，就可以进而转化为unknown(a, b)。</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">crack_unknown_modulus</span><span class="token punctuation">(</span>states<span class="token punctuation">)</span><span class="token punctuation">:</span>    diffs <span class="token operator">=</span> <span class="token punctuation">[</span>s1 <span class="token operator">-</span> s0 <span class="token keyword">for</span> s0<span class="token punctuation">,</span> s1 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>states<span class="token punctuation">,</span> states<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    zeroes <span class="token operator">=</span> <span class="token punctuation">[</span>t2<span class="token operator">*</span>t0 <span class="token operator">-</span> t1<span class="token operator">*</span>t1 <span class="token keyword">for</span> t0<span class="token punctuation">,</span> t1<span class="token punctuation">,</span> t2 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>diffs<span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>    modulus <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span> zeroes<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> crack_unknown_multiplier<span class="token punctuation">(</span>states<span class="token punctuation">,</span> modulus<span class="token punctuation">)</span></code></pre><h2 id="Many-Time-Pad-Attack-多次一密攻击"><a href="#Many-Time-Pad-Attack-多次一密攻击" class="headerlink" title="Many Time Pad Attack(多次一密攻击)"></a>Many Time Pad Attack(多次一密攻击)</h2><p><a href="https://lazzzaro.github.io/2020/11/07/crypto-%E6%B5%81%E5%AF%86%E7%A0%81/#%E5%A4%9A%E6%AC%A1%E4%B8%80%E5%AF%86%E6%94%BB%E5%87%BB%EF%BC%88Many-Time-Pad-Attack%EF%BC%89">https://lazzzaro.github.io/2020/11/07/crypto-%E6%B5%81%E5%AF%86%E7%A0%81/#%E5%A4%9A%E6%AC%A1%E4%B8%80%E5%AF%86%E6%94%BB%E5%87%BB%EF%BC%88Many-Time-Pad-Attack%EF%BC%89</a></p><h2 id="Truncated-LCG-given-a-b-m"><a href="#Truncated-LCG-given-a-b-m" class="headerlink" title="Truncated LCG(given a, b, m)"></a>Truncated LCG(given a, b, m)</h2><p><a href="https://0xdktb.top/2020/03/27/Summary-of-Crypto-in-CTF-PRNG/">https://0xdktb.top/2020/03/27/Summary-of-Crypto-in-CTF-PRNG/</a></p><h2 id="examples"><a href="#examples" class="headerlink" title="examples"></a>examples</h2><h3 id="NPUCTF2020-babyLCG"><a href="#NPUCTF2020-babyLCG" class="headerlink" title="[NPUCTF2020]babyLCG"></a>[NPUCTF2020]babyLCG</h3><p>又要跟格结合。。学完格再来补</p><h3 id="NCTF2019-LCG"><a href="#NCTF2019-LCG" class="headerlink" title="[NCTF2019]LCG"></a>[NCTF2019]LCG</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> seed<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>N <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>a <span class="token operator">=</span> randrange<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>b <span class="token operator">=</span> randrange<span class="token punctuation">(</span>self<span class="token punctuation">.</span>N<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> seed <span class="token operator">%</span> self<span class="token punctuation">.</span>N        self<span class="token punctuation">.</span>state <span class="token operator">=</span> self<span class="token punctuation">.</span>seed    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a <span class="token operator">*</span> self<span class="token punctuation">.</span>state <span class="token operator">+</span> self<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>N        <span class="token keyword">return</span> self<span class="token punctuation">.</span>state</code></pre><h4 id="challenge1"><a href="#challenge1" class="headerlink" title="challenge1"></a>challenge1</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">challenge1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Generating challenge 1 [++++++++++++++++]'</span>    init_seed <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>init_seed<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] init_seed = getrandbits(256)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg = LCG(init_seed)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.N = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span>N<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.a = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span>a<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.b = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span>b<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print lcg.seed</span>    guess <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">"[-] lcg.seed = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> guess <span class="token operator">!=</span> lcg<span class="token punctuation">.</span>seed<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">'[!] Sorry, you are wrong, exit...'</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Challenge 1 completed [++++++++++++++++]\n\n'</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>N <span class="token operator">=</span> <span class="token number">58752504807475554471851705640525123198743088433770689920509844260675922894303</span>a <span class="token operator">=</span> <span class="token number">42193965358850167681766742821143818559444699348244818042292306553454049730799</span>b <span class="token operator">=</span> <span class="token number">42429115791925198614889893041072535667400342792227251328952232401985843207872</span>s1 <span class="token operator">=</span> <span class="token number">123623408317446005887944641919451936767286763339264317753249629629642353726</span><span class="token keyword">print</span> <span class="token punctuation">(</span>s1 <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token operator">*</span>invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token operator">%</span>N<span class="token comment"># 3089764217562322037307689879824939943247311529771999590125371401998628371556</span></code></pre><h4 id="challenge2"><a href="#challenge2" class="headerlink" title="challenge2"></a>challenge2</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">challenge2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Generating challenge 2 [++++++++++++++++]'</span>    init_seed <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>init_seed<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] init_seed = getrandbits(256)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg = LCG(init_seed)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.N = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span>N<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.a = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span>a<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print lcg.seed</span>    guess <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">"[-] lcg.seed = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> guess <span class="token operator">!=</span> lcg<span class="token punctuation">.</span>seed<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">'[!] Sorry, you are wrong, exit...'</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Challenge 2 completed [++++++++++++++++]\n'</span></code></pre><pre class="language-python" data-language="python"><code class="language-python">N <span class="token operator">=</span> <span class="token number">101470213826837298141028377779692401427985568344670829326638899536127536313103</span>a <span class="token operator">=</span> <span class="token number">86370044869286000119047733119317698391807712572419053385405009900702446856846</span>s1 <span class="token operator">=</span> <span class="token number">27339319018189698721036925245943861167317224772565620839961798799373592916981</span>s2 <span class="token operator">=</span> <span class="token number">45263309243420058081365422177433427100509767860087066494963084621382820012390</span>b <span class="token operator">=</span> <span class="token punctuation">(</span>s2 <span class="token operator">-</span> s1 <span class="token operator">*</span> a<span class="token punctuation">)</span><span class="token operator">%</span>N<span class="token keyword">print</span> <span class="token punctuation">(</span>s1 <span class="token operator">-</span> b<span class="token punctuation">)</span><span class="token operator">*</span>invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> N<span class="token punctuation">)</span><span class="token operator">%</span>N<span class="token comment"># 33765136920494984413601288497824917256683713134500996060688539794373845183755</span></code></pre><h4 id="challenge3"><a href="#challenge3" class="headerlink" title="challenge3"></a>challenge3</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">challenge3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Generating challenge 3 [++++++++++++++++]'</span>    init_seed <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>init_seed<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] init_seed = getrandbits(256)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg = LCG(init_seed)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.N = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span>N<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print lcg.seed</span>    guess <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">"[-] lcg.seed = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> guess <span class="token operator">!=</span> lcg<span class="token punctuation">.</span>seed<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">'[!] Sorry, you are wrong, exit...'</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Challenge 3 completed [++++++++++++++++]\n'</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span>N <span class="token operator">=</span> <span class="token number">86766439951265287525487539006776786932804476484278575487912531572552286991509</span>s1 <span class="token operator">=</span> <span class="token number">63587912967838086183322581621576636358608467591605562266383548088573935033444</span>s2 <span class="token operator">=</span> <span class="token number">28390902812821650275945306214310346484832726105204083622359403128874833124588</span>s3 <span class="token operator">=</span> <span class="token number">30101273684101790863644319735020937206505092134221511353128745353203553781415</span>a <span class="token operator">=</span> <span class="token punctuation">(</span>s3 <span class="token operator">-</span> s2<span class="token punctuation">)</span> <span class="token operator">*</span> invert<span class="token punctuation">(</span>s2 <span class="token operator">-</span> s1<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">%</span> Nb <span class="token operator">=</span> <span class="token punctuation">(</span>s2 <span class="token operator">-</span> s1 <span class="token operator">*</span> a<span class="token punctuation">)</span> <span class="token operator">%</span> Ns0 <span class="token operator">=</span> <span class="token punctuation">(</span>s1 <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">%</span> N<span class="token keyword">print</span> s0<span class="token comment"># 3481108678780346291643455023551848157248371628861397673129497751455844069120</span></code></pre><h4 id="challenge4"><a href="#challenge4" class="headerlink" title="challenge4"></a>challenge4</h4><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">challenge4</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] Generating challenge 4 [++++++++++++++++]'</span>    init_seed <span class="token operator">=</span> getrandbits<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>    lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span>init_seed<span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[+] init_seed = getrandbits(256)'</span>    <span class="token keyword">print</span> <span class="token string">'[+] lcg = LCG(init_seed)'</span>    <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">'[+] lcg.next() = '</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token comment"># print lcg.seed</span>    guess <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span><span class="token builtin">raw_input</span><span class="token punctuation">(</span><span class="token string">"[-] lcg.seed = "</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> guess <span class="token operator">!=</span> lcg<span class="token punctuation">.</span>seed<span class="token punctuation">:</span>        <span class="token keyword">print</span> <span class="token string">'[!] Sorry, you are wrong, exit...'</span>        exit<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>    <span class="token keyword">print</span> <span class="token string">'[++++++++++++++++] challenge 4 completed [++++++++++++++++]\n'</span>    <span class="token keyword">print</span> <span class="token string">'[+] Good job! Here is your flag: '</span> <span class="token operator">+</span> flag</code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> primefac <span class="token keyword">import</span> <span class="token operator">*</span>s <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">91998030559539294118763300984087645302586520269401699283197802967845643768875</span><span class="token punctuation">,</span> <span class="token number">80069740776294650362142884296348197761629802041548573589982752426687778180055</span><span class="token punctuation">,</span> <span class="token number">55063243971314211579722221731224042285420160417657223615910086478363530969645</span><span class="token punctuation">,</span> <span class="token number">102301473242334107121311900448732568466210701241317168575997729679274391909345</span><span class="token punctuation">,</span> <span class="token number">50041444132184927123261592271067474333230884356724219423508831265553492817229</span><span class="token punctuation">,</span> <span class="token number">50661436852907184517648938922437143528821344611212575011889385677863365840831</span><span class="token punctuation">]</span>diffs <span class="token operator">=</span> <span class="token punctuation">[</span>s1 <span class="token operator">-</span> s0 <span class="token keyword">for</span> s1<span class="token punctuation">,</span> s0 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>s<span class="token punctuation">,</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>zeros <span class="token operator">=</span> <span class="token punctuation">[</span>t2<span class="token operator">*</span>t0<span class="token operator">-</span>t1<span class="token operator">*</span>t1 <span class="token keyword">for</span> t0<span class="token punctuation">,</span> t1<span class="token punctuation">,</span> t2 <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>diffs<span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">,</span> diffs<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">]</span>N <span class="token operator">=</span> <span class="token builtin">abs</span><span class="token punctuation">(</span><span class="token builtin">reduce</span><span class="token punctuation">(</span>gcd<span class="token punctuation">,</span> zeros<span class="token punctuation">)</span><span class="token punctuation">)</span>factors <span class="token operator">=</span> factorint<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token keyword">while</span> <span class="token keyword">not</span> isprime<span class="token punctuation">(</span>N<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token comment"># 注意这里N刚开始有可能不是素数导致后面无法求出逆元</span>    <span class="token keyword">for</span> prime<span class="token punctuation">,</span> order <span class="token keyword">in</span> factors<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> prime<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">128</span><span class="token punctuation">:</span>            <span class="token keyword">continue</span>        N <span class="token operator">=</span> N <span class="token operator">/</span> prime<span class="token operator">**</span>ordera <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">*</span> invert<span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">%</span> Nb <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">*</span> a<span class="token punctuation">)</span> <span class="token operator">%</span> Nseed <span class="token operator">=</span> <span class="token punctuation">(</span>s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> invert<span class="token punctuation">(</span>a<span class="token punctuation">,</span> N<span class="token punctuation">)</span> <span class="token operator">%</span> N<span class="token keyword">print</span> seed</code></pre><h3 id="BJDCTF3rd-easyLCG"><a href="#BJDCTF3rd-easyLCG" class="headerlink" title="[BJDCTF3rd]easyLCG"></a>[BJDCTF3rd]easyLCG</h3><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span><span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">class</span> <span class="token class-name">LCG</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>a <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>b <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">next</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>seed <span class="token operator">=</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token operator">*</span>self<span class="token punctuation">.</span>seed<span class="token operator">+</span>self<span class="token punctuation">.</span>b<span class="token punctuation">)</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>m        <span class="token keyword">return</span> self<span class="token punctuation">.</span>seed <span class="token operator">>></span> <span class="token number">16</span>    <span class="token keyword">def</span> <span class="token function">output</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"a = &#123;&#125;\nb = &#123;&#125;\nm = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>a<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> self<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"state1 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"state2 = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">DH</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>lcg <span class="token operator">=</span> LCG<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>lcg<span class="token punctuation">.</span>output<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>g <span class="token operator">=</span> getRandomNBitInteger<span class="token punctuation">(</span><span class="token number">128</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>A<span class="token punctuation">,</span> self<span class="token punctuation">.</span>a <span class="token operator">=</span> self<span class="token punctuation">.</span>gen_AB<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>B<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b <span class="token operator">=</span> self<span class="token punctuation">.</span>gen_AB<span class="token punctuation">(</span><span class="token punctuation">)</span>        self<span class="token punctuation">.</span>key <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>A<span class="token punctuation">,</span> self<span class="token punctuation">.</span>b<span class="token punctuation">,</span> self<span class="token punctuation">.</span>m<span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">gen_AB</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        x <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            x <span class="token operator">+=</span> <span class="token string">'1'</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>lcg<span class="token punctuation">.</span><span class="token builtin">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">2</span> <span class="token keyword">else</span> <span class="token string">'0'</span>        <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>g<span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> self<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>DH <span class="token operator">=</span> DH<span class="token punctuation">(</span><span class="token punctuation">)</span>flag <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"g = &#123;&#125;\nA = &#123;&#125;\nB = &#123;&#125;\nM = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>DH<span class="token punctuation">.</span>g<span class="token punctuation">,</span> DH<span class="token punctuation">.</span>A<span class="token punctuation">,</span> DH<span class="token punctuation">.</span>B<span class="token punctuation">,</span> DH<span class="token punctuation">.</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Cipher = &#123;&#125;"</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>flag <span class="token operator">^</span> DH<span class="token punctuation">.</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token triple-quoted-string string">'''a = 3844066521b = 3316005024m = 2249804527state1 = 16269state2 = 4249g = 183096451267674849541594370111199688704A = 102248652770540219619953045171664636108622486775480799200725530949685509093530B = 74913924633988481450801262607456437193056607965094613549273335198280176291445M = 102752586316294557951738800745394456033378966059875498971396396583576430992701Cipher = 13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703'''</span></code></pre><p>爆破低位的那16位，满足条件的有四个</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span>a <span class="token operator">=</span> <span class="token number">3844066521</span>b <span class="token operator">=</span> <span class="token number">3316005024</span>m <span class="token operator">=</span> <span class="token number">2249804527</span>state1 <span class="token operator">=</span> <span class="token number">16269</span>state2 <span class="token operator">=</span> <span class="token number">4249</span>g <span class="token operator">=</span> <span class="token number">183096451267674849541594370111199688704</span>A <span class="token operator">=</span> <span class="token number">102248652770540219619953045171664636108622486775480799200725530949685509093530</span>B <span class="token operator">=</span> <span class="token number">74913924633988481450801262607456437193056607965094613549273335198280176291445</span>M <span class="token operator">=</span> <span class="token number">102752586316294557951738800745394456033378966059875498971396396583576430992701</span>Cipher <span class="token operator">=</span> <span class="token number">13040004482819935755130996285494678592830702618071750116744173145400949521388647864913527703</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token operator">**</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    s1 <span class="token operator">=</span> <span class="token punctuation">(</span>state1 <span class="token operator">&lt;&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token operator">+</span> i    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>s1 <span class="token operator">*</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> m<span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">16</span> <span class="token operator">==</span> state2<span class="token punctuation">:</span>        s2 <span class="token operator">=</span> <span class="token punctuation">(</span>s1 <span class="token operator">*</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> m        x <span class="token operator">=</span> <span class="token string">''</span>        <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            s2 <span class="token operator">=</span> <span class="token punctuation">(</span>s2 <span class="token operator">*</span> a <span class="token operator">+</span> b<span class="token punctuation">)</span> <span class="token operator">%</span> m            x <span class="token operator">+=</span> <span class="token string">'1'</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s2<span class="token operator">>></span><span class="token number">16</span><span class="token punctuation">)</span><span class="token operator">%</span> <span class="token number">2</span> <span class="token keyword">else</span> <span class="token string">'0'</span>        x <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>        key <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>B<span class="token punctuation">,</span> x<span class="token punctuation">,</span> M<span class="token punctuation">)</span>        <span class="token keyword">print</span> n2s<span class="token punctuation">(</span>Cipher <span class="token operator">^</span> key<span class="token punctuation">)</span><span class="token comment"># flag&#123;4dfe14e0c6c21ffcf5a3b4f0ed1911f6&#125;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> note </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>记五道RSA</title>
      <link href="2021/02/04/ji-5-dao-rsa/"/>
      <url>2021/02/04/ji-5-dao-rsa/</url>
      
        <content type="html"><![CDATA[<h1 id="记5道RSA"><a href="#记5道RSA" class="headerlink" title="记5道RSA"></a>记5道RSA</h1><h2 id="RoarCTF2019-babyRSA"><a href="#RoarCTF2019-babyRSA" class="headerlink" title="[RoarCTF2019]babyRSA"></a>[RoarCTF2019]babyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> sympy<span class="token keyword">import</span> random<span class="token keyword">def</span> <span class="token function">myGetPrime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    A<span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">513</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>A<span class="token punctuation">)</span>    B<span class="token operator">=</span>A<span class="token operator">-</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1e3</span><span class="token punctuation">,</span><span class="token number">1e5</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>B<span class="token punctuation">)</span>    <span class="token keyword">return</span> sympy<span class="token punctuation">.</span>nextPrime<span class="token punctuation">(</span><span class="token punctuation">(</span>B!<span class="token punctuation">)</span><span class="token operator">%</span>A<span class="token punctuation">)</span>p<span class="token operator">=</span>myGetPrime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#A1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span><span class="token comment">#B1=21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span>q<span class="token operator">=</span>myGetPrime<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">#A2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span><span class="token comment">#B2=16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span>r<span class="token operator">=</span>myGetPrime<span class="token punctuation">(</span><span class="token punctuation">)</span>n<span class="token operator">=</span>p<span class="token operator">*</span>q<span class="token operator">*</span>r<span class="token comment">#n=85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span>c<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token comment">#e=0x1001</span><span class="token comment">#c=75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span><span class="token comment">#so,what is the flag?</span></code></pre><blockquote><p>wilson定理：<br>当且仅当p为素数时：( p -1 )! ≡ -1 ( mod p )</p></blockquote><p>通过invert函数，一步步将A推成B</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> gmpy2<span class="token keyword">import</span> sympy<span class="token keyword">import</span> libnum<span class="token keyword">def</span> <span class="token function">wilson</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>B<span class="token punctuation">)</span><span class="token punctuation">:</span>t<span class="token operator">=</span>A<span class="token operator">-</span>B<span class="token operator">-</span><span class="token number">1</span>res<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>k<span class="token operator">=</span>A<span class="token operator">-</span><span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>res<span class="token operator">=</span><span class="token punctuation">(</span>res<span class="token operator">*</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>k<span class="token punctuation">,</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>Ak<span class="token operator">=</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> res<span class="token operator">+</span>A<span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">return</span> resn<span class="token operator">=</span><span class="token number">85492663786275292159831603391083876175149354309327673008716627650718160585639723100793347534649628330416631255660901307533909900431413447524262332232659153047067908693481947121069070451562822417357656432171870951184673132554213690123308042697361969986360375060954702920656364144154145812838558365334172935931441424096270206140691814662318562696925767991937369782627908408239087358033165410020690152067715711112732252038588432896758405898709010342467882264362733</span>e<span class="token operator">=</span><span class="token number">0x1001</span>c<span class="token operator">=</span><span class="token number">75700883021669577739329316795450706204502635802310731477156998834710820770245219468703245302009998932067080383977560299708060476222089630209972629755965140317526034680452483360917378812244365884527186056341888615564335560765053550155758362271622330017433403027261127561225585912484777829588501213961110690451987625502701331485141639684356427316905122995759825241133872734362716041819819948645662803292418802204430874521342108413623635150475963121220095236776428</span>A2<span class="token operator">=</span><span class="token number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858418927</span>B2<span class="token operator">=</span><span class="token number">16466113115839228119767887899308820025749260933863446888224167169857612178664139545726340867406790754560227516013796269941438076818194617030304851858351026</span>A1<span class="token operator">=</span><span class="token number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467234407</span>B1<span class="token operator">=</span><span class="token number">21856963452461630437348278434191434000066076750419027493852463513469865262064340836613831066602300959772632397773487317560339056658299954464169264467140596</span>p<span class="token operator">=</span>sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>wilson<span class="token punctuation">(</span>A1<span class="token punctuation">,</span>B1<span class="token punctuation">)</span><span class="token punctuation">)</span>q<span class="token operator">=</span>sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>wilson<span class="token punctuation">(</span>A2<span class="token punctuation">,</span>B2<span class="token punctuation">)</span><span class="token punctuation">)</span>r<span class="token operator">=</span>n<span class="token operator">//</span>p<span class="token operator">//</span>qphi<span class="token operator">=</span><span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d<span class="token operator">=</span>gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span>phi<span class="token punctuation">)</span>m<span class="token operator">=</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span>d<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>libnum<span class="token punctuation">.</span>n2s<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#RoarCTF&#123;wm-CongrAtu1ation4-1t4-ju4t-A-bAby-R4A&#125;</span></code></pre><p>或者</p><pre class="language-python" data-language="python"><code class="language-python">tmp <span class="token operator">=</span> <span class="token number">1</span>   <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span> <span class="token punctuation">(</span>B<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span>A<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          tmp <span class="token operator">*=</span> i       tmp <span class="token operator">%=</span> A   a <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>invert<span class="token punctuation">(</span>tmp<span class="token punctuation">,</span>A<span class="token punctuation">)</span>   result <span class="token operator">=</span> sympy<span class="token punctuation">.</span>nextprime<span class="token punctuation">(</span>a<span class="token punctuation">)</span></code></pre><h2 id="NPUCTF2020-共-模-攻-击"><a href="#NPUCTF2020-共-模-攻-击" class="headerlink" title="[NPUCTF2020]共 模 攻 击"></a>[NPUCTF2020]共 模 攻 击</h2><p>hint.py</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> hintm <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>hint<span class="token punctuation">)</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span>p<span class="token punctuation">,</span> q <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qe1<span class="token punctuation">,</span> e2 <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">,</span> getPrime<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span>c1<span class="token punctuation">,</span> c2 <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e1<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> e2<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>e1<span class="token punctuation">,</span> c1<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>e2<span class="token punctuation">,</span> c2<span class="token punctuation">)</span><span class="token triple-quoted-string string">'''10731697577128434210836295494509648970890030263373452094390528365528331853570968074920062199353352337222320248097844342932931723172828149786889317114239396296822243748702335879699607136383100687844154745350337807727661713204612815792303413961 17544211690361913917173092569380359609129411092068723748264445267330306960568217317081932701517598437808947506966426597954527875473550433453487141292177232622163991 1613454015951555289711148366977297613624544025937559371784736059448454437652633847111272619248126613500028992813732842041018588707201458398726700828844249'''</span></code></pre><p>c = m^256 mod p<br>m = nthroot_mod(c, 256, p)</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> sympy <span class="token keyword">import</span> nthroot_mode1 <span class="token operator">=</span> <span class="token number">2303413961</span>e2 <span class="token operator">=</span> <span class="token number">2622163991</span>n <span class="token operator">=</span> <span class="token number">6807492006219935335233722232024809784434293293172317282814978688931711423939629682224374870233587969960713638310068784415474535033780772766171320461281579</span>c1 <span class="token operator">=</span> <span class="token number">1754421169036191391717309256938035960912941109206872374826444526733030696056821731708193270151759843780894750696642659795452787547355043345348714129217723</span>c2 <span class="token operator">=</span> <span class="token number">1613454015951555289711148366977297613624544025937559371784736059448454437652633847111272619248126613500028992813732842041018588707201458398726700828844249</span>p <span class="token operator">=</span> <span class="token number">107316975771284342108362954945096489708900302633734520943905283655283318535709</span>s <span class="token operator">=</span> gcdext<span class="token punctuation">(</span>e1<span class="token punctuation">,</span> e2<span class="token punctuation">)</span>s1 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>s2 <span class="token operator">=</span> s<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token comment"># 求模反元素</span><span class="token keyword">if</span> s1 <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">:</span>  s1 <span class="token operator">=</span> <span class="token operator">-</span> s1  c1 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">elif</span> s2<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">:</span>  s2 <span class="token operator">=</span> <span class="token operator">-</span> s2  c2 <span class="token operator">=</span> invert<span class="token punctuation">(</span>c2<span class="token punctuation">,</span> n<span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c1<span class="token punctuation">,</span>s1<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c2<span class="token punctuation">,</span>s2<span class="token punctuation">,</span>n<span class="token punctuation">)</span> <span class="token operator">%</span> n<span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span>nthroot_mod<span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># m.bit_length() &lt; 400</span></code></pre><p>Coppersmith定理：在一个e阶的mod n多项式f(x)中，如果有一个根小于n^1/e，就可以运用一个O(log n)的算法求出这些根。</p><p>　　c1 = mp mod n = mp mod p*q</p><p>　　c2 = mq mod n = mq mod p*q</p><p>因为p、q为素数，所以由费马定理可得：</p><p>　　mp ≡ m mod p</p><p>　　mq ≡ m mod q</p><p>所以，又有：</p><p>　　c1 = m + ip + xpq，可整理成 c1 = m + ip </p><p>　　c2 = m + jq + ypq，可整理成 c2 = m + jq</p><p>因此：</p><p>　　c1 * c2 = m2 + (ip + jq)m + ijn</p><p>　　(c1 + c2)m = 2m2 + (ip+jq)m </p><p>　　有： m2 - (c1 + c2)m + c1 * c2 = ijn ≡ 0 mod n</p><pre class="language-python" data-language="python"><code class="language-python">n <span class="token operator">=</span> <span class="token number">128205304743751985889679351195836799434324346996129753896234917982647254577214018524580290192396070591032007818847697193260130051396080104704981594190602854241936777324431673564677900773992273463534717009587530152480725448774018550562603894883079711995434332008363470321069097619786793617099517770260029108149</span>c1 <span class="token operator">=</span> <span class="token number">96860654235275202217368130195089839608037558388884522737500611121271571335123981588807994043800468529002147570655597610639680977780779494880330669466389788497046710319213376228391138021976388925171307760030058456934898771589435836261317283743951614505136840364638706914424433566782044926111639955612412134198</span>c2 <span class="token operator">=</span> <span class="token number">9566853166416448316408476072940703716510748416699965603380497338943730666656667456274146023583837768495637484138572090891246105018219222267465595710692705776272469703739932909158740030049375350999465338363044226512016686534246611049299981674236577960786526527933966681954486377462298197949323271904405241585</span>a <span class="token operator">=</span> c1 <span class="token operator">+</span> c2b <span class="token operator">=</span> c1 <span class="token operator">*</span> c2P<span class="token punctuation">.</span><span class="token operator">&lt;</span>x<span class="token operator">></span> <span class="token operator">=</span> PolynomialRing<span class="token punctuation">(</span>Zmod<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>f <span class="token operator">=</span> x<span class="token operator">^</span><span class="token number">2</span> <span class="token operator">-</span> a <span class="token operator">*</span> x <span class="token operator">+</span> bflag <span class="token operator">=</span> f<span class="token punctuation">.</span>small_roots<span class="token punctuation">(</span>X<span class="token operator">=</span><span class="token number">2</span><span class="token operator">^</span><span class="token number">400</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token comment"># 4242839043019782000788118887372132807371568279472499477998758466224002905442227156537788110520335652385855</span></code></pre><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">print</span><span class="token punctuation">(</span>n2s<span class="token punctuation">(</span><span class="token number">4242839043019782000788118887372132807371568279472499477998758466224002905442227156537788110520335652385855</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># verrrrrrry_345yyyyyyy_rsaaaaaaa_righttttttt?</span></code></pre><h2 id="NCTF2019-easyRSA"><a href="#NCTF2019-easyRSA" class="headerlink" title="[NCTF2019]easyRSA"></a>[NCTF2019]easyRSA</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flag <span class="token keyword">import</span> flage <span class="token operator">=</span> <span class="token number">0x1337</span>p <span class="token operator">=</span> <span class="token number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span>q <span class="token operator">=</span> <span class="token number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q<span class="token keyword">assert</span><span class="token punctuation">(</span>flag<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">'NCTF'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">.</span>from_bytes<span class="token punctuation">(</span>flag<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'big'</span><span class="token punctuation">)</span><span class="token keyword">assert</span><span class="token punctuation">(</span>m<span class="token punctuation">.</span>bit_length<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1337</span><span class="token punctuation">)</span>c <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span><span class="token comment"># 10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span></code></pre><p>e是φ(n)的一个因子，无法求出私钥d</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> tqdm <span class="token keyword">import</span> tqdm<span class="token keyword">def</span> <span class="token function">onemod</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>r<span class="token punctuation">)</span><span class="token punctuation">:</span>    t <span class="token operator">=</span> p<span class="token operator">-</span><span class="token number">2</span>    <span class="token keyword">while</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> r<span class="token punctuation">,</span> p<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">:</span> t <span class="token operator">-=</span> <span class="token number">1</span>    <span class="token keyword">return</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> r<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">solution</span><span class="token punctuation">(</span>p<span class="token punctuation">,</span>root<span class="token punctuation">)</span><span class="token punctuation">:</span>     g <span class="token operator">=</span> onemod<span class="token punctuation">(</span>p<span class="token punctuation">,</span> <span class="token number">0x1337</span><span class="token punctuation">)</span>    may <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">0x1337</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> i <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>        may<span class="token punctuation">.</span>append<span class="token punctuation">(</span>root <span class="token operator">*</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>g<span class="token punctuation">,</span>i<span class="token punctuation">,</span>p<span class="token punctuation">)</span> <span class="token operator">%</span> p<span class="token punctuation">)</span>    <span class="token keyword">return</span> mayc <span class="token operator">=</span> <span class="token number">10562302690541901187975815594605242014385201583329309191736952454310803387032252007244962585846519762051885640856082157060593829013572592812958261432327975138581784360302599265408134332094134880789013207382277849503344042487389850373487656200657856862096900860792273206447552132458430989534820256156021128891296387414689693952047302604774923411425863612316726417214819110981605912408620996068520823370069362751149060142640529571400977787330956486849449005402750224992048562898004309319577192693315658275912449198365737965570035264841782399978307388920681068646219895287752359564029778568376881425070363592696751183359</span>p <span class="token operator">=</span> <span class="token number">199138677823743837339927520157607820029746574557746549094921488292877226509198315016018919385259781238148402833316033634968163276198999279327827901879426429664674358844084491830543271625147280950273934405879341438429171453002453838897458102128836690385604150324972907981960626767679153125735677417397078196059</span>q <span class="token operator">=</span> <span class="token number">112213695905472142415221444515326532320352429478341683352811183503269676555434601229013679319423878238944956830244386653674413411658696751173844443394608246716053086226910581400528167848306119179879115809778793093611381764939789057524575349501163689452810148280625226541609383166347879832134495444706697124741</span>e <span class="token operator">=</span> <span class="token number">0x1337</span>n <span class="token operator">=</span> p <span class="token operator">*</span> qc_p <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token number">3307</span> <span class="token operator">*</span> <span class="token punctuation">(</span>p <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> e<span class="token punctuation">)</span> <span class="token operator">//</span> e<span class="token punctuation">,</span> p<span class="token punctuation">)</span>C1 <span class="token operator">=</span> solution<span class="token punctuation">(</span>p<span class="token punctuation">,</span> c_p<span class="token punctuation">)</span>c_q <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token number">2649</span> <span class="token operator">*</span> <span class="token punctuation">(</span>q <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">//</span> e<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">//</span> e<span class="token punctuation">,</span> q<span class="token punctuation">)</span>C2 <span class="token operator">=</span> solution<span class="token punctuation">(</span>q<span class="token punctuation">,</span> c_q<span class="token punctuation">)</span>a <span class="token operator">=</span> invert<span class="token punctuation">(</span>p<span class="token punctuation">,</span> q<span class="token punctuation">)</span>b <span class="token operator">=</span> invert<span class="token punctuation">(</span>q<span class="token punctuation">,</span> p<span class="token punctuation">)</span>flag<span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>C1<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> j <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>C2<span class="token punctuation">)</span><span class="token punctuation">:</span>        flag <span class="token operator">+=</span> <span class="token number">1</span>        <span class="token keyword">if</span> flag <span class="token operator">%</span> <span class="token number">1000000</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>        x <span class="token operator">=</span> <span class="token punctuation">(</span>b <span class="token operator">*</span> q <span class="token operator">*</span> i <span class="token operator">+</span> a <span class="token operator">*</span> p <span class="token operator">*</span> j<span class="token punctuation">)</span> <span class="token operator">%</span> n        <span class="token keyword">if</span> <span class="token string">b"NCTF&#123;"</span> <span class="token keyword">in</span> long_to_bytes<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span>            exit<span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre><h2 id="DJBCTF-RealSimpleAlgorithm"><a href="#DJBCTF-RealSimpleAlgorithm" class="headerlink" title="[DJBCTF]RealSimpleAlgorithm"></a>[DJBCTF]RealSimpleAlgorithm</h2><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> secret <span class="token keyword">import</span> flag<span class="token keyword">def</span> <span class="token function">findPrime</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> k <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">else</span> findPrime<span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>p <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span>q <span class="token operator">=</span> findPrime<span class="token punctuation">(</span><span class="token number">20210123</span> <span class="token operator">*</span> p <span class="token operator">*</span> p<span class="token punctuation">)</span>r <span class="token operator">=</span> findPrime<span class="token punctuation">(</span>p <span class="token operator">*</span> q <span class="token operator">*</span> q<span class="token punctuation">)</span>s <span class="token operator">=</span> findPrime<span class="token punctuation">(</span>p <span class="token operator">*</span> q <span class="token operator">*</span> r<span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q <span class="token operator">*</span> r <span class="token operator">*</span> se <span class="token operator">=</span> <span class="token number">0x10001</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>flag<span class="token punctuation">)</span>w <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'output'</span><span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span>w<span class="token punctuation">.</span>write<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span>w<span class="token punctuation">.</span>write<span class="token punctuation">(</span><span class="token string">b'\n\n'</span><span class="token punctuation">)</span>w<span class="token punctuation">.</span>write<span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> e<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre><p>猜想n约等于20210123的6次方乘上p的16次方</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> gmpy2 <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> libnum <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">def</span> <span class="token function">findPrime</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> k <span class="token keyword">if</span> isPrime<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token keyword">else</span> findPrime<span class="token punctuation">(</span>k<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>n <span class="token operator">=</span> s2n<span class="token punctuation">(</span><span class="token string">b'\x14r\xa6\xc3\xc1\xd1\xcd\xbf\xe7m8Q\x19*\xb5\x8f~\xd9\x08iD\xc6W\xca)_4\xd8tR\xd0_\xfd\xfb\xcb\xb1\x9cRc\xff\x18\x93\x8b\x1f\xe3\x07\xfe\xe2\xa1\x8d\xfa\xe4D\xe1qv]\xc3\x8808as\n\xac8S\xb7\xe1\x1b*\xde\xf5\x16\x02\xecv\xe2\x83*\x89g\x17\x9f\xe5\xe2U,\xb1\x94+\x17\xf0\x99\xa4%\xb9~^7_\x84\x0b\xa0\x98\xf8\xb2\xcf\x8c&lt;\xc4\x1a\x87f\xcaZ\x8f\xbb\x1a\xb8\xddh\xd3mL\x85\x87\xb6dfv\x01G\x9aX\xa5[\xff\x1e\xea\xfc5o\x9co\xad\xd5\xa6\xae\xffg!\xee\x9c\xaa\\\xdate\xf4\xea\x1a\xe2*\xbd\xa0\x1e\xcd\xf1j;\xa8\xd0^(d1`\xeb\xa43I\xfb\x8e4P!\xa9\xcd\x86\x95\x0e\xc1l\x96\xfc\x8f*\xb5$6\x03l\xbd\xf9\xbe\x0cBm\nm4\xa6aa9?pK]Y\x01:\xfaM\xc6\x1f\xe83\x0c\xe7\xfeW\xba\xa2\xf5\x88\x18h\xb5?+\x04\xb6@\xdf\x85\x15\x8c\xe5!8-&amp;\xc7FCfw\xba\x1d\xb2(\xe026?\xa3\x0b\x19\xf6\x9f\x1cB2\xee\x87\x02y\xc5\x95\x9a\xeb\t1E5x\x08\x0f\xafF\x96a\xe8\xa73P5*\xe4Y\\\xcaa\xfcy\xb0\x97DHm\xeb>;\xfadfu\xec\x90\xa4x\xc8\\\x87\xbf\xcdz(\x96^\x10\xd2\xe2\xc0\xd6\xe1\xb1\x9dk&amp;\xfb\x06J\x8c\x9f\x0c%\x97 \xd4i\xbbo\x1ft\x89Q-\x11\xf8\x9e\xce\xc2\x143\x1a\xf6\x05\x11\x9cn\xc9]o\xb40\xfa\x8c\xb8\xee\xaa\xc7\xf2_\x80\x81=ry\xb5\xc3\x1d\xcd\x1f\xc1)\x0b\xe8/[\xc3\x19\xb1\x1b`\x15\x07\xb2\x87\xce\xe6J1\xe6\xbcC&lt;\xd7\x99\x10:U\x92\x00d\x9eE3\xa7\xb0\x89\x180\xb6$pCWU)\x14\xb3\x11\x8c\x86V0>JQ\xf2h/\xcf\x15\xd2\x02\x0e\x9c\xab\xb3H\xf4\xe7\xd4\xd9\xe8&lt;Pk\x05qRN\xf8-\xa9=)J\xf4\x01j\x81\xc6\x99X\xf2\x87_\xaenl\xf3\xfb\xf6P\xa3_p\xc7\xc0a\xc1\xd4e&lt;\xc0\x8ei#Y\xeb\xb1\xa9z\xe0;I3U\x89\x84\xe9"S\x87?'</span><span class="token punctuation">)</span>c <span class="token operator">=</span> s2n<span class="token punctuation">(</span><span class="token string">b'\r\xf3\xeb\xf3\x96\x9aGc\x10\xb8\xe7\x88P\xa9\x1f/\xfb\xf7;z \xc9\xca\xb3=\x9c\xee\x95vL\xd2y\x05\xafm\x18 \x7f\x1b\x8c\xfe#\x17\xc1+#\xf0\xa7\xbf\xe1\xc6\xf7\xb76L\xf7\xb0n\xf7(\xd5\xe59E\xfbp4\xe1\xa2w\xe5\xe5\xe5\xf2@%\xab\xfe@\xc8#^T\xa3\xb1w\xfb\xd9\x8bp\x0bxoR)\x9a\xc6\xe1\x9dT\xbd\xe7&#123;\xef\xbc\xba\xa8\x0c\x8e\xbc/\xc9&#125;\xcd\xd6\xc2\xdd\x16\xf1Qa\xed\x1a\x86\x1c)\x9e\xf0,\xf2\x11\xccD\t\x02M\x12\x85\xd6\xe1\x15"\xbd\x8b\xc4\x92\x94Y\x1d:\xc1\x17\x1c\x92\xd3>c\xc0BG\t\xac(#\x7f\\\xd6\x10Y\xdd\xf2\x06Nf\xac\x97 \xc3$\xd1\x06*\xf0\t\xcbM\xe4\x92\xa1,\xf0\x97\x86\x1e\xc2\x10gM\xe7\xf1L\x00b\xc6\xbeH|\xba\xa1o\x81\xf6\xe3\x87\xaa\xd3\xde\xbd\xafa\x81|\x8c\xb8\x91\xed\xca\x80\xf4\xf3\x91\x189\x0ciH\xdf\xcfj\x9eK\x83\x7f)d\xa8\x08\xe7F\\\xaa8\x1c\x96N\xb0\xb1\xabvP\'\xd4\xea\x02E:\xe0\xe9\x96\xc6\xdc\xd2\xd6\xce\xb7e\xcd\x8b\x1b\xc5\x9a/\xdd\x98\x94\x00\x18NC\x9e\xb2z\x9e\x0f\xffol\xc2\xf43\xbd\x1b\xea\xdf$\xc4\xe3\x96\x03_\x16a\x15\x13\xc7_g!\x11\xb2\xb9=\xe5?\x0b\xc0\xdf6!U\x06\xb2i\x94\xed0\xe8\xd8\xaf\x9f\'z\x02\xa1\x17\x8e\xdb@\xd9R\x9c&amp;\xed\x97&amp;\x9f\x82Y\nXS@\x976!\x19\x17c|Rv\xfc4@\xad\xed\x92U\xe2T\xed8qbn\xdf\xd8\xe06\xcf\xa0\x87;X\xe3:0\xa3Z\x98\x89\xbe\x8eJ\xd0\xd5rV\xea2\xa4\xc6\xaf\xdeBi\xd1`QR\x90W\x83\xb7Yy\xba\xaa\x08\x81\xe7|U\xde\xf5\xaeF\xb6K\x13\xa4]\xec\x931\xfb\xb0\xf4\xc5\x9e,\x8d\x138\x8c~\x03\xa9\xf2/dCw\xf6\xb7\x1d\xc9b\xdc\xc1\xde+.&#123;PK\x17:\xa8\xd6\xcc\x9a\xee06\x00\x04\xbf\xcfXN\xb4\xcc\x03qQ/\x9e\x95\xf0\xa3\x0b\x08f\x0f\x03\x8e\xb7\xb1\xc4\x1avo\xbb\x9dGF\xb7.\t\xdd#\xf72 \xa8\x9f2b!'</span><span class="token punctuation">)</span>p <span class="token operator">=</span> iroot<span class="token punctuation">(</span>n<span class="token operator">//</span><span class="token punctuation">(</span><span class="token number">20210123</span><span class="token operator">**</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>q <span class="token operator">=</span> findPrime<span class="token punctuation">(</span><span class="token number">20210123</span> <span class="token operator">*</span> p <span class="token operator">*</span> p<span class="token punctuation">)</span>r <span class="token operator">=</span> findPrime<span class="token punctuation">(</span>p <span class="token operator">*</span> q <span class="token operator">*</span> q<span class="token punctuation">)</span>s <span class="token operator">=</span> findPrime<span class="token punctuation">(</span>p <span class="token operator">*</span> q <span class="token operator">*</span> r<span class="token punctuation">)</span>n <span class="token operator">=</span> p <span class="token operator">*</span> q <span class="token operator">*</span> r <span class="token operator">*</span> se <span class="token operator">=</span> <span class="token number">0x10001</span>phi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>r<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>s<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> phi<span class="token punctuation">)</span><span class="token keyword">print</span> n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># flag&#123;we11_y0U_aRe_n07_AFra1d_0F_nA1VE_R5A_NOw~&#125;</span></code></pre><h2 id="某校月赛"><a href="#某校月赛" class="headerlink" title="某校月赛"></a>某校月赛</h2><pre class="language-python" data-language="python"><code class="language-python">m <span class="token operator">=</span> <span class="token string">"CSA&#123;xxxx...&#125;"</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">GetP</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>a<span class="token punctuation">)</span>    <span class="token keyword">print</span> a<span class="token operator">*</span>b    c <span class="token operator">=</span> <span class="token punctuation">(</span>sympy<span class="token punctuation">.</span>factorial<span class="token punctuation">(</span>a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>b    p <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span>c<span class="token punctuation">)</span>    <span class="token keyword">return</span> p<span class="token keyword">def</span> <span class="token function">GetQ</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    b <span class="token operator">=</span> getPrime<span class="token punctuation">(</span><span class="token number">1024</span><span class="token punctuation">)</span>    <span class="token keyword">assert</span> a<span class="token operator">></span>b    <span class="token keyword">print</span> b    q <span class="token operator">=</span> gmpy2<span class="token punctuation">.</span>next_prime<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span><span class="token builtin">pow</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> qe <span class="token operator">=</span> <span class="token number">0x10001</span>p <span class="token operator">=</span> GetP<span class="token punctuation">(</span><span class="token punctuation">)</span>q <span class="token operator">=</span> GetQ<span class="token punctuation">(</span><span class="token punctuation">)</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qc <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span>e<span class="token punctuation">,</span>n<span class="token punctuation">)</span><span class="token keyword">print</span> c</code></pre><p>因b是a的下一个质数，所以相差不大，可以先开方再依次减一来爆破<br>大整数求阶乘模，相差不多，可用威尔逊定理</p><pre class="language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">wilson</span><span class="token punctuation">(</span>A<span class="token punctuation">,</span>B<span class="token punctuation">)</span><span class="token punctuation">:</span>t<span class="token operator">=</span>A<span class="token operator">-</span>B<span class="token operator">-</span><span class="token number">1</span>res<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>k<span class="token operator">=</span>A<span class="token operator">-</span><span class="token number">1</span><span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>t<span class="token punctuation">)</span><span class="token punctuation">:</span>res<span class="token operator">=</span><span class="token punctuation">(</span>res<span class="token operator">*</span>invert<span class="token punctuation">(</span>k<span class="token punctuation">,</span>A<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">%</span>Ak<span class="token operator">=</span>k<span class="token operator">-</span><span class="token number">1</span><span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token operator">&lt;</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span> res<span class="token operator">+</span>A<span class="token keyword">else</span><span class="token punctuation">:</span><span class="token keyword">return</span> rese <span class="token operator">=</span> <span class="token number">0x10001</span>a_b <span class="token operator">=</span> <span class="token number">8791983291862316547120032002246797778973254864878605386970992669673492259939968094797888952000007665099557258875733921945858542033686958451053071321949445567554111280121591346171077943880260679125991880697230370219526880175562742459075094530147965941656736934866149682649579460280980677646021442609216740720035530819475189210391218236576964069192397380463810610320042000382292193209315399852054457274097472992485848055230344883241567824771770093197030208652860081386700063761662731826974842068243177453217775722649679295194925961548515215408631410811652474082983292228905477331688617735677908498102304912120235373673</span>b <span class="token operator">=</span> <span class="token number">118830448651410685339257790004824429485649682854840323484849009324486118171877706146949014994839630959269120471558355441928485561834486801067099318678275406237859608336855343079327803228141993768895085486382938883215719857931006640727311171816907582743931515808064737866306165395059736627157339004410141600439</span>c <span class="token operator">=</span> <span class="token number">1883542149569091174279536150168908263646954186271291671824785843443243892583487651671300286308926172470442971603905412854092328155166231193046952547441484309496731233232032329302915437265167230962789623953726262153609071938085116529042215589144472265020275468260088671221409979372525200484718932529778499387278835971899408449219198570586884993769637405957394495603493918863913753918387538916758810844800356847596945689024738607675026456041290170218954590732925097228128824030100261173705092887218946711496138633451915979360395821610285826057145659991391437575320290538094685588193509092498259185122588642642635746</span>_a <span class="token operator">=</span> iroot<span class="token punctuation">(</span>a_b<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>_b <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>_a<span class="token punctuation">)</span><span class="token comment"># while _a*_b!=a_b:</span><span class="token comment"># _a -= 1</span><span class="token comment"># _b = next_prime(_a)</span><span class="token comment"># print _a</span><span class="token comment"># print _b</span>_a <span class="token operator">=</span> <span class="token number">93765576262625915496683241788947101718343164873988642315984413216815591384688881866482241684943051686788225803937137421688879814888625596496853667570833634103978674488665724274162336184943604672899422874130229212143055853110350654929253902909062114677358501123568396278075295297381414205770662659185396216063</span>_b <span class="token operator">=</span> <span class="token number">93765576262625915496683241788947101718343164873988642315984413216815591384688881866482241684943051686788225803937137421688879814888625596496853667570833634103978674488665724274162336184943604672899422874130229212143055853110350654929253902909062114677358501123568396278075295297381414205770662659185396216471</span>q <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>b<span class="token punctuation">)</span>_c <span class="token operator">=</span> wilson<span class="token punctuation">(</span>_b<span class="token punctuation">,</span> _a<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span>p <span class="token operator">=</span> next_prime<span class="token punctuation">(</span>_c<span class="token punctuation">)</span>d <span class="token operator">=</span> invert<span class="token punctuation">(</span>e<span class="token punctuation">,</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span> n2s<span class="token punctuation">(</span><span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> p<span class="token operator">*</span>q<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># CSA&#123;RSARSaRsarsaRS4Rs4rs4rS4&#125;</span></code></pre>]]></content>
      
      
      <categories>
          
          <category> writeup </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
